(function($t,Qe){typeof exports=="object"&&typeof module=="object"?module.exports=Qe():typeof define=="function"&&define.amd?define([],Qe):typeof exports=="object"?exports.videojs=Qe():$t.videojs=Qe()})(this,function(){return(()=>{var pi={477:oe=>{function re(K){if(K===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return K}oe.exports=re,oe.exports.default=oe.exports,oe.exports.__esModule=!0},811:(oe,re,K)=>{var M=K(470),H=K(751);function k(x,j,F){return H()?(oe.exports=k=Reflect.construct,oe.exports.default=oe.exports,oe.exports.__esModule=!0):(oe.exports=k=function(O,y,C){var P=[null];P.push.apply(P,y);var u=Function.bind.apply(O,P),d=new u;return C&&M(d,C.prototype),d},oe.exports.default=oe.exports,oe.exports.__esModule=!0),k.apply(null,arguments)}oe.exports=k,oe.exports.default=oe.exports,oe.exports.__esModule=!0},723:oe=>{function re(){return oe.exports=re=Object.assign||function(K){for(var M=1;M<arguments.length;M++){var H=arguments[M];for(var k in H)Object.prototype.hasOwnProperty.call(H,k)&&(K[k]=H[k])}return K},oe.exports.default=oe.exports,oe.exports.__esModule=!0,re.apply(this,arguments)}oe.exports=re,oe.exports.default=oe.exports,oe.exports.__esModule=!0},324:(oe,re,K)=>{var M=K(470);function H(k,x){if(typeof x!="function"&&x!==null)throw new TypeError("Super expression must either be null or a function");k.prototype=Object.create(x&&x.prototype,{constructor:{value:k,writable:!0,configurable:!0}}),x&&M(k,x)}oe.exports=H,oe.exports.default=oe.exports,oe.exports.__esModule=!0},743:(oe,re,K)=>{var M=K(470);function H(k,x){k.prototype=Object.create(x.prototype),k.prototype.constructor=k,M(k,x)}oe.exports=H,oe.exports.default=oe.exports,oe.exports.__esModule=!0},751:oe=>{function re(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(K){return!1}}oe.exports=re,oe.exports.default=oe.exports,oe.exports.__esModule=!0},470:oe=>{function re(K,M){return oe.exports=re=Object.setPrototypeOf||function(k,x){return k.__proto__=x,k},oe.exports.default=oe.exports,oe.exports.__esModule=!0,re(K,M)}oe.exports=re,oe.exports.default=oe.exports,oe.exports.__esModule=!0},480:(oe,re,K)=>{"use strict";var M=K(697),H=function(j,F){return F===void 0&&(F=!1),function(R,O,y){if(R){j(R);return}if(O.statusCode>=400&&O.statusCode<=599){var C=y;if(F)if(M.TextDecoder){var P=k(O.headers&&O.headers["content-type"]);try{C=new TextDecoder(P).decode(y)}catch(u){}}else C=String.fromCharCode.apply(null,new Uint8Array(y));j({cause:C});return}j(null,y)}};function k(x){return x===void 0&&(x=""),x.toLowerCase().split(";").reduce(function(j,F){var R=F.split("="),O=R[0],y=R[1];return O.trim()==="charset"?y.trim():j},"utf-8")}oe.exports=H},424:(oe,re,K)=>{"use strict";var M=K(697),H=K(723),k=K(988);O.httpHandler=K(480);/**
 * @license
 * slighly modified parse-headers 2.0.2 <https://github.com/kesla/parse-headers/>
 * Copyright (c) 2014 David Bj√∂rklund
 * Available under the MIT license
 * <https://github.com/kesla/parse-headers/blob/master/LICENCE>
 */var x=function(d){var E={};return d&&d.trim().split(`
`).forEach(function(c){var a=c.indexOf(":"),i=c.slice(0,a).trim().toLowerCase(),l=c.slice(a+1).trim();typeof E[i]=="undefined"?E[i]=l:Array.isArray(E[i])?E[i].push(l):E[i]=[E[i],l]}),E};oe.exports=O,oe.exports.default=O,O.XMLHttpRequest=M.XMLHttpRequest||P,O.XDomainRequest="withCredentials"in new O.XMLHttpRequest?O.XMLHttpRequest:M.XDomainRequest,j(["get","put","post","patch","head","delete"],function(u){O[u==="delete"?"del":u]=function(d,E,c){return E=R(d,E,c),E.method=u.toUpperCase(),y(E)}});function j(u,d){for(var E=0;E<u.length;E++)d(u[E])}function F(u){for(var d in u)if(u.hasOwnProperty(d))return!1;return!0}function R(u,d,E){var c=u;return k(d)?(E=d,typeof u=="string"&&(c={uri:u})):c=H({},d,{uri:u}),c.callback=E,c}function O(u,d,E){return d=R(u,d,E),y(d)}function y(u){if(typeof u.callback=="undefined")throw new Error("callback argument missing");var d=!1,E=function(I,w,B){d||(d=!0,u.callback(I,w,B))};function c(){p.readyState===4&&setTimeout(l,0)}function a(){var D=void 0;if(p.response?D=p.response:D=p.responseText||C(p),s)try{D=JSON.parse(D)}catch(I){}return D}function i(D){return clearTimeout(A),D instanceof Error||(D=new Error(""+(D||"Unknown XMLHttpRequest Error"))),D.statusCode=0,E(D,_)}function l(){if(!h){var D;clearTimeout(A),u.useXDR&&p.status===void 0?D=200:D=p.status===1223?204:p.status;var I=_,w=null;return D!==0?(I={body:a(),statusCode:D,method:L,headers:{},url:m,rawRequest:p},p.getAllResponseHeaders&&(I.headers=x(p.getAllResponseHeaders()))):w=new Error("Internal XMLHttpRequest Error"),E(w,I,I.body)}}var p=u.xhr||null;p||(u.cors||u.useXDR?p=new O.XDomainRequest:p=new O.XMLHttpRequest);var f,h,m=p.url=u.uri||u.url,L=p.method=u.method||"GET",S=u.body||u.data,v=p.headers=u.headers||{},n=!!u.sync,s=!1,A,_={body:void 0,headers:{},statusCode:0,method:L,url:m,rawRequest:p};if("json"in u&&u.json!==!1&&(s=!0,v.accept||v.Accept||(v.Accept="application/json"),L!=="GET"&&L!=="HEAD"&&(v["content-type"]||v["Content-Type"]||(v["Content-Type"]="application/json"),S=JSON.stringify(u.json===!0?S:u.json))),p.onreadystatechange=c,p.onload=l,p.onerror=i,p.onprogress=function(){},p.onabort=function(){h=!0},p.ontimeout=i,p.open(L,m,!n,u.username,u.password),n||(p.withCredentials=!!u.withCredentials),!n&&u.timeout>0&&(A=setTimeout(function(){if(!h){h=!0,p.abort("timeout");var D=new Error("XMLHttpRequest timeout");D.code="ETIMEDOUT",i(D)}},u.timeout)),p.setRequestHeader)for(f in v)v.hasOwnProperty(f)&&p.setRequestHeader(f,v[f]);else if(u.headers&&!F(u.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in u&&(p.responseType=u.responseType),"beforeSend"in u&&typeof u.beforeSend=="function"&&u.beforeSend(p),p.send(S||null),p}function C(u){try{if(u.responseType==="document")return u.responseXML;var d=u.responseXML&&u.responseXML.documentElement.nodeName==="parsererror";if(u.responseType===""&&!d)return u.responseXML}catch(E){}return null}function P(){}},675:(oe,re,K)=>{var M=typeof K.g!="undefined"?K.g:typeof window!="undefined"?window:{},H=K(893),k;typeof document!="undefined"?k=document:(k=M["__GLOBAL_DOCUMENT_CACHE@4"],k||(k=M["__GLOBAL_DOCUMENT_CACHE@4"]=H)),oe.exports=k},697:(oe,re,K)=>{var M;typeof window!="undefined"?M=window:typeof K.g!="undefined"?M=K.g:typeof self!="undefined"?M=self:M={},oe.exports=M},199:function(oe){typeof window!="undefined"&&function(K,M){oe.exports=M()}(this,function(){return function(re){var K={};function M(H){if(K[H])return K[H].exports;var k=K[H]={i:H,l:!1,exports:{}};return re[H].call(k.exports,k,k.exports,M),k.l=!0,k.exports}return M.m=re,M.c=K,M.d=function(H,k,x){M.o(H,k)||Object.defineProperty(H,k,{enumerable:!0,get:x})},M.r=function(H){typeof Symbol!="undefined"&&Symbol.toStringTag&&Object.defineProperty(H,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(H,"__esModule",{value:!0})},M.t=function(H,k){if(k&1&&(H=M(H)),k&8||k&4&&typeof H=="object"&&H&&H.__esModule)return H;var x=Object.create(null);if(M.r(x),Object.defineProperty(x,"default",{enumerable:!0,value:H}),k&2&&typeof H!="string")for(var j in H)M.d(x,j,function(F){return H[F]}.bind(null,j));return x},M.n=function(H){var k=H&&H.__esModule?function(){return H.default}:function(){return H};return M.d(k,"a",k),k},M.o=function(H,k){return Object.prototype.hasOwnProperty.call(H,k)},M.p="/dist/",M(M.s="./src/hls.ts")}({"./node_modules/eventemitter3/index.js":function(re,K,M){"use strict";var H=Object.prototype.hasOwnProperty,k="~";function x(){}Object.create&&(x.prototype=Object.create(null),new x().__proto__||(k=!1));function j(y,C,P){this.fn=y,this.context=C,this.once=P||!1}function F(y,C,P,u,d){if(typeof P!="function")throw new TypeError("The listener must be a function");var E=new j(P,u||y,d),c=k?k+C:C;return y._events[c]?y._events[c].fn?y._events[c]=[y._events[c],E]:y._events[c].push(E):(y._events[c]=E,y._eventsCount++),y}function R(y,C){--y._eventsCount==0?y._events=new x:delete y._events[C]}function O(){this._events=new x,this._eventsCount=0}O.prototype.eventNames=function(){var C=[],P,u;if(this._eventsCount===0)return C;for(u in P=this._events)H.call(P,u)&&C.push(k?u.slice(1):u);return Object.getOwnPropertySymbols?C.concat(Object.getOwnPropertySymbols(P)):C},O.prototype.listeners=function(C){var P=k?k+C:C,u=this._events[P];if(!u)return[];if(u.fn)return[u.fn];for(var d=0,E=u.length,c=new Array(E);d<E;d++)c[d]=u[d].fn;return c},O.prototype.listenerCount=function(C){var P=k?k+C:C,u=this._events[P];return u?u.fn?1:u.length:0},O.prototype.emit=function(C,P,u,d,E,c){var a=k?k+C:C;if(!this._events[a])return!1;var i=this._events[a],l=arguments.length,p,f;if(i.fn){switch(i.once&&this.removeListener(C,i.fn,void 0,!0),l){case 1:return i.fn.call(i.context),!0;case 2:return i.fn.call(i.context,P),!0;case 3:return i.fn.call(i.context,P,u),!0;case 4:return i.fn.call(i.context,P,u,d),!0;case 5:return i.fn.call(i.context,P,u,d,E),!0;case 6:return i.fn.call(i.context,P,u,d,E,c),!0}for(f=1,p=new Array(l-1);f<l;f++)p[f-1]=arguments[f];i.fn.apply(i.context,p)}else{var h=i.length,m;for(f=0;f<h;f++)switch(i[f].once&&this.removeListener(C,i[f].fn,void 0,!0),l){case 1:i[f].fn.call(i[f].context);break;case 2:i[f].fn.call(i[f].context,P);break;case 3:i[f].fn.call(i[f].context,P,u);break;case 4:i[f].fn.call(i[f].context,P,u,d);break;default:if(!p)for(m=1,p=new Array(l-1);m<l;m++)p[m-1]=arguments[m];i[f].fn.apply(i[f].context,p)}}return!0},O.prototype.on=function(C,P,u){return F(this,C,P,u,!1)},O.prototype.once=function(C,P,u){return F(this,C,P,u,!0)},O.prototype.removeListener=function(C,P,u,d){var E=k?k+C:C;if(!this._events[E])return this;if(!P)return R(this,E),this;var c=this._events[E];if(c.fn)c.fn===P&&(!d||c.once)&&(!u||c.context===u)&&R(this,E);else{for(var a=0,i=[],l=c.length;a<l;a++)(c[a].fn!==P||d&&!c[a].once||u&&c[a].context!==u)&&i.push(c[a]);i.length?this._events[E]=i.length===1?i[0]:i:R(this,E)}return this},O.prototype.removeAllListeners=function(C){var P;return C?(P=k?k+C:C,this._events[P]&&R(this,P)):(this._events=new x,this._eventsCount=0),this},O.prototype.off=O.prototype.removeListener,O.prototype.addListener=O.prototype.on,O.prefixed=k,O.EventEmitter=O,re.exports=O},"./node_modules/url-toolkit/src/url-toolkit.js":function(re,K,M){(function(H){var k=/^((?:[a-zA-Z0-9+\-.]+:)?)(\/\/[^\/?#]*)?((?:[^\/?#]*\/)*[^;?#]*)?(;[^?#]*)?(\?[^#]*)?(#[^]*)?$/,x=/^([^\/?#]*)([^]*)$/,j=/(?:\/|^)\.(?=\/)/g,F=/(?:\/|^)\.\.\/(?!\.\.\/)[^\/]*(?=\/)/g,R={buildAbsoluteURL:function(O,y,C){if(C=C||{},O=O.trim(),y=y.trim(),!y){if(!C.alwaysNormalize)return O;var P=R.parseURL(O);if(!P)throw new Error("Error trying to parse base URL.");return P.path=R.normalizePath(P.path),R.buildURLFromParts(P)}var u=R.parseURL(y);if(!u)throw new Error("Error trying to parse relative URL.");if(u.scheme)return C.alwaysNormalize?(u.path=R.normalizePath(u.path),R.buildURLFromParts(u)):y;var d=R.parseURL(O);if(!d)throw new Error("Error trying to parse base URL.");if(!d.netLoc&&d.path&&d.path[0]!=="/"){var E=x.exec(d.path);d.netLoc=E[1],d.path=E[2]}d.netLoc&&!d.path&&(d.path="/");var c={scheme:d.scheme,netLoc:u.netLoc,path:null,params:u.params,query:u.query,fragment:u.fragment};if(!u.netLoc&&(c.netLoc=d.netLoc,u.path[0]!=="/"))if(!u.path)c.path=d.path,u.params||(c.params=d.params,u.query||(c.query=d.query));else{var a=d.path,i=a.substring(0,a.lastIndexOf("/")+1)+u.path;c.path=R.normalizePath(i)}return c.path===null&&(c.path=C.alwaysNormalize?R.normalizePath(u.path):u.path),R.buildURLFromParts(c)},parseURL:function(O){var y=k.exec(O);return y?{scheme:y[1]||"",netLoc:y[2]||"",path:y[3]||"",params:y[4]||"",query:y[5]||"",fragment:y[6]||""}:null},normalizePath:function(O){for(O=O.split("").reverse().join("").replace(j,"");O.length!==(O=O.replace(F,"")).length;);return O.split("").reverse().join("")},buildURLFromParts:function(O){return O.scheme+O.netLoc+O.path+O.params+O.query+O.fragment}};re.exports=R})(this)},"./node_modules/webworkify-webpack/index.js":function(re,K,M){function H(C){var P={};function u(E){if(P[E])return P[E].exports;var c=P[E]={i:E,l:!1,exports:{}};return C[E].call(c.exports,c,c.exports,u),c.l=!0,c.exports}u.m=C,u.c=P,u.i=function(E){return E},u.d=function(E,c,a){u.o(E,c)||Object.defineProperty(E,c,{configurable:!1,enumerable:!0,get:a})},u.r=function(E){Object.defineProperty(E,"__esModule",{value:!0})},u.n=function(E){var c=E&&E.__esModule?function(){return E.default}:function(){return E};return u.d(c,"a",c),c},u.o=function(E,c){return Object.prototype.hasOwnProperty.call(E,c)},u.p="/",u.oe=function(E){throw console.error(E),E};var d=u(u.s=ENTRY_MODULE);return d.default||d}var k="[\\.|\\-|\\+|\\w|/|@]+",x="\\(\\s*(/\\*.*?\\*/)?\\s*.*?("+k+").*?\\)";function j(C){return(C+"").replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}function F(C){return!isNaN(1*C)}function R(C,P,u){var d={};d[u]=[];var E=P.toString(),c=E.match(/^function\s?\w*\(\w+,\s*\w+,\s*(\w+)\)/);if(!c)return d;for(var a=c[1],i=new RegExp("(\\\\n|\\W)"+j(a)+x,"g"),l;l=i.exec(E);)l[3]!=="dll-reference"&&d[u].push(l[3]);for(i=new RegExp("\\("+j(a)+'\\("(dll-reference\\s('+k+'))"\\)\\)'+x,"g");l=i.exec(E);)C[l[2]]||(d[u].push(l[1]),C[l[2]]=M(l[1]).m),d[l[2]]=d[l[2]]||[],d[l[2]].push(l[4]);for(var p=Object.keys(d),f=0;f<p.length;f++)for(var h=0;h<d[p[f]].length;h++)F(d[p[f]][h])&&(d[p[f]][h]=1*d[p[f]][h]);return d}function O(C){var P=Object.keys(C);return P.reduce(function(u,d){return u||C[d].length>0},!1)}function y(C,P){for(var u={main:[P]},d={main:[]},E={main:{}};O(u);)for(var c=Object.keys(u),a=0;a<c.length;a++){var i=c[a],l=u[i],p=l.pop();if(E[i]=E[i]||{},!(E[i][p]||!C[i][p])){E[i][p]=!0,d[i]=d[i]||[],d[i].push(p);for(var f=R(C,C[i][p],i),h=Object.keys(f),m=0;m<h.length;m++)u[h[m]]=u[h[m]]||[],u[h[m]]=u[h[m]].concat(f[h[m]])}}return d}re.exports=function(C,P){P=P||{};var u={main:M.m},d=P.all?{main:Object.keys(u.main)}:y(u,C),E="";Object.keys(d).filter(function(p){return p!=="main"}).forEach(function(p){for(var f=0;d[p][f];)f++;d[p].push(f),u[p][f]="(function(module, exports, __webpack_require__) { module.exports = __webpack_require__; })",E=E+"var "+p+" = ("+H.toString().replace("ENTRY_MODULE",JSON.stringify(f))+")({"+d[p].map(function(h){return""+JSON.stringify(h)+": "+u[p][h].toString()}).join(",")+`});
`}),E=E+"new (("+H.toString().replace("ENTRY_MODULE",JSON.stringify(C))+")({"+d.main.map(function(p){return""+JSON.stringify(p)+": "+u.main[p].toString()}).join(",")+"}))(self);";var c=new window.Blob([E],{type:"text/javascript"});if(P.bare)return c;var a=window.URL||window.webkitURL||window.mozURL||window.msURL,i=a.createObjectURL(c),l=new window.Worker(i);return l.objectURL=i,l}},"./src/config.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"hlsDefaultConfig",function(){return h}),M.d(K,"mergeConfig",function(){return L}),M.d(K,"enableStreamingMode",function(){return S});var H=M("./src/controller/abr-controller.ts"),k=M("./src/controller/audio-stream-controller.ts"),x=M("./src/controller/audio-track-controller.ts"),j=M("./src/controller/subtitle-stream-controller.ts"),F=M("./src/controller/subtitle-track-controller.ts"),R=M("./src/controller/buffer-controller.ts"),O=M("./src/controller/timeline-controller.ts"),y=M("./src/controller/cap-level-controller.ts"),C=M("./src/controller/fps-controller.ts"),P=M("./src/controller/eme-controller.ts"),u=M("./src/utils/xhr-loader.ts"),d=M("./src/utils/fetch-loader.ts"),E=M("./src/utils/cues.ts"),c=M("./src/utils/mediakeys-helper.ts"),a=M("./src/utils/logger.ts");function i(){return i=Object.assign||function(v){for(var n=1;n<arguments.length;n++){var s=arguments[n];for(var A in s)Object.prototype.hasOwnProperty.call(s,A)&&(v[A]=s[A])}return v},i.apply(this,arguments)}function l(v,n){var s=Object.keys(v);if(Object.getOwnPropertySymbols){var A=Object.getOwnPropertySymbols(v);n&&(A=A.filter(function(_){return Object.getOwnPropertyDescriptor(v,_).enumerable})),s.push.apply(s,A)}return s}function p(v){for(var n=1;n<arguments.length;n++){var s=arguments[n]!=null?arguments[n]:{};n%2?l(Object(s),!0).forEach(function(A){f(v,A,s[A])}):Object.getOwnPropertyDescriptors?Object.defineProperties(v,Object.getOwnPropertyDescriptors(s)):l(Object(s)).forEach(function(A){Object.defineProperty(v,A,Object.getOwnPropertyDescriptor(s,A))})}return v}function f(v,n,s){return n in v?Object.defineProperty(v,n,{value:s,enumerable:!0,configurable:!0,writable:!0}):v[n]=s,v}var h=p(p({autoStartLoad:!0,startPosition:-1,defaultAudioCodec:void 0,debug:!1,capLevelOnFPSDrop:!1,capLevelToPlayerSize:!1,initialLiveManifestSize:1,maxBufferLength:30,backBufferLength:Infinity,maxBufferSize:60*1e3*1e3,maxBufferHole:.1,highBufferWatchdogPeriod:2,nudgeOffset:.1,nudgeMaxRetry:3,maxFragLookUpTolerance:.25,liveSyncDurationCount:3,liveMaxLatencyDurationCount:Infinity,liveSyncDuration:void 0,liveMaxLatencyDuration:void 0,maxLiveSyncPlaybackRate:1,liveDurationInfinity:!1,liveBackBufferLength:null,maxMaxBufferLength:600,enableWorker:!0,enableSoftwareAES:!0,manifestLoadingTimeOut:1e4,manifestLoadingMaxRetry:1,manifestLoadingRetryDelay:1e3,manifestLoadingMaxRetryTimeout:64e3,startLevel:void 0,levelLoadingTimeOut:1e4,levelLoadingMaxRetry:4,levelLoadingRetryDelay:1e3,levelLoadingMaxRetryTimeout:64e3,fragLoadingTimeOut:2e4,fragLoadingMaxRetry:6,fragLoadingRetryDelay:1e3,fragLoadingMaxRetryTimeout:64e3,startFragPrefetch:!1,fpsDroppedMonitoringPeriod:5e3,fpsDroppedMonitoringThreshold:.2,appendErrorMaxRetry:3,loader:u.default,fLoader:void 0,pLoader:void 0,xhrSetup:void 0,licenseXhrSetup:void 0,licenseResponseCallback:void 0,abrController:H.default,bufferController:R.default,capLevelController:y.default,fpsController:C.default,stretchShortVideoTrack:!1,maxAudioFramesDrift:1,forceKeyFrameOnDiscontinuity:!0,abrEwmaFastLive:3,abrEwmaSlowLive:9,abrEwmaFastVoD:3,abrEwmaSlowVoD:9,abrEwmaDefaultEstimate:5e5,abrBandWidthFactor:.95,abrBandWidthUpFactor:.7,abrMaxWithRealBitrate:!1,maxStarvationDelay:4,maxLoadingDelay:4,minAutoBitrate:0,emeEnabled:!1,widevineLicenseUrl:void 0,drmSystemOptions:{},requestMediaKeySystemAccessFunc:c.requestMediaKeySystemAccess,testBandwidth:!0,progressive:!1,lowLatencyMode:!0},m()),{},{subtitleStreamController:j.SubtitleStreamController,subtitleTrackController:F.default,timelineController:O.TimelineController,audioStreamController:k.default,audioTrackController:x.default,emeController:P.default});function m(){return{cueHandler:E.default,enableCEA708Captions:!0,enableWebVTT:!0,enableIMSC1:!0,captionsTextTrack1Label:"English",captionsTextTrack1LanguageCode:"en",captionsTextTrack2Label:"Spanish",captionsTextTrack2LanguageCode:"es",captionsTextTrack3Label:"Unknown CC",captionsTextTrack3LanguageCode:"",captionsTextTrack4Label:"Unknown CC",captionsTextTrack4LanguageCode:"",renderTextTracksNatively:!0}}function L(v,n){if((n.liveSyncDurationCount||n.liveMaxLatencyDurationCount)&&(n.liveSyncDuration||n.liveMaxLatencyDuration))throw new Error("Illegal hls.js config: don't mix up liveSyncDurationCount/liveMaxLatencyDurationCount and liveSyncDuration/liveMaxLatencyDuration");if(n.liveMaxLatencyDurationCount!==void 0&&(n.liveSyncDurationCount===void 0||n.liveMaxLatencyDurationCount<=n.liveSyncDurationCount))throw new Error('Illegal hls.js config: "liveMaxLatencyDurationCount" must be greater than "liveSyncDurationCount"');if(n.liveMaxLatencyDuration!==void 0&&(n.liveSyncDuration===void 0||n.liveMaxLatencyDuration<=n.liveSyncDuration))throw new Error('Illegal hls.js config: "liveMaxLatencyDuration" must be greater than "liveSyncDuration"');return i({},v,n)}function S(v){var n=v.loader;if(n!==d.default&&n!==u.default)a.logger.log("[config]: Custom loader detected, cannot enable progressive streaming"),v.progressive=!1;else{var s=Object(d.fetchSupported)();s&&(v.loader=d.default,v.progressive=!0,v.enableSoftwareAES=!0,a.logger.log("[config]: Progressive streaming enabled, using FetchLoader"))}}},"./src/controller/abr-controller.ts":function(re,K,M){"use strict";M.r(K);var H=M("./src/polyfills/number.ts"),k=M("./src/utils/ewma-bandwidth-estimator.ts"),x=M("./src/events.ts"),j=M("./src/utils/buffer-helper.ts"),F=M("./src/errors.ts"),R=M("./src/types/loader.ts"),O=M("./src/utils/logger.ts");function y(u,d){for(var E=0;E<d.length;E++){var c=d[E];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(u,c.key,c)}}function C(u,d,E){return d&&y(u.prototype,d),E&&y(u,E),u}var P=function(){function u(E){this.hls=void 0,this.lastLoadedFragLevel=0,this._nextAutoLevel=-1,this.timer=void 0,this.onCheck=this._abandonRulesCheck.bind(this),this.fragCurrent=null,this.partCurrent=null,this.bitrateTestDelay=0,this.bwEstimator=void 0,this.hls=E;var c=E.config;this.bwEstimator=new k.default(c.abrEwmaSlowVoD,c.abrEwmaFastVoD,c.abrEwmaDefaultEstimate),this.registerListeners()}var d=u.prototype;return d.registerListeners=function(){var c=this.hls;c.on(x.Events.FRAG_LOADING,this.onFragLoading,this),c.on(x.Events.FRAG_LOADED,this.onFragLoaded,this),c.on(x.Events.FRAG_BUFFERED,this.onFragBuffered,this),c.on(x.Events.LEVEL_LOADED,this.onLevelLoaded,this),c.on(x.Events.ERROR,this.onError,this)},d.unregisterListeners=function(){var c=this.hls;c.off(x.Events.FRAG_LOADING,this.onFragLoading,this),c.off(x.Events.FRAG_LOADED,this.onFragLoaded,this),c.off(x.Events.FRAG_BUFFERED,this.onFragBuffered,this),c.off(x.Events.LEVEL_LOADED,this.onLevelLoaded,this),c.off(x.Events.ERROR,this.onError,this)},d.destroy=function(){this.unregisterListeners(),this.clearTimer(),this.hls=this.onCheck=null,this.fragCurrent=this.partCurrent=null},d.onFragLoading=function(c,a){var i=a.frag;if(i.type===R.PlaylistLevelType.MAIN&&!this.timer){var l;this.fragCurrent=i,this.partCurrent=(l=a.part)!=null?l:null,this.timer=self.setInterval(this.onCheck,100)}},d.onLevelLoaded=function(c,a){var i=this.hls.config;a.details.live?this.bwEstimator.update(i.abrEwmaSlowLive,i.abrEwmaFastLive):this.bwEstimator.update(i.abrEwmaSlowVoD,i.abrEwmaFastVoD)},d._abandonRulesCheck=function(){var c=this.fragCurrent,a=this.partCurrent,i=this.hls,l=i.autoLevelEnabled,p=i.config,f=i.media;if(!(!c||!f)){var h=a?a.stats:c.stats,m=a?a.duration:c.duration;if(h.aborted){O.logger.warn("frag loader destroy or aborted, disarm abandonRules"),this.clearTimer(),this._nextAutoLevel=-1;return}if(!(!l||f.paused||!f.playbackRate||!f.readyState)){var L=performance.now()-h.loading.start,S=Math.abs(f.playbackRate);if(!(L<=500*m/S)){var v=i.levels,n=i.minAutoLevel,s=v[c.level],A=h.total||Math.max(h.loaded,Math.round(m*s.maxBitrate/8)),_=Math.max(1,h.bwEstimate?h.bwEstimate/8:h.loaded*1e3/L),D=(A-h.loaded)/_,I=f.currentTime,w=(j.BufferHelper.bufferInfo(f,I,p.maxBufferHole).end-I)/S;if(!(w>=2*m/S||D<=w)){var B=Number.POSITIVE_INFINITY,N;for(N=c.level-1;N>n;N--){var W=v[N].maxBitrate;if(B=m*W/(8*.8*_),B<w)break}if(!(B>=D)){var G=this.bwEstimator.getEstimate();O.logger.warn("Fragment "+c.sn+(a?" part "+a.index:"")+" of level "+c.level+" is loading too slowly and will cause an underbuffer; aborting and switching to level "+N+`
      Current BW estimate: `+(Object(H.isFiniteNumber)(G)?(G/1024).toFixed(3):"Unknown")+` Kb/s
      Estimated load time for current fragment: `+D.toFixed(3)+` s
      Estimated load time for the next fragment: `+B.toFixed(3)+` s
      Time to underbuffer: `+w.toFixed(3)+" s"),i.nextLoadLevel=N,this.bwEstimator.sample(L,h.loaded),this.clearTimer(),c.loader&&(this.fragCurrent=this.partCurrent=null,c.loader.abort()),i.trigger(x.Events.FRAG_LOAD_EMERGENCY_ABORTED,{frag:c,part:a,stats:h})}}}}}},d.onFragLoaded=function(c,a){var i=a.frag,l=a.part;if(i.type===R.PlaylistLevelType.MAIN&&Object(H.isFiniteNumber)(i.sn)){var p=l?l.stats:i.stats,f=l?l.duration:i.duration;if(this.clearTimer(),this.lastLoadedFragLevel=i.level,this._nextAutoLevel=-1,this.hls.config.abrMaxWithRealBitrate){var h=this.hls.levels[i.level],m=(h.loaded?h.loaded.bytes:0)+p.loaded,L=(h.loaded?h.loaded.duration:0)+f;h.loaded={bytes:m,duration:L},h.realBitrate=Math.round(8*m/L)}if(i.bitrateTest){var S={stats:p,frag:i,part:l,id:i.type};this.onFragBuffered(x.Events.FRAG_BUFFERED,S),i.bitrateTest=!1}}},d.onFragBuffered=function(c,a){var i=a.frag,l=a.part,p=l?l.stats:i.stats;if(!p.aborted&&!(i.type!==R.PlaylistLevelType.MAIN||i.sn==="initSegment")){var f=p.parsing.end-p.loading.start;this.bwEstimator.sample(f,p.loaded),p.bwEstimate=this.bwEstimator.getEstimate(),i.bitrateTest?this.bitrateTestDelay=f/1e3:this.bitrateTestDelay=0}},d.onError=function(c,a){switch(a.details){case F.ErrorDetails.FRAG_LOAD_ERROR:case F.ErrorDetails.FRAG_LOAD_TIMEOUT:this.clearTimer();break;default:break}},d.clearTimer=function(){self.clearInterval(this.timer),this.timer=void 0},d.getNextABRAutoLevel=function(){var c=this.fragCurrent,a=this.partCurrent,i=this.hls,l=i.maxAutoLevel,p=i.config,f=i.minAutoLevel,h=i.media,m=a?a.duration:c?c.duration:0,L=h?h.currentTime:0,S=h&&h.playbackRate!==0?Math.abs(h.playbackRate):1,v=this.bwEstimator?this.bwEstimator.getEstimate():p.abrEwmaDefaultEstimate,n=(j.BufferHelper.bufferInfo(h,L,p.maxBufferHole).end-L)/S,s=this.findBestLevel(v,f,l,n,p.abrBandWidthFactor,p.abrBandWidthUpFactor);if(s>=0)return s;O.logger.trace((n?"rebuffering expected":"buffer is empty")+", finding optimal quality level");var A=m?Math.min(m,p.maxStarvationDelay):p.maxStarvationDelay,_=p.abrBandWidthFactor,D=p.abrBandWidthUpFactor;if(!n){var I=this.bitrateTestDelay;if(I){var w=m?Math.min(m,p.maxLoadingDelay):p.maxLoadingDelay;A=w-I,O.logger.trace("bitrate test took "+Math.round(1e3*I)+"ms, set first fragment max fetchDuration to "+Math.round(1e3*A)+" ms"),_=D=1}}return s=this.findBestLevel(v,f,l,n+A,_,D),Math.max(s,0)},d.findBestLevel=function(c,a,i,l,p,f){for(var h,m=this.fragCurrent,L=this.partCurrent,S=this.lastLoadedFragLevel,v=this.hls.levels,n=v[S],s=!!(n!=null&&(h=n.details)!==null&&h!==void 0&&h.live),A=n==null?void 0:n.codecSet,_=L?L.duration:m?m.duration:0,D=i;D>=a;D--){var I=v[D];if(!(!I||A&&I.codecSet!==A)){var w=I.details,B=(L?w==null?void 0:w.partTarget:w==null?void 0:w.averagetargetduration)||_,N=void 0;D<=S?N=p*c:N=f*c;var W=v[D].maxBitrate,G=W*B/N;if(O.logger.trace("level/adjustedbw/bitrate/avgDuration/maxFetchDuration/fetchDuration: "+D+"/"+Math.round(N)+"/"+W+"/"+B+"/"+l+"/"+G),N>W&&(!G||s&&!this.bitrateTestDelay||G<l))return D}}return-1},C(u,[{key:"nextAutoLevel",get:function(){var c=this._nextAutoLevel,a=this.bwEstimator;if(c!==-1&&(!a||!a.canEstimate()))return c;var i=this.getNextABRAutoLevel();return c!==-1&&(i=Math.min(c,i)),i},set:function(c){this._nextAutoLevel=c}}]),u}();K.default=P},"./src/controller/audio-stream-controller.ts":function(re,K,M){"use strict";M.r(K);var H=M("./src/polyfills/number.ts"),k=M("./src/controller/base-stream-controller.ts"),x=M("./src/events.ts"),j=M("./src/utils/buffer-helper.ts"),F=M("./src/controller/fragment-tracker.ts"),R=M("./src/types/level.ts"),O=M("./src/types/loader.ts"),y=M("./src/loader/fragment.ts"),C=M("./src/demux/chunk-cache.ts"),P=M("./src/demux/transmuxer-interface.ts"),u=M("./src/types/transmuxer.ts"),d=M("./src/controller/fragment-finders.ts"),E=M("./src/utils/discontinuities.ts"),c=M("./src/errors.ts"),a=M("./src/utils/logger.ts");function i(){return i=Object.assign||function(m){for(var L=1;L<arguments.length;L++){var S=arguments[L];for(var v in S)Object.prototype.hasOwnProperty.call(S,v)&&(m[v]=S[v])}return m},i.apply(this,arguments)}function l(m,L){m.prototype=Object.create(L.prototype),m.prototype.constructor=m,p(m,L)}function p(m,L){return p=Object.setPrototypeOf||function(v,n){return v.__proto__=n,v},p(m,L)}var f=100,h=function(m){l(L,m);function L(v,n){var s;return s=m.call(this,v,n,"[audio-stream-controller]")||this,s.videoBuffer=null,s.videoTrackCC=-1,s.waitingVideoCC=-1,s.audioSwitch=!1,s.trackId=-1,s.waitingData=null,s.mainDetails=null,s.bufferFlushed=!1,s._registerListeners(),s}var S=L.prototype;return S.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},S._registerListeners=function(){var n=this.hls;n.on(x.Events.MEDIA_ATTACHED,this.onMediaAttached,this),n.on(x.Events.MEDIA_DETACHING,this.onMediaDetaching,this),n.on(x.Events.MANIFEST_LOADING,this.onManifestLoading,this),n.on(x.Events.LEVEL_LOADED,this.onLevelLoaded,this),n.on(x.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),n.on(x.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),n.on(x.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),n.on(x.Events.ERROR,this.onError,this),n.on(x.Events.BUFFER_RESET,this.onBufferReset,this),n.on(x.Events.BUFFER_CREATED,this.onBufferCreated,this),n.on(x.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),n.on(x.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),n.on(x.Events.FRAG_BUFFERED,this.onFragBuffered,this)},S._unregisterListeners=function(){var n=this.hls;n.off(x.Events.MEDIA_ATTACHED,this.onMediaAttached,this),n.off(x.Events.MEDIA_DETACHING,this.onMediaDetaching,this),n.off(x.Events.MANIFEST_LOADING,this.onManifestLoading,this),n.off(x.Events.LEVEL_LOADED,this.onLevelLoaded,this),n.off(x.Events.AUDIO_TRACKS_UPDATED,this.onAudioTracksUpdated,this),n.off(x.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),n.off(x.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),n.off(x.Events.ERROR,this.onError,this),n.off(x.Events.BUFFER_RESET,this.onBufferReset,this),n.off(x.Events.BUFFER_CREATED,this.onBufferCreated,this),n.off(x.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),n.off(x.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),n.off(x.Events.FRAG_BUFFERED,this.onFragBuffered,this)},S.onInitPtsFound=function(n,s){var A=s.frag,_=s.id,D=s.initPTS;if(_==="main"){var I=A.cc;this.initPTS[A.cc]=D,this.log("InitPTS for cc: "+I+" found from main: "+D),this.videoTrackCC=I,this.state===k.State.WAITING_INIT_PTS&&this.tick()}},S.startLoad=function(n){if(!this.levels){this.startPosition=n,this.state=k.State.STOPPED;return}var s=this.lastCurrentTime;this.stopLoad(),this.setInterval(f),this.fragLoadError=0,s>0&&n===-1?(this.log("Override startPosition with lastCurrentTime @"+s.toFixed(3)),this.state=k.State.IDLE):(this.loadedmetadata=!1,this.state=k.State.WAITING_TRACK),this.nextLoadPosition=this.startPosition=this.lastCurrentTime=n,this.tick()},S.doTick=function(){switch(this.state){case k.State.IDLE:this.doTickIdle();break;case k.State.WAITING_TRACK:{var n,s=this.levels,A=this.trackId,_=s==null||(n=s[A])===null||n===void 0?void 0:n.details;if(_){if(this.waitForCdnTuneIn(_))break;this.state=k.State.WAITING_INIT_PTS}break}case k.State.FRAG_LOADING_WAITING_RETRY:{var D,I=performance.now(),w=this.retryDate;(!w||I>=w||(D=this.media)!==null&&D!==void 0&&D.seeking)&&(this.log("RetryDate reached, switch back to IDLE state"),this.state=k.State.IDLE);break}case k.State.WAITING_INIT_PTS:{var B=this.waitingData;if(B){var N=B.frag,W=B.part,G=B.cache,V=B.complete;if(this.initPTS[N.cc]!==void 0){this.waitingData=null,this.waitingVideoCC=-1,this.state=k.State.FRAG_LOADING;var X=G.flush(),$={frag:N,part:W,payload:X,networkDetails:null};this._handleFragmentLoadProgress($),V&&m.prototype._handleFragmentLoadComplete.call(this,$)}else if(this.videoTrackCC!==this.waitingVideoCC)a.logger.log("Waiting fragment cc ("+N.cc+") cancelled because video is at cc "+this.videoTrackCC),this.clearWaitingFragment();else{var q=this.getLoadPosition(),Z=j.BufferHelper.bufferInfo(this.mediaBuffer,q,this.config.maxBufferHole),ee=Object(d.fragmentWithinToleranceTest)(Z.end,this.config.maxFragLookUpTolerance,N);ee<0&&(a.logger.log("Waiting fragment cc ("+N.cc+") @ "+N.start+" cancelled because another fragment at "+Z.end+" is needed"),this.clearWaitingFragment())}}else this.state=k.State.IDLE}}this.onTickEnd()},S.clearWaitingFragment=function(){var n=this.waitingData;n&&(this.fragmentTracker.removeFragment(n.frag),this.waitingData=null,this.waitingVideoCC=-1,this.state=k.State.IDLE)},S.onTickEnd=function(){var n=this.media;if(!(!n||!n.readyState)){var s=this.mediaBuffer?this.mediaBuffer:n,A=s.buffered;!this.loadedmetadata&&A.length&&(this.loadedmetadata=!0),this.lastCurrentTime=n.currentTime}},S.doTickIdle=function(){var n,s,A=this.hls,_=this.levels,D=this.media,I=this.trackId,w=A.config;if(!(!_||!_[I])&&!(!D&&(this.startFragRequested||!w.startFragPrefetch))){var B=_[I],N=B.details;if(!N||N.live&&this.levelLastLoaded!==I||this.waitForCdnTuneIn(N)){this.state=k.State.WAITING_TRACK;return}this.bufferFlushed&&(this.bufferFlushed=!1,this.afterBufferFlushed(this.mediaBuffer?this.mediaBuffer:this.media,y.ElementaryStreamTypes.AUDIO,O.PlaylistLevelType.AUDIO));var W=this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:this.media,O.PlaylistLevelType.AUDIO);if(W!==null){var G=W.len,V=this.getMaxBufferLength(),X=this.audioSwitch;if(!(G>=V&&!X)){if(!X&&this._streamEnded(W,N)){A.trigger(x.Events.BUFFER_EOS,{type:"audio"}),this.state=k.State.ENDED;return}var $=N.fragments,q=$[0].start,Z=W.end;if(X){var ee=this.getLoadPosition();Z=ee,N.PTSKnown&&ee<q&&(W.end>q||W.nextStart)&&(this.log("Alt audio track ahead of main track, seek to start of alt audio track"),D.currentTime=q+.05)}var ie=this.getNextFragment(Z,N);if(!ie){this.bufferFlushed=!0;return}((n=ie.decryptdata)===null||n===void 0?void 0:n.keyFormat)==="identity"&&!((s=ie.decryptdata)!==null&&s!==void 0&&s.key)?this.loadKey(ie,N):this.loadFragment(ie,N,Z)}}}},S.getMaxBufferLength=function(){var n=m.prototype.getMaxBufferLength.call(this),s=this.getFwdBufferInfo(this.videoBuffer?this.videoBuffer:this.media,O.PlaylistLevelType.MAIN);return s===null?n:Math.max(n,s.len)},S.onMediaDetaching=function(){this.videoBuffer=null,m.prototype.onMediaDetaching.call(this)},S.onAudioTracksUpdated=function(n,s){var A=s.audioTracks;this.resetTransmuxer(),this.levels=A.map(function(_){return new R.Level(_)})},S.onAudioTrackSwitching=function(n,s){var A=!!s.url;this.trackId=s.id;var _=this.fragCurrent;_!=null&&_.loader&&_.loader.abort(),this.fragCurrent=null,this.clearWaitingFragment(),A?this.setInterval(f):this.resetTransmuxer(),A?(this.audioSwitch=!0,this.state=k.State.IDLE):this.state=k.State.STOPPED,this.tick()},S.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments(),this.startPosition=this.lastCurrentTime=0,this.bufferFlushed=!1},S.onLevelLoaded=function(n,s){this.mainDetails=s.details},S.onAudioTrackLoaded=function(n,s){var A,_=this.levels,D=s.details,I=s.id;if(!_){this.warn("Audio tracks were reset while loading level "+I);return}this.log("Track "+I+" loaded ["+D.startSN+","+D.endSN+"],duration:"+D.totalduration);var w=_[I],B=0;if(D.live||(A=w.details)!==null&&A!==void 0&&A.live){var N=this.mainDetails;if(D.fragments[0]||(D.deltaUpdateFailed=!0),D.deltaUpdateFailed||!N)return;!w.details&&D.hasProgramDateTime&&N.hasProgramDateTime?(Object(E.alignPDT)(D,N),B=D.fragments[0].start):B=this.alignPlaylists(D,w.details)}w.details=D,this.levelLastLoaded=I,!this.startFragRequested&&(this.mainDetails||!D.live)&&this.setStartPosition(w.details,B),this.state===k.State.WAITING_TRACK&&!this.waitForCdnTuneIn(D)&&(this.state=k.State.IDLE),this.tick()},S._handleFragmentLoadProgress=function(n){var s,A=n.frag,_=n.part,D=n.payload,I=this.config,w=this.trackId,B=this.levels;if(!B){this.warn("Audio tracks were reset while fragment load was in progress. Fragment "+A.sn+" of level "+A.level+" will not be buffered");return}var N=B[w];console.assert(N,"Audio track is defined on fragment load progress");var W=N.details;console.assert(W,"Audio track details are defined on fragment load progress");var G=I.defaultAudioCodec||N.audioCodec||"mp4a.40.2",V=this.transmuxer;V||(V=this.transmuxer=new P.default(this.hls,O.PlaylistLevelType.AUDIO,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)));var X=this.initPTS[A.cc],$=(s=A.initSegment)===null||s===void 0?void 0:s.data;if(X!==void 0){var q=!1,Z=_?_.index:-1,ee=Z!==-1,ie=new u.ChunkMetadata(A.level,A.sn,A.stats.chunkCount,D.byteLength,Z,ee);V.push(D,$,G,"",A,_,W.totalduration,q,ie,X)}else{a.logger.log("Unknown video PTS for cc "+A.cc+", waiting for video PTS before demuxing audio frag "+A.sn+" of ["+W.startSN+" ,"+W.endSN+"],track "+w);var ue=this.waitingData=this.waitingData||{frag:A,part:_,cache:new C.default,complete:!1},se=ue.cache;se.push(new Uint8Array(D)),this.waitingVideoCC=this.videoTrackCC,this.state=k.State.WAITING_INIT_PTS}},S._handleFragmentLoadComplete=function(n){if(this.waitingData){this.waitingData.complete=!0;return}m.prototype._handleFragmentLoadComplete.call(this,n)},S.onBufferReset=function(){this.mediaBuffer=this.videoBuffer=null,this.loadedmetadata=!1},S.onBufferCreated=function(n,s){var A=s.tracks.audio;A&&(this.mediaBuffer=A.buffer),s.tracks.video&&(this.videoBuffer=s.tracks.video.buffer)},S.onFragBuffered=function(n,s){var A=s.frag,_=s.part;if(A.type===O.PlaylistLevelType.AUDIO){if(this.fragContextChanged(A)){this.warn("Fragment "+A.sn+(_?" p: "+_.index:"")+" of level "+A.level+" finished buffering, but was aborted. state: "+this.state+", audioSwitch: "+this.audioSwitch);return}A.sn!=="initSegment"&&(this.fragPrevious=A,this.audioSwitch&&(this.audioSwitch=!1,this.hls.trigger(x.Events.AUDIO_TRACK_SWITCHED,{id:this.trackId}))),this.fragBufferedComplete(A,_)}},S.onError=function(n,s){switch(s.details){case c.ErrorDetails.FRAG_LOAD_ERROR:case c.ErrorDetails.FRAG_LOAD_TIMEOUT:case c.ErrorDetails.KEY_LOAD_ERROR:case c.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(O.PlaylistLevelType.AUDIO,s);break;case c.ErrorDetails.AUDIO_TRACK_LOAD_ERROR:case c.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:this.state!==k.State.ERROR&&this.state!==k.State.STOPPED&&(this.state=s.fatal?k.State.ERROR:k.State.IDLE,this.warn(s.details+" while loading frag, switching to "+this.state+" state"));break;case c.ErrorDetails.BUFFER_FULL_ERROR:if(s.parent==="audio"&&(this.state===k.State.PARSING||this.state===k.State.PARSED)){var A=!0,_=this.getFwdBufferInfo(this.mediaBuffer,O.PlaylistLevelType.AUDIO);_&&_.len>.5&&(A=!this.reduceMaxBufferLength(_.len)),A&&(this.warn("Buffer full error also media.currentTime is not buffered, flush audio buffer"),this.fragCurrent=null,m.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.resetLoadingState()}break;default:break}},S.onBufferFlushed=function(n,s){var A=s.type;A===y.ElementaryStreamTypes.AUDIO&&(this.bufferFlushed=!0)},S._handleTransmuxComplete=function(n){var s,A="audio",_=this.hls,D=n.remuxResult,I=n.chunkMeta,w=this.getCurrentContext(I);if(!w){this.warn("The loading context changed while buffering fragment "+I.sn+" of level "+I.level+". This chunk will not be buffered."),this.resetLiveStartWhenNotLoaded(I.level);return}var B=w.frag,N=w.part,W=D.audio,G=D.text,V=D.id3,X=D.initSegment;if(!this.fragContextChanged(B)){if(this.state=k.State.PARSING,this.audioSwitch&&W&&this.completeAudioSwitch(),X!=null&&X.tracks&&(this._bufferInitSegment(X.tracks,B,I),_.trigger(x.Events.FRAG_PARSING_INIT_SEGMENT,{frag:B,id:A,tracks:X.tracks})),W){var $=W.startPTS,q=W.endPTS,Z=W.startDTS,ee=W.endDTS;N&&(N.elementaryStreams[y.ElementaryStreamTypes.AUDIO]={startPTS:$,endPTS:q,startDTS:Z,endDTS:ee}),B.setElementaryStreamInfo(y.ElementaryStreamTypes.AUDIO,$,q,Z,ee),this.bufferFragmentData(W,B,N,I)}if(V!=null&&(s=V.samples)!==null&&s!==void 0&&s.length){var ie=i({frag:B,id:A},V);_.trigger(x.Events.FRAG_PARSING_METADATA,ie)}if(G){var ue=i({frag:B,id:A},G);_.trigger(x.Events.FRAG_PARSING_USERDATA,ue)}}},S._bufferInitSegment=function(n,s,A){if(this.state===k.State.PARSING){n.video&&delete n.video;var _=n.audio;if(!!_){_.levelCodec=_.codec,_.id="audio",this.log("Init audio buffer, container:"+_.container+", codecs[parsed]=["+_.codec+"]"),this.hls.trigger(x.Events.BUFFER_CODECS,n);var D=_.initSegment;if(D!=null&&D.byteLength){var I={type:"audio",frag:s,part:null,chunkMeta:A,parent:s.type,data:D};this.hls.trigger(x.Events.BUFFER_APPENDING,I)}this.tick()}}},S.loadFragment=function(n,s,A){var _=this.fragmentTracker.getState(n);this.fragCurrent=n,(this.audioSwitch||_===F.FragmentState.NOT_LOADED||_===F.FragmentState.PARTIAL)&&(n.sn==="initSegment"?this._loadInitSegment(n):s.live&&!Object(H.isFiniteNumber)(this.initPTS[n.cc])?(this.log("Waiting for video PTS in continuity counter "+n.cc+" of live stream before loading audio fragment "+n.sn+" of level "+this.trackId),this.state=k.State.WAITING_INIT_PTS):(this.startFragRequested=!0,m.prototype.loadFragment.call(this,n,s,A)))},S.completeAudioSwitch=function(){var n=this.hls,s=this.media,A=this.trackId;s&&(this.log("Switching audio track : flushing all audio"),m.prototype.flushMainBuffer.call(this,0,Number.POSITIVE_INFINITY,"audio")),this.audioSwitch=!1,n.trigger(x.Events.AUDIO_TRACK_SWITCHED,{id:A})},L}(k.default);K.default=h},"./src/controller/audio-track-controller.ts":function(re,K,M){"use strict";M.r(K);var H=M("./src/events.ts"),k=M("./src/errors.ts"),x=M("./src/controller/base-playlist-controller.ts"),j=M("./src/types/loader.ts");function F(P,u){for(var d=0;d<u.length;d++){var E=u[d];E.enumerable=E.enumerable||!1,E.configurable=!0,"value"in E&&(E.writable=!0),Object.defineProperty(P,E.key,E)}}function R(P,u,d){return u&&F(P.prototype,u),d&&F(P,d),P}function O(P,u){P.prototype=Object.create(u.prototype),P.prototype.constructor=P,y(P,u)}function y(P,u){return y=Object.setPrototypeOf||function(E,c){return E.__proto__=c,E},y(P,u)}var C=function(P){O(u,P);function u(E){var c;return c=P.call(this,E,"[audio-track-controller]")||this,c.tracks=[],c.groupId=null,c.tracksInGroup=[],c.trackId=-1,c.trackName="",c.selectDefaultTrack=!0,c.registerListeners(),c}var d=u.prototype;return d.registerListeners=function(){var c=this.hls;c.on(H.Events.MANIFEST_LOADING,this.onManifestLoading,this),c.on(H.Events.MANIFEST_PARSED,this.onManifestParsed,this),c.on(H.Events.LEVEL_LOADING,this.onLevelLoading,this),c.on(H.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),c.on(H.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),c.on(H.Events.ERROR,this.onError,this)},d.unregisterListeners=function(){var c=this.hls;c.off(H.Events.MANIFEST_LOADING,this.onManifestLoading,this),c.off(H.Events.MANIFEST_PARSED,this.onManifestParsed,this),c.off(H.Events.LEVEL_LOADING,this.onLevelLoading,this),c.off(H.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),c.off(H.Events.AUDIO_TRACK_LOADED,this.onAudioTrackLoaded,this),c.off(H.Events.ERROR,this.onError,this)},d.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,P.prototype.destroy.call(this)},d.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.trackName="",this.selectDefaultTrack=!0},d.onManifestParsed=function(c,a){this.tracks=a.audioTracks||[]},d.onAudioTrackLoaded=function(c,a){var i=a.id,l=a.details,p=this.tracksInGroup[i];if(!p){this.warn("Invalid audio track id "+i);return}var f=p.details;p.details=a.details,this.log("audioTrack "+i+" loaded ["+l.startSN+"-"+l.endSN+"]"),i===this.trackId&&(this.retryCount=0,this.playlistLoaded(i,a,f))},d.onLevelLoading=function(c,a){this.switchLevel(a.level)},d.onLevelSwitching=function(c,a){this.switchLevel(a.level)},d.switchLevel=function(c){var a=this.hls.levels[c];if(!!(a!=null&&a.audioGroupIds)){var i=a.audioGroupIds[a.urlId];if(this.groupId!==i){this.groupId=i;var l=this.tracks.filter(function(f){return!i||f.groupId===i});this.selectDefaultTrack&&!l.some(function(f){return f.default})&&(this.selectDefaultTrack=!1),this.tracksInGroup=l;var p={audioTracks:l};this.log("Updating audio tracks, "+l.length+' track(s) found in "'+i+'" group-id'),this.hls.trigger(H.Events.AUDIO_TRACKS_UPDATED,p),this.selectInitialTrack()}}},d.onError=function(c,a){P.prototype.onError.call(this,c,a),!(a.fatal||!a.context)&&a.context.type===j.PlaylistContextType.AUDIO_TRACK&&a.context.id===this.trackId&&a.context.groupId===this.groupId&&this.retryLoadingOrFail(a)},d.setAudioTrack=function(c){var a=this.tracksInGroup;if(c<0||c>=a.length){this.warn("Invalid id passed to audio-track controller");return}this.clearTimer();var i=a[this.trackId];this.log("Now switching to audio-track index "+c);var l=a[c],p=l.id,f=l.groupId,h=f===void 0?"":f,m=l.name,L=l.type,S=l.url;if(this.trackId=c,this.trackName=m,this.selectDefaultTrack=!1,this.hls.trigger(H.Events.AUDIO_TRACK_SWITCHING,{id:p,groupId:h,name:m,type:L,url:S}),!(l.details&&!l.details.live)){var v=this.switchParams(l.url,i==null?void 0:i.details);this.loadPlaylist(v)}},d.selectInitialTrack=function(){var c=this.tracksInGroup;console.assert(c.length,"Initial audio track should be selected when tracks are known");var a=this.trackName,i=this.findTrackId(a)||this.findTrackId();i!==-1?this.setAudioTrack(i):(this.warn("No track found for running audio group-ID: "+this.groupId),this.hls.trigger(H.Events.ERROR,{type:k.ErrorTypes.MEDIA_ERROR,details:k.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,fatal:!0}))},d.findTrackId=function(c){for(var a=this.tracksInGroup,i=0;i<a.length;i++){var l=a[i];if((!this.selectDefaultTrack||l.default)&&(!c||c===l.name))return l.id}return-1},d.loadPlaylist=function(c){var a=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(a)){var i=a.id,l=a.groupId,p=a.url;if(c)try{p=c.addDirectives(p)}catch(f){this.warn("Could not construct new URL with HLS Delivery Directives: "+f)}this.log("loading audio-track playlist for id: "+i),this.clearTimer(),this.hls.trigger(H.Events.AUDIO_TRACK_LOADING,{url:p,id:i,groupId:l,deliveryDirectives:c||null})}},R(u,[{key:"audioTracks",get:function(){return this.tracksInGroup}},{key:"audioTrack",get:function(){return this.trackId},set:function(c){this.selectDefaultTrack=!1,this.setAudioTrack(c)}}]),u}(x.default);K.default=C},"./src/controller/base-playlist-controller.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"default",function(){return R});var H=M("./src/polyfills/number.ts"),k=M("./src/types/level.ts"),x=M("./src/controller/level-helper.ts"),j=M("./src/utils/logger.ts"),F=M("./src/errors.ts"),R=function(){function O(C,P){this.hls=void 0,this.timer=-1,this.canLoad=!1,this.retryCount=0,this.log=void 0,this.warn=void 0,this.log=j.logger.log.bind(j.logger,P+":"),this.warn=j.logger.warn.bind(j.logger,P+":"),this.hls=C}var y=O.prototype;return y.destroy=function(){this.clearTimer(),this.hls=this.log=this.warn=null},y.onError=function(P,u){u.fatal&&u.type===F.ErrorTypes.NETWORK_ERROR&&this.clearTimer()},y.clearTimer=function(){clearTimeout(this.timer),this.timer=-1},y.startLoad=function(){this.canLoad=!0,this.retryCount=0,this.loadPlaylist()},y.stopLoad=function(){this.canLoad=!1,this.clearTimer()},y.switchParams=function(P,u){var d=u==null?void 0:u.renditionReports;if(d)for(var E=0;E<d.length;E++){var c=d[E],a=""+c.URI;if(a===P.substr(-a.length)){var i=parseInt(c["LAST-MSN"]),l=parseInt(c["LAST-PART"]);if(u&&this.hls.config.lowLatencyMode){var p=Math.min(u.age-u.partTarget,u.targetduration);l!==void 0&&p>u.partTarget&&(l+=1)}if(Object(H.isFiniteNumber)(i))return new k.HlsUrlParameters(i,Object(H.isFiniteNumber)(l)?l:void 0,k.HlsSkip.No)}}},y.loadPlaylist=function(P){},y.shouldLoadTrack=function(P){return this.canLoad&&P&&!!P.url&&(!P.details||P.details.live)},y.playlistLoaded=function(P,u,d){var E=this,c=u.details,a=u.stats,i=a.loading.end?Math.max(0,self.performance.now()-a.loading.end):0;if(c.advancedDateTime=Date.now()-i,c.live||d!=null&&d.live){if(c.reloaded(d),d&&this.log("live playlist "+P+" "+(c.advanced?"REFRESHED "+c.lastPartSn+"-"+c.lastPartIndex:"MISSED")),d&&c.fragments.length>0&&Object(x.mergeDetails)(d,c),!this.canLoad||!c.live)return;var l,p=void 0,f=void 0;if(c.canBlockReload&&c.endSN&&c.advanced){var h=this.hls.config.lowLatencyMode,m=c.lastPartSn,L=c.endSN,S=c.lastPartIndex,v=S!==-1,n=m===L,s=h?0:S;v?(p=n?L+1:m,f=n?s:S+1):p=L+1;var A=c.age,_=A+c.ageHeader,D=Math.min(_-c.partTarget,c.targetduration*1.5);if(D>0){if(d&&D>d.tuneInGoal)this.warn("CDN Tune-in goal increased from: "+d.tuneInGoal+" to: "+D+" with playlist age: "+c.age),D=0;else{var I=Math.floor(D/c.targetduration);if(p+=I,f!==void 0){var w=Math.round(D%c.targetduration/c.partTarget);f+=w}this.log("CDN Tune-in age: "+c.ageHeader+"s last advanced "+A.toFixed(2)+"s goal: "+D+" skip sn "+I+" to part "+f)}c.tuneInGoal=D}if(l=this.getDeliveryDirectives(c,u.deliveryDirectives,p,f),h||!n){this.loadPlaylist(l);return}}else l=this.getDeliveryDirectives(c,u.deliveryDirectives,p,f);var B=Object(x.computeReloadInterval)(c,a);p!==void 0&&c.canBlockReload&&(B-=c.partTarget||1),this.log("reload live playlist "+P+" in "+Math.round(B)+" ms"),this.timer=self.setTimeout(function(){return E.loadPlaylist(l)},B)}else this.clearTimer()},y.getDeliveryDirectives=function(P,u,d,E){var c=Object(k.getSkipValue)(P,d);return u!=null&&u.skip&&P.deltaUpdateFailed&&(d=u.msn,E=u.part,c=k.HlsSkip.No),new k.HlsUrlParameters(d,E,c)},y.retryLoadingOrFail=function(P){var u=this,d=this.hls.config,E=this.retryCount<d.levelLoadingMaxRetry;if(E){var c;if(this.retryCount++,P.details.indexOf("LoadTimeOut")>-1&&(c=P.context)!==null&&c!==void 0&&c.deliveryDirectives)this.warn("retry playlist loading #"+this.retryCount+' after "'+P.details+'"'),this.loadPlaylist();else{var a=Math.min(Math.pow(2,this.retryCount)*d.levelLoadingRetryDelay,d.levelLoadingMaxRetryTimeout);this.timer=self.setTimeout(function(){return u.loadPlaylist()},a),this.warn("retry playlist loading #"+this.retryCount+" in "+a+' ms after "'+P.details+'"')}}else this.warn('cannot recover from error "'+P.details+'"'),this.clearTimer(),P.fatal=!0;return E},O}()},"./src/controller/base-stream-controller.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"State",function(){return L}),M.d(K,"default",function(){return S});var H=M("./src/polyfills/number.ts"),k=M("./src/task-loop.ts"),x=M("./src/controller/fragment-tracker.ts"),j=M("./src/utils/buffer-helper.ts"),F=M("./src/utils/logger.ts"),R=M("./src/events.ts"),O=M("./src/errors.ts"),y=M("./src/types/transmuxer.ts"),C=M("./src/utils/mp4-tools.ts"),P=M("./src/utils/discontinuities.ts"),u=M("./src/controller/fragment-finders.ts"),d=M("./src/controller/level-helper.ts"),E=M("./src/loader/fragment-loader.ts"),c=M("./src/crypt/decrypter.ts"),a=M("./src/utils/time-ranges.ts"),i=M("./src/types/loader.ts");function l(v,n){for(var s=0;s<n.length;s++){var A=n[s];A.enumerable=A.enumerable||!1,A.configurable=!0,"value"in A&&(A.writable=!0),Object.defineProperty(v,A.key,A)}}function p(v,n,s){return n&&l(v.prototype,n),s&&l(v,s),v}function f(v){if(v===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return v}function h(v,n){v.prototype=Object.create(n.prototype),v.prototype.constructor=v,m(v,n)}function m(v,n){return m=Object.setPrototypeOf||function(A,_){return A.__proto__=_,A},m(v,n)}var L={STOPPED:"STOPPED",IDLE:"IDLE",KEY_LOADING:"KEY_LOADING",FRAG_LOADING:"FRAG_LOADING",FRAG_LOADING_WAITING_RETRY:"FRAG_LOADING_WAITING_RETRY",WAITING_TRACK:"WAITING_TRACK",PARSING:"PARSING",PARSED:"PARSED",BACKTRACKING:"BACKTRACKING",ENDED:"ENDED",ERROR:"ERROR",WAITING_INIT_PTS:"WAITING_INIT_PTS",WAITING_LEVEL:"WAITING_LEVEL"},S=function(v){h(n,v);function n(A,_,D){var I;return I=v.call(this)||this,I.hls=void 0,I.fragPrevious=null,I.fragCurrent=null,I.fragmentTracker=void 0,I.transmuxer=null,I._state=L.STOPPED,I.media=void 0,I.mediaBuffer=void 0,I.config=void 0,I.bitrateTest=!1,I.lastCurrentTime=0,I.nextLoadPosition=0,I.startPosition=0,I.loadedmetadata=!1,I.fragLoadError=0,I.retryDate=0,I.levels=null,I.fragmentLoader=void 0,I.levelLastLoaded=null,I.startFragRequested=!1,I.decrypter=void 0,I.initPTS=[],I.onvseeking=null,I.onvended=null,I.logPrefix="",I.log=void 0,I.warn=void 0,I.logPrefix=D,I.log=F.logger.log.bind(F.logger,D+":"),I.warn=F.logger.warn.bind(F.logger,D+":"),I.hls=A,I.fragmentLoader=new E.default(A.config),I.fragmentTracker=_,I.config=A.config,I.decrypter=new c.default(A,A.config),A.on(R.Events.KEY_LOADED,I.onKeyLoaded,f(I)),I}var s=n.prototype;return s.doTick=function(){this.onTickEnd()},s.onTickEnd=function(){},s.startLoad=function(_){},s.stopLoad=function(){this.fragmentLoader.abort();var _=this.fragCurrent;_&&this.fragmentTracker.removeFragment(_),this.resetTransmuxer(),this.fragCurrent=null,this.fragPrevious=null,this.clearInterval(),this.clearNextTick(),this.state=L.STOPPED},s._streamEnded=function(_,D){var I=this.fragCurrent,w=this.fragmentTracker;if(!D.live&&I&&I.sn===D.endSN&&!_.nextStart){var B=w.getState(I);return B===x.FragmentState.PARTIAL||B===x.FragmentState.OK}return!1},s.onMediaAttached=function(_,D){var I=this.media=this.mediaBuffer=D.media;this.onvseeking=this.onMediaSeeking.bind(this),this.onvended=this.onMediaEnded.bind(this),I.addEventListener("seeking",this.onvseeking),I.addEventListener("ended",this.onvended);var w=this.config;this.levels&&w.autoStartLoad&&this.state===L.STOPPED&&this.startLoad(w.startPosition)},s.onMediaDetaching=function(){var _=this.media;_!=null&&_.ended&&(this.log("MSE detaching and video ended, reset startPosition"),this.startPosition=this.lastCurrentTime=0),_&&(_.removeEventListener("seeking",this.onvseeking),_.removeEventListener("ended",this.onvended),this.onvseeking=this.onvended=null),this.media=this.mediaBuffer=null,this.loadedmetadata=!1,this.fragmentTracker.removeAllFragments(),this.stopLoad()},s.onMediaSeeking=function(){var _=this.config,D=this.fragCurrent,I=this.media,w=this.mediaBuffer,B=this.state,N=I?I.currentTime:0,W=j.BufferHelper.bufferInfo(w||I,N,_.maxBufferHole);if(this.log("media seeking to "+(Object(H.isFiniteNumber)(N)?N.toFixed(3):N)+", state: "+B),B===L.ENDED)this.resetLoadingState();else if(D&&!W.len){var G=_.maxFragLookUpTolerance,V=D.start-G,X=D.start+D.duration+G,$=N>X;(N<V||$)&&($&&D.loader&&(this.log("seeking outside of buffer while fragment load in progress, cancel fragment load"),D.loader.abort()),this.resetLoadingState())}I&&(this.lastCurrentTime=N),!this.loadedmetadata&&!W.len&&(this.nextLoadPosition=this.startPosition=N),this.tickImmediate()},s.onMediaEnded=function(){this.startPosition=this.lastCurrentTime=0},s.onKeyLoaded=function(_,D){if(!(this.state!==L.KEY_LOADING||D.frag!==this.fragCurrent||!this.levels)){this.state=L.IDLE;var I=this.levels[D.frag.level].details;I&&this.loadFragment(D.frag,I,D.frag.start)}},s.onHandlerDestroying=function(){this.stopLoad(),v.prototype.onHandlerDestroying.call(this)},s.onHandlerDestroyed=function(){this.state=L.STOPPED,this.hls.off(R.Events.KEY_LOADED,this.onKeyLoaded,this),this.fragmentLoader&&this.fragmentLoader.destroy(),this.decrypter&&this.decrypter.destroy(),this.hls=this.log=this.warn=this.decrypter=this.fragmentLoader=this.fragmentTracker=null,v.prototype.onHandlerDestroyed.call(this)},s.loadKey=function(_,D){this.log("Loading key for "+_.sn+" of ["+D.startSN+"-"+D.endSN+"], "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+_.level),this.state=L.KEY_LOADING,this.fragCurrent=_,this.hls.trigger(R.Events.KEY_LOADING,{frag:_})},s.loadFragment=function(_,D,I){this._loadFragForPlayback(_,D,I)},s._loadFragForPlayback=function(_,D,I){var w=this,B=function(W){if(w.fragContextChanged(_)){w.warn("Fragment "+_.sn+(W.part?" p: "+W.part.index:"")+" of level "+_.level+" was dropped during download."),w.fragmentTracker.removeFragment(_);return}_.stats.chunkCount++,w._handleFragmentLoadProgress(W)};this._doFragLoad(_,D,I,B).then(function(N){if(!!N){w.fragLoadError=0;var W=w.state;if(w.fragContextChanged(_)){(W===L.FRAG_LOADING||W===L.BACKTRACKING||!w.fragCurrent&&W===L.PARSING)&&(w.fragmentTracker.removeFragment(_),w.state=L.IDLE);return}if("payload"in N&&(w.log("Loaded fragment "+_.sn+" of level "+_.level),w.hls.trigger(R.Events.FRAG_LOADED,N),w.state===L.BACKTRACKING)){w.fragmentTracker.backtrack(_,N),w.resetFragmentLoading(_);return}w._handleFragmentLoadComplete(N)}}).catch(function(N){w.warn(N),w.resetFragmentLoading(_)})},s.flushMainBuffer=function(_,D,I){if(I===void 0&&(I=null),!!(_-D)){var w={startOffset:_,endOffset:D,type:I};this.fragLoadError=0,this.hls.trigger(R.Events.BUFFER_FLUSHING,w)}},s._loadInitSegment=function(_){var D=this;this._doFragLoad(_).then(function(I){if(!I||D.fragContextChanged(_)||!D.levels)throw new Error("init load aborted");return I}).then(function(I){var w=D.hls,B=I.payload,N=_.decryptdata;if(B&&B.byteLength>0&&N&&N.key&&N.iv&&N.method==="AES-128"){var W=self.performance.now();return D.decrypter.webCryptoDecrypt(new Uint8Array(B),N.key.buffer,N.iv.buffer).then(function(G){var V=self.performance.now();return w.trigger(R.Events.FRAG_DECRYPTED,{frag:_,payload:G,stats:{tstart:W,tdecrypt:V}}),I.payload=G,I})}return I}).then(function(I){var w=D.fragCurrent,B=D.hls,N=D.levels;if(!N)throw new Error("init load aborted, missing levels");var W=N[_.level].details;console.assert(W,"Level details are defined when init segment is loaded");var G=_.stats;D.state=L.IDLE,D.fragLoadError=0,_.data=new Uint8Array(I.payload),G.parsing.start=G.buffering.start=self.performance.now(),G.parsing.end=G.buffering.end=self.performance.now(),I.frag===w&&B.trigger(R.Events.FRAG_BUFFERED,{stats:G,frag:w,part:null,id:_.type}),D.tick()}).catch(function(I){D.warn(I),D.resetFragmentLoading(_)})},s.fragContextChanged=function(_){var D=this.fragCurrent;return!_||!D||_.level!==D.level||_.sn!==D.sn||_.urlId!==D.urlId},s.fragBufferedComplete=function(_,D){var I=this.mediaBuffer?this.mediaBuffer:this.media;this.log("Buffered "+_.type+" sn: "+_.sn+(D?" part: "+D.index:"")+" of "+(this.logPrefix==="[stream-controller]"?"level":"track")+" "+_.level+" "+a.default.toString(j.BufferHelper.getBuffered(I))),this.state=L.IDLE,this.tick()},s._handleFragmentLoadComplete=function(_){var D=this.transmuxer;if(!!D){var I=_.frag,w=_.part,B=_.partsLoaded,N=!B||B.length===0||B.some(function(G){return!G}),W=new y.ChunkMetadata(I.level,I.sn,I.stats.chunkCount+1,0,w?w.index:-1,!N);D.flush(W)}},s._handleFragmentLoadProgress=function(_){},s._doFragLoad=function(_,D,I,w){var B=this;if(I===void 0&&(I=null),!this.levels)throw new Error("frag load aborted, missing levels");if(I=Math.max(_.start,I||0),this.config.lowLatencyMode&&D){var N=D.partList;if(N&&w){I>_.end&&D.fragmentHint&&(_=D.fragmentHint);var W=this.getNextPart(N,_,I);if(W>-1){var G=N[W];return this.log("Loading part sn: "+_.sn+" p: "+G.index+" cc: "+_.cc+" of playlist ["+D.startSN+"-"+D.endSN+"] parts [0-"+W+"-"+(N.length-1)+"] "+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+_.level+", target: "+parseFloat(I.toFixed(3))),this.nextLoadPosition=G.start+G.duration,this.state=L.FRAG_LOADING,this.hls.trigger(R.Events.FRAG_LOADING,{frag:_,part:N[W],targetBufferTime:I}),this.doFragPartsLoad(_,N,W,w).catch(function(V){return B.handleFragLoadError(V)})}else if(!_.url||this.loadedEndOfParts(N,I))return Promise.resolve(null)}}return this.log("Loading fragment "+_.sn+" cc: "+_.cc+" "+(D?"of ["+D.startSN+"-"+D.endSN+"] ":"")+(this.logPrefix==="[stream-controller]"?"level":"track")+": "+_.level+", target: "+parseFloat(I.toFixed(3))),Object(H.isFiniteNumber)(_.sn)&&!this.bitrateTest&&(this.nextLoadPosition=_.start+_.duration),this.state=L.FRAG_LOADING,this.hls.trigger(R.Events.FRAG_LOADING,{frag:_,targetBufferTime:I}),this.fragmentLoader.load(_,w).catch(function(V){return B.handleFragLoadError(V)})},s.doFragPartsLoad=function(_,D,I,w){var B=this;return new Promise(function(N,W){var G=[],V=function X($){var q=D[$];B.fragmentLoader.loadPart(_,q,w).then(function(Z){G[q.index]=Z;var ee=Z.part;B.hls.trigger(R.Events.FRAG_LOADED,Z);var ie=D[$+1];if(ie&&ie.fragment===_)X($+1);else return N({frag:_,part:ee,partsLoaded:G})}).catch(W)};V(I)})},s.handleFragLoadError=function(_){var D=_.data;return D&&D.details===O.ErrorDetails.INTERNAL_ABORTED?this.handleFragLoadAborted(D.frag,D.part):this.hls.trigger(R.Events.ERROR,D),null},s._handleTransmuxerFlush=function(_){var D=this.getCurrentContext(_);if(!D||this.state!==L.PARSING){this.fragCurrent||(this.state=L.IDLE);return}var I=D.frag,w=D.part,B=D.level,N=self.performance.now();I.stats.parsing.end=N,w&&(w.stats.parsing.end=N),this.updateLevelTiming(I,w,B,_.partial)},s.getCurrentContext=function(_){var D=this.levels,I=_.level,w=_.sn,B=_.part;if(!D||!D[I])return this.warn("Levels object was unset while buffering fragment "+w+" of level "+I+". The current chunk will not be buffered."),null;var N=D[I],W=B>-1?Object(d.getPartWith)(N,w,B):null,G=W?W.fragment:Object(d.getFragmentWithSN)(N,w,this.fragCurrent);return G?{frag:G,part:W,level:N}:null},s.bufferFragmentData=function(_,D,I,w){if(!(!_||this.state!==L.PARSING)){var B=_.data1,N=_.data2,W=B;if(B&&N&&(W=Object(C.appendUint8Array)(B,N)),!(!W||!W.length)){var G={type:_.type,frag:D,part:I,chunkMeta:w,parent:D.type,data:W};this.hls.trigger(R.Events.BUFFER_APPENDING,G),_.dropped&&_.independent&&!I&&this.flushBufferGap(D)}}},s.flushBufferGap=function(_){var D=this.media;if(!!D){if(!j.BufferHelper.isBuffered(D,D.currentTime)){this.flushMainBuffer(0,_.start);return}var I=D.currentTime,w=j.BufferHelper.bufferInfo(D,I,0),B=_.duration,N=Math.min(this.config.maxFragLookUpTolerance*2,B*.25),W=Math.max(Math.min(_.start-N,w.end-N),I+N);_.start-W>N&&this.flushMainBuffer(W,_.start)}},s.getFwdBufferInfo=function(_,D){var I=this.config,w=this.getLoadPosition();if(!Object(H.isFiniteNumber)(w))return null;var B=j.BufferHelper.bufferInfo(_,w,I.maxBufferHole);if(B.len===0&&B.nextStart!==void 0){var N=this.fragmentTracker.getBufferedFrag(w,D);if(N&&B.nextStart<N.end)return j.BufferHelper.bufferInfo(_,w,Math.max(B.nextStart,I.maxBufferHole))}return B},s.getMaxBufferLength=function(_){var D=this.config,I;return _?I=Math.max(8*D.maxBufferSize/_,D.maxBufferLength):I=D.maxBufferLength,Math.min(I,D.maxMaxBufferLength)},s.reduceMaxBufferLength=function(_){var D=this.config,I=_||D.maxBufferLength;return D.maxMaxBufferLength>=I?(D.maxMaxBufferLength/=2,this.warn("Reduce max buffer length to "+D.maxMaxBufferLength+"s"),!0):!1},s.getNextFragment=function(_,D){var I,w,B=D.fragments,N=B.length;if(!N)return null;var W=this.config,G=B[0].start,V;if(D.live){var X=W.initialLiveManifestSize;if(N<X)return this.warn("Not enough fragments to start playback (have: "+N+", need: "+X+")"),null;!D.PTSKnown&&!this.startFragRequested&&this.startPosition===-1&&(V=this.getInitialLiveFragment(D,B),this.startPosition=V?this.hls.liveSyncPosition||V.start:_)}else _<=G&&(V=B[0]);if(!V){var $=W.lowLatencyMode?D.partEnd:D.fragmentEnd;V=this.getFragmentAtPosition(_,$,D)}return(I=V)!==null&&I!==void 0&&I.initSegment&&!((w=V)!==null&&w!==void 0&&w.initSegment.data)&&!this.bitrateTest&&(V=V.initSegment),V},s.getNextPart=function(_,D,I){for(var w=-1,B=!1,N=!0,W=0,G=_.length;W<G;W++){var V=_[W];if(N=N&&!V.independent,w>-1&&I<V.start)break;var X=V.loaded;!X&&(B||V.independent||N)&&V.fragment===D&&(w=W),B=X}return w},s.loadedEndOfParts=function(_,D){var I=_[_.length-1];return I&&D>I.start&&I.loaded},s.getInitialLiveFragment=function(_,D){var I=this.fragPrevious,w=null;if(I){if(_.hasProgramDateTime&&(this.log("Live playlist, switching playlist, load frag with same PDT: "+I.programDateTime),w=Object(u.findFragmentByPDT)(D,I.endProgramDateTime,this.config.maxFragLookUpTolerance)),!w){var B=I.sn+1;if(B>=_.startSN&&B<=_.endSN){var N=D[B-_.startSN];I.cc===N.cc&&(w=N,this.log("Live playlist, switching playlist, load frag with next SN: "+w.sn))}w||(w=Object(u.findFragWithCC)(D,I.cc),w&&this.log("Live playlist, switching playlist, load frag with same CC: "+w.sn))}}else{var W=this.hls.liveSyncPosition;W!==null&&(w=this.getFragmentAtPosition(W,this.bitrateTest?_.fragmentEnd:_.edge,_))}return w},s.getFragmentAtPosition=function(_,D,I){var w=this.config,B=this.fragPrevious,N=I.fragments,W=I.endSN,G=I.fragmentHint,V=w.maxFragLookUpTolerance,X=!!(w.lowLatencyMode&&I.partList&&G);X&&G&&!this.bitrateTest&&(N=N.concat(G),W=G.sn);var $;if(_<D){var q=_>D-V?0:V;$=Object(u.findFragmentByPTS)(B,N,_,q)}else $=N[N.length-1];if($){var Z=$.sn-I.startSN,ee=B&&$.level===B.level,ie=N[Z+1],ue=this.fragmentTracker.getState($);if(ue===x.FragmentState.BACKTRACKED){$=null;for(var se=Z;N[se]&&this.fragmentTracker.getState(N[se])===x.FragmentState.BACKTRACKED;)B?$=N[se--]:$=N[--se];$||($=ie)}else B&&$.sn===B.sn&&!X&&ee&&($.sn<W&&this.fragmentTracker.getState(ie)!==x.FragmentState.OK?(this.log("SN "+$.sn+" just loaded, load next one: "+ie.sn),$=ie):$=null)}return $},s.synchronizeToLiveEdge=function(_){var D=this.config,I=this.media;if(!!I){var w=this.hls.liveSyncPosition,B=I.currentTime,N=_.fragments[0].start,W=_.edge,G=B>=N-D.maxFragLookUpTolerance&&B<=W;if(w!==null&&I.duration>w&&(B<w||!G)){var V=D.liveMaxLatencyDuration!==void 0?D.liveMaxLatencyDuration:D.liveMaxLatencyDurationCount*_.targetduration;(!G&&I.readyState<4||B<W-V)&&(this.loadedmetadata||(this.nextLoadPosition=w),I.readyState&&(this.warn("Playback: "+B.toFixed(3)+" is located too far from the end of live sliding playlist: "+W+", reset currentTime to : "+w.toFixed(3)),I.currentTime=w))}}},s.alignPlaylists=function(_,D){var I=this.levels,w=this.levelLastLoaded,B=this.fragPrevious,N=w!==null?I[w]:null,W=_.fragments.length;if(!W)return this.warn("No fragments in live playlist"),0;var G=_.fragments[0].start,V=!D,X=_.alignedSliding&&Object(H.isFiniteNumber)(G);if(V||!X&&!G){Object(P.alignStream)(B,N,_);var $=_.fragments[0].start;return this.log("Live playlist sliding: "+$.toFixed(2)+" start-sn: "+(D?D.startSN:"na")+"->"+_.startSN+" prev-sn: "+(B?B.sn:"na")+" fragments: "+W),$}return G},s.waitForCdnTuneIn=function(_){var D=3;return _.live&&_.canBlockReload&&_.tuneInGoal>Math.max(_.partHoldBack,_.partTarget*D)},s.setStartPosition=function(_,D){var I=this.startPosition;if(I<D&&(I=-1),I===-1||this.lastCurrentTime===-1){var w=_.startTimeOffset;Object(H.isFiniteNumber)(w)?(I=D+w,w<0&&(I+=_.totalduration),I=Math.min(Math.max(D,I),D+_.totalduration),this.log("Start time offset "+w+" found in playlist, adjust startPosition to "+I),this.startPosition=I):_.live?I=this.hls.liveSyncPosition||D:this.startPosition=I=0,this.lastCurrentTime=I}this.nextLoadPosition=I},s.getLoadPosition=function(){var _=this.media,D=0;return this.loadedmetadata&&_?D=_.currentTime:this.nextLoadPosition&&(D=this.nextLoadPosition),D},s.handleFragLoadAborted=function(_,D){this.transmuxer&&_.sn!=="initSegment"&&_.stats.aborted&&(this.warn("Fragment "+_.sn+(D?" part"+D.index:"")+" of level "+_.level+" was aborted"),this.resetFragmentLoading(_))},s.resetFragmentLoading=function(_){(!this.fragCurrent||!this.fragContextChanged(_))&&(this.state=L.IDLE)},s.onFragmentOrKeyLoadError=function(_,D){if(!D.fatal){var I=D.frag;if(!(!I||I.type!==_)){var w=this.fragCurrent;console.assert(w&&I.sn===w.sn&&I.level===w.level&&I.urlId===w.urlId,"Frag load error must match current frag to retry");var B=this.config;if(this.fragLoadError+1<=B.fragLoadingMaxRetry){if(this.resetLiveStartWhenNotLoaded(I.level))return;var N=Math.min(Math.pow(2,this.fragLoadError)*B.fragLoadingRetryDelay,B.fragLoadingMaxRetryTimeout);this.warn("Fragment "+I.sn+" of "+_+" "+I.level+" failed to load, retrying in "+N+"ms"),this.retryDate=self.performance.now()+N,this.fragLoadError++,this.state=L.FRAG_LOADING_WAITING_RETRY}else D.levelRetry?(_===i.PlaylistLevelType.AUDIO&&(this.fragCurrent=null),this.fragLoadError=0,this.state=L.IDLE):(F.logger.error(D.details+" reaches max retry, redispatch as fatal ..."),D.fatal=!0,this.hls.stopLoad(),this.state=L.ERROR)}}},s.afterBufferFlushed=function(_,D,I){if(!!_){var w=j.BufferHelper.getBuffered(_);this.fragmentTracker.detectEvictedFragments(D,w,I),this.state===L.ENDED&&this.resetLoadingState()}},s.resetLoadingState=function(){this.fragCurrent=null,this.fragPrevious=null,this.state=L.IDLE},s.resetLiveStartWhenNotLoaded=function(_){if(!this.loadedmetadata){this.startFragRequested=!1;var D=this.levels?this.levels[_].details:null;if(D!=null&&D.live)return this.startPosition=-1,this.setStartPosition(D,0),this.resetLoadingState(),!0;this.nextLoadPosition=this.startPosition}return!1},s.updateLevelTiming=function(_,D,I,w){var B=this,N=I.details;console.assert(!!N,"level.details must be defined");var W=Object.keys(_.elementaryStreams).reduce(function(G,V){var X=_.elementaryStreams[V];if(X){var $=X.endPTS-X.startPTS;if($<=0)return B.warn("Could not parse fragment "+_.sn+" "+V+" duration reliably ("+$+") resetting transmuxer to fallback to playlist timing"),B.resetTransmuxer(),G||!1;var q=w?0:Object(d.updateFragPTSDTS)(N,_,X.startPTS,X.endPTS,X.startDTS,X.endDTS);return B.hls.trigger(R.Events.LEVEL_PTS_UPDATED,{details:N,level:I,drift:q,type:V,frag:_,start:X.startPTS,end:X.endPTS}),!0}return G},!1);W?(this.state=L.PARSED,this.hls.trigger(R.Events.FRAG_PARSED,{frag:_,part:D})):this.resetLoadingState()},s.resetTransmuxer=function(){this.transmuxer&&(this.transmuxer.destroy(),this.transmuxer=null)},p(n,[{key:"state",get:function(){return this._state},set:function(_){var D=this._state;D!==_&&(this._state=_,this.log(D+"->"+_))}}]),n}(k.default)},"./src/controller/buffer-controller.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"default",function(){return u});var H=M("./src/polyfills/number.ts"),k=M("./src/events.ts"),x=M("./src/utils/logger.ts"),j=M("./src/errors.ts"),F=M("./src/utils/buffer-helper.ts"),R=M("./src/utils/mediasource-helper.ts"),O=M("./src/loader/fragment.ts"),y=M("./src/controller/buffer-operation-queue.ts"),C=Object(R.getMediaSource)(),P=/([ha]vc.)(?:\.[^.,]+)+/,u=function(){function d(c){var a=this;this.details=null,this._objectUrl=null,this.operationQueue=void 0,this.listeners=void 0,this.hls=void 0,this.bufferCodecEventsExpected=0,this._bufferCodecEventsTotal=0,this.media=null,this.mediaSource=null,this.appendError=0,this.tracks={},this.pendingTracks={},this.sourceBuffer=void 0,this._onMediaSourceOpen=function(){var i=a.hls,l=a.media,p=a.mediaSource;x.logger.log("[buffer-controller]: Media source opened"),l&&(a.updateMediaElementDuration(),i.trigger(k.Events.MEDIA_ATTACHED,{media:l})),p&&p.removeEventListener("sourceopen",a._onMediaSourceOpen),a.checkPendingTracks()},this._onMediaSourceClose=function(){x.logger.log("[buffer-controller]: Media source closed")},this._onMediaSourceEnded=function(){x.logger.log("[buffer-controller]: Media source ended")},this.hls=c,this._initSourceBuffer(),this.registerListeners()}var E=d.prototype;return E.hasSourceTypes=function(){return this.getSourceBufferTypes().length>0||Object.keys(this.pendingTracks).length>0},E.destroy=function(){this.unregisterListeners(),this.details=null},E.registerListeners=function(){var a=this.hls;a.on(k.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),a.on(k.Events.MEDIA_DETACHING,this.onMediaDetaching,this),a.on(k.Events.MANIFEST_PARSED,this.onManifestParsed,this),a.on(k.Events.BUFFER_RESET,this.onBufferReset,this),a.on(k.Events.BUFFER_APPENDING,this.onBufferAppending,this),a.on(k.Events.BUFFER_CODECS,this.onBufferCodecs,this),a.on(k.Events.BUFFER_EOS,this.onBufferEos,this),a.on(k.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),a.on(k.Events.LEVEL_UPDATED,this.onLevelUpdated,this),a.on(k.Events.FRAG_PARSED,this.onFragParsed,this),a.on(k.Events.FRAG_CHANGED,this.onFragChanged,this)},E.unregisterListeners=function(){var a=this.hls;a.off(k.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),a.off(k.Events.MEDIA_DETACHING,this.onMediaDetaching,this),a.off(k.Events.MANIFEST_PARSED,this.onManifestParsed,this),a.off(k.Events.BUFFER_RESET,this.onBufferReset,this),a.off(k.Events.BUFFER_APPENDING,this.onBufferAppending,this),a.off(k.Events.BUFFER_CODECS,this.onBufferCodecs,this),a.off(k.Events.BUFFER_EOS,this.onBufferEos,this),a.off(k.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),a.off(k.Events.LEVEL_UPDATED,this.onLevelUpdated,this),a.off(k.Events.FRAG_PARSED,this.onFragParsed,this),a.off(k.Events.FRAG_CHANGED,this.onFragChanged,this)},E._initSourceBuffer=function(){this.sourceBuffer={},this.operationQueue=new y.default(this.sourceBuffer),this.listeners={audio:[],video:[],audiovideo:[]}},E.onManifestParsed=function(a,i){var l=2;(i.audio&&!i.video||!i.altAudio)&&(l=1),this.bufferCodecEventsExpected=this._bufferCodecEventsTotal=l,this.details=null,x.logger.log(this.bufferCodecEventsExpected+" bufferCodec event(s) expected")},E.onMediaAttaching=function(a,i){var l=this.media=i.media;if(l&&C){var p=this.mediaSource=new C;p.addEventListener("sourceopen",this._onMediaSourceOpen),p.addEventListener("sourceended",this._onMediaSourceEnded),p.addEventListener("sourceclose",this._onMediaSourceClose),l.src=self.URL.createObjectURL(p),this._objectUrl=l.src}},E.onMediaDetaching=function(){var a=this.media,i=this.mediaSource,l=this._objectUrl;if(i){if(x.logger.log("[buffer-controller]: media source detaching"),i.readyState==="open")try{i.endOfStream()}catch(p){x.logger.warn("[buffer-controller]: onMediaDetaching: "+p.message+" while calling endOfStream")}this.onBufferReset(),i.removeEventListener("sourceopen",this._onMediaSourceOpen),i.removeEventListener("sourceended",this._onMediaSourceEnded),i.removeEventListener("sourceclose",this._onMediaSourceClose),a&&(l&&self.URL.revokeObjectURL(l),a.src===l?(a.removeAttribute("src"),a.load()):x.logger.warn("[buffer-controller]: media.src was changed by a third party - skip cleanup")),this.mediaSource=null,this.media=null,this._objectUrl=null,this.bufferCodecEventsExpected=this._bufferCodecEventsTotal,this.pendingTracks={},this.tracks={}}this.hls.trigger(k.Events.MEDIA_DETACHED,void 0)},E.onBufferReset=function(){var a=this;this.getSourceBufferTypes().forEach(function(i){var l=a.sourceBuffer[i];try{l&&(a.removeBufferListeners(i),a.mediaSource&&a.mediaSource.removeSourceBuffer(l),a.sourceBuffer[i]=void 0)}catch(p){x.logger.warn("[buffer-controller]: Failed to reset the "+i+" buffer",p)}}),this._initSourceBuffer()},E.onBufferCodecs=function(a,i){var l=this,p=this.getSourceBufferTypes().length;Object.keys(i).forEach(function(f){if(p){var h=l.tracks[f];if(h&&typeof h.buffer.changeType=="function"){var m=i[f],L=m.codec,S=m.levelCodec,v=m.container,n=(h.levelCodec||h.codec).replace(P,"$1"),s=(S||L).replace(P,"$1");if(n!==s){var A=v+";codecs="+(S||L);l.appendChangeType(f,A)}}}else l.pendingTracks[f]=i[f]}),!p&&(this.bufferCodecEventsExpected=Math.max(this.bufferCodecEventsExpected-1,0),this.mediaSource&&this.mediaSource.readyState==="open"&&this.checkPendingTracks())},E.appendChangeType=function(a,i){var l=this,p=this.operationQueue,f={execute:function(){var m=l.sourceBuffer[a];m&&(x.logger.log("[buffer-controller]: changing "+a+" sourceBuffer type to "+i),m.changeType(i)),p.shiftAndExecuteNext(a)},onStart:function(){},onComplete:function(){},onError:function(m){x.logger.warn("[buffer-controller]: Failed to change "+a+" SourceBuffer type",m)}};p.append(f,a)},E.onBufferAppending=function(a,i){var l=this,p=this.hls,f=this.operationQueue,h=this.tracks,m=i.data,L=i.type,S=i.frag,v=i.part,n=i.chunkMeta,s=n.buffering[L],A=self.performance.now();s.start=A;var _=S.stats.buffering,D=v?v.stats.buffering:null;_.start===0&&(_.start=A),D&&D.start===0&&(D.start=A);var I=h.audio,w=L==="audio"&&n.id===1&&(I==null?void 0:I.container)==="audio/mpeg",B={execute:function(){if(s.executeStart=self.performance.now(),w){var W=l.sourceBuffer[L];if(W){var G=S.start-W.timestampOffset;Math.abs(G)>=.1&&(x.logger.log("[buffer-controller]: Updating audio SourceBuffer timestampOffset to "+S.start+" (delta: "+G+") sn: "+S.sn+")"),W.timestampOffset=S.start)}}l.appendExecutor(m,L)},onStart:function(){},onComplete:function(){var W=self.performance.now();s.executeEnd=s.end=W,_.first===0&&(_.first=W),D&&D.first===0&&(D.first=W);var G=l.sourceBuffer,V={};for(var X in G)V[X]=F.BufferHelper.getBuffered(G[X]);l.appendError=0,l.hls.trigger(k.Events.BUFFER_APPENDED,{type:L,frag:S,part:v,chunkMeta:n,parent:S.type,timeRanges:V})},onError:function(W){x.logger.error("[buffer-controller]: Error encountered while trying to append to the "+L+" SourceBuffer",W);var G={type:j.ErrorTypes.MEDIA_ERROR,parent:S.type,details:j.ErrorDetails.BUFFER_APPEND_ERROR,err:W,fatal:!1};W.code===DOMException.QUOTA_EXCEEDED_ERR?G.details=j.ErrorDetails.BUFFER_FULL_ERROR:(l.appendError++,G.details=j.ErrorDetails.BUFFER_APPEND_ERROR,l.appendError>p.config.appendErrorMaxRetry&&(x.logger.error("[buffer-controller]: Failed "+p.config.appendErrorMaxRetry+" times to append segment in sourceBuffer"),G.fatal=!0)),p.trigger(k.Events.ERROR,G)}};f.append(B,L)},E.onBufferFlushing=function(a,i){var l=this,p=this.operationQueue,f=function(m){return{execute:l.removeExecutor.bind(l,m,i.startOffset,i.endOffset),onStart:function(){},onComplete:function(){l.hls.trigger(k.Events.BUFFER_FLUSHED,{type:m})},onError:function(S){x.logger.warn("[buffer-controller]: Failed to remove from "+m+" SourceBuffer",S)}}};i.type?p.append(f(i.type),i.type):this.getSourceBufferTypes().forEach(function(h){p.append(f(h),h)})},E.onFragParsed=function(a,i){var l=this,p=i.frag,f=i.part,h=[],m=f?f.elementaryStreams:p.elementaryStreams;m[O.ElementaryStreamTypes.AUDIOVIDEO]?h.push("audiovideo"):(m[O.ElementaryStreamTypes.AUDIO]&&h.push("audio"),m[O.ElementaryStreamTypes.VIDEO]&&h.push("video"));var L=function(){var v=self.performance.now();p.stats.buffering.end=v,f&&(f.stats.buffering.end=v);var n=f?f.stats:p.stats;l.hls.trigger(k.Events.FRAG_BUFFERED,{frag:p,part:f,stats:n,id:p.type})};h.length===0&&x.logger.warn("Fragments must have at least one ElementaryStreamType set. type: "+p.type+" level: "+p.level+" sn: "+p.sn),this.blockBuffers(L,h)},E.onFragChanged=function(a,i){this.flushBackBuffer()},E.onBufferEos=function(a,i){var l=this,p=this.getSourceBufferTypes().reduce(function(f,h){var m=l.sourceBuffer[h];return(!i.type||i.type===h)&&m&&!m.ended&&(m.ended=!0,x.logger.log("[buffer-controller]: "+h+" sourceBuffer now EOS")),f&&!!(!m||m.ended)},!0);p&&this.blockBuffers(function(){var f=l.mediaSource;!f||f.readyState!=="open"||f.endOfStream()})},E.onLevelUpdated=function(a,i){var l=i.details;!l.fragments.length||(this.details=l,this.getSourceBufferTypes().length?this.blockBuffers(this.updateMediaElementDuration.bind(this)):this.updateMediaElementDuration())},E.flushBackBuffer=function(){var a=this.hls,i=this.details,l=this.media,p=this.sourceBuffer;if(!(!l||i===null)){var f=this.getSourceBufferTypes();if(!!f.length){var h=i.live&&a.config.liveBackBufferLength!==null?a.config.liveBackBufferLength:a.config.backBufferLength;if(!(!Object(H.isFiniteNumber)(h)||h<0)){var m=l.currentTime,L=i.levelTargetDuration,S=Math.max(h,L),v=Math.floor(m/L)*L-S;f.forEach(function(n){var s=p[n];if(s){var A=F.BufferHelper.getBuffered(s);A.length>0&&v>A.start(0)&&(a.trigger(k.Events.BACK_BUFFER_REACHED,{bufferEnd:v}),i.live&&a.trigger(k.Events.LIVE_BACK_BUFFER_REACHED,{bufferEnd:v}),a.trigger(k.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:v,type:n}))}})}}}},E.updateMediaElementDuration=function(){if(!(!this.details||!this.media||!this.mediaSource||this.mediaSource.readyState!=="open")){var a=this.details,i=this.hls,l=this.media,p=this.mediaSource,f=a.fragments[0].start+a.totalduration,h=l.duration,m=Object(H.isFiniteNumber)(p.duration)?p.duration:0;a.live&&i.config.liveDurationInfinity?(x.logger.log("[buffer-controller]: Media Source duration is set to Infinity"),p.duration=Infinity,this.updateSeekableRange(a)):(f>m&&f>h||!Object(H.isFiniteNumber)(h))&&(x.logger.log("[buffer-controller]: Updating Media Source duration to "+f.toFixed(3)),p.duration=f)}},E.updateSeekableRange=function(a){var i=this.mediaSource,l=a.fragments,p=l.length;if(p&&a.live&&i!==null&&i!==void 0&&i.setLiveSeekableRange){var f=Math.max(0,l[0].start),h=Math.max(f,f+a.totalduration);i.setLiveSeekableRange(f,h)}},E.checkPendingTracks=function(){var a=this.bufferCodecEventsExpected,i=this.operationQueue,l=this.pendingTracks,p=Object.keys(l).length;if(p&&!a||p===2){this.createSourceBuffers(l),this.pendingTracks={};var f=this.getSourceBufferTypes();if(f.length===0){this.hls.trigger(k.Events.ERROR,{type:j.ErrorTypes.MEDIA_ERROR,details:j.ErrorDetails.BUFFER_INCOMPATIBLE_CODECS_ERROR,fatal:!0,reason:"could not create source buffer for media codec(s)"});return}f.forEach(function(h){i.executeNext(h)})}},E.createSourceBuffers=function(a){var i=this.sourceBuffer,l=this.mediaSource;if(!l)throw Error("createSourceBuffers called when mediaSource was null");var p=0;for(var f in a)if(!i[f]){var h=a[f];if(!h)throw Error("source buffer exists for track "+f+", however track does not");var m=h.levelCodec||h.codec,L=h.container+";codecs="+m;x.logger.log("[buffer-controller]: creating sourceBuffer("+L+")");try{var S=i[f]=l.addSourceBuffer(L),v=f;this.addBufferListener(v,"updatestart",this._onSBUpdateStart),this.addBufferListener(v,"updateend",this._onSBUpdateEnd),this.addBufferListener(v,"error",this._onSBUpdateError),this.tracks[f]={buffer:S,codec:m,container:h.container,levelCodec:h.levelCodec,id:h.id},p++}catch(n){x.logger.error("[buffer-controller]: error while trying to add sourceBuffer: "+n.message),this.hls.trigger(k.Events.ERROR,{type:j.ErrorTypes.MEDIA_ERROR,details:j.ErrorDetails.BUFFER_ADD_CODEC_ERROR,fatal:!1,error:n,mimeType:L})}}p&&this.hls.trigger(k.Events.BUFFER_CREATED,{tracks:this.tracks})},E._onSBUpdateStart=function(a){var i=this.operationQueue,l=i.current(a);l.onStart()},E._onSBUpdateEnd=function(a){var i=this.operationQueue,l=i.current(a);l.onComplete(),i.shiftAndExecuteNext(a)},E._onSBUpdateError=function(a,i){x.logger.error("[buffer-controller]: "+a+" SourceBuffer error",i),this.hls.trigger(k.Events.ERROR,{type:j.ErrorTypes.MEDIA_ERROR,details:j.ErrorDetails.BUFFER_APPENDING_ERROR,fatal:!1});var l=this.operationQueue.current(a);l&&l.onError(i)},E.removeExecutor=function(a,i,l){var p=this.media,f=this.mediaSource,h=this.operationQueue,m=this.sourceBuffer,L=m[a];if(!p||!f||!L){x.logger.warn("[buffer-controller]: Attempting to remove from the "+a+" SourceBuffer, but it does not exist"),h.shiftAndExecuteNext(a);return}var S=Object(H.isFiniteNumber)(p.duration)?p.duration:Infinity,v=Object(H.isFiniteNumber)(f.duration)?f.duration:Infinity,n=Math.max(0,i),s=Math.min(l,S,v);s>n?(x.logger.log("[buffer-controller]: Removing ["+n+","+s+"] from the "+a+" SourceBuffer"),console.assert(!L.updating,a+" sourceBuffer must not be updating"),L.remove(n,s)):h.shiftAndExecuteNext(a)},E.appendExecutor=function(a,i){var l=this.operationQueue,p=this.sourceBuffer,f=p[i];if(!f){x.logger.warn("[buffer-controller]: Attempting to append to the "+i+" SourceBuffer, but it does not exist"),l.shiftAndExecuteNext(i);return}f.ended=!1,console.assert(!f.updating,i+" sourceBuffer must not be updating"),f.appendBuffer(a)},E.blockBuffers=function(a,i){var l=this;if(i===void 0&&(i=this.getSourceBufferTypes()),!i.length){x.logger.log("[buffer-controller]: Blocking operation requested, but no SourceBuffers exist"),Promise.resolve(a);return}var p=this.operationQueue,f=i.map(function(h){return p.appendBlocker(h)});Promise.all(f).then(function(){a(),i.forEach(function(h){var m=l.sourceBuffer[h];(!m||!m.updating)&&p.shiftAndExecuteNext(h)})})},E.getSourceBufferTypes=function(){return Object.keys(this.sourceBuffer)},E.addBufferListener=function(a,i,l){var p=this.sourceBuffer[a];if(!!p){var f=l.bind(this,a);this.listeners[a].push({event:i,listener:f}),p.addEventListener(i,f)}},E.removeBufferListeners=function(a){var i=this.sourceBuffer[a];!i||this.listeners[a].forEach(function(l){i.removeEventListener(l.event,l.listener)})},d}()},"./src/controller/buffer-operation-queue.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"default",function(){return k});var H=M("./src/utils/logger.ts"),k=function(){function x(F){this.buffers=void 0,this.queues={video:[],audio:[],audiovideo:[]},this.buffers=F}var j=x.prototype;return j.append=function(R,O){var y=this.queues[O];y.push(R),y.length===1&&this.buffers[O]&&this.executeNext(O)},j.insertAbort=function(R,O){var y=this.queues[O];y.unshift(R),this.executeNext(O)},j.appendBlocker=function(R){var O,y=new Promise(function(P){O=P}),C={execute:O,onStart:function(){},onComplete:function(){},onError:function(){}};return this.append(C,R),y},j.executeNext=function(R){var O=this.buffers,y=this.queues,C=O[R],P=y[R];if(P.length){var u=P[0];try{u.execute()}catch(d){H.logger.warn("[buffer-operation-queue]: Unhandled exception executing the current operation"),u.onError(d),(!C||!C.updating)&&(P.shift(),this.executeNext(R))}}},j.shiftAndExecuteNext=function(R){this.queues[R].shift(),this.executeNext(R)},j.current=function(R){return this.queues[R][0]},x}()},"./src/controller/cap-level-controller.ts":function(re,K,M){"use strict";M.r(K);var H=M("./src/events.ts");function k(F,R){for(var O=0;O<R.length;O++){var y=R[O];y.enumerable=y.enumerable||!1,y.configurable=!0,"value"in y&&(y.writable=!0),Object.defineProperty(F,y.key,y)}}function x(F,R,O){return R&&k(F.prototype,R),O&&k(F,O),F}var j=function(){function F(O){this.autoLevelCapping=void 0,this.firstLevel=void 0,this.media=void 0,this.restrictedLevels=void 0,this.timer=void 0,this.hls=void 0,this.streamController=void 0,this.clientRect=void 0,this.hls=O,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.firstLevel=-1,this.media=null,this.restrictedLevels=[],this.timer=void 0,this.clientRect=null,this.registerListeners()}var R=F.prototype;return R.setStreamController=function(y){this.streamController=y},R.destroy=function(){this.unregisterListener(),this.hls.config.capLevelToPlayerSize&&this.stopCapping(),this.media=null,this.clientRect=null,this.hls=this.streamController=null},R.registerListeners=function(){var y=this.hls;y.on(H.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),y.on(H.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),y.on(H.Events.MANIFEST_PARSED,this.onManifestParsed,this),y.on(H.Events.BUFFER_CODECS,this.onBufferCodecs,this),y.on(H.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},R.unregisterListener=function(){var y=this.hls;y.off(H.Events.FPS_DROP_LEVEL_CAPPING,this.onFpsDropLevelCapping,this),y.off(H.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),y.off(H.Events.MANIFEST_PARSED,this.onManifestParsed,this),y.off(H.Events.BUFFER_CODECS,this.onBufferCodecs,this),y.off(H.Events.MEDIA_DETACHING,this.onMediaDetaching,this)},R.onFpsDropLevelCapping=function(y,C){F.isLevelAllowed(C.droppedLevel,this.restrictedLevels)&&this.restrictedLevels.push(C.droppedLevel)},R.onMediaAttaching=function(y,C){this.media=C.media instanceof HTMLVideoElement?C.media:null},R.onManifestParsed=function(y,C){var P=this.hls;this.restrictedLevels=[],this.firstLevel=C.firstLevel,P.config.capLevelToPlayerSize&&C.video&&this.startCapping()},R.onBufferCodecs=function(y,C){var P=this.hls;P.config.capLevelToPlayerSize&&C.video&&this.startCapping()},R.onMediaDetaching=function(){this.stopCapping()},R.detectPlayerSize=function(){if(this.media&&this.mediaHeight>0&&this.mediaWidth>0){var y=this.hls.levels;if(y.length){var C=this.hls;C.autoLevelCapping=this.getMaxLevel(y.length-1),C.autoLevelCapping>this.autoLevelCapping&&this.streamController&&this.streamController.nextLevelSwitch(),this.autoLevelCapping=C.autoLevelCapping}}},R.getMaxLevel=function(y){var C=this,P=this.hls.levels;if(!P.length)return-1;var u=P.filter(function(d,E){return F.isLevelAllowed(E,C.restrictedLevels)&&E<=y});return this.clientRect=null,F.getMaxLevelByMediaSize(u,this.mediaWidth,this.mediaHeight)},R.startCapping=function(){this.timer||(this.autoLevelCapping=Number.POSITIVE_INFINITY,this.hls.firstLevel=this.getMaxLevel(this.firstLevel),self.clearInterval(this.timer),this.timer=self.setInterval(this.detectPlayerSize.bind(this),1e3),this.detectPlayerSize())},R.stopCapping=function(){this.restrictedLevels=[],this.firstLevel=-1,this.autoLevelCapping=Number.POSITIVE_INFINITY,this.timer&&(self.clearInterval(this.timer),this.timer=void 0)},R.getDimensions=function(){if(this.clientRect)return this.clientRect;var y=this.media,C={width:0,height:0};if(y){var P=y.getBoundingClientRect();C.width=P.width,C.height=P.height,!C.width&&!C.height&&(C.width=P.right-P.left||y.width||0,C.height=P.bottom-P.top||y.height||0)}return this.clientRect=C,C},F.isLevelAllowed=function(y,C){return C===void 0&&(C=[]),C.indexOf(y)===-1},F.getMaxLevelByMediaSize=function(y,C,P){if(!y||!y.length)return-1;for(var u=function(i,l){return l?i.width!==l.width||i.height!==l.height:!0},d=y.length-1,E=0;E<y.length;E+=1){var c=y[E];if((c.width>=C||c.height>=P)&&u(c,y[E+1])){d=E;break}}return d},x(F,[{key:"mediaWidth",get:function(){return this.getDimensions().width*F.contentScaleFactor}},{key:"mediaHeight",get:function(){return this.getDimensions().height*F.contentScaleFactor}}],[{key:"contentScaleFactor",get:function(){var y=1;try{y=self.devicePixelRatio}catch(C){}return y}}]),F}();K.default=j},"./src/controller/eme-controller.ts":function(re,K,M){"use strict";M.r(K);var H=M("./src/events.ts"),k=M("./src/errors.ts"),x=M("./src/utils/logger.ts"),j=M("./src/utils/mediakeys-helper.ts");function F(u,d){for(var E=0;E<d.length;E++){var c=d[E];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(u,c.key,c)}}function R(u,d,E){return d&&F(u.prototype,d),E&&F(u,E),u}var O=3,y=function(d,E,c){var a={audioCapabilities:[],videoCapabilities:[]};return d.forEach(function(i){a.audioCapabilities.push({contentType:'audio/mp4; codecs="'+i+'"',robustness:c.audioRobustness||""})}),E.forEach(function(i){a.videoCapabilities.push({contentType:'video/mp4; codecs="'+i+'"',robustness:c.videoRobustness||""})}),[a]},C=function(d,E,c,a){switch(d){case j.KeySystems.WIDEVINE:return y(E,c,a);default:throw new Error("Unknown key-system: "+d)}},P=function(){function u(E){this.hls=void 0,this._widevineLicenseUrl=void 0,this._licenseXhrSetup=void 0,this._licenseResponseCallback=void 0,this._emeEnabled=void 0,this._requestMediaKeySystemAccess=void 0,this._drmSystemOptions=void 0,this._config=void 0,this._mediaKeysList=[],this._media=null,this._hasSetMediaKeys=!1,this._requestLicenseFailureCount=0,this.mediaKeysPromise=null,this._onMediaEncrypted=this.onMediaEncrypted.bind(this),this.hls=E,this._config=E.config,this._widevineLicenseUrl=this._config.widevineLicenseUrl,this._licenseXhrSetup=this._config.licenseXhrSetup,this._licenseResponseCallback=this._config.licenseResponseCallback,this._emeEnabled=this._config.emeEnabled,this._requestMediaKeySystemAccess=this._config.requestMediaKeySystemAccessFunc,this._drmSystemOptions=this._config.drmSystemOptions,this._registerListeners()}var d=u.prototype;return d.destroy=function(){this._unregisterListeners(),this.hls=this._onMediaEncrypted=null,this._requestMediaKeySystemAccess=null},d._registerListeners=function(){this.hls.on(H.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(H.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.on(H.Events.MANIFEST_PARSED,this.onManifestParsed,this)},d._unregisterListeners=function(){this.hls.off(H.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.off(H.Events.MEDIA_DETACHED,this.onMediaDetached,this),this.hls.off(H.Events.MANIFEST_PARSED,this.onManifestParsed,this)},d.getLicenseServerUrl=function(c){switch(c){case j.KeySystems.WIDEVINE:if(!this._widevineLicenseUrl)break;return this._widevineLicenseUrl}throw new Error('no license server URL configured for key-system "'+c+'"')},d._attemptKeySystemAccess=function(c,a,i){var l=this,p=C(c,a,i,this._drmSystemOptions);x.logger.log("Requesting encrypted media key-system access");var f=this.requestMediaKeySystemAccess(c,p);this.mediaKeysPromise=f.then(function(h){return l._onMediaKeySystemAccessObtained(c,h)}),f.catch(function(h){x.logger.error('Failed to obtain key-system "'+c+'" access:',h)})},d._onMediaKeySystemAccessObtained=function(c,a){var i=this;x.logger.log('Access for key-system "'+c+'" obtained');var l={mediaKeysSessionInitialized:!1,mediaKeySystemAccess:a,mediaKeySystemDomain:c};this._mediaKeysList.push(l);var p=Promise.resolve().then(function(){return a.createMediaKeys()}).then(function(f){return l.mediaKeys=f,x.logger.log('Media-keys created for key-system "'+c+'"'),i._onMediaKeysCreated(),f});return p.catch(function(f){x.logger.error("Failed to create media-keys:",f)}),p},d._onMediaKeysCreated=function(){var c=this;this._mediaKeysList.forEach(function(a){a.mediaKeysSession||(a.mediaKeysSession=a.mediaKeys.createSession(),c._onNewMediaKeySession(a.mediaKeysSession))})},d._onNewMediaKeySession=function(c){var a=this;x.logger.log("New key-system session "+c.sessionId),c.addEventListener("message",function(i){a._onKeySessionMessage(c,i.message)},!1)},d._onKeySessionMessage=function(c,a){x.logger.log("Got EME message event, creating license request"),this._requestLicense(a,function(i){x.logger.log("Received license data (length: "+(i&&i.byteLength)+"), updating key-session"),c.update(i)})},d.onMediaEncrypted=function(c){var a=this;if(x.logger.log('Media is encrypted using "'+c.initDataType+'" init data type'),!this.mediaKeysPromise){x.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been requested"),this.hls.trigger(H.Events.ERROR,{type:k.ErrorTypes.KEY_SYSTEM_ERROR,details:k.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}var i=function(p){!a._media||(a._attemptSetMediaKeys(p),a._generateRequestWithPreferredKeySession(c.initDataType,c.initData))};this.mediaKeysPromise.then(i).catch(i)},d._attemptSetMediaKeys=function(c){if(!this._media)throw new Error("Attempted to set mediaKeys without first attaching a media element");if(!this._hasSetMediaKeys){var a=this._mediaKeysList[0];if(!a||!a.mediaKeys){x.logger.error("Fatal: Media is encrypted but no CDM access or no keys have been obtained yet"),this.hls.trigger(H.Events.ERROR,{type:k.ErrorTypes.KEY_SYSTEM_ERROR,details:k.ErrorDetails.KEY_SYSTEM_NO_KEYS,fatal:!0});return}x.logger.log("Setting keys for encrypted media"),this._media.setMediaKeys(a.mediaKeys),this._hasSetMediaKeys=!0}},d._generateRequestWithPreferredKeySession=function(c,a){var i=this,l=this._mediaKeysList[0];if(!l){x.logger.error("Fatal: Media is encrypted but not any key-system access has been obtained yet"),this.hls.trigger(H.Events.ERROR,{type:k.ErrorTypes.KEY_SYSTEM_ERROR,details:k.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}if(l.mediaKeysSessionInitialized){x.logger.warn("Key-Session already initialized but requested again");return}var p=l.mediaKeysSession;if(!p){x.logger.error("Fatal: Media is encrypted but no key-session existing"),this.hls.trigger(H.Events.ERROR,{type:k.ErrorTypes.KEY_SYSTEM_ERROR,details:k.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!0});return}if(!a){x.logger.warn("Fatal: initData required for generating a key session is null"),this.hls.trigger(H.Events.ERROR,{type:k.ErrorTypes.KEY_SYSTEM_ERROR,details:k.ErrorDetails.KEY_SYSTEM_NO_INIT_DATA,fatal:!0});return}x.logger.log('Generating key-session request for "'+c+'" init data type'),l.mediaKeysSessionInitialized=!0,p.generateRequest(c,a).then(function(){x.logger.debug("Key-session generation succeeded")}).catch(function(f){x.logger.error("Error generating key-session request:",f),i.hls.trigger(H.Events.ERROR,{type:k.ErrorTypes.KEY_SYSTEM_ERROR,details:k.ErrorDetails.KEY_SYSTEM_NO_SESSION,fatal:!1})})},d._createLicenseXhr=function(c,a,i){var l=new XMLHttpRequest;l.responseType="arraybuffer",l.onreadystatechange=this._onLicenseRequestReadyStageChange.bind(this,l,c,a,i);var p=this._licenseXhrSetup;if(p)try{p.call(this.hls,l,c),p=void 0}catch(f){x.logger.error(f)}try{l.readyState||l.open("POST",c,!0),p&&p.call(this.hls,l,c)}catch(f){throw new Error("issue setting up KeySystem license XHR "+f)}return l},d._onLicenseRequestReadyStageChange=function(c,a,i,l){switch(c.readyState){case 4:if(c.status===200){this._requestLicenseFailureCount=0,x.logger.log("License request succeeded");var p=c.response,f=this._licenseResponseCallback;if(f)try{p=f.call(this.hls,c,a)}catch(m){x.logger.error(m)}l(p)}else{if(x.logger.error("License Request XHR failed ("+a+"). Status: "+c.status+" ("+c.statusText+")"),this._requestLicenseFailureCount++,this._requestLicenseFailureCount>O){this.hls.trigger(H.Events.ERROR,{type:k.ErrorTypes.KEY_SYSTEM_ERROR,details:k.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0});return}var h=O-this._requestLicenseFailureCount+1;x.logger.warn("Retrying license request, "+h+" attempts left"),this._requestLicense(i,l)}break}},d._generateLicenseRequestChallenge=function(c,a){switch(c.mediaKeySystemDomain){case j.KeySystems.WIDEVINE:return a}throw new Error("unsupported key-system: "+c.mediaKeySystemDomain)},d._requestLicense=function(c,a){x.logger.log("Requesting content license for key-system");var i=this._mediaKeysList[0];if(!i){x.logger.error("Fatal error: Media is encrypted but no key-system access has been obtained yet"),this.hls.trigger(H.Events.ERROR,{type:k.ErrorTypes.KEY_SYSTEM_ERROR,details:k.ErrorDetails.KEY_SYSTEM_NO_ACCESS,fatal:!0});return}try{var l=this.getLicenseServerUrl(i.mediaKeySystemDomain),p=this._createLicenseXhr(l,c,a);x.logger.log("Sending license request to URL: "+l);var f=this._generateLicenseRequestChallenge(i,c);p.send(f)}catch(h){x.logger.error("Failure requesting DRM license: "+h),this.hls.trigger(H.Events.ERROR,{type:k.ErrorTypes.KEY_SYSTEM_ERROR,details:k.ErrorDetails.KEY_SYSTEM_LICENSE_REQUEST_FAILED,fatal:!0})}},d.onMediaAttached=function(c,a){if(!!this._emeEnabled){var i=a.media;this._media=i,i.addEventListener("encrypted",this._onMediaEncrypted)}},d.onMediaDetached=function(){var c=this._media,a=this._mediaKeysList;!c||(c.removeEventListener("encrypted",this._onMediaEncrypted),this._media=null,this._mediaKeysList=[],Promise.all(a.map(function(i){if(i.mediaKeysSession)return i.mediaKeysSession.close().catch(function(){})})).then(function(){return c.setMediaKeys(null)}).catch(function(){}))},d.onManifestParsed=function(c,a){if(!!this._emeEnabled){var i=a.levels.map(function(p){return p.audioCodec}).filter(function(p){return!!p}),l=a.levels.map(function(p){return p.videoCodec}).filter(function(p){return!!p});this._attemptKeySystemAccess(j.KeySystems.WIDEVINE,i,l)}},R(u,[{key:"requestMediaKeySystemAccess",get:function(){if(!this._requestMediaKeySystemAccess)throw new Error("No requestMediaKeySystemAccess function configured");return this._requestMediaKeySystemAccess}}]),u}();K.default=P},"./src/controller/fps-controller.ts":function(re,K,M){"use strict";M.r(K);var H=M("./src/events.ts"),k=M("./src/utils/logger.ts"),x=function(){function j(R){this.hls=void 0,this.isVideoPlaybackQualityAvailable=!1,this.timer=void 0,this.media=null,this.lastTime=void 0,this.lastDroppedFrames=0,this.lastDecodedFrames=0,this.streamController=void 0,this.hls=R,this.registerListeners()}var F=j.prototype;return F.setStreamController=function(O){this.streamController=O},F.registerListeners=function(){this.hls.on(H.Events.MEDIA_ATTACHING,this.onMediaAttaching,this)},F.unregisterListeners=function(){this.hls.off(H.Events.MEDIA_ATTACHING,this.onMediaAttaching)},F.destroy=function(){this.timer&&clearInterval(this.timer),this.unregisterListeners(),this.isVideoPlaybackQualityAvailable=!1,this.media=null},F.onMediaAttaching=function(O,y){var C=this.hls.config;if(C.capLevelOnFPSDrop){var P=y.media instanceof self.HTMLVideoElement?y.media:null;this.media=P,P&&typeof P.getVideoPlaybackQuality=="function"&&(this.isVideoPlaybackQualityAvailable=!0),self.clearInterval(this.timer),this.timer=self.setInterval(this.checkFPSInterval.bind(this),C.fpsDroppedMonitoringPeriod)}},F.checkFPS=function(O,y,C){var P=performance.now();if(y){if(this.lastTime){var u=P-this.lastTime,d=C-this.lastDroppedFrames,E=y-this.lastDecodedFrames,c=1e3*d/u,a=this.hls;if(a.trigger(H.Events.FPS_DROP,{currentDropped:d,currentDecoded:E,totalDroppedFrames:C}),c>0&&d>a.config.fpsDroppedMonitoringThreshold*E){var i=a.currentLevel;k.logger.warn("drop FPS ratio greater than max allowed value for currentLevel: "+i),i>0&&(a.autoLevelCapping===-1||a.autoLevelCapping>=i)&&(i=i-1,a.trigger(H.Events.FPS_DROP_LEVEL_CAPPING,{level:i,droppedLevel:a.currentLevel}),a.autoLevelCapping=i,this.streamController.nextLevelSwitch())}}this.lastTime=P,this.lastDroppedFrames=C,this.lastDecodedFrames=y}},F.checkFPSInterval=function(){var O=this.media;if(O)if(this.isVideoPlaybackQualityAvailable){var y=O.getVideoPlaybackQuality();this.checkFPS(O,y.totalVideoFrames,y.droppedVideoFrames)}else this.checkFPS(O,O.webkitDecodedFrameCount,O.webkitDroppedFrameCount)},j}();K.default=x},"./src/controller/fragment-finders.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"findFragmentByPDT",function(){return x}),M.d(K,"findFragmentByPTS",function(){return j}),M.d(K,"fragmentWithinToleranceTest",function(){return F}),M.d(K,"pdtWithinToleranceTest",function(){return R}),M.d(K,"findFragWithCC",function(){return O});var H=M("./src/polyfills/number.ts"),k=M("./src/utils/binary-search.ts");function x(y,C,P){if(C===null||!Array.isArray(y)||!y.length||!Object(H.isFiniteNumber)(C))return null;var u=y[0].programDateTime;if(C<(u||0))return null;var d=y[y.length-1].endProgramDateTime;if(C>=(d||0))return null;P=P||0;for(var E=0;E<y.length;++E){var c=y[E];if(R(C,P,c))return c}return null}function j(y,C,P,u){P===void 0&&(P=0),u===void 0&&(u=0);var d=null;if(y?d=C[y.sn-C[0].sn+1]||null:P===0&&C[0].start===0&&(d=C[0]),d&&F(P,u,d)===0)return d;var E=k.default.search(C,F.bind(null,P,u));return E||d}function F(y,C,P){y===void 0&&(y=0),C===void 0&&(C=0);var u=Math.min(C,P.duration+(P.deltaPTS?P.deltaPTS:0));return P.start+P.duration-u<=y?1:P.start-u>y&&P.start?-1:0}function R(y,C,P){var u=Math.min(C,P.duration+(P.deltaPTS?P.deltaPTS:0))*1e3,d=P.endProgramDateTime||0;return d-u>y}function O(y,C){return k.default.search(y,function(P){return P.cc<C?1:P.cc>C?-1:0})}},"./src/controller/fragment-tracker.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"FragmentState",function(){return x}),M.d(K,"FragmentTracker",function(){return j});var H=M("./src/events.ts"),k=M("./src/types/loader.ts"),x;(function(O){O.NOT_LOADED="NOT_LOADED",O.BACKTRACKED="BACKTRACKED",O.APPENDING="APPENDING",O.PARTIAL="PARTIAL",O.OK="OK"})(x||(x={}));var j=function(){function O(C){this.activeFragment=null,this.activeParts=null,this.fragments=Object.create(null),this.timeRanges=Object.create(null),this.bufferPadding=.2,this.hls=void 0,this.hls=C,this._registerListeners()}var y=O.prototype;return y._registerListeners=function(){var P=this.hls;P.on(H.Events.BUFFER_APPENDED,this.onBufferAppended,this),P.on(H.Events.FRAG_BUFFERED,this.onFragBuffered,this),P.on(H.Events.FRAG_LOADED,this.onFragLoaded,this)},y._unregisterListeners=function(){var P=this.hls;P.off(H.Events.BUFFER_APPENDED,this.onBufferAppended,this),P.off(H.Events.FRAG_BUFFERED,this.onFragBuffered,this),P.off(H.Events.FRAG_LOADED,this.onFragLoaded,this)},y.destroy=function(){this._unregisterListeners(),this.fragments=this.timeRanges=null},y.getAppendedFrag=function(P,u){if(u===k.PlaylistLevelType.MAIN){var d=this.activeFragment,E=this.activeParts;if(!d)return null;if(E)for(var c=E.length;c--;){var a=E[c],i=a?a.end:d.appendedPTS;if(a.start<=P&&i!==void 0&&P<=i)return c>9&&(this.activeParts=E.slice(c-9)),a}else if(d.start<=P&&d.appendedPTS!==void 0&&P<=d.appendedPTS)return d}return this.getBufferedFrag(P,u)},y.getBufferedFrag=function(P,u){for(var d=this.fragments,E=Object.keys(d),c=E.length;c--;){var a=d[E[c]];if((a==null?void 0:a.body.type)===u&&a.buffered){var i=a.body;if(i.start<=P&&P<=i.end)return i}}return null},y.detectEvictedFragments=function(P,u,d){var E=this;Object.keys(this.fragments).forEach(function(c){var a=E.fragments[c];if(!!a){if(!a.buffered){a.body.type===d&&E.removeFragment(a.body);return}var i=a.range[P];!i||i.time.some(function(l){var p=!E.isTimeBuffered(l.startPTS,l.endPTS,u);return p&&E.removeFragment(a.body),p})}})},y.detectPartialFragments=function(P){var u=this,d=this.timeRanges,E=P.frag,c=P.part;if(!(!d||E.sn==="initSegment")){var a=R(E),i=this.fragments[a];!i||(Object.keys(d).forEach(function(l){var p=E.elementaryStreams[l];if(!!p){var f=d[l],h=c!==null||p.partial===!0;i.range[l]=u.getBufferedTimes(E,c,h,f)}}),i.backtrack=i.loaded=null,Object.keys(i.range).length?i.buffered=!0:this.removeFragment(i.body))}},y.fragBuffered=function(P){var u=R(P),d=this.fragments[u];d&&(d.backtrack=d.loaded=null,d.buffered=!0)},y.getBufferedTimes=function(P,u,d,E){for(var c={time:[],partial:d},a=u?u.start:P.start,i=u?u.end:P.end,l=P.minEndPTS||i,p=P.maxStartPTS||a,f=0;f<E.length;f++){var h=E.start(f)-this.bufferPadding,m=E.end(f)+this.bufferPadding;if(p>=h&&l<=m){c.time.push({startPTS:Math.max(a,E.start(f)),endPTS:Math.min(i,E.end(f))});break}else if(a<m&&i>h)c.partial=!0,c.time.push({startPTS:Math.max(a,E.start(f)),endPTS:Math.min(i,E.end(f))});else if(i<=h)break}return c},y.getPartialFragment=function(P){var u=null,d,E,c,a=0,i=this.bufferPadding,l=this.fragments;return Object.keys(l).forEach(function(p){var f=l[p];!f||F(f)&&(E=f.body.start-i,c=f.body.end+i,P>=E&&P<=c&&(d=Math.min(P-E,c-P),a<=d&&(u=f.body,a=d)))}),u},y.getState=function(P){var u=R(P),d=this.fragments[u];return d?d.buffered?F(d)?x.PARTIAL:x.OK:d.backtrack?x.BACKTRACKED:x.APPENDING:x.NOT_LOADED},y.backtrack=function(P,u){var d=R(P),E=this.fragments[d];if(!E||E.backtrack)return null;var c=E.backtrack=u||E.loaded;return E.loaded=null,c},y.getBacktrackData=function(P){var u=R(P),d=this.fragments[u];if(d){var E,c=d.backtrack;if(c!=null&&(E=c.payload)!==null&&E!==void 0&&E.byteLength)return c;this.removeFragment(P)}return null},y.isTimeBuffered=function(P,u,d){for(var E,c,a=0;a<d.length;a++){if(E=d.start(a)-this.bufferPadding,c=d.end(a)+this.bufferPadding,P>=E&&u<=c)return!0;if(u<=E)return!1}return!1},y.onFragLoaded=function(P,u){var d=u.frag,E=u.part;if(!(d.sn==="initSegment"||d.bitrateTest||E)){var c=R(d);this.fragments[c]={body:d,loaded:u,backtrack:null,buffered:!1,range:Object.create(null)}}},y.onBufferAppended=function(P,u){var d=this,E=u.frag,c=u.part,a=u.timeRanges;if(E.type===k.PlaylistLevelType.MAIN)if(this.activeFragment=E,c){var i=this.activeParts;i||(this.activeParts=i=[]),i.push(c)}else this.activeParts=null;this.timeRanges=a,Object.keys(a).forEach(function(l){var p=a[l];if(d.detectEvictedFragments(l,p),!c)for(var f=0;f<p.length;f++)E.appendedPTS=Math.max(p.end(f),E.appendedPTS||0)})},y.onFragBuffered=function(P,u){this.detectPartialFragments(u)},y.hasFragment=function(P){var u=R(P);return!!this.fragments[u]},y.removeFragmentsInRange=function(P,u,d){var E=this;Object.keys(this.fragments).forEach(function(c){var a=E.fragments[c];if(!!a&&a.buffered){var i=a.body;i.type===d&&i.start<u&&i.end>P&&E.removeFragment(i)}})},y.removeFragment=function(P){var u=R(P);P.stats.loaded=0,P.clearElementaryStreamInfo(),delete this.fragments[u]},y.removeAllFragments=function(){this.fragments=Object.create(null),this.activeFragment=null,this.activeParts=null},O}();function F(O){var y,C;return O.buffered&&(((y=O.range.video)===null||y===void 0?void 0:y.partial)||((C=O.range.audio)===null||C===void 0?void 0:C.partial))}function R(O){return O.type+"_"+O.level+"_"+O.urlId+"_"+O.sn}},"./src/controller/gap-controller.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"STALL_MINIMUM_DURATION_MS",function(){return F}),M.d(K,"MAX_START_GAP_JUMP",function(){return R}),M.d(K,"SKIP_BUFFER_HOLE_STEP_SECONDS",function(){return O}),M.d(K,"SKIP_BUFFER_RANGE_START",function(){return y}),M.d(K,"default",function(){return C});var H=M("./src/utils/buffer-helper.ts"),k=M("./src/errors.ts"),x=M("./src/events.ts"),j=M("./src/utils/logger.ts"),F=250,R=2,O=.1,y=.05,C=function(){function P(d,E,c,a){this.config=void 0,this.media=void 0,this.fragmentTracker=void 0,this.hls=void 0,this.nudgeRetry=0,this.stallReported=!1,this.stalled=null,this.moved=!1,this.seeking=!1,this.config=d,this.media=E,this.fragmentTracker=c,this.hls=a}var u=P.prototype;return u.destroy=function(){this.hls=this.fragmentTracker=this.media=null},u.poll=function(E){var c=this.config,a=this.media,i=this.stalled,l=a.currentTime,p=a.seeking,f=this.seeking&&!p,h=!this.seeking&&p;if(this.seeking=p,l!==E){if(this.moved=!0,i!==null){if(this.stallReported){var m=self.performance.now()-i;j.logger.warn("playback not stuck anymore @"+l+", after "+Math.round(m)+"ms"),this.stallReported=!1}this.stalled=null,this.nudgeRetry=0}return}if((h||f)&&(this.stalled=null),!(a.paused||a.ended||a.playbackRate===0||!H.BufferHelper.getBuffered(a).length)){var L=H.BufferHelper.bufferInfo(a,l,0),S=L.len>0,v=L.nextStart||0;if(!(!S&&!v)){if(p){var n=L.len>R,s=!v||v-l>R&&!this.fragmentTracker.getPartialFragment(l);if(n||s)return;this.moved=!1}if(!this.moved&&this.stalled!==null){var A,_=Math.max(v,L.start||0)-l,D=this.hls.levels?this.hls.levels[this.hls.currentLevel]:null,I=D==null||(A=D.details)===null||A===void 0?void 0:A.live,w=I?D.details.targetduration*2:R;if(_>0&&_<=w){this._trySkipBufferHole(null);return}}var B=self.performance.now();if(i===null){this.stalled=B;return}var N=B-i;!p&&N>=F&&this._reportStall(L.len);var W=H.BufferHelper.bufferInfo(a,l,c.maxBufferHole);this._tryFixBufferStall(W,N)}}},u._tryFixBufferStall=function(E,c){var a=this.config,i=this.fragmentTracker,l=this.media,p=l.currentTime,f=i.getPartialFragment(p);if(f){var h=this._trySkipBufferHole(f);if(h)return}E.len>a.maxBufferHole&&c>a.highBufferWatchdogPeriod*1e3&&(j.logger.warn("Trying to nudge playhead over buffer-hole"),this.stalled=null,this._tryNudgeBuffer())},u._reportStall=function(E){var c=this.hls,a=this.media,i=this.stallReported;i||(this.stallReported=!0,j.logger.warn("Playback stalling at @"+a.currentTime+" due to low buffer (buffer="+E+")"),c.trigger(x.Events.ERROR,{type:k.ErrorTypes.MEDIA_ERROR,details:k.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!1,buffer:E}))},u._trySkipBufferHole=function(E){for(var c=this.config,a=this.hls,i=this.media,l=i.currentTime,p=0,f=H.BufferHelper.getBuffered(i),h=0;h<f.length;h++){var m=f.start(h);if(l+c.maxBufferHole>=p&&l<m){var L=Math.max(m+y,i.currentTime+O);return j.logger.warn("skipping hole, adjusting currentTime from "+l+" to "+L),this.moved=!0,this.stalled=null,i.currentTime=L,E&&a.trigger(x.Events.ERROR,{type:k.ErrorTypes.MEDIA_ERROR,details:k.ErrorDetails.BUFFER_SEEK_OVER_HOLE,fatal:!1,reason:"fragment loaded with buffer holes, seeking from "+l+" to "+L,frag:E}),L}p=f.end(h)}return 0},u._tryNudgeBuffer=function(){var E=this.config,c=this.hls,a=this.media,i=a.currentTime,l=(this.nudgeRetry||0)+1;if(this.nudgeRetry=l,l<E.nudgeMaxRetry){var p=i+l*E.nudgeOffset;j.logger.warn("Nudging 'currentTime' from "+i+" to "+p),a.currentTime=p,c.trigger(x.Events.ERROR,{type:k.ErrorTypes.MEDIA_ERROR,details:k.ErrorDetails.BUFFER_NUDGE_ON_STALL,fatal:!1})}else j.logger.error("Playhead still not moving while enough data buffered @"+i+" after "+E.nudgeMaxRetry+" nudges"),c.trigger(x.Events.ERROR,{type:k.ErrorTypes.MEDIA_ERROR,details:k.ErrorDetails.BUFFER_STALLED_ERROR,fatal:!0})},P}()},"./src/controller/id3-track-controller.ts":function(re,K,M){"use strict";M.r(K);var H=M("./src/events.ts"),k=M("./src/utils/texttrack-utils.ts"),x=M("./src/demux/id3.ts"),j=.25,F=function(){function R(y){this.hls=void 0,this.id3Track=null,this.media=null,this.hls=y,this._registerListeners()}var O=R.prototype;return O.destroy=function(){this._unregisterListeners()},O._registerListeners=function(){var C=this.hls;C.on(H.Events.MEDIA_ATTACHED,this.onMediaAttached,this),C.on(H.Events.MEDIA_DETACHING,this.onMediaDetaching,this),C.on(H.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),C.on(H.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},O._unregisterListeners=function(){var C=this.hls;C.off(H.Events.MEDIA_ATTACHED,this.onMediaAttached,this),C.off(H.Events.MEDIA_DETACHING,this.onMediaDetaching,this),C.off(H.Events.FRAG_PARSING_METADATA,this.onFragParsingMetadata,this),C.off(H.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},O.onMediaAttached=function(C,P){this.media=P.media},O.onMediaDetaching=function(){!this.id3Track||(Object(k.clearCurrentCues)(this.id3Track),this.id3Track=null,this.media=null)},O.getID3Track=function(C){if(!!this.media){for(var P=0;P<C.length;P++){var u=C[P];if(u.kind==="metadata"&&u.label==="id3")return Object(k.sendAddTrackEvent)(u,this.media),u}return this.media.addTextTrack("metadata","id3")}},O.onFragParsingMetadata=function(C,P){if(!!this.media){var u=P.frag,d=P.samples;this.id3Track||(this.id3Track=this.getID3Track(this.media.textTracks),this.id3Track.mode="hidden");for(var E=self.WebKitDataCue||self.VTTCue||self.TextTrackCue,c=0;c<d.length;c++){var a=x.getID3Frames(d[c].data);if(a){var i=d[c].pts,l=c<d.length-1?d[c+1].pts:u.end,p=l-i;p<=0&&(l=i+j);for(var f=0;f<a.length;f++){var h=a[f];if(!x.isTimeStampFrame(h)){var m=new E(i,l,"");m.value=h,this.id3Track.addCue(m)}}}}}},O.onBufferFlushing=function(C,P){var u=P.startOffset,d=P.endOffset,E=P.type;if(!E||E==="audio"){var c=this.id3Track;c&&Object(k.removeCuesInRange)(c,u,d)}},R}();K.default=F},"./src/controller/latency-controller.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"default",function(){return R});var H=M("./src/errors.ts"),k=M("./src/events.ts"),x=M("./src/utils/logger.ts");function j(O,y){for(var C=0;C<y.length;C++){var P=y[C];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(O,P.key,P)}}function F(O,y,C){return y&&j(O.prototype,y),C&&j(O,C),O}var R=function(){function O(C){var P=this;this.hls=void 0,this.config=void 0,this.media=null,this.levelDetails=null,this.currentTime=0,this.stallCount=0,this._latency=null,this.timeupdateHandler=function(){return P.timeupdate()},this.hls=C,this.config=C.config,this.registerListeners()}var y=O.prototype;return y.destroy=function(){this.unregisterListeners(),this.onMediaDetaching(),this.levelDetails=null,this.hls=this.timeupdateHandler=null},y.registerListeners=function(){this.hls.on(k.Events.MEDIA_ATTACHED,this.onMediaAttached,this),this.hls.on(k.Events.MEDIA_DETACHING,this.onMediaDetaching,this),this.hls.on(k.Events.MANIFEST_LOADING,this.onManifestLoading,this),this.hls.on(k.Events.LEVEL_UPDATED,this.onLevelUpdated,this),this.hls.on(k.Events.ERROR,this.onError,this)},y.unregisterListeners=function(){this.hls.off(k.Events.MEDIA_ATTACHED,this.onMediaAttached),this.hls.off(k.Events.MEDIA_DETACHING,this.onMediaDetaching),this.hls.off(k.Events.MANIFEST_LOADING,this.onManifestLoading),this.hls.off(k.Events.LEVEL_UPDATED,this.onLevelUpdated),this.hls.off(k.Events.ERROR,this.onError)},y.onMediaAttached=function(P,u){this.media=u.media,this.media.addEventListener("timeupdate",this.timeupdateHandler)},y.onMediaDetaching=function(){this.media&&(this.media.removeEventListener("timeupdate",this.timeupdateHandler),this.media=null)},y.onManifestLoading=function(){this.levelDetails=null,this._latency=null,this.stallCount=0},y.onLevelUpdated=function(P,u){var d=u.details;this.levelDetails=d,d.advanced&&this.timeupdate(),!d.live&&this.media&&this.media.removeEventListener("timeupdate",this.timeupdateHandler)},y.onError=function(P,u){u.details===H.ErrorDetails.BUFFER_STALLED_ERROR&&(this.stallCount++,x.logger.warn("[playback-rate-controller]: Stall detected, adjusting target latency"))},y.timeupdate=function(){var P=this.media,u=this.levelDetails;if(!(!P||!u)){this.currentTime=P.currentTime;var d=this.computeLatency();if(d!==null){this._latency=d;var E=this.config,c=E.lowLatencyMode,a=E.maxLiveSyncPlaybackRate;if(!(!c||a===1)){var i=this.targetLatency;if(i!==null){var l=d-i,p=Math.min(this.maxLatency,i+u.targetduration),f=l<p;if(u.live&&f&&l>.05&&this.forwardBufferLength>1){var h=Math.min(2,Math.max(1,a)),m=Math.round(2/(1+Math.exp(-.75*l-this.edgeStalled))*20)/20;P.playbackRate=Math.min(h,Math.max(1,m))}else P.playbackRate!==1&&P.playbackRate!==0&&(P.playbackRate=1)}}}}},y.estimateLiveEdge=function(){var P=this.levelDetails;return P===null?null:P.edge+P.age},y.computeLatency=function(){var P=this.estimateLiveEdge();return P===null?null:P-this.currentTime},F(O,[{key:"latency",get:function(){return this._latency||0}},{key:"maxLatency",get:function(){var P=this.config,u=this.levelDetails;return P.liveMaxLatencyDuration!==void 0?P.liveMaxLatencyDuration:u?P.liveMaxLatencyDurationCount*u.targetduration:0}},{key:"targetLatency",get:function(){var P=this.levelDetails;if(P===null)return null;var u=P.holdBack,d=P.partHoldBack,E=P.targetduration,c=this.config,a=c.liveSyncDuration,i=c.liveSyncDurationCount,l=c.lowLatencyMode,p=this.hls.userConfig,f=l&&d||u;(p.liveSyncDuration||p.liveSyncDurationCount||f===0)&&(f=a!==void 0?a:i*E);var h=E,m=1;return f+Math.min(this.stallCount*m,h)}},{key:"liveSyncPosition",get:function(){var P=this.estimateLiveEdge(),u=this.targetLatency,d=this.levelDetails;if(P===null||u===null||d===null)return null;var E=d.edge,c=P-u-this.edgeStalled,a=E-d.totalduration,i=E-(this.config.lowLatencyMode&&d.partTarget||d.targetduration);return Math.min(Math.max(a,c),i)}},{key:"drift",get:function(){var P=this.levelDetails;return P===null?1:P.drift}},{key:"edgeStalled",get:function(){var P=this.levelDetails;if(P===null)return 0;var u=(this.config.lowLatencyMode&&P.partTarget||P.targetduration)*3;return Math.max(P.age-u,0)}},{key:"forwardBufferLength",get:function(){var P=this.media,u=this.levelDetails;if(!P||!u)return 0;var d=P.buffered.length;return d?P.buffered.end(d-1):u.edge-this.currentTime}}]),O}()},"./src/controller/level-controller.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"default",function(){return c});var H=M("./src/types/level.ts"),k=M("./src/events.ts"),x=M("./src/errors.ts"),j=M("./src/utils/codecs.ts"),F=M("./src/controller/level-helper.ts"),R=M("./src/controller/base-playlist-controller.ts"),O=M("./src/types/loader.ts");function y(){return y=Object.assign||function(a){for(var i=1;i<arguments.length;i++){var l=arguments[i];for(var p in l)Object.prototype.hasOwnProperty.call(l,p)&&(a[p]=l[p])}return a},y.apply(this,arguments)}function C(a,i){for(var l=0;l<i.length;l++){var p=i[l];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(a,p.key,p)}}function P(a,i,l){return i&&C(a.prototype,i),l&&C(a,l),a}function u(a,i){a.prototype=Object.create(i.prototype),a.prototype.constructor=a,d(a,i)}function d(a,i){return d=Object.setPrototypeOf||function(p,f){return p.__proto__=f,p},d(a,i)}var E=/chrome|firefox/.test(navigator.userAgent.toLowerCase()),c=function(a){u(i,a);function i(p){var f;return f=a.call(this,p,"[level-controller]")||this,f._levels=[],f._firstLevel=-1,f._startLevel=void 0,f.currentLevelIndex=-1,f.manualLevelIndex=-1,f.onParsedComplete=void 0,f._registerListeners(),f}var l=i.prototype;return l._registerListeners=function(){var f=this.hls;f.on(k.Events.MANIFEST_LOADED,this.onManifestLoaded,this),f.on(k.Events.LEVEL_LOADED,this.onLevelLoaded,this),f.on(k.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),f.on(k.Events.FRAG_LOADED,this.onFragLoaded,this),f.on(k.Events.ERROR,this.onError,this)},l._unregisterListeners=function(){var f=this.hls;f.off(k.Events.MANIFEST_LOADED,this.onManifestLoaded,this),f.off(k.Events.LEVEL_LOADED,this.onLevelLoaded,this),f.off(k.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),f.off(k.Events.FRAG_LOADED,this.onFragLoaded,this),f.off(k.Events.ERROR,this.onError,this)},l.destroy=function(){this._unregisterListeners(),this.manualLevelIndex=-1,this._levels.length=0,a.prototype.destroy.call(this)},l.startLoad=function(){var f=this._levels;f.forEach(function(h){h.loadError=0}),a.prototype.startLoad.call(this)},l.onManifestLoaded=function(f,h){var m=[],L=[],S=[],v,n={},s,A=!1,_=!1,D=!1;if(h.levels.forEach(function(N){var W=N.attrs;A=A||!!(N.width&&N.height),_=_||!!N.videoCodec,D=D||!!N.audioCodec,E&&N.audioCodec&&N.audioCodec.indexOf("mp4a.40.34")!==-1&&(N.audioCodec=void 0);var G=N.bitrate+"-"+N.attrs.RESOLUTION+"-"+N.attrs.CODECS;s=n[G],s?s.url.push(N.url):(s=new H.Level(N),n[G]=s,m.push(s)),W&&(W.AUDIO&&Object(F.addGroupId)(s,"audio",W.AUDIO),W.SUBTITLES&&Object(F.addGroupId)(s,"text",W.SUBTITLES))}),(A||_)&&D&&(m=m.filter(function(N){var W=N.videoCodec,G=N.width,V=N.height;return!!W||!!(G&&V)})),m=m.filter(function(N){var W=N.audioCodec,G=N.videoCodec;return(!W||Object(j.isCodecSupportedInMp4)(W,"audio"))&&(!G||Object(j.isCodecSupportedInMp4)(G,"video"))}),h.audioTracks&&(L=h.audioTracks.filter(function(N){return!N.audioCodec||Object(j.isCodecSupportedInMp4)(N.audioCodec,"audio")}),Object(F.assignTrackIdsByGroup)(L)),h.subtitles&&(S=h.subtitles,Object(F.assignTrackIdsByGroup)(S)),m.length>0){v=m[0].bitrate,m.sort(function(N,W){return N.bitrate-W.bitrate}),this._levels=m;for(var I=0;I<m.length;I++)if(m[I].bitrate===v){this._firstLevel=I,this.log("manifest loaded, "+m.length+" level(s) found, first bitrate: "+v);break}var w=D&&!_,B={levels:m,audioTracks:L,subtitleTracks:S,firstLevel:this._firstLevel,stats:h.stats,audio:D,video:_,altAudio:!w&&L.some(function(N){return!!N.url})};this.hls.trigger(k.Events.MANIFEST_PARSED,B),(this.hls.config.autoStartLoad||this.hls.forceStartLoad)&&this.hls.startLoad(this.hls.config.startPosition)}else this.hls.trigger(k.Events.ERROR,{type:x.ErrorTypes.MEDIA_ERROR,details:x.ErrorDetails.MANIFEST_INCOMPATIBLE_CODECS_ERROR,fatal:!0,url:h.url,reason:"no level with compatible codecs found in manifest"})},l.onError=function(f,h){if(a.prototype.onError.call(this,f,h),!h.fatal){var m=h.context,L=this._levels[this.currentLevelIndex];if(m&&(m.type===O.PlaylistContextType.AUDIO_TRACK&&L.audioGroupIds&&m.groupId===L.audioGroupIds[L.urlId]||m.type===O.PlaylistContextType.SUBTITLE_TRACK&&L.textGroupIds&&m.groupId===L.textGroupIds[L.urlId])){this.redundantFailover(this.currentLevelIndex);return}var S=!1,v=!0,n;switch(h.details){case x.ErrorDetails.FRAG_LOAD_ERROR:case x.ErrorDetails.FRAG_LOAD_TIMEOUT:case x.ErrorDetails.KEY_LOAD_ERROR:case x.ErrorDetails.KEY_LOAD_TIMEOUT:if(h.frag){var s=this._levels[h.frag.level];s?(s.fragmentError++,s.fragmentError>this.hls.config.fragLoadingMaxRetry&&(n=h.frag.level)):n=h.frag.level}break;case x.ErrorDetails.LEVEL_LOAD_ERROR:case x.ErrorDetails.LEVEL_LOAD_TIMEOUT:m&&(m.deliveryDirectives&&(v=!1),n=m.level),S=!0;break;case x.ErrorDetails.REMUX_ALLOC_ERROR:n=h.level,S=!0;break}n!==void 0&&this.recoverLevel(h,n,S,v)}},l.recoverLevel=function(f,h,m,L){var S=f.details,v=this._levels[h];if(v.loadError++,m){var n=this.retryLoadingOrFail(f);if(n)f.levelRetry=!0;else{this.currentLevelIndex=-1;return}}if(L){var s=v.url.length;if(s>1&&v.loadError<s)f.levelRetry=!0,this.redundantFailover(h);else if(this.manualLevelIndex===-1){var A=h===0?this._levels.length-1:h-1;this.currentLevelIndex!==A&&this._levels[A].loadError===0&&(this.warn(S+": switch to "+A),f.levelRetry=!0,this.hls.nextAutoLevel=A)}}},l.redundantFailover=function(f){var h=this._levels[f],m=h.url.length;if(m>1){var L=(h.urlId+1)%m;this.warn("Switching to redundant URL-id "+L),this._levels.forEach(function(S){S.urlId=L}),this.level=f}},l.onFragLoaded=function(f,h){var m=h.frag;if(m!==void 0&&m.type===O.PlaylistLevelType.MAIN){var L=this._levels[m.level];L!==void 0&&(L.fragmentError=0,L.loadError=0)}},l.onLevelLoaded=function(f,h){var m,L=h.level,S=h.details,v=this._levels[L];if(!v){var n;this.warn("Invalid level index "+L),(n=h.deliveryDirectives)!==null&&n!==void 0&&n.skip&&(S.deltaUpdateFailed=!0);return}L===this.currentLevelIndex?(v.fragmentError===0&&(v.loadError=0,this.retryCount=0),this.playlistLoaded(L,h,v.details)):(m=h.deliveryDirectives)!==null&&m!==void 0&&m.skip&&(S.deltaUpdateFailed=!0)},l.onAudioTrackSwitched=function(f,h){var m=this.hls.levels[this.currentLevelIndex];if(!!m&&m.audioGroupIds){for(var L=-1,S=this.hls.audioTracks[h.id].groupId,v=0;v<m.audioGroupIds.length;v++)if(m.audioGroupIds[v]===S){L=v;break}L!==m.urlId&&(m.urlId=L,this.startLoad())}},l.loadPlaylist=function(f){var h=this.currentLevelIndex,m=this._levels[h];if(this.canLoad&&m&&m.url.length>0){var L=m.urlId,S=m.url[L];if(f)try{S=f.addDirectives(S)}catch(v){this.warn("Could not construct new URL with HLS Delivery Directives: "+v)}this.log("Attempt loading level index "+h+(f?" at sn "+f.msn+" part "+f.part:"")+" with URL-id "+L+" "+S),this.clearTimer(),this.hls.trigger(k.Events.LEVEL_LOADING,{url:S,level:h,id:L,deliveryDirectives:f||null})}},l.removeLevel=function(f,h){var m=function(v,n){return n!==h},L=this._levels.filter(function(S,v){return v!==f?!0:S.url.length>1&&h!==void 0?(S.url=S.url.filter(m),S.audioGroupIds&&(S.audioGroupIds=S.audioGroupIds.filter(m)),S.textGroupIds&&(S.textGroupIds=S.textGroupIds.filter(m)),S.urlId=0,!0):!1}).map(function(S,v){var n=S.details;return n!=null&&n.fragments&&n.fragments.forEach(function(s){s.level=v}),S});this._levels=L,this.hls.trigger(k.Events.LEVELS_UPDATED,{levels:L})},P(i,[{key:"levels",get:function(){return this._levels.length===0?null:this._levels}},{key:"level",get:function(){return this.currentLevelIndex},set:function(f){var h,m=this._levels;if(m.length!==0&&!(this.currentLevelIndex===f&&(h=m[f])!==null&&h!==void 0&&h.details)){if(f<0||f>=m.length){var L=f<0;if(this.hls.trigger(k.Events.ERROR,{type:x.ErrorTypes.OTHER_ERROR,details:x.ErrorDetails.LEVEL_SWITCH_ERROR,level:f,fatal:L,reason:"invalid level idx"}),L)return;f=Math.min(f,m.length-1)}this.clearTimer();var S=this.currentLevelIndex,v=m[S],n=m[f];this.log("switching to level "+f+" from "+S),this.currentLevelIndex=f;var s=y({},n,{level:f,maxBitrate:n.maxBitrate,uri:n.uri,urlId:n.urlId});delete s._urlId,this.hls.trigger(k.Events.LEVEL_SWITCHING,s);var A=n.details;if(!A||A.live){var _=this.switchParams(n.uri,v==null?void 0:v.details);this.loadPlaylist(_)}}}},{key:"manualLevel",get:function(){return this.manualLevelIndex},set:function(f){this.manualLevelIndex=f,this._startLevel===void 0&&(this._startLevel=f),f!==-1&&(this.level=f)}},{key:"firstLevel",get:function(){return this._firstLevel},set:function(f){this._firstLevel=f}},{key:"startLevel",get:function(){if(this._startLevel===void 0){var f=this.hls.config.startLevel;return f!==void 0?f:this._firstLevel}else return this._startLevel},set:function(f){this._startLevel=f}},{key:"nextLoadLevel",get:function(){return this.manualLevelIndex!==-1?this.manualLevelIndex:this.hls.nextAutoLevel},set:function(f){this.level=f,this.manualLevelIndex===-1&&(this.hls.nextAutoLevel=f)}}]),i}(R.default)},"./src/controller/level-helper.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"addGroupId",function(){return x}),M.d(K,"assignTrackIdsByGroup",function(){return j}),M.d(K,"updatePTS",function(){return F}),M.d(K,"updateFragPTSDTS",function(){return O}),M.d(K,"mergeDetails",function(){return y}),M.d(K,"mapPartIntersection",function(){return C}),M.d(K,"mapFragmentIntersection",function(){return P}),M.d(K,"adjustSliding",function(){return u}),M.d(K,"addSliding",function(){return d}),M.d(K,"computeReloadInterval",function(){return E}),M.d(K,"getFragmentWithSN",function(){return c}),M.d(K,"getPartWith",function(){return a});var H=M("./src/polyfills/number.ts"),k=M("./src/utils/logger.ts");function x(i,l,p){switch(l){case"audio":i.audioGroupIds||(i.audioGroupIds=[]),i.audioGroupIds.push(p);break;case"text":i.textGroupIds||(i.textGroupIds=[]),i.textGroupIds.push(p);break}}function j(i){var l={};i.forEach(function(p){var f=p.groupId||"";p.id=l[f]=l[f]||0,l[f]++})}function F(i,l,p){var f=i[l],h=i[p];R(f,h)}function R(i,l){var p=l.startPTS;if(Object(H.isFiniteNumber)(p)){var f=0,h;l.sn>i.sn?(f=p-i.start,h=i):(f=i.start-p,h=l),h.duration!==f&&(h.duration=f)}else if(l.sn>i.sn){var m=i.cc===l.cc;m&&i.minEndPTS?l.start=i.start+(i.minEndPTS-i.start):l.start=i.start+i.duration}else l.start=Math.max(i.start-l.duration,0)}function O(i,l,p,f,h,m){var L=f-p;L<=0&&(k.logger.warn("Fragment should have a positive duration",l),f=p+l.duration,m=h+l.duration);var S=p,v=f,n=l.startPTS,s=l.endPTS;if(Object(H.isFiniteNumber)(n)){var A=Math.abs(n-p);Object(H.isFiniteNumber)(l.deltaPTS)?l.deltaPTS=Math.max(A,l.deltaPTS):l.deltaPTS=A,S=Math.max(p,n),p=Math.min(p,n),h=Math.min(h,l.startDTS),v=Math.min(f,s),f=Math.max(f,s),m=Math.max(m,l.endDTS)}l.duration=f-p;var _=p-l.start;l.appendedPTS=f,l.start=l.startPTS=p,l.maxStartPTS=S,l.startDTS=h,l.endPTS=f,l.minEndPTS=v,l.endDTS=m;var D=l.sn;if(!i||D<i.startSN||D>i.endSN)return 0;var I,w=D-i.startSN,B=i.fragments;for(B[w]=l,I=w;I>0;I--)R(B[I],B[I-1]);for(I=w;I<B.length-1;I++)R(B[I],B[I+1]);return i.fragmentHint&&R(B[B.length-1],i.fragmentHint),i.PTSKnown=i.alignedSliding=!0,_}function y(i,l){for(var p=null,f=i.fragments,h=f.length-1;h>=0;h--){var m=f[h].initSegment;if(m){p=m;break}}i.fragmentHint&&delete i.fragmentHint.endPTS;var L=0,S;if(P(i,l,function(D,I){var w;D.relurl&&(L=D.cc-I.cc),Object(H.isFiniteNumber)(D.startPTS)&&Object(H.isFiniteNumber)(D.endPTS)&&(I.start=I.startPTS=D.startPTS,I.startDTS=D.startDTS,I.appendedPTS=D.appendedPTS,I.maxStartPTS=D.maxStartPTS,I.endPTS=D.endPTS,I.endDTS=D.endDTS,I.minEndPTS=D.minEndPTS,I.duration=D.endPTS-D.startPTS,I.duration&&(S=I),l.PTSKnown=l.alignedSliding=!0),I.elementaryStreams=D.elementaryStreams,I.loader=D.loader,I.stats=D.stats,I.urlId=D.urlId,D.initSegment?(I.initSegment=D.initSegment,p=D.initSegment):(!I.initSegment||I.initSegment.relurl==((w=p)===null||w===void 0?void 0:w.relurl))&&(I.initSegment=p)}),l.skippedSegments&&(l.deltaUpdateFailed=l.fragments.some(function(D){return!D}),l.deltaUpdateFailed)){k.logger.warn("[level-helper] Previous playlist missing segments skipped in delta playlist");for(var v=l.skippedSegments;v--;)l.fragments.shift();l.startSN=l.fragments[0].sn,l.startCC=l.fragments[0].cc}var n=l.fragments;if(L){k.logger.warn("discontinuity sliding from playlist, take drift into account");for(var s=0;s<n.length;s++)n[s].cc+=L}l.skippedSegments&&(l.startCC=l.fragments[0].cc),C(i.partList,l.partList,function(D,I){I.elementaryStreams=D.elementaryStreams,I.stats=D.stats}),S?O(l,S,S.startPTS,S.endPTS,S.startDTS,S.endDTS):u(i,l),n.length&&(l.totalduration=l.edge-n[0].start),l.driftStartTime=i.driftStartTime,l.driftStart=i.driftStart;var A=l.advancedDateTime;if(l.advanced&&A){var _=l.edge;l.driftStart||(l.driftStartTime=A,l.driftStart=_),l.driftEndTime=A,l.driftEnd=_}else l.driftEndTime=i.driftEndTime,l.driftEnd=i.driftEnd,l.advancedDateTime=i.advancedDateTime}function C(i,l,p){if(i&&l)for(var f=0,h=0,m=i.length;h<=m;h++){var L=i[h],S=l[h+f];L&&S&&L.index===S.index&&L.fragment.sn===S.fragment.sn?p(L,S):f--}}function P(i,l,p){for(var f=l.skippedSegments,h=Math.max(i.startSN,l.startSN)-l.startSN,m=(i.fragmentHint?1:0)+(f?l.endSN:Math.min(i.endSN,l.endSN))-l.startSN,L=l.startSN-i.startSN,S=l.fragmentHint?l.fragments.concat(l.fragmentHint):l.fragments,v=i.fragmentHint?i.fragments.concat(i.fragmentHint):i.fragments,n=h;n<=m;n++){var s=v[L+n],A=S[n];f&&!A&&n<f&&(A=l.fragments[n]=s),s&&A&&p(s,A)}}function u(i,l){var p=l.startSN+l.skippedSegments-i.startSN,f=i.fragments;p<0||p>=f.length||d(l,f[p].start)}function d(i,l){if(l){for(var p=i.fragments,f=i.skippedSegments;f<p.length;f++)p[f].start+=l;i.fragmentHint&&(i.fragmentHint.start+=l)}}function E(i,l){var p=1e3*i.levelTargetDuration,f=p/2,h=i.age,m=h>0&&h<p*3,L=l.loading.end-l.loading.start,S,v=i.availabilityDelay;if(i.updated===!1)if(m){var n=333*i.misses;S=Math.max(Math.min(f,L*2),n),i.availabilityDelay=(i.availabilityDelay||0)+S}else S=f;else m?(v=Math.min(v||p/2,h),i.availabilityDelay=v,S=v+p-h):S=p-L;return Math.round(S)}function c(i,l,p){if(!i||!i.details)return null;var f=i.details,h=f.fragments[l-f.startSN];return h||(h=f.fragmentHint,h&&h.sn===l)?h:l<f.startSN&&p&&p.sn===l?p:null}function a(i,l,p){if(!i||!i.details)return null;var f=i.details.partList;if(f)for(var h=f.length;h--;){var m=f[h];if(m.index===p&&m.fragment.sn===l)return m}return null}},"./src/controller/stream-controller.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"default",function(){return f});var H=M("./src/polyfills/number.ts"),k=M("./src/controller/base-stream-controller.ts"),x=M("./src/is-supported.ts"),j=M("./src/events.ts"),F=M("./src/utils/buffer-helper.ts"),R=M("./src/controller/fragment-tracker.ts"),O=M("./src/types/loader.ts"),y=M("./src/loader/fragment.ts"),C=M("./src/demux/transmuxer-interface.ts"),P=M("./src/types/transmuxer.ts"),u=M("./src/controller/gap-controller.ts"),d=M("./src/errors.ts"),E=M("./src/utils/logger.ts");function c(h,m){for(var L=0;L<m.length;L++){var S=m[L];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(h,S.key,S)}}function a(h,m,L){return m&&c(h.prototype,m),L&&c(h,L),h}function i(h,m){h.prototype=Object.create(m.prototype),h.prototype.constructor=h,l(h,m)}function l(h,m){return l=Object.setPrototypeOf||function(S,v){return S.__proto__=v,S},l(h,m)}var p=100,f=function(h){i(m,h);function m(S,v){var n;return n=h.call(this,S,v,"[stream-controller]")||this,n.audioCodecSwap=!1,n.gapController=null,n.level=-1,n._forceStartLoad=!1,n.altAudio=!1,n.audioOnly=!1,n.fragPlaying=null,n.onvplaying=null,n.onvseeked=null,n.fragLastKbps=0,n.stalled=!1,n.couldBacktrack=!1,n.audioCodecSwitch=!1,n.videoBuffer=null,n._registerListeners(),n}var L=m.prototype;return L._registerListeners=function(){var v=this.hls;v.on(j.Events.MEDIA_ATTACHED,this.onMediaAttached,this),v.on(j.Events.MEDIA_DETACHING,this.onMediaDetaching,this),v.on(j.Events.MANIFEST_LOADING,this.onManifestLoading,this),v.on(j.Events.MANIFEST_PARSED,this.onManifestParsed,this),v.on(j.Events.LEVEL_LOADING,this.onLevelLoading,this),v.on(j.Events.LEVEL_LOADED,this.onLevelLoaded,this),v.on(j.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),v.on(j.Events.ERROR,this.onError,this),v.on(j.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),v.on(j.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),v.on(j.Events.BUFFER_CREATED,this.onBufferCreated,this),v.on(j.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),v.on(j.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),v.on(j.Events.FRAG_BUFFERED,this.onFragBuffered,this)},L._unregisterListeners=function(){var v=this.hls;v.off(j.Events.MEDIA_ATTACHED,this.onMediaAttached,this),v.off(j.Events.MEDIA_DETACHING,this.onMediaDetaching,this),v.off(j.Events.MANIFEST_LOADING,this.onManifestLoading,this),v.off(j.Events.MANIFEST_PARSED,this.onManifestParsed,this),v.off(j.Events.LEVEL_LOADED,this.onLevelLoaded,this),v.off(j.Events.FRAG_LOAD_EMERGENCY_ABORTED,this.onFragLoadEmergencyAborted,this),v.off(j.Events.ERROR,this.onError,this),v.off(j.Events.AUDIO_TRACK_SWITCHING,this.onAudioTrackSwitching,this),v.off(j.Events.AUDIO_TRACK_SWITCHED,this.onAudioTrackSwitched,this),v.off(j.Events.BUFFER_CREATED,this.onBufferCreated,this),v.off(j.Events.BUFFER_FLUSHED,this.onBufferFlushed,this),v.off(j.Events.LEVELS_UPDATED,this.onLevelsUpdated,this),v.off(j.Events.FRAG_BUFFERED,this.onFragBuffered,this)},L.onHandlerDestroying=function(){this._unregisterListeners(),this.onMediaDetaching()},L.startLoad=function(v){if(this.levels){var n=this.lastCurrentTime,s=this.hls;if(this.stopLoad(),this.setInterval(p),this.level=-1,this.fragLoadError=0,!this.startFragRequested){var A=s.startLevel;A===-1&&(s.config.testBandwidth?(A=0,this.bitrateTest=!0):A=s.nextAutoLevel),this.level=s.nextLoadLevel=A,this.loadedmetadata=!1}n>0&&v===-1&&(this.log("Override startPosition with lastCurrentTime @"+n.toFixed(3)),v=n),this.state=k.State.IDLE,this.nextLoadPosition=this.startPosition=this.lastCurrentTime=v,this.tick()}else this._forceStartLoad=!0,this.state=k.State.STOPPED},L.stopLoad=function(){this._forceStartLoad=!1,h.prototype.stopLoad.call(this)},L.doTick=function(){switch(this.state){case k.State.IDLE:this.doTickIdle();break;case k.State.WAITING_LEVEL:{var v,n=this.levels,s=this.level,A=n==null||(v=n[s])===null||v===void 0?void 0:v.details;if(A&&(!A.live||this.levelLastLoaded===this.level)){if(this.waitForCdnTuneIn(A))break;this.state=k.State.IDLE;break}break}case k.State.FRAG_LOADING_WAITING_RETRY:{var _,D=self.performance.now(),I=this.retryDate;(!I||D>=I||(_=this.media)!==null&&_!==void 0&&_.seeking)&&(this.log("retryDate reached, switch back to IDLE state"),this.state=k.State.IDLE)}break;default:break}this.onTickEnd()},L.onTickEnd=function(){h.prototype.onTickEnd.call(this),this.checkBuffer(),this.checkFragmentChanged()},L.doTickIdle=function(){var v,n,s=this.hls,A=this.levelLastLoaded,_=this.levels,D=this.media,I=s.config,w=s.nextLoadLevel;if(!(A===null||!D&&(this.startFragRequested||!I.startFragPrefetch))&&!(this.altAudio&&this.audioOnly)&&!(!_||!_[w])){var B=_[w];this.level=s.nextLoadLevel=w;var N=B.details;if(!N||this.state===k.State.WAITING_LEVEL||N.live&&this.levelLastLoaded!==w){this.state=k.State.WAITING_LEVEL;return}var W=this.getFwdBufferInfo(this.mediaBuffer?this.mediaBuffer:D,O.PlaylistLevelType.MAIN);if(W!==null){var G=W.len,V=this.getMaxBufferLength(B.maxBitrate);if(!(G>=V)){if(this._streamEnded(W,N)){var X={};this.altAudio&&(X.type="video"),this.hls.trigger(j.Events.BUFFER_EOS,X),this.state=k.State.ENDED;return}var $=W.end,q=this.getNextFragment($,N);if(this.couldBacktrack&&!this.fragPrevious&&q&&q.sn!=="initSegment"){var Z=q.sn-N.startSN;Z>1&&(q=N.fragments[Z-1],this.fragmentTracker.removeFragment(q))}if(q&&this.fragmentTracker.getState(q)===R.FragmentState.OK&&this.nextLoadPosition>$){var ee=this.audioOnly&&!this.altAudio?y.ElementaryStreamTypes.AUDIO:y.ElementaryStreamTypes.VIDEO;this.afterBufferFlushed(D,ee,O.PlaylistLevelType.MAIN),q=this.getNextFragment(this.nextLoadPosition,N)}!q||(q.initSegment&&!q.initSegment.data&&!this.bitrateTest&&(q=q.initSegment),((v=q.decryptdata)===null||v===void 0?void 0:v.keyFormat)==="identity"&&!((n=q.decryptdata)!==null&&n!==void 0&&n.key)?this.loadKey(q,N):this.loadFragment(q,N,$))}}}},L.loadFragment=function(v,n,s){var A,_=this.fragmentTracker.getState(v);if(this.fragCurrent=v,_===R.FragmentState.BACKTRACKED){var D=this.fragmentTracker.getBacktrackData(v);if(D){this._handleFragmentLoadProgress(D),this._handleFragmentLoadComplete(D);return}else _=R.FragmentState.NOT_LOADED}_===R.FragmentState.NOT_LOADED||_===R.FragmentState.PARTIAL?v.sn==="initSegment"?this._loadInitSegment(v):this.bitrateTest?(v.bitrateTest=!0,this.log("Fragment "+v.sn+" of level "+v.level+" is being downloaded to test bitrate and will not be buffered"),this._loadBitrateTestFrag(v)):(this.startFragRequested=!0,h.prototype.loadFragment.call(this,v,n,s)):_===R.FragmentState.APPENDING?this.reduceMaxBufferLength(v.duration)&&this.fragmentTracker.removeFragment(v):((A=this.media)===null||A===void 0?void 0:A.buffered.length)===0&&this.fragmentTracker.removeAllFragments()},L.getAppendedFrag=function(v){var n=this.fragmentTracker.getAppendedFrag(v,O.PlaylistLevelType.MAIN);return n&&"fragment"in n?n.fragment:n},L.getBufferedFrag=function(v){return this.fragmentTracker.getBufferedFrag(v,O.PlaylistLevelType.MAIN)},L.followingBufferedFrag=function(v){return v?this.getBufferedFrag(v.end+.5):null},L.immediateLevelSwitch=function(){this.abortCurrentFrag(),this.flushMainBuffer(0,Number.POSITIVE_INFINITY)},L.nextLevelSwitch=function(){var v=this.levels,n=this.media;if(n!=null&&n.readyState){var s,A=this.getAppendedFrag(n.currentTime);if(A&&A.start>1&&this.flushMainBuffer(0,A.start-1),!n.paused&&v){var _=this.hls.nextLoadLevel,D=v[_],I=this.fragLastKbps;I&&this.fragCurrent?s=this.fragCurrent.duration*D.maxBitrate/(1e3*I)+1:s=0}else s=0;var w=this.getBufferedFrag(n.currentTime+s);if(w){var B=this.followingBufferedFrag(w);if(B){this.abortCurrentFrag();var N=B.maxStartPTS?B.maxStartPTS:B.start,W=B.duration,G=Math.max(w.end,N+Math.min(Math.max(W-this.config.maxFragLookUpTolerance,W*.5),W*.75));this.flushMainBuffer(G,Number.POSITIVE_INFINITY)}}}},L.abortCurrentFrag=function(){var v=this.fragCurrent;this.fragCurrent=null,v!=null&&v.loader&&v.loader.abort(),this.state===k.State.KEY_LOADING&&(this.state=k.State.IDLE),this.nextLoadPosition=this.getLoadPosition()},L.flushMainBuffer=function(v,n){h.prototype.flushMainBuffer.call(this,v,n,this.altAudio?"video":null)},L.onMediaAttached=function(v,n){h.prototype.onMediaAttached.call(this,v,n);var s=n.media;this.onvplaying=this.onMediaPlaying.bind(this),this.onvseeked=this.onMediaSeeked.bind(this),s.addEventListener("playing",this.onvplaying),s.addEventListener("seeked",this.onvseeked),this.gapController=new u.default(this.config,s,this.fragmentTracker,this.hls)},L.onMediaDetaching=function(){var v=this.media;v&&(v.removeEventListener("playing",this.onvplaying),v.removeEventListener("seeked",this.onvseeked),this.onvplaying=this.onvseeked=null,this.videoBuffer=null),this.fragPlaying=null,this.gapController&&(this.gapController.destroy(),this.gapController=null),h.prototype.onMediaDetaching.call(this)},L.onMediaPlaying=function(){this.tick()},L.onMediaSeeked=function(){var v=this.media,n=v?v.currentTime:null;Object(H.isFiniteNumber)(n)&&this.log("Media seeked to "+n.toFixed(3)),this.tick()},L.onManifestLoading=function(){this.log("Trigger BUFFER_RESET"),this.hls.trigger(j.Events.BUFFER_RESET,void 0),this.fragmentTracker.removeAllFragments(),this.couldBacktrack=this.stalled=!1,this.startPosition=this.lastCurrentTime=0,this.fragPlaying=null},L.onManifestParsed=function(v,n){var s=!1,A=!1,_;n.levels.forEach(function(D){_=D.audioCodec,_&&(_.indexOf("mp4a.40.2")!==-1&&(s=!0),_.indexOf("mp4a.40.5")!==-1&&(A=!0))}),this.audioCodecSwitch=s&&A&&!Object(x.changeTypeSupported)(),this.audioCodecSwitch&&this.log("Both AAC/HE-AAC audio found in levels; declaring level codec as HE-AAC"),this.levels=n.levels,this.startFragRequested=!1},L.onLevelLoading=function(v,n){var s=this.levels;if(!(!s||this.state!==k.State.IDLE)){var A=s[n.level];(!A.details||A.details.live&&this.levelLastLoaded!==n.level||this.waitForCdnTuneIn(A.details))&&(this.state=k.State.WAITING_LEVEL)}},L.onLevelLoaded=function(v,n){var s,A=this.levels,_=n.level,D=n.details,I=D.totalduration;if(!A){this.warn("Levels were reset while loading level "+_);return}this.log("Level "+_+" loaded ["+D.startSN+","+D.endSN+"], cc ["+D.startCC+", "+D.endCC+"] duration:"+I);var w=this.fragCurrent;w&&(this.state===k.State.FRAG_LOADING||this.state===k.State.FRAG_LOADING_WAITING_RETRY)&&w.level!==n.level&&w.loader&&(this.state=k.State.IDLE,w.loader.abort());var B=A[_],N=0;if(D.live||(s=B.details)!==null&&s!==void 0&&s.live){if(D.fragments[0]||(D.deltaUpdateFailed=!0),D.deltaUpdateFailed)return;N=this.alignPlaylists(D,B.details)}if(B.details=D,this.levelLastLoaded=_,this.hls.trigger(j.Events.LEVEL_UPDATED,{details:D,level:_}),this.state===k.State.WAITING_LEVEL){if(this.waitForCdnTuneIn(D))return;this.state=k.State.IDLE}this.startFragRequested?D.live&&this.synchronizeToLiveEdge(D):this.setStartPosition(D,N),this.tick()},L._handleFragmentLoadProgress=function(v){var n,s=v.frag,A=v.part,_=v.payload,D=this.levels;if(!D){this.warn("Levels were reset while fragment load was in progress. Fragment "+s.sn+" of level "+s.level+" will not be buffered");return}var I=D[s.level],w=I.details;if(!w){this.warn("Dropping fragment "+s.sn+" of level "+s.level+" after level details were reset");return}var B=I.videoCodec,N=w.PTSKnown||!w.live,W=(n=s.initSegment)===null||n===void 0?void 0:n.data,G=this._getAudioCodec(I),V=this.transmuxer=this.transmuxer||new C.default(this.hls,O.PlaylistLevelType.MAIN,this._handleTransmuxComplete.bind(this),this._handleTransmuxerFlush.bind(this)),X=A?A.index:-1,$=X!==-1,q=new P.ChunkMetadata(s.level,s.sn,s.stats.chunkCount,_.byteLength,X,$),Z=this.initPTS[s.cc];V.push(_,W,G,B,s,A,w.totalduration,N,q,Z)},L.onAudioTrackSwitching=function(v,n){var s=this.altAudio,A=!!n.url,_=n.id;if(!A){if(this.mediaBuffer!==this.media){this.log("Switching on main audio, use media.buffered to schedule main fragment loading"),this.mediaBuffer=this.media;var D=this.fragCurrent;D!=null&&D.loader&&(this.log("Switching to main audio track, cancel main fragment load"),D.loader.abort()),this.resetTransmuxer(),this.resetLoadingState()}else this.audioOnly&&this.resetTransmuxer();var I=this.hls;s&&I.trigger(j.Events.BUFFER_FLUSHING,{startOffset:0,endOffset:Number.POSITIVE_INFINITY,type:"audio"}),I.trigger(j.Events.AUDIO_TRACK_SWITCHED,{id:_})}},L.onAudioTrackSwitched=function(v,n){var s=n.id,A=!!this.hls.audioTracks[s].url;if(A){var _=this.videoBuffer;_&&this.mediaBuffer!==_&&(this.log("Switching on alternate audio, use video.buffered to schedule main fragment loading"),this.mediaBuffer=_)}this.altAudio=A,this.tick()},L.onBufferCreated=function(v,n){var s=n.tracks,A,_,D=!1;for(var I in s){var w=s[I];if(w.id==="main"){if(_=I,A=w,I==="video"){var B=s[I];B&&(this.videoBuffer=B.buffer)}}else D=!0}D&&A?(this.log("Alternate track found, use "+_+".buffered to schedule main fragment loading"),this.mediaBuffer=A.buffer):this.mediaBuffer=this.media},L.onFragBuffered=function(v,n){var s=n.frag,A=n.part;if(!(s&&s.type!==O.PlaylistLevelType.MAIN)){if(this.fragContextChanged(s)){this.warn("Fragment "+s.sn+(A?" p: "+A.index:"")+" of level "+s.level+" finished buffering, but was aborted. state: "+this.state),this.state===k.State.PARSED&&(this.state=k.State.IDLE);return}var _=A?A.stats:s.stats;this.fragLastKbps=Math.round(8*_.total/(_.buffering.end-_.loading.first)),s.sn!=="initSegment"&&(this.fragPrevious=s),this.fragBufferedComplete(s,A)}},L.onError=function(v,n){switch(n.details){case d.ErrorDetails.FRAG_LOAD_ERROR:case d.ErrorDetails.FRAG_LOAD_TIMEOUT:case d.ErrorDetails.KEY_LOAD_ERROR:case d.ErrorDetails.KEY_LOAD_TIMEOUT:this.onFragmentOrKeyLoadError(O.PlaylistLevelType.MAIN,n);break;case d.ErrorDetails.LEVEL_LOAD_ERROR:case d.ErrorDetails.LEVEL_LOAD_TIMEOUT:this.state!==k.State.ERROR&&(n.fatal?(this.warn(""+n.details),this.state=k.State.ERROR):!n.levelRetry&&this.state===k.State.WAITING_LEVEL&&(this.state=k.State.IDLE));break;case d.ErrorDetails.BUFFER_FULL_ERROR:if(n.parent==="main"&&(this.state===k.State.PARSING||this.state===k.State.PARSED)){var s=!0,A=this.getFwdBufferInfo(this.media,O.PlaylistLevelType.MAIN);A&&A.len>.5&&(s=!this.reduceMaxBufferLength(A.len)),s&&(this.warn("buffer full error also media.currentTime is not buffered, flush main"),this.immediateLevelSwitch()),this.resetLoadingState()}break;default:break}},L.checkBuffer=function(){var v=this.media,n=this.gapController;if(!(!v||!n||!v.readyState)){var s=F.BufferHelper.getBuffered(v);!this.loadedmetadata&&s.length?(this.loadedmetadata=!0,this.seekToStartPos()):n.poll(this.lastCurrentTime),this.lastCurrentTime=v.currentTime}},L.onFragLoadEmergencyAborted=function(){this.state=k.State.IDLE,this.loadedmetadata||(this.startFragRequested=!1,this.nextLoadPosition=this.startPosition),this.tickImmediate()},L.onBufferFlushed=function(v,n){var s=n.type;if(s!==y.ElementaryStreamTypes.AUDIO||this.audioOnly&&!this.altAudio){var A=(s===y.ElementaryStreamTypes.VIDEO?this.videoBuffer:this.mediaBuffer)||this.media;this.afterBufferFlushed(A,s,O.PlaylistLevelType.MAIN)}},L.onLevelsUpdated=function(v,n){this.levels=n.levels},L.swapAudioCodec=function(){this.audioCodecSwap=!this.audioCodecSwap},L.seekToStartPos=function(){var v=this.media,n=v.currentTime,s=this.startPosition;if(s>=0&&n<s){if(v.seeking){E.logger.log("could not seek to "+s+", already seeking at "+n);return}var A=F.BufferHelper.getBuffered(v),_=A.length?A.start(0):0,D=_-s;D>0&&D<this.config.maxBufferHole&&(E.logger.log("adjusting start position by "+D+" to match buffer start"),s+=D,this.startPosition=s),this.log("seek to target start position "+s+" from current time "+n),v.currentTime=s}},L._getAudioCodec=function(v){var n=this.config.defaultAudioCodec||v.audioCodec;return this.audioCodecSwap&&n&&(this.log("Swapping audio codec"),n.indexOf("mp4a.40.5")!==-1?n="mp4a.40.2":n="mp4a.40.5"),n},L._loadBitrateTestFrag=function(v){var n=this;this._doFragLoad(v).then(function(s){var A=n.hls;if(!(!s||A.nextLoadLevel||n.fragContextChanged(v))){n.fragLoadError=0,n.state=k.State.IDLE,n.startFragRequested=!1,n.bitrateTest=!1;var _=v.stats;_.parsing.start=_.parsing.end=_.buffering.start=_.buffering.end=self.performance.now(),A.trigger(j.Events.FRAG_LOADED,s)}})},L._handleTransmuxComplete=function(v){var n,s="main",A=this.hls,_=v.remuxResult,D=v.chunkMeta,I=this.getCurrentContext(D);if(!I){this.warn("The loading context changed while buffering fragment "+D.sn+" of level "+D.level+". This chunk will not be buffered."),this.resetLiveStartWhenNotLoaded(D.level);return}var w=I.frag,B=I.part,N=I.level,W=_.video,G=_.text,V=_.id3,X=_.initSegment,$=this.altAudio?void 0:_.audio;if(!this.fragContextChanged(w)){if(this.state=k.State.PARSING,X){X.tracks&&(this._bufferInitSegment(N,X.tracks,w,D),A.trigger(j.Events.FRAG_PARSING_INIT_SEGMENT,{frag:w,id:s,tracks:X.tracks}));var q=X.initPTS,Z=X.timescale;Object(H.isFiniteNumber)(q)&&(this.initPTS[w.cc]=q,A.trigger(j.Events.INIT_PTS_FOUND,{frag:w,id:s,initPTS:q,timescale:Z}))}if(W&&_.independent!==!1){if(N.details){var ee=W.startPTS,ie=W.endPTS,ue=W.startDTS,se=W.endDTS;if(B)B.elementaryStreams[W.type]={startPTS:ee,endPTS:ie,startDTS:ue,endDTS:se};else if(W.firstKeyFrame&&W.independent&&(this.couldBacktrack=!0),W.dropped&&W.independent){var le=this.getLoadPosition()+this.config.maxBufferHole;if(le<ee){this.backtrack(w);return}w.setElementaryStreamInfo(W.type,w.start,ie,w.start,se,!0)}w.setElementaryStreamInfo(W.type,ee,ie,ue,se),this.bufferFragmentData(W,w,B,D)}}else if(_.independent===!1){this.backtrack(w);return}if($){var ce=$.startPTS,me=$.endPTS,ye=$.startDTS,Ee=$.endDTS;B&&(B.elementaryStreams[y.ElementaryStreamTypes.AUDIO]={startPTS:ce,endPTS:me,startDTS:ye,endDTS:Ee}),w.setElementaryStreamInfo(y.ElementaryStreamTypes.AUDIO,ce,me,ye,Ee),this.bufferFragmentData($,w,B,D)}if(V!=null&&(n=V.samples)!==null&&n!==void 0&&n.length){var ke={frag:w,id:s,samples:V.samples};A.trigger(j.Events.FRAG_PARSING_METADATA,ke)}if(G){var Ae={frag:w,id:s,samples:G.samples};A.trigger(j.Events.FRAG_PARSING_USERDATA,Ae)}}},L._bufferInitSegment=function(v,n,s,A){var _=this;if(this.state===k.State.PARSING){this.audioOnly=!!n.audio&&!n.video,this.altAudio&&!this.audioOnly&&delete n.audio;var D=n.audio,I=n.video,w=n.audiovideo;if(D){var B=v.audioCodec,N=navigator.userAgent.toLowerCase();this.audioCodecSwitch&&(B&&(B.indexOf("mp4a.40.5")!==-1?B="mp4a.40.2":B="mp4a.40.5"),D.metadata.channelCount!==1&&N.indexOf("firefox")===-1&&(B="mp4a.40.5")),N.indexOf("android")!==-1&&D.container!=="audio/mpeg"&&(B="mp4a.40.2",this.log("Android: force audio codec to "+B)),v.audioCodec&&v.audioCodec!==B&&this.log('Swapping manifest audio codec "'+v.audioCodec+'" for "'+B+'"'),D.levelCodec=B,D.id="main",this.log("Init audio buffer, container:"+D.container+", codecs[selected/level/parsed]=["+(B||"")+"/"+(v.audioCodec||"")+"/"+D.codec+"]")}I&&(I.levelCodec=v.videoCodec,I.id="main",this.log("Init video buffer, container:"+I.container+", codecs[level/parsed]=["+(v.videoCodec||"")+"/"+I.codec+"]")),w&&this.log("Init audiovideo buffer, container:"+w.container+", codecs[level/parsed]=["+(v.attrs.CODECS||"")+"/"+w.codec+"]"),this.hls.trigger(j.Events.BUFFER_CODECS,n),Object.keys(n).forEach(function(W){var G=n[W],V=G.initSegment;V!=null&&V.byteLength&&_.hls.trigger(j.Events.BUFFER_APPENDING,{type:W,data:V,frag:s,part:null,chunkMeta:A,parent:s.type})}),this.tick()}},L.backtrack=function(v){this.couldBacktrack=!0,this.resetTransmuxer(),this.flushBufferGap(v);var n=this.fragmentTracker.backtrack(v);this.fragPrevious=null,this.nextLoadPosition=v.start,n?this.resetFragmentLoading(v):this.state=k.State.BACKTRACKING},L.checkFragmentChanged=function(){var v=this.media,n=null;if(v&&v.readyState>1&&v.seeking===!1){var s=v.currentTime;if(F.BufferHelper.isBuffered(v,s)?n=this.getAppendedFrag(s):F.BufferHelper.isBuffered(v,s+.1)&&(n=this.getAppendedFrag(s+.1)),n){var A=this.fragPlaying,_=n.level;(!A||n.sn!==A.sn||A.level!==_||n.urlId!==A.urlId)&&(this.hls.trigger(j.Events.FRAG_CHANGED,{frag:n}),(!A||A.level!==_)&&this.hls.trigger(j.Events.LEVEL_SWITCHED,{level:_}),this.fragPlaying=n)}}},a(m,[{key:"nextLevel",get:function(){var v=this.nextBufferedFrag;return v?v.level:-1}},{key:"currentLevel",get:function(){var v=this.media;if(v){var n=this.getAppendedFrag(v.currentTime);if(n)return n.level}return-1}},{key:"nextBufferedFrag",get:function(){var v=this.media;if(v){var n=this.getAppendedFrag(v.currentTime);return this.followingBufferedFrag(n)}else return null}},{key:"forceStartLoad",get:function(){return this._forceStartLoad}}]),m}(k.default)},"./src/controller/subtitle-stream-controller.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"SubtitleStreamController",function(){return i});var H=M("./src/events.ts"),k=M("./src/utils/logger.ts"),x=M("./src/utils/buffer-helper.ts"),j=M("./src/controller/fragment-finders.ts"),F=M("./src/utils/discontinuities.ts"),R=M("./src/controller/level-helper.ts"),O=M("./src/controller/fragment-tracker.ts"),y=M("./src/controller/base-stream-controller.ts"),C=M("./src/types/loader.ts"),P=M("./src/types/level.ts");function u(l,p){for(var f=0;f<p.length;f++){var h=p[f];h.enumerable=h.enumerable||!1,h.configurable=!0,"value"in h&&(h.writable=!0),Object.defineProperty(l,h.key,h)}}function d(l,p,f){return p&&u(l.prototype,p),f&&u(l,f),l}function E(l,p){l.prototype=Object.create(p.prototype),l.prototype.constructor=l,c(l,p)}function c(l,p){return c=Object.setPrototypeOf||function(h,m){return h.__proto__=m,h},c(l,p)}var a=500,i=function(l){E(p,l);function p(h,m){var L;return L=l.call(this,h,m,"[subtitle-stream-controller]")||this,L.levels=[],L.currentTrackId=-1,L.tracksBuffered=[],L.mainDetails=null,L._registerListeners(),L}var f=p.prototype;return f.onHandlerDestroying=function(){this._unregisterListeners(),this.mainDetails=null},f._registerListeners=function(){var m=this.hls;m.on(H.Events.MEDIA_ATTACHED,this.onMediaAttached,this),m.on(H.Events.MEDIA_DETACHING,this.onMediaDetaching,this),m.on(H.Events.MANIFEST_LOADING,this.onManifestLoading,this),m.on(H.Events.LEVEL_LOADED,this.onLevelLoaded,this),m.on(H.Events.ERROR,this.onError,this),m.on(H.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),m.on(H.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),m.on(H.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),m.on(H.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),m.on(H.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},f._unregisterListeners=function(){var m=this.hls;m.off(H.Events.MEDIA_ATTACHED,this.onMediaAttached,this),m.off(H.Events.MEDIA_DETACHING,this.onMediaDetaching,this),m.off(H.Events.MANIFEST_LOADING,this.onManifestLoading,this),m.off(H.Events.LEVEL_LOADED,this.onLevelLoaded,this),m.off(H.Events.ERROR,this.onError,this),m.off(H.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),m.off(H.Events.SUBTITLE_TRACK_SWITCH,this.onSubtitleTrackSwitch,this),m.off(H.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),m.off(H.Events.SUBTITLE_FRAG_PROCESSED,this.onSubtitleFragProcessed,this),m.off(H.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)},f.startLoad=function(){this.stopLoad(),this.state=y.State.IDLE,this.setInterval(a),this.tick()},f.onManifestLoading=function(){this.mainDetails=null,this.fragmentTracker.removeAllFragments()},f.onLevelLoaded=function(m,L){this.mainDetails=L.details},f.onSubtitleFragProcessed=function(m,L){var S=L.frag,v=L.success;if(this.fragPrevious=S,this.state=y.State.IDLE,!!v){var n=this.tracksBuffered[this.currentTrackId];if(!!n){for(var s,A=S.start,_=0;_<n.length;_++)if(A>=n[_].start&&A<=n[_].end){s=n[_];break}var D=S.start+S.duration;s?s.end=D:(s={start:A,end:D},n.push(s)),this.fragmentTracker.fragBuffered(S)}}},f.onBufferFlushing=function(m,L){var S=L.startOffset,v=L.endOffset;if(S===0&&v!==Number.POSITIVE_INFINITY){var n=this.currentTrackId,s=this.levels;if(!s.length||!s[n]||!s[n].details)return;var A=s[n].details,_=A.targetduration,D=v-_;if(D<=0)return;L.endOffsetSubtitles=Math.max(0,D),this.tracksBuffered.forEach(function(I){for(var w=0;w<I.length;){if(I[w].end<=D){I.shift();continue}else if(I[w].start<D)I[w].start=D;else break;w++}}),this.fragmentTracker.removeFragmentsInRange(S,D,C.PlaylistLevelType.SUBTITLE)}},f.onError=function(m,L){var S,v=L.frag;!v||v.type!==C.PlaylistLevelType.SUBTITLE||((S=this.fragCurrent)!==null&&S!==void 0&&S.loader&&this.fragCurrent.loader.abort(),this.state=y.State.IDLE)},f.onSubtitleTracksUpdated=function(m,L){var S=this,v=L.subtitleTracks;this.tracksBuffered=[],this.levels=v.map(function(n){return new P.Level(n)}),this.fragmentTracker.removeAllFragments(),this.fragPrevious=null,this.levels.forEach(function(n){S.tracksBuffered[n.id]=[]}),this.mediaBuffer=null},f.onSubtitleTrackSwitch=function(m,L){if(this.currentTrackId=L.id,!this.levels.length||this.currentTrackId===-1){this.clearInterval();return}var S=this.levels[this.currentTrackId];S!=null&&S.details?(this.mediaBuffer=this.mediaBufferTimeRanges,this.setInterval(a)):this.mediaBuffer=null},f.onSubtitleTrackLoaded=function(m,L){var S,v=L.details,n=L.id,s=this.currentTrackId,A=this.levels;if(!!A.length){var _=A[s];if(!(n>=A.length||n!==s||!_)){if(this.mediaBuffer=this.mediaBufferTimeRanges,v.live||(S=_.details)!==null&&S!==void 0&&S.live){var D=this.mainDetails;if(v.deltaUpdateFailed||!D)return;var I=D.fragments[0];if(!_.details)v.hasProgramDateTime&&D.hasProgramDateTime?Object(F.alignPDT)(v,D):I&&Object(R.addSliding)(v,I.start);else{var w=this.alignPlaylists(v,_.details);w===0&&I&&Object(R.addSliding)(v,I.start)}}if(_.details=v,this.levelLastLoaded=n,this.tick(),v.live&&!this.fragCurrent&&this.media&&this.state===y.State.IDLE){var B=Object(j.findFragmentByPTS)(null,v.fragments,this.media.currentTime,0);B||(this.warn("Subtitle playlist not aligned with playback"),_.details=void 0)}}}},f._handleFragmentLoadComplete=function(m){var L=m.frag,S=m.payload,v=L.decryptdata,n=this.hls;if(!this.fragContextChanged(L)&&S&&S.byteLength>0&&v&&v.key&&v.iv&&v.method==="AES-128"){var s=performance.now();this.decrypter.webCryptoDecrypt(new Uint8Array(S),v.key.buffer,v.iv.buffer).then(function(A){var _=performance.now();n.trigger(H.Events.FRAG_DECRYPTED,{frag:L,payload:A,stats:{tstart:s,tdecrypt:_}})})}},f.doTick=function(){if(!this.media){this.state=y.State.IDLE;return}if(this.state===y.State.IDLE){var m,L=this.currentTrackId,S=this.levels;if(!S.length||!S[L]||!S[L].details)return;var v=S[L].details,n=v.targetduration,s=this.config,A=this.media,_=x.BufferHelper.bufferedInfo(this.mediaBufferTimeRanges,A.currentTime-n,s.maxBufferHole),D=_.end,I=_.len,w=this.getMaxBufferLength()+n;if(I>w)return;console.assert(v,"Subtitle track details are defined on idle subtitle stream controller tick");var B=v.fragments,N=B.length,W=v.edge,G,V=this.fragPrevious;if(D<W){var X=s.maxFragLookUpTolerance;V&&v.hasProgramDateTime&&(G=Object(j.findFragmentByPDT)(B,V.endProgramDateTime,X)),G||(G=Object(j.findFragmentByPTS)(V,B,D,X),!G&&V&&V.start<B[0].start&&(G=B[0]))}else G=B[N-1];(m=G)!==null&&m!==void 0&&m.encrypted?(k.logger.log("Loading key for "+G.sn),this.state=y.State.KEY_LOADING,this.hls.trigger(H.Events.KEY_LOADING,{frag:G})):G&&this.fragmentTracker.getState(G)===O.FragmentState.NOT_LOADED&&this.loadFragment(G,v,D)}},f.loadFragment=function(m,L,S){this.fragCurrent=m,l.prototype.loadFragment.call(this,m,L,S)},d(p,[{key:"mediaBufferTimeRanges",get:function(){return this.tracksBuffered[this.currentTrackId]||[]}}]),p}(y.default)},"./src/controller/subtitle-track-controller.ts":function(re,K,M){"use strict";M.r(K);var H=M("./src/events.ts"),k=M("./src/utils/texttrack-utils.ts"),x=M("./src/controller/base-playlist-controller.ts"),j=M("./src/types/loader.ts");function F(u,d){for(var E=0;E<d.length;E++){var c=d[E];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(u,c.key,c)}}function R(u,d,E){return d&&F(u.prototype,d),E&&F(u,E),u}function O(u,d){u.prototype=Object.create(d.prototype),u.prototype.constructor=u,y(u,d)}function y(u,d){return y=Object.setPrototypeOf||function(c,a){return c.__proto__=a,c},y(u,d)}var C=function(u){O(d,u);function d(c){var a;return a=u.call(this,c,"[subtitle-track-controller]")||this,a.media=null,a.tracks=[],a.groupId=null,a.tracksInGroup=[],a.trackId=-1,a.selectDefaultTrack=!0,a.queuedDefaultTrack=-1,a.trackChangeListener=function(){return a.onTextTracksChanged()},a.asyncPollTrackChange=function(){return a.pollTrackChange(0)},a.useTextTrackPolling=!1,a.subtitlePollingInterval=-1,a.subtitleDisplay=!0,a.registerListeners(),a}var E=d.prototype;return E.destroy=function(){this.unregisterListeners(),this.tracks.length=0,this.tracksInGroup.length=0,this.trackChangeListener=this.asyncPollTrackChange=null,u.prototype.destroy.call(this)},E.registerListeners=function(){var a=this.hls;a.on(H.Events.MEDIA_ATTACHED,this.onMediaAttached,this),a.on(H.Events.MEDIA_DETACHING,this.onMediaDetaching,this),a.on(H.Events.MANIFEST_LOADING,this.onManifestLoading,this),a.on(H.Events.MANIFEST_PARSED,this.onManifestParsed,this),a.on(H.Events.LEVEL_LOADING,this.onLevelLoading,this),a.on(H.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),a.on(H.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),a.on(H.Events.ERROR,this.onError,this)},E.unregisterListeners=function(){var a=this.hls;a.off(H.Events.MEDIA_ATTACHED,this.onMediaAttached,this),a.off(H.Events.MEDIA_DETACHING,this.onMediaDetaching,this),a.off(H.Events.MANIFEST_LOADING,this.onManifestLoading,this),a.off(H.Events.MANIFEST_PARSED,this.onManifestParsed,this),a.off(H.Events.LEVEL_LOADING,this.onLevelLoading,this),a.off(H.Events.LEVEL_SWITCHING,this.onLevelSwitching,this),a.off(H.Events.SUBTITLE_TRACK_LOADED,this.onSubtitleTrackLoaded,this),a.off(H.Events.ERROR,this.onError,this)},E.onMediaAttached=function(a,i){this.media=i.media,!!this.media&&(this.queuedDefaultTrack>-1&&(this.subtitleTrack=this.queuedDefaultTrack,this.queuedDefaultTrack=-1),this.useTextTrackPolling=!(this.media.textTracks&&"onchange"in this.media.textTracks),this.useTextTrackPolling?this.pollTrackChange(500):this.media.textTracks.addEventListener("change",this.asyncPollTrackChange))},E.pollTrackChange=function(a){self.clearInterval(this.subtitlePollingInterval),this.subtitlePollingInterval=self.setInterval(this.trackChangeListener,a)},E.onMediaDetaching=function(){if(!!this.media){self.clearInterval(this.subtitlePollingInterval),this.useTextTrackPolling||this.media.textTracks.removeEventListener("change",this.asyncPollTrackChange),this.trackId>-1&&(this.queuedDefaultTrack=this.trackId);var a=P(this.media.textTracks);a.forEach(function(i){Object(k.clearCurrentCues)(i)}),this.subtitleTrack=-1,this.media=null}},E.onManifestLoading=function(){this.tracks=[],this.groupId=null,this.tracksInGroup=[],this.trackId=-1,this.selectDefaultTrack=!0},E.onManifestParsed=function(a,i){this.tracks=i.subtitleTracks},E.onSubtitleTrackLoaded=function(a,i){var l=i.id,p=i.details,f=this.trackId,h=this.tracksInGroup[f];if(!h){this.warn("Invalid subtitle track id "+l);return}var m=h.details;h.details=i.details,this.log("subtitle track "+l+" loaded ["+p.startSN+"-"+p.endSN+"]"),l===this.trackId&&(this.retryCount=0,this.playlistLoaded(l,i,m))},E.onLevelLoading=function(a,i){this.switchLevel(i.level)},E.onLevelSwitching=function(a,i){this.switchLevel(i.level)},E.switchLevel=function(a){var i=this.hls.levels[a];if(!!(i!=null&&i.textGroupIds)){var l=i.textGroupIds[i.urlId];if(this.groupId!==l){var p=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0,f=this.tracks.filter(function(L){return!l||L.groupId===l});this.tracksInGroup=f;var h=this.findTrackId(p==null?void 0:p.name)||this.findTrackId();this.groupId=l;var m={subtitleTracks:f};this.log("Updating subtitle tracks, "+f.length+' track(s) found in "'+l+'" group-id'),this.hls.trigger(H.Events.SUBTITLE_TRACKS_UPDATED,m),h!==-1&&this.setSubtitleTrack(h,p)}}},E.findTrackId=function(a){for(var i=this.tracksInGroup,l=0;l<i.length;l++){var p=i[l];if((!this.selectDefaultTrack||p.default)&&(!a||a===p.name))return p.id}return-1},E.onError=function(a,i){u.prototype.onError.call(this,a,i),!(i.fatal||!i.context)&&i.context.type===j.PlaylistContextType.SUBTITLE_TRACK&&i.context.id===this.trackId&&i.context.groupId===this.groupId&&this.retryLoadingOrFail(i)},E.loadPlaylist=function(a){var i=this.tracksInGroup[this.trackId];if(this.shouldLoadTrack(i)){var l=i.id,p=i.groupId,f=i.url;if(a)try{f=a.addDirectives(f)}catch(h){this.warn("Could not construct new URL with HLS Delivery Directives: "+h)}this.log("Loading subtitle playlist for id "+l),this.hls.trigger(H.Events.SUBTITLE_TRACK_LOADING,{url:f,id:l,groupId:p,deliveryDirectives:a||null})}},E.toggleTrackModes=function(a){var i=this,l=this.media,p=this.subtitleDisplay,f=this.trackId;if(!!l){var h=P(l.textTracks),m=h.filter(function(v){return v.groupId===i.groupId});if(a===-1)[].slice.call(h).forEach(function(v){v.mode="disabled"});else{var L=m[f];L&&(L.mode="disabled")}var S=m[a];S&&(S.mode=p?"showing":"hidden")}},E.setSubtitleTrack=function(a,i){var l,p=this.tracksInGroup;if(!this.media){this.queuedDefaultTrack=a;return}if(this.trackId!==a&&this.toggleTrackModes(a),!(this.trackId===a&&(a===-1||(l=p[a])!==null&&l!==void 0&&l.details)||a<-1||a>=p.length)){this.clearTimer();var f=p[a];if(this.log("Switching to subtitle track "+a),this.trackId=a,f){var h=f.id,m=f.groupId,L=m===void 0?"":m,S=f.name,v=f.type,n=f.url;this.hls.trigger(H.Events.SUBTITLE_TRACK_SWITCH,{id:h,groupId:L,name:S,type:v,url:n});var s=this.switchParams(f.url,i==null?void 0:i.details);this.loadPlaylist(s)}else this.hls.trigger(H.Events.SUBTITLE_TRACK_SWITCH,{id:a})}},E.onTextTracksChanged=function(){if(this.useTextTrackPolling||self.clearInterval(this.subtitlePollingInterval),!(!this.media||!this.hls.config.renderTextTracksNatively)){for(var a=-1,i=P(this.media.textTracks),l=0;l<i.length;l++)if(i[l].mode==="hidden")a=l;else if(i[l].mode==="showing"){a=l;break}this.subtitleTrack!==a&&(this.subtitleTrack=a)}},R(d,[{key:"subtitleTracks",get:function(){return this.tracksInGroup}},{key:"subtitleTrack",get:function(){return this.trackId},set:function(a){this.selectDefaultTrack=!1;var i=this.tracksInGroup?this.tracksInGroup[this.trackId]:void 0;this.setSubtitleTrack(a,i)}}]),d}(x.default);function P(u){for(var d=[],E=0;E<u.length;E++){var c=u[E];c.kind==="subtitles"&&c.label&&d.push(u[E])}return d}K.default=C},"./src/controller/timeline-controller.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"TimelineController",function(){return P});var H=M("./src/polyfills/number.ts"),k=M("./src/events.ts"),x=M("./src/utils/cea-608-parser.ts"),j=M("./src/utils/output-filter.ts"),F=M("./src/utils/webvtt-parser.ts"),R=M("./src/utils/texttrack-utils.ts"),O=M("./src/utils/imsc1-ttml-parser.ts"),y=M("./src/types/loader.ts"),C=M("./src/utils/logger.ts"),P=function(){function c(i){if(this.hls=void 0,this.media=null,this.config=void 0,this.enabled=!0,this.Cues=void 0,this.textTracks=[],this.tracks=[],this.initPTS=[],this.timescale=[],this.unparsedVttFrags=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.cea608Parser1=void 0,this.cea608Parser2=void 0,this.lastSn=-1,this.prevCC=-1,this.vttCCs=E(),this.captionsProperties=void 0,this.hls=i,this.config=i.config,this.Cues=i.config.cueHandler,this.captionsProperties={textTrack1:{label:this.config.captionsTextTrack1Label,languageCode:this.config.captionsTextTrack1LanguageCode},textTrack2:{label:this.config.captionsTextTrack2Label,languageCode:this.config.captionsTextTrack2LanguageCode},textTrack3:{label:this.config.captionsTextTrack3Label,languageCode:this.config.captionsTextTrack3LanguageCode},textTrack4:{label:this.config.captionsTextTrack4Label,languageCode:this.config.captionsTextTrack4LanguageCode}},this.config.enableCEA708Captions){var l=new j.default(this,"textTrack1"),p=new j.default(this,"textTrack2"),f=new j.default(this,"textTrack3"),h=new j.default(this,"textTrack4");this.cea608Parser1=new x.default(1,l,p),this.cea608Parser2=new x.default(3,f,h)}i.on(k.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),i.on(k.Events.MEDIA_DETACHING,this.onMediaDetaching,this),i.on(k.Events.MANIFEST_LOADING,this.onManifestLoading,this),i.on(k.Events.MANIFEST_LOADED,this.onManifestLoaded,this),i.on(k.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),i.on(k.Events.FRAG_LOADING,this.onFragLoading,this),i.on(k.Events.FRAG_LOADED,this.onFragLoaded,this),i.on(k.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),i.on(k.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),i.on(k.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),i.on(k.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),i.on(k.Events.BUFFER_FLUSHING,this.onBufferFlushing,this)}var a=c.prototype;return a.destroy=function(){var l=this.hls;l.off(k.Events.MEDIA_ATTACHING,this.onMediaAttaching,this),l.off(k.Events.MEDIA_DETACHING,this.onMediaDetaching,this),l.off(k.Events.MANIFEST_LOADING,this.onManifestLoading,this),l.off(k.Events.MANIFEST_LOADED,this.onManifestLoaded,this),l.off(k.Events.SUBTITLE_TRACKS_UPDATED,this.onSubtitleTracksUpdated,this),l.off(k.Events.FRAG_LOADING,this.onFragLoading,this),l.off(k.Events.FRAG_LOADED,this.onFragLoaded,this),l.off(k.Events.FRAG_PARSING_USERDATA,this.onFragParsingUserdata,this),l.off(k.Events.FRAG_DECRYPTED,this.onFragDecrypted,this),l.off(k.Events.INIT_PTS_FOUND,this.onInitPtsFound,this),l.off(k.Events.SUBTITLE_TRACKS_CLEARED,this.onSubtitleTracksCleared,this),l.off(k.Events.BUFFER_FLUSHING,this.onBufferFlushing,this),this.hls=this.config=this.cea608Parser1=this.cea608Parser2=null},a.addCues=function(l,p,f,h,m){for(var L=!1,S=m.length;S--;){var v=m[S],n=d(v[0],v[1],p,f);if(n>=0&&(v[0]=Math.min(v[0],p),v[1]=Math.max(v[1],f),L=!0,n/(f-p)>.5))return}if(L||m.push([p,f]),this.config.renderTextTracksNatively){var s=this.captionsTracks[l];this.Cues.newCue(s,p,f,h)}else{var A=this.Cues.newCue(null,p,f,h);this.hls.trigger(k.Events.CUES_PARSED,{type:"captions",cues:A,track:l})}},a.onInitPtsFound=function(l,p){var f=this,h=p.frag,m=p.id,L=p.initPTS,S=p.timescale,v=this.unparsedVttFrags;m==="main"&&(this.initPTS[h.cc]=L,this.timescale[h.cc]=S),v.length&&(this.unparsedVttFrags=[],v.forEach(function(n){f.onFragLoaded(k.Events.FRAG_LOADED,n)}))},a.getExistingTrack=function(l){var p=this.media;if(p)for(var f=0;f<p.textTracks.length;f++){var h=p.textTracks[f];if(h[l])return h}return null},a.createCaptionsTrack=function(l){this.config.renderTextTracksNatively?this.createNativeTrack(l):this.createNonNativeTrack(l)},a.createNativeTrack=function(l){if(!this.captionsTracks[l]){var p=this.captionsProperties,f=this.captionsTracks,h=this.media,m=p[l],L=m.label,S=m.languageCode,v=this.getExistingTrack(l);if(v)f[l]=v,Object(R.clearCurrentCues)(f[l]),Object(R.sendAddTrackEvent)(f[l],h);else{var n=this.createTextTrack("captions",L,S);n&&(n[l]=!0,f[l]=n)}}},a.createNonNativeTrack=function(l){if(!this.nonNativeCaptionsTracks[l]){var p=this.captionsProperties[l];if(!!p){var f=p.label,h={_id:l,label:f,kind:"captions",default:p.media?!!p.media.default:!1,closedCaptions:p.media};this.nonNativeCaptionsTracks[l]=h,this.hls.trigger(k.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:[h]})}}},a.createTextTrack=function(l,p,f){var h=this.media;if(!!h)return h.addTextTrack(l,p,f)},a.onMediaAttaching=function(l,p){this.media=p.media,this._cleanTracks()},a.onMediaDetaching=function(){var l=this.captionsTracks;Object.keys(l).forEach(function(p){Object(R.clearCurrentCues)(l[p]),delete l[p]}),this.nonNativeCaptionsTracks={}},a.onManifestLoading=function(){this.lastSn=-1,this.prevCC=-1,this.vttCCs=E(),this._cleanTracks(),this.tracks=[],this.captionsTracks={},this.nonNativeCaptionsTracks={},this.textTracks=[],this.unparsedVttFrags=this.unparsedVttFrags||[],this.initPTS=[],this.timescale=[],this.cea608Parser1&&this.cea608Parser2&&(this.cea608Parser1.reset(),this.cea608Parser2.reset())},a._cleanTracks=function(){var l=this.media;if(!!l){var p=l.textTracks;if(p)for(var f=0;f<p.length;f++)Object(R.clearCurrentCues)(p[f])}},a.onSubtitleTracksUpdated=function(l,p){var f=this;this.textTracks=[];var h=p.subtitleTracks||[],m=h.some(function(n){return n.textCodec===O.IMSC1_CODEC});if(this.config.enableWebVTT||m&&this.config.enableIMSC1){var L=this.tracks&&h&&this.tracks.length===h.length;if(this.tracks=h||[],this.config.renderTextTracksNatively){var S=this.media?this.media.textTracks:[];this.tracks.forEach(function(n,s){var A;if(s<S.length){for(var _=null,D=0;D<S.length;D++)if(u(S[D],n)){_=S[D];break}_&&(A=_)}A?Object(R.clearCurrentCues)(A):(A=f.createTextTrack("subtitles",n.name,n.lang),A&&(A.mode="disabled")),A&&(A.groupId=n.groupId,f.textTracks.push(A))})}else if(!L&&this.tracks&&this.tracks.length){var v=this.tracks.map(function(n){return{label:n.name,kind:n.type.toLowerCase(),default:n.default,subtitleTrack:n}});this.hls.trigger(k.Events.NON_NATIVE_TEXT_TRACKS_FOUND,{tracks:v})}}},a.onManifestLoaded=function(l,p){var f=this;this.config.enableCEA708Captions&&p.captions&&p.captions.forEach(function(h){var m=/(?:CC|SERVICE)([1-4])/.exec(h.instreamId);if(!!m){var L="textTrack"+m[1],S=f.captionsProperties[L];!S||(S.label=h.name,h.lang&&(S.languageCode=h.lang),S.media=h)}})},a.onFragLoading=function(l,p){var f=this.cea608Parser1,h=this.cea608Parser2,m=this.lastSn;if(!(!this.enabled||!(f&&h))&&p.frag.type===y.PlaylistLevelType.MAIN){var L=p.frag.sn;L!==m+1&&(f.reset(),h.reset()),this.lastSn=L}},a.onFragLoaded=function(l,p){var f=p.frag,h=p.payload,m=this.initPTS,L=this.unparsedVttFrags;if(f.type===y.PlaylistLevelType.SUBTITLE)if(h.byteLength){if(!Object(H.isFiniteNumber)(m[f.cc])){L.push(p),m.length&&this.hls.trigger(k.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:f,error:new Error("Missing initial subtitle PTS")});return}var S=f.decryptdata;if(S==null||S.key==null||S.method!=="AES-128"){var v=this.tracks[f.level],n=this.vttCCs;n[f.cc]||(n[f.cc]={start:f.start,prevCC:this.prevCC,new:!0},this.prevCC=f.cc),v&&v.textCodec===O.IMSC1_CODEC?this._parseIMSC1(f,h):this._parseVTTs(f,h,n)}}else this.hls.trigger(k.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:f,error:new Error("Empty subtitle payload")})},a._parseIMSC1=function(l,p){var f=this,h=this.hls;Object(O.parseIMSC1)(p,this.initPTS[l.cc],this.timescale[l.cc],function(m){f._appendCues(m,l.level),h.trigger(k.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:l})},function(m){C.logger.log("Failed to parse IMSC1: "+m),h.trigger(k.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:l,error:m})})},a._parseVTTs=function(l,p,f){var h=this,m=this.hls;Object(F.parseWebVTT)(p,this.initPTS[l.cc],this.timescale[l.cc],f,l.cc,l.start,function(L){h._appendCues(L,l.level),m.trigger(k.Events.SUBTITLE_FRAG_PROCESSED,{success:!0,frag:l})},function(L){h._fallbackToIMSC1(l,p),C.logger.log("Failed to parse VTT cue: "+L),m.trigger(k.Events.SUBTITLE_FRAG_PROCESSED,{success:!1,frag:l,error:L})})},a._fallbackToIMSC1=function(l,p){var f=this,h=this.tracks[l.level];h.textCodec||Object(O.parseIMSC1)(p,this.initPTS[l.cc],this.timescale[l.cc],function(){h.textCodec=O.IMSC1_CODEC,f._parseIMSC1(l,p)},function(){h.textCodec="wvtt"})},a._appendCues=function(l,p){var f=this.hls;if(this.config.renderTextTracksNatively){var h=this.textTracks[p];if(h.mode==="disabled")return;l.forEach(function(S){return Object(R.addCueToTrack)(h,S)})}else{var m=this.tracks[p],L=m.default?"default":"subtitles"+p;f.trigger(k.Events.CUES_PARSED,{type:"subtitles",cues:l,track:L})}},a.onFragDecrypted=function(l,p){var f=p.frag;if(f.type===y.PlaylistLevelType.SUBTITLE){if(!Object(H.isFiniteNumber)(this.initPTS[f.cc])){this.unparsedVttFrags.push(p);return}this.onFragLoaded(k.Events.FRAG_LOADED,p)}},a.onSubtitleTracksCleared=function(){this.tracks=[],this.captionsTracks={}},a.onFragParsingUserdata=function(l,p){var f=this.cea608Parser1,h=this.cea608Parser2;if(!(!this.enabled||!(f&&h)))for(var m=0;m<p.samples.length;m++){var L=p.samples[m].bytes;if(L){var S=this.extractCea608Data(L);f.addData(p.samples[m].pts,S[0]),h.addData(p.samples[m].pts,S[1])}}},a.onBufferFlushing=function(l,p){var f=p.startOffset,h=p.endOffset,m=p.endOffsetSubtitles,L=p.type,S=this.media;if(!(!S||S.currentTime<h)){if(!L||L==="video"){var v=this.captionsTracks;Object.keys(v).forEach(function(s){return Object(R.removeCuesInRange)(v[s],f,h)})}if(this.config.renderTextTracksNatively&&f===0&&m!==void 0){var n=this.textTracks;Object.keys(n).forEach(function(s){return Object(R.removeCuesInRange)(n[s],f,m)})}}},a.extractCea608Data=function(l){for(var p=l[0]&31,f=2,h=[[],[]],m=0;m<p;m++){var L=l[f++],S=127&l[f++],v=127&l[f++],n=(4&L)!=0,s=3&L;S===0&&v===0||n&&(s===0||s===1)&&(h[s].push(S),h[s].push(v))}return h},c}();function u(c,a){return c&&c.label===a.name&&!(c.textTrack1||c.textTrack2)}function d(c,a,i,l){return Math.min(a,l)-Math.max(c,i)}function E(){return{ccOffset:0,presentationOffset:0,0:{start:0,prevCC:-1,new:!1}}}},"./src/crypt/aes-crypto.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"default",function(){return H});var H=function(){function k(j,F){this.subtle=void 0,this.aesIV=void 0,this.subtle=j,this.aesIV=F}var x=k.prototype;return x.decrypt=function(F,R){return this.subtle.decrypt({name:"AES-CBC",iv:this.aesIV},R,F)},k}()},"./src/crypt/aes-decryptor.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"removePadding",function(){return k}),M.d(K,"default",function(){return x});var H=M("./src/utils/typed-array.ts");function k(j){var F=j.byteLength,R=F&&new DataView(j.buffer).getUint8(F-1);return R?Object(H.sliceUint8)(j,0,F-R):j}var x=function(){function j(){this.rcon=[0,1,2,4,8,16,32,64,128,27,54],this.subMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.invSubMix=[new Uint32Array(256),new Uint32Array(256),new Uint32Array(256),new Uint32Array(256)],this.sBox=new Uint32Array(256),this.invSBox=new Uint32Array(256),this.key=new Uint32Array(0),this.ksRows=0,this.keySize=0,this.keySchedule=void 0,this.invKeySchedule=void 0,this.initTable()}var F=j.prototype;return F.uint8ArrayToUint32Array_=function(O){for(var y=new DataView(O),C=new Uint32Array(4),P=0;P<4;P++)C[P]=y.getUint32(P*4);return C},F.initTable=function(){var O=this.sBox,y=this.invSBox,C=this.subMix,P=C[0],u=C[1],d=C[2],E=C[3],c=this.invSubMix,a=c[0],i=c[1],l=c[2],p=c[3],f=new Uint32Array(256),h=0,m=0,L=0;for(L=0;L<256;L++)L<128?f[L]=L<<1:f[L]=L<<1^283;for(L=0;L<256;L++){var S=m^m<<1^m<<2^m<<3^m<<4;S=S>>>8^S&255^99,O[h]=S,y[S]=h;var v=f[h],n=f[v],s=f[n],A=f[S]*257^S*16843008;P[h]=A<<24|A>>>8,u[h]=A<<16|A>>>16,d[h]=A<<8|A>>>24,E[h]=A,A=s*16843009^n*65537^v*257^h*16843008,a[S]=A<<24|A>>>8,i[S]=A<<16|A>>>16,l[S]=A<<8|A>>>24,p[S]=A,h?(h=v^f[f[f[s^v]]],m^=f[f[m]]):h=m=1}},F.expandKey=function(O){for(var y=this.uint8ArrayToUint32Array_(O),C=!0,P=0;P<y.length&&C;)C=y[P]===this.key[P],P++;if(!C){this.key=y;var u=this.keySize=y.length;if(u!==4&&u!==6&&u!==8)throw new Error("Invalid aes key size="+u);var d=this.ksRows=(u+6+1)*4,E,c,a=this.keySchedule=new Uint32Array(d),i=this.invKeySchedule=new Uint32Array(d),l=this.sBox,p=this.rcon,f=this.invSubMix,h=f[0],m=f[1],L=f[2],S=f[3],v,n;for(E=0;E<d;E++){if(E<u){v=a[E]=y[E];continue}n=v,E%u==0?(n=n<<8|n>>>24,n=l[n>>>24]<<24|l[n>>>16&255]<<16|l[n>>>8&255]<<8|l[n&255],n^=p[E/u|0]<<24):u>6&&E%u==4&&(n=l[n>>>24]<<24|l[n>>>16&255]<<16|l[n>>>8&255]<<8|l[n&255]),a[E]=v=(a[E-u]^n)>>>0}for(c=0;c<d;c++)E=d-c,c&3?n=a[E]:n=a[E-4],c<4||E<=4?i[c]=n:i[c]=h[l[n>>>24]]^m[l[n>>>16&255]]^L[l[n>>>8&255]]^S[l[n&255]],i[c]=i[c]>>>0}},F.networkToHostOrderSwap=function(O){return O<<24|(O&65280)<<8|(O&16711680)>>8|O>>>24},F.decrypt=function(O,y,C){for(var P=this.keySize+6,u=this.invKeySchedule,d=this.invSBox,E=this.invSubMix,c=E[0],a=E[1],i=E[2],l=E[3],p=this.uint8ArrayToUint32Array_(C),f=p[0],h=p[1],m=p[2],L=p[3],S=new Int32Array(O),v=new Int32Array(S.length),n,s,A,_,D,I,w,B,N,W,G,V,X,$,q=this.networkToHostOrderSwap;y<S.length;){for(N=q(S[y]),W=q(S[y+1]),G=q(S[y+2]),V=q(S[y+3]),D=N^u[0],I=V^u[1],w=G^u[2],B=W^u[3],X=4,$=1;$<P;$++)n=c[D>>>24]^a[I>>16&255]^i[w>>8&255]^l[B&255]^u[X],s=c[I>>>24]^a[w>>16&255]^i[B>>8&255]^l[D&255]^u[X+1],A=c[w>>>24]^a[B>>16&255]^i[D>>8&255]^l[I&255]^u[X+2],_=c[B>>>24]^a[D>>16&255]^i[I>>8&255]^l[w&255]^u[X+3],D=n,I=s,w=A,B=_,X=X+4;n=d[D>>>24]<<24^d[I>>16&255]<<16^d[w>>8&255]<<8^d[B&255]^u[X],s=d[I>>>24]<<24^d[w>>16&255]<<16^d[B>>8&255]<<8^d[D&255]^u[X+1],A=d[w>>>24]<<24^d[B>>16&255]<<16^d[D>>8&255]<<8^d[I&255]^u[X+2],_=d[B>>>24]<<24^d[D>>16&255]<<16^d[I>>8&255]<<8^d[w&255]^u[X+3],v[y]=q(n^f),v[y+1]=q(_^h),v[y+2]=q(A^m),v[y+3]=q(s^L),f=N,h=W,m=G,L=V,y=y+4}return v.buffer},j}()},"./src/crypt/decrypter.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"default",function(){return y});var H=M("./src/crypt/aes-crypto.ts"),k=M("./src/crypt/fast-aes-key.ts"),x=M("./src/crypt/aes-decryptor.ts"),j=M("./src/utils/logger.ts"),F=M("./src/utils/mp4-tools.ts"),R=M("./src/utils/typed-array.ts"),O=16,y=function(){function C(u,d,E){var c=E===void 0?{}:E,a=c.removePKCS7Padding,i=a===void 0?!0:a;if(this.logEnabled=!0,this.observer=void 0,this.config=void 0,this.removePKCS7Padding=void 0,this.subtle=null,this.softwareDecrypter=null,this.key=null,this.fastAesKey=null,this.remainderData=null,this.currentIV=null,this.currentResult=null,this.observer=u,this.config=d,this.removePKCS7Padding=i,i)try{var l=self.crypto;l&&(this.subtle=l.subtle||l.webkitSubtle)}catch(p){}this.subtle===null&&(this.config.enableSoftwareAES=!0)}var P=C.prototype;return P.destroy=function(){this.observer=null},P.isSync=function(){return this.config.enableSoftwareAES},P.flush=function(){var d=this.currentResult;if(!d){this.reset();return}var E=new Uint8Array(d);return this.reset(),this.removePKCS7Padding?Object(x.removePadding)(E):E},P.reset=function(){this.currentResult=null,this.currentIV=null,this.remainderData=null,this.softwareDecrypter&&(this.softwareDecrypter=null)},P.decrypt=function(d,E,c,a){if(this.config.enableSoftwareAES){this.softwareDecrypt(new Uint8Array(d),E,c);var i=this.flush();i&&a(i.buffer)}else this.webCryptoDecrypt(new Uint8Array(d),E,c).then(a)},P.softwareDecrypt=function(d,E,c){var a=this.currentIV,i=this.currentResult,l=this.remainderData;this.logOnce("JS AES decrypt"),l&&(d=Object(F.appendUint8Array)(l,d),this.remainderData=null);var p=this.getValidChunk(d);if(!p.length)return null;a&&(c=a);var f=this.softwareDecrypter;f||(f=this.softwareDecrypter=new x.default),f.expandKey(E);var h=i;return this.currentResult=f.decrypt(p.buffer,0,c),this.currentIV=Object(R.sliceUint8)(p,-16).buffer,h||null},P.webCryptoDecrypt=function(d,E,c){var a=this,i=this.subtle;return(this.key!==E||!this.fastAesKey)&&(this.key=E,this.fastAesKey=new k.default(i,E)),this.fastAesKey.expandKey().then(function(l){if(!i)return Promise.reject(new Error("web crypto not initialized"));var p=new H.default(i,c);return p.decrypt(d.buffer,l)}).catch(function(l){return a.onWebCryptoError(l,d,E,c)})},P.onWebCryptoError=function(d,E,c,a){return j.logger.warn("[decrypter.ts]: WebCrypto Error, disable WebCrypto API:",d),this.config.enableSoftwareAES=!0,this.logEnabled=!0,this.softwareDecrypt(E,c,a)},P.getValidChunk=function(d){var E=d,c=d.length-d.length%O;return c!==d.length&&(E=Object(R.sliceUint8)(d,0,c),this.remainderData=Object(R.sliceUint8)(d,c)),E},P.logOnce=function(d){!this.logEnabled||(j.logger.log("[decrypter.ts]: "+d),this.logEnabled=!1)},C}()},"./src/crypt/fast-aes-key.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"default",function(){return H});var H=function(){function k(j,F){this.subtle=void 0,this.key=void 0,this.subtle=j,this.key=F}var x=k.prototype;return x.expandKey=function(){return this.subtle.importKey("raw",this.key,{name:"AES-CBC"},!1,["encrypt","decrypt"])},k}()},"./src/demux/aacdemuxer.ts":function(re,K,M){"use strict";M.r(K);var H=M("./src/demux/base-audio-demuxer.ts"),k=M("./src/demux/adts.ts"),x=M("./src/utils/logger.ts"),j=M("./src/demux/id3.ts");function F(y,C){y.prototype=Object.create(C.prototype),y.prototype.constructor=y,R(y,C)}function R(y,C){return R=Object.setPrototypeOf||function(u,d){return u.__proto__=d,u},R(y,C)}var O=function(y){F(C,y);function C(u,d){var E;return E=y.call(this)||this,E.observer=void 0,E.config=void 0,E.observer=u,E.config=d,E}var P=C.prototype;return P.resetInitSegment=function(d,E,c){y.prototype.resetInitSegment.call(this,d,E,c),this._audioTrack={container:"audio/adts",type:"audio",id:0,pid:-1,sequenceNumber:0,isAAC:!0,samples:[],manifestCodec:d,duration:c,inputTimeScale:9e4,dropped:0}},C.probe=function(d){if(!d)return!1;for(var E=j.getID3Data(d,0)||[],c=E.length,a=d.length;c<a;c++)if(k.probe(d,c))return x.logger.log("ADTS sync word found !"),!0;return!1},P.canParse=function(d,E){return k.canParse(d,E)},P.appendFrame=function(d,E,c){k.initTrackConfig(d,this.observer,E,c,d.manifestCodec);var a=k.appendFrame(d,E,c,this.initPTS,this.frameIndex);if(a&&a.missing===0)return a},C}(H.default);O.minProbeByteLength=9,K.default=O},"./src/demux/adts.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"getAudioConfig",function(){return j}),M.d(K,"isHeaderPattern",function(){return F}),M.d(K,"getHeaderLength",function(){return R}),M.d(K,"getFullFrameLength",function(){return O}),M.d(K,"canGetFrameLength",function(){return y}),M.d(K,"isHeader",function(){return C}),M.d(K,"canParse",function(){return P}),M.d(K,"probe",function(){return u}),M.d(K,"initTrackConfig",function(){return d}),M.d(K,"getFrameDuration",function(){return E}),M.d(K,"parseFrameHeader",function(){return c}),M.d(K,"appendFrame",function(){return a});var H=M("./src/utils/logger.ts"),k=M("./src/errors.ts"),x=M("./src/events.ts");function j(i,l,p,f){var h,m,L,S,v=navigator.userAgent.toLowerCase(),n=f,s=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350];h=((l[p+2]&192)>>>6)+1;var A=(l[p+2]&60)>>>2;if(A>s.length-1){i.trigger(x.Events.ERROR,{type:k.ErrorTypes.MEDIA_ERROR,details:k.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"invalid ADTS sampling index:"+A});return}return L=(l[p+2]&1)<<2,L|=(l[p+3]&192)>>>6,H.logger.log("manifest codec:"+f+", ADTS type:"+h+", samplingIndex:"+A),/firefox/i.test(v)?A>=6?(h=5,S=new Array(4),m=A-3):(h=2,S=new Array(2),m=A):v.indexOf("android")!==-1?(h=2,S=new Array(2),m=A):(h=5,S=new Array(4),f&&(f.indexOf("mp4a.40.29")!==-1||f.indexOf("mp4a.40.5")!==-1)||!f&&A>=6?m=A-3:((f&&f.indexOf("mp4a.40.2")!==-1&&(A>=6&&L===1||/vivaldi/i.test(v))||!f&&L===1)&&(h=2,S=new Array(2)),m=A)),S[0]=h<<3,S[0]|=(A&14)>>1,S[1]|=(A&1)<<7,S[1]|=L<<3,h===5&&(S[1]|=(m&14)>>1,S[2]=(m&1)<<7,S[2]|=2<<2,S[3]=0),{config:S,samplerate:s[A],channelCount:L,codec:"mp4a.40."+h,manifestCodec:n}}function F(i,l){return i[l]===255&&(i[l+1]&246)==240}function R(i,l){return i[l+1]&1?7:9}function O(i,l){return(i[l+3]&3)<<11|i[l+4]<<3|(i[l+5]&224)>>>5}function y(i,l){return l+5<i.length}function C(i,l){return l+1<i.length&&F(i,l)}function P(i,l){return y(i,l)&&F(i,l)&&O(i,l)<=i.length-l}function u(i,l){if(C(i,l)){var p=R(i,l);if(l+p>=i.length)return!1;var f=O(i,l);if(f<=p)return!1;var h=l+f;return h===i.length||C(i,h)}return!1}function d(i,l,p,f,h){if(!i.samplerate){var m=j(l,p,f,h);if(!m)return;i.config=m.config,i.samplerate=m.samplerate,i.channelCount=m.channelCount,i.codec=m.codec,i.manifestCodec=m.manifestCodec,H.logger.log("parsed codec:"+i.codec+", rate:"+m.samplerate+", channels:"+m.channelCount)}}function E(i){return 1024*9e4/i}function c(i,l,p,f,h){var m=R(i,l),L=O(i,l);if(L-=m,L>0){var S=p+f*h;return{headerLength:m,frameLength:L,stamp:S}}}function a(i,l,p,f,h){var m=E(i.samplerate),L=c(l,p,f,h,m);if(L){var S=L.frameLength,v=L.headerLength,n=L.stamp,s=v+S,A=Math.max(0,p+s-l.length),_;A?(_=new Uint8Array(s-v),_.set(l.subarray(p+v,l.length),0)):_=l.subarray(p+v,p+s);var D={unit:_,pts:n};return A||i.samples.push(D),{sample:D,length:s,missing:A}}}},"./src/demux/base-audio-demuxer.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"initPTSFn",function(){return O});var H=M("./src/polyfills/number.ts"),k=M("./src/demux/id3.ts"),x=M("./src/demux/dummy-demuxed-track.ts"),j=M("./src/utils/mp4-tools.ts"),F=M("./src/utils/typed-array.ts"),R=function(){function y(){this._audioTrack=void 0,this._id3Track=void 0,this.frameIndex=0,this.cachedData=null,this.initPTS=null}var C=y.prototype;return C.resetInitSegment=function(u,d,E){this._id3Track={type:"id3",id:0,pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0}},C.resetTimeStamp=function(){},C.resetContiguity=function(){},C.canParse=function(u,d){return!1},C.appendFrame=function(u,d,E){},C.demux=function(u,d){this.cachedData&&(u=Object(j.appendUint8Array)(this.cachedData,u),this.cachedData=null);var E=k.getID3Data(u,0),c=E?E.length:0,a,i,l=this._audioTrack,p=this._id3Track,f=E?k.getTimeStamp(E):void 0,h=u.length;for((this.frameIndex===0||this.initPTS===null)&&(this.initPTS=O(f,d)),E&&E.length>0&&p.samples.push({pts:this.initPTS,dts:this.initPTS,data:E}),i=this.initPTS;c<h;){if(this.canParse(u,c)){var m=this.appendFrame(l,u,c);m?(this.frameIndex++,i=m.sample.pts,c+=m.length,a=c):c=h}else k.canParse(u,c)?(E=k.getID3Data(u,c),p.samples.push({pts:i,dts:i,data:E}),c+=E.length,a=c):c++;if(c===h&&a!==h){var L=Object(F.sliceUint8)(u,a);this.cachedData?this.cachedData=Object(j.appendUint8Array)(this.cachedData,L):this.cachedData=L}}return{audioTrack:l,avcTrack:Object(x.dummyTrack)(),id3Track:p,textTrack:Object(x.dummyTrack)()}},C.demuxSampleAes=function(u,d,E){return Promise.reject(new Error("["+this+"] This demuxer does not support Sample-AES decryption"))},C.flush=function(u){var d=this.cachedData;return d&&(this.cachedData=null,this.demux(d,0)),this.frameIndex=0,{audioTrack:this._audioTrack,avcTrack:Object(x.dummyTrack)(),id3Track:this._id3Track,textTrack:Object(x.dummyTrack)()}},C.destroy=function(){},y}(),O=function(C,P){return Object(H.isFiniteNumber)(C)?C*90:P*9e4};K.default=R},"./src/demux/chunk-cache.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"default",function(){return H});var H=function(){function x(){this.chunks=[],this.dataLength=0}var j=x.prototype;return j.push=function(R){this.chunks.push(R),this.dataLength+=R.length},j.flush=function(){var R=this.chunks,O=this.dataLength,y;if(R.length)R.length===1?y=R[0]:y=k(R,O);else return new Uint8Array(0);return this.reset(),y},j.reset=function(){this.chunks.length=0,this.dataLength=0},x}();function k(x,j){for(var F=new Uint8Array(j),R=0,O=0;O<x.length;O++){var y=x[O];F.set(y,R),R+=y.length}return F}},"./src/demux/dummy-demuxed-track.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"dummyTrack",function(){return H});function H(){return{type:"",id:-1,pid:-1,inputTimeScale:9e4,sequenceNumber:-1,samples:[],dropped:0}}},"./src/demux/exp-golomb.ts":function(re,K,M){"use strict";M.r(K);var H=M("./src/utils/logger.ts"),k=function(){function x(F){this.data=void 0,this.bytesAvailable=void 0,this.word=void 0,this.bitsAvailable=void 0,this.data=F,this.bytesAvailable=F.byteLength,this.word=0,this.bitsAvailable=0}var j=x.prototype;return j.loadWord=function(){var R=this.data,O=this.bytesAvailable,y=R.byteLength-O,C=new Uint8Array(4),P=Math.min(4,O);if(P===0)throw new Error("no bytes available");C.set(R.subarray(y,y+P)),this.word=new DataView(C.buffer).getUint32(0),this.bitsAvailable=P*8,this.bytesAvailable-=P},j.skipBits=function(R){var O;this.bitsAvailable>R?(this.word<<=R,this.bitsAvailable-=R):(R-=this.bitsAvailable,O=R>>3,R-=O>>3,this.bytesAvailable-=O,this.loadWord(),this.word<<=R,this.bitsAvailable-=R)},j.readBits=function(R){var O=Math.min(this.bitsAvailable,R),y=this.word>>>32-O;return R>32&&H.logger.error("Cannot read more than 32 bits at a time"),this.bitsAvailable-=O,this.bitsAvailable>0?this.word<<=O:this.bytesAvailable>0&&this.loadWord(),O=R-O,O>0&&this.bitsAvailable?y<<O|this.readBits(O):y},j.skipLZ=function(){var R;for(R=0;R<this.bitsAvailable;++R)if((this.word&2147483648>>>R)!=0)return this.word<<=R,this.bitsAvailable-=R,R;return this.loadWord(),R+this.skipLZ()},j.skipUEG=function(){this.skipBits(1+this.skipLZ())},j.skipEG=function(){this.skipBits(1+this.skipLZ())},j.readUEG=function(){var R=this.skipLZ();return this.readBits(R+1)-1},j.readEG=function(){var R=this.readUEG();return 1&R?1+R>>>1:-1*(R>>>1)},j.readBoolean=function(){return this.readBits(1)===1},j.readUByte=function(){return this.readBits(8)},j.readUShort=function(){return this.readBits(16)},j.readUInt=function(){return this.readBits(32)},j.skipScalingList=function(R){for(var O=8,y=8,C,P=0;P<R;P++)y!==0&&(C=this.readEG(),y=(O+C+256)%256),O=y===0?O:y},j.readSPS=function(){var R=0,O=0,y=0,C=0,P,u,d,E=this.readUByte.bind(this),c=this.readBits.bind(this),a=this.readUEG.bind(this),i=this.readBoolean.bind(this),l=this.skipBits.bind(this),p=this.skipEG.bind(this),f=this.skipUEG.bind(this),h=this.skipScalingList.bind(this);E();var m=E();if(c(5),l(3),E(),f(),m===100||m===110||m===122||m===244||m===44||m===83||m===86||m===118||m===128){var L=a();if(L===3&&l(1),f(),f(),l(1),i())for(u=L!==3?8:12,d=0;d<u;d++)i()&&(d<6?h(16):h(64))}f();var S=a();if(S===0)a();else if(S===1)for(l(1),p(),p(),P=a(),d=0;d<P;d++)p();f(),l(1);var v=a(),n=a(),s=c(1);s===0&&l(1),l(1),i()&&(R=a(),O=a(),y=a(),C=a());var A=[1,1];if(i()&&i()){var _=E();switch(_){case 1:A=[1,1];break;case 2:A=[12,11];break;case 3:A=[10,11];break;case 4:A=[16,11];break;case 5:A=[40,33];break;case 6:A=[24,11];break;case 7:A=[20,11];break;case 8:A=[32,11];break;case 9:A=[80,33];break;case 10:A=[18,11];break;case 11:A=[15,11];break;case 12:A=[64,33];break;case 13:A=[160,99];break;case 14:A=[4,3];break;case 15:A=[3,2];break;case 16:A=[2,1];break;case 255:{A=[E()<<8|E(),E()<<8|E()];break}}}return{width:Math.ceil((v+1)*16-R*2-O*2),height:(2-s)*(n+1)*16-(s?2:4)*(y+C),pixelRatio:A}},j.readSliceType=function(){return this.readUByte(),this.readUEG(),this.readUEG()},x}();K.default=k},"./src/demux/id3.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"isHeader",function(){return H}),M.d(K,"isFooter",function(){return k}),M.d(K,"getID3Data",function(){return x}),M.d(K,"canParse",function(){return F}),M.d(K,"getTimeStamp",function(){return R}),M.d(K,"isTimeStampFrame",function(){return O}),M.d(K,"getID3Frames",function(){return C}),M.d(K,"decodeFrame",function(){return P}),M.d(K,"utf8ArrayToStr",function(){return a}),M.d(K,"testables",function(){return i});var H=function(h,m){return m+10<=h.length&&h[m]===73&&h[m+1]===68&&h[m+2]===51&&h[m+3]<255&&h[m+4]<255&&h[m+6]<128&&h[m+7]<128&&h[m+8]<128&&h[m+9]<128},k=function(h,m){return m+10<=h.length&&h[m]===51&&h[m+1]===68&&h[m+2]===73&&h[m+3]<255&&h[m+4]<255&&h[m+6]<128&&h[m+7]<128&&h[m+8]<128&&h[m+9]<128},x=function(h,m){for(var L=m,S=0;H(h,m);){S+=10;var v=j(h,m+6);S+=v,k(h,m+10)&&(S+=10),m+=S}if(S>0)return h.subarray(L,L+S)},j=function(h,m){var L=0;return L=(h[m]&127)<<21,L|=(h[m+1]&127)<<14,L|=(h[m+2]&127)<<7,L|=h[m+3]&127,L},F=function(h,m){return H(h,m)&&j(h,m+6)+10<=h.length-m},R=function(h){for(var m=C(h),L=0;L<m.length;L++){var S=m[L];if(O(S))return c(S)}},O=function(h){return h&&h.key==="PRIV"&&h.info==="com.apple.streaming.transportStreamTimestamp"},y=function(h){var m=String.fromCharCode(h[0],h[1],h[2],h[3]),L=j(h,4),S=10;return{type:m,size:L,data:h.subarray(S,S+L)}},C=function(h){for(var m=0,L=[];H(h,m);){var S=j(h,m+6);m+=10;for(var v=m+S;m+8<v;){var n=y(h.subarray(m)),s=P(n);s&&L.push(s),m+=n.size+10}k(h,m)&&(m+=10)}return L},P=function(h){return h.type==="PRIV"?u(h):h.type[0]==="W"?E(h):d(h)},u=function(h){if(!(h.size<2)){var m=a(h.data,!0),L=new Uint8Array(h.data.subarray(m.length+1));return{key:h.type,info:m,data:L.buffer}}},d=function(h){if(!(h.size<2)){if(h.type==="TXXX"){var m=1,L=a(h.data.subarray(m),!0);m+=L.length+1;var S=a(h.data.subarray(m));return{key:h.type,info:L,data:S}}var v=a(h.data.subarray(1));return{key:h.type,data:v}}},E=function(h){if(h.type==="WXXX"){if(h.size<2)return;var m=1,L=a(h.data.subarray(m),!0);m+=L.length+1;var S=a(h.data.subarray(m));return{key:h.type,info:L,data:S}}var v=a(h.data);return{key:h.type,data:v}},c=function(h){if(h.data.byteLength===8){var m=new Uint8Array(h.data),L=m[3]&1,S=(m[4]<<23)+(m[5]<<15)+(m[6]<<7)+m[7];return S/=45,L&&(S+=4772185884e-2),Math.round(S)}},a=function(h,m){m===void 0&&(m=!1);var L=p();if(L){var S=L.decode(h);if(m){var v=S.indexOf("\0");return v!==-1?S.substring(0,v):S}return S.replace(/\0/g,"")}for(var n=h.length,s,A,_,D="",I=0;I<n;){if(s=h[I++],s===0&&m)return D;if(s===0||s===3)continue;switch(s>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:D+=String.fromCharCode(s);break;case 12:case 13:A=h[I++],D+=String.fromCharCode((s&31)<<6|A&63);break;case 14:A=h[I++],_=h[I++],D+=String.fromCharCode((s&15)<<12|(A&63)<<6|(_&63)<<0);break;default:}}return D},i={decodeTextFrame:d},l;function p(){return!l&&typeof self.TextDecoder!="undefined"&&(l=new self.TextDecoder("utf-8")),l}},"./src/demux/mp3demuxer.ts":function(re,K,M){"use strict";M.r(K);var H=M("./src/demux/base-audio-demuxer.ts"),k=M("./src/demux/id3.ts"),x=M("./src/utils/logger.ts"),j=M("./src/demux/mpegaudio.ts");function F(y,C){y.prototype=Object.create(C.prototype),y.prototype.constructor=y,R(y,C)}function R(y,C){return R=Object.setPrototypeOf||function(u,d){return u.__proto__=d,u},R(y,C)}var O=function(y){F(C,y);function C(){return y.apply(this,arguments)||this}var P=C.prototype;return P.resetInitSegment=function(d,E,c){y.prototype.resetInitSegment.call(this,d,E,c),this._audioTrack={container:"audio/mpeg",type:"audio",id:0,pid:-1,sequenceNumber:0,isAAC:!1,samples:[],manifestCodec:d,duration:c,inputTimeScale:9e4,dropped:0}},C.probe=function(d){if(!d)return!1;for(var E=k.getID3Data(d,0)||[],c=E.length,a=d.length;c<a;c++)if(j.probe(d,c))return x.logger.log("MPEG Audio sync word found !"),!0;return!1},P.canParse=function(d,E){return j.canParse(d,E)},P.appendFrame=function(d,E,c){if(this.initPTS!==null)return j.appendFrame(d,E,c,this.initPTS,this.frameIndex)},C}(H.default);O.minProbeByteLength=4,K.default=O},"./src/demux/mp4demuxer.ts":function(re,K,M){"use strict";M.r(K);var H=M("./src/utils/mp4-tools.ts"),k=M("./src/demux/dummy-demuxed-track.ts"),x=function(){function j(R,O){this.remainderData=null,this.config=void 0,this.config=O}var F=j.prototype;return F.resetTimeStamp=function(){},F.resetInitSegment=function(){},F.resetContiguity=function(){},j.probe=function(O){return Object(H.findBox)({data:O,start:0,end:Math.min(O.length,16384)},["moof"]).length>0},F.demux=function(O){var y=O,C=Object(k.dummyTrack)();if(this.config.progressive){this.remainderData&&(y=Object(H.appendUint8Array)(this.remainderData,O));var P=Object(H.segmentValidRange)(y);this.remainderData=P.remainder,C.samples=P.valid||new Uint8Array}else C.samples=y;return{audioTrack:Object(k.dummyTrack)(),avcTrack:C,id3Track:Object(k.dummyTrack)(),textTrack:Object(k.dummyTrack)()}},F.flush=function(){var O=Object(k.dummyTrack)();return O.samples=this.remainderData||new Uint8Array,this.remainderData=null,{audioTrack:Object(k.dummyTrack)(),avcTrack:O,id3Track:Object(k.dummyTrack)(),textTrack:Object(k.dummyTrack)()}},F.demuxSampleAes=function(O,y,C){return Promise.reject(new Error("The MP4 demuxer does not support SAMPLE-AES decryption"))},F.destroy=function(){},j}();x.minProbeByteLength=1024,K.default=x},"./src/demux/mpegaudio.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"appendFrame",function(){return R}),M.d(K,"parseHeader",function(){return O}),M.d(K,"isHeaderPattern",function(){return y}),M.d(K,"isHeader",function(){return C}),M.d(K,"canParse",function(){return P}),M.d(K,"probe",function(){return u});var H=null,k=[32,64,96,128,160,192,224,256,288,320,352,384,416,448,32,48,56,64,80,96,112,128,160,192,224,256,320,384,32,40,48,56,64,80,96,112,128,160,192,224,256,320,32,48,56,64,80,96,112,128,144,160,176,192,224,256,8,16,24,32,40,48,56,64,80,96,112,128,144,160],x=[44100,48e3,32e3,22050,24e3,16e3,11025,12e3,8e3],j=[[0,72,144,12],[0,0,0,0],[0,72,144,12],[0,144,144,12]],F=[0,1,1,4];function R(d,E,c,a,i){if(!(c+24>E.length)){var l=O(E,c);if(l&&c+l.frameLength<=E.length){var p=l.samplesPerFrame*9e4/l.sampleRate,f=a+i*p,h={unit:E.subarray(c,c+l.frameLength),pts:f,dts:f};return d.config=[],d.channelCount=l.channelCount,d.samplerate=l.sampleRate,d.samples.push(h),{sample:h,length:l.frameLength,missing:0}}}}function O(d,E){var c=d[E+1]>>3&3,a=d[E+1]>>1&3,i=d[E+2]>>4&15,l=d[E+2]>>2&3;if(c!==1&&i!==0&&i!==15&&l!==3){var p=d[E+2]>>1&1,f=d[E+3]>>6,h=c===3?3-a:a===3?3:4,m=k[h*14+i-1]*1e3,L=c===3?0:c===2?1:2,S=x[L*3+l],v=f===3?1:2,n=j[c][a],s=F[a],A=n*8*s,_=Math.floor(n*m/S+p)*s;if(H===null){var D=navigator.userAgent||"",I=D.match(/Chrome\/(\d+)/i);H=I?parseInt(I[1]):0}var w=!!H&&H<=87;return w&&a===2&&m>=224e3&&f===0&&(d[E+3]=d[E+3]|128),{sampleRate:S,channelCount:v,frameLength:_,samplesPerFrame:A}}}function y(d,E){return d[E]===255&&(d[E+1]&224)==224&&(d[E+1]&6)!=0}function C(d,E){return E+1<d.length&&y(d,E)}function P(d,E){var c=4;return y(d,E)&&c<=d.length-E}function u(d,E){if(E+1<d.length&&y(d,E)){var c=4,a=O(d,E),i=c;a!=null&&a.frameLength&&(i=a.frameLength);var l=E+i;return l===d.length||C(d,l)}return!1}},"./src/demux/sample-aes.ts":function(re,K,M){"use strict";M.r(K);var H=M("./src/crypt/decrypter.ts"),k=M("./src/demux/tsdemuxer.ts"),x=function(){function j(R,O,y){this.keyData=void 0,this.decrypter=void 0,this.keyData=y,this.decrypter=new H.default(R,O,{removePKCS7Padding:!1})}var F=j.prototype;return F.decryptBuffer=function(O,y){this.decrypter.decrypt(O,this.keyData.key.buffer,this.keyData.iv.buffer,y)},F.decryptAacSample=function(O,y,C,P){var u=O[y].unit,d=u.subarray(16,u.length-u.length%16),E=d.buffer.slice(d.byteOffset,d.byteOffset+d.length),c=this;this.decryptBuffer(E,function(a){var i=new Uint8Array(a);u.set(i,16),P||c.decryptAacSamples(O,y+1,C)})},F.decryptAacSamples=function(O,y,C){for(;;y++){if(y>=O.length){C();return}if(!(O[y].unit.length<32)){var P=this.decrypter.isSync();if(this.decryptAacSample(O,y,C,P),!P)return}}},F.getAvcEncryptedData=function(O){for(var y=Math.floor((O.length-48)/160)*16+16,C=new Int8Array(y),P=0,u=32;u<=O.length-16;u+=160,P+=16)C.set(O.subarray(u,u+16),P);return C},F.getAvcDecryptedUnit=function(O,y){for(var C=new Uint8Array(y),P=0,u=32;u<=O.length-16;u+=160,P+=16)O.set(C.subarray(P,P+16),u);return O},F.decryptAvcSample=function(O,y,C,P,u,d){var E=Object(k.discardEPB)(u.data),c=this.getAvcEncryptedData(E),a=this;this.decryptBuffer(c.buffer,function(i){u.data=a.getAvcDecryptedUnit(E,i),d||a.decryptAvcSamples(O,y,C+1,P)})},F.decryptAvcSamples=function(O,y,C,P){if(O instanceof Uint8Array)throw new Error("Cannot decrypt samples of type Uint8Array");for(;;y++,C=0){if(y>=O.length){P();return}for(var u=O[y].units;!(C>=u.length);C++){var d=u[C];if(!(d.data.length<=48||d.type!==1&&d.type!==5)){var E=this.decrypter.isSync();if(this.decryptAvcSample(O,y,C,P,d,E),!E)return}}}},j}();K.default=x},"./src/demux/transmuxer-interface.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"default",function(){return u});var H=M("./node_modules/webworkify-webpack/index.js"),k=M.n(H),x=M("./src/events.ts"),j=M("./src/demux/transmuxer.ts"),F=M("./src/utils/logger.ts"),R=M("./src/errors.ts"),O=M("./src/utils/mediasource-helper.ts"),y=M("./node_modules/eventemitter3/index.js"),C=M.n(y),P=Object(O.getMediaSource)()||{isTypeSupported:function(){return!1}},u=function(){function d(c,a,i,l){var p=this;this.hls=void 0,this.id=void 0,this.observer=void 0,this.frag=null,this.part=null,this.worker=void 0,this.onwmsg=void 0,this.transmuxer=null,this.onTransmuxComplete=void 0,this.onFlush=void 0,this.hls=c,this.id=a,this.onTransmuxComplete=i,this.onFlush=l;var f=c.config,h=function(n,s){s=s||{},s.frag=p.frag,s.id=p.id,c.trigger(n,s)};this.observer=new y.EventEmitter,this.observer.on(x.Events.FRAG_DECRYPTED,h),this.observer.on(x.Events.ERROR,h);var m={mp4:P.isTypeSupported("video/mp4"),mpeg:P.isTypeSupported("audio/mpeg"),mp3:P.isTypeSupported('audio/mp4; codecs="mp3"')},L=navigator.vendor;if(f.enableWorker&&typeof Worker!="undefined"){F.logger.log("demuxing in webworker");var S;try{S=this.worker=H("./src/demux/transmuxer-worker.ts"),this.onwmsg=this.onWorkerMessage.bind(this),S.addEventListener("message",this.onwmsg),S.onerror=function(v){c.trigger(x.Events.ERROR,{type:R.ErrorTypes.OTHER_ERROR,details:R.ErrorDetails.INTERNAL_EXCEPTION,fatal:!0,event:"demuxerWorker",error:new Error(v.message+"  ("+v.filename+":"+v.lineno+")")})},S.postMessage({cmd:"init",typeSupported:m,vendor:L,id:a,config:JSON.stringify(f)})}catch(v){F.logger.warn("Error in worker:",v),F.logger.error("Error while initializing DemuxerWorker, fallback to inline"),S&&self.URL.revokeObjectURL(S.objectURL),this.transmuxer=new j.default(this.observer,m,f,L,a),this.worker=null}}else this.transmuxer=new j.default(this.observer,m,f,L,a)}var E=d.prototype;return E.destroy=function(){var a=this.worker;if(a)a.removeEventListener("message",this.onwmsg),a.terminate(),this.worker=null;else{var i=this.transmuxer;i&&(i.destroy(),this.transmuxer=null)}var l=this.observer;l&&l.removeAllListeners(),this.observer=null},E.push=function(a,i,l,p,f,h,m,L,S,v){var n=this;S.transmuxing.start=self.performance.now();var s=this.transmuxer,A=this.worker,_=h?h.start:f.start,D=f.decryptdata,I=this.frag,w=!(I&&f.cc===I.cc),B=!(I&&S.level===I.level),N=I?S.sn-I.sn:-1,W=this.part?S.part-this.part.index:1,G=!B&&(N===1||N===0&&W===1),V=self.performance.now();(B||N||f.stats.parsing.start===0)&&(f.stats.parsing.start=V),h&&(W||!G)&&(h.stats.parsing.start=V);var X=new j.TransmuxState(w,G,L,B,_);if(!G||w){F.logger.log("[transmuxer-interface, "+f.type+"]: Starting new transmux session for sn: "+S.sn+" p: "+S.part+" level: "+S.level+" id: "+S.id+`
        discontinuity: `+w+`
        trackSwitch: `+B+`
        contiguous: `+G+`
        accurateTimeOffset: `+L+`
        timeOffset: `+_);var $=new j.TransmuxConfig(l,p,i,m,v);this.configureTransmuxer($)}if(this.frag=f,this.part=h,A)A.postMessage({cmd:"demux",data:a,decryptdata:D,chunkMeta:S,state:X},a instanceof ArrayBuffer?[a]:[]);else if(s){var q=s.push(a,D,S,X);Object(j.isPromise)(q)?q.then(function(Z){n.handleTransmuxComplete(Z)}):this.handleTransmuxComplete(q)}},E.flush=function(a){var i=this;a.transmuxing.start=self.performance.now();var l=this.transmuxer,p=this.worker;if(p)p.postMessage({cmd:"flush",chunkMeta:a});else if(l){var f=l.flush(a);Object(j.isPromise)(f)?f.then(function(h){i.handleFlushResult(h,a)}):this.handleFlushResult(f,a)}},E.handleFlushResult=function(a,i){var l=this;a.forEach(function(p){l.handleTransmuxComplete(p)}),this.onFlush(i)},E.onWorkerMessage=function(a){var i=a.data,l=this.hls;switch(i.event){case"init":{self.URL.revokeObjectURL(this.worker.objectURL);break}case"transmuxComplete":{this.handleTransmuxComplete(i.data);break}case"flush":{this.onFlush(i.data);break}default:{i.data=i.data||{},i.data.frag=this.frag,i.data.id=this.id,l.trigger(i.event,i.data);break}}},E.configureTransmuxer=function(a){var i=this.worker,l=this.transmuxer;i?i.postMessage({cmd:"configure",config:a}):l&&l.configure(a)},E.handleTransmuxComplete=function(a){a.chunkMeta.transmuxing.end=self.performance.now(),this.onTransmuxComplete(a)},d}()},"./src/demux/transmuxer-worker.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"default",function(){return R});var H=M("./src/demux/transmuxer.ts"),k=M("./src/events.ts"),x=M("./src/utils/logger.ts"),j=M("./node_modules/eventemitter3/index.js"),F=M.n(j);function R(u){var d=new j.EventEmitter,E=function(a,i){u.postMessage({event:a,data:i})};d.on(k.Events.FRAG_DECRYPTED,E),d.on(k.Events.ERROR,E),u.addEventListener("message",function(c){var a=c.data;switch(a.cmd){case"init":{var i=JSON.parse(a.config);u.transmuxer=new H.default(d,a.typeSupported,i,a.vendor,a.id),Object(x.enableLogs)(i.debug),E("init",null);break}case"configure":{u.transmuxer.configure(a.config);break}case"demux":{var l=u.transmuxer.push(a.data,a.decryptdata,a.chunkMeta,a.state);Object(H.isPromise)(l)?l.then(function(h){O(u,h)}):O(u,l);break}case"flush":{var p=a.chunkMeta,f=u.transmuxer.flush(p);Object(H.isPromise)(f)?f.then(function(h){C(u,h,p)}):C(u,f,p);break}default:break}})}function O(u,d){if(!P(d.remuxResult)){var E=[],c=d.remuxResult,a=c.audio,i=c.video;a&&y(E,a),i&&y(E,i),u.postMessage({event:"transmuxComplete",data:d},E)}}function y(u,d){d.data1&&u.push(d.data1.buffer),d.data2&&u.push(d.data2.buffer)}function C(u,d,E){d.forEach(function(c){O(u,c)}),u.postMessage({event:"flush",data:E})}function P(u){return!u.audio&&!u.video&&!u.text&&!u.id3&&!u.initSegment}},"./src/demux/transmuxer.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"default",function(){return i}),M.d(K,"isPromise",function(){return f}),M.d(K,"TransmuxConfig",function(){return h}),M.d(K,"TransmuxState",function(){return m});var H=M("./src/events.ts"),k=M("./src/errors.ts"),x=M("./src/crypt/decrypter.ts"),j=M("./src/demux/aacdemuxer.ts"),F=M("./src/demux/mp4demuxer.ts"),R=M("./src/demux/tsdemuxer.ts"),O=M("./src/demux/mp3demuxer.ts"),y=M("./src/remux/mp4-remuxer.ts"),C=M("./src/remux/passthrough-remuxer.ts"),P=M("./src/demux/chunk-cache.ts"),u=M("./src/utils/mp4-tools.ts"),d=M("./src/utils/logger.ts"),E;try{E=self.performance.now.bind(self.performance)}catch(L){d.logger.debug("Unable to use Performance API on this environment"),E=self.Date.now}var c=[{demux:R.default,remux:y.default},{demux:F.default,remux:C.default},{demux:j.default,remux:y.default},{demux:O.default,remux:y.default}],a=1024;c.forEach(function(L){var S=L.demux;a=Math.max(a,S.minProbeByteLength)});var i=function(){function L(v,n,s,A,_){this.observer=void 0,this.typeSupported=void 0,this.config=void 0,this.vendor=void 0,this.id=void 0,this.demuxer=void 0,this.remuxer=void 0,this.decrypter=void 0,this.probe=void 0,this.decryptionPromise=null,this.transmuxConfig=void 0,this.currentTransmuxState=void 0,this.cache=new P.default,this.observer=v,this.typeSupported=n,this.config=s,this.vendor=A,this.id=_}var S=L.prototype;return S.configure=function(n){this.transmuxConfig=n,this.decrypter&&this.decrypter.reset()},S.push=function(n,s,A,_){var D=this,I=A.transmuxing;I.executeStart=E();var w=new Uint8Array(n),B=this.cache,N=this.config,W=this.currentTransmuxState,G=this.transmuxConfig;_&&(this.currentTransmuxState=_);var V=l(w,s);if(V&&V.method==="AES-128"){var X=this.getDecrypter();if(N.enableSoftwareAES){var $=X.softwareDecrypt(w,V.key.buffer,V.iv.buffer);if(!$)return I.executeEnd=E(),p(A);w=new Uint8Array($)}else return this.decryptionPromise=X.webCryptoDecrypt(w,V.key.buffer,V.iv.buffer).then(function(Le){var Be=D.push(Le,null,A);return D.decryptionPromise=null,Be}),this.decryptionPromise}var q=_||W,Z=q.contiguous,ee=q.discontinuity,ie=q.trackSwitch,ue=q.accurateTimeOffset,se=q.timeOffset,le=G.audioCodec,ce=G.videoCodec,me=G.defaultInitPts,ye=G.duration,Ee=G.initSegmentData;if((ee||ie)&&this.resetInitSegment(Ee,le,ce,ye),ee&&this.resetInitialTimestamp(me),Z||this.resetContiguity(),this.needsProbing(w,ee,ie)){if(B.dataLength){var ke=B.flush();w=Object(u.appendUint8Array)(ke,w)}this.configureTransmuxer(w,G)}var Ae=this.transmux(w,V,se,ue,A),Ie=this.currentTransmuxState;return Ie.contiguous=!0,Ie.discontinuity=!1,Ie.trackSwitch=!1,I.executeEnd=E(),Ae},S.flush=function(n){var s=this,A=n.transmuxing;A.executeStart=E();var _=this.decrypter,D=this.cache,I=this.currentTransmuxState,w=this.decryptionPromise;if(w)return w.then(function(){return s.flush(n)});var B=[],N=I.timeOffset;if(_){var W=_.flush();W&&B.push(this.push(W,null,n))}var G=D.dataLength;D.reset();var V=this.demuxer,X=this.remuxer;if(!V||!X)return G>=a&&this.observer.emit(H.Events.ERROR,H.Events.ERROR,{type:k.ErrorTypes.MEDIA_ERROR,details:k.ErrorDetails.FRAG_PARSING_ERROR,fatal:!0,reason:"no demux matching with content found"}),A.executeEnd=E(),[p(n)];var $=V.flush(N);return f($)?$.then(function(q){return s.flushRemux(B,q,n),B}):(this.flushRemux(B,$,n),B)},S.flushRemux=function(n,s,A){var _=s.audioTrack,D=s.avcTrack,I=s.id3Track,w=s.textTrack,B=this.currentTransmuxState,N=B.accurateTimeOffset,W=B.timeOffset;d.logger.log("[transmuxer.ts]: Flushed fragment "+A.sn+(A.part>-1?" p: "+A.part:"")+" of level "+A.level);var G=this.remuxer.remux(_,D,I,w,W,N,!0,this.id);n.push({remuxResult:G,chunkMeta:A}),A.transmuxing.executeEnd=E()},S.resetInitialTimestamp=function(n){var s=this.demuxer,A=this.remuxer;!s||!A||(s.resetTimeStamp(n),A.resetTimeStamp(n))},S.resetContiguity=function(){var n=this.demuxer,s=this.remuxer;!n||!s||(n.resetContiguity(),s.resetNextTimestamp())},S.resetInitSegment=function(n,s,A,_){var D=this.demuxer,I=this.remuxer;!D||!I||(D.resetInitSegment(s,A,_),I.resetInitSegment(n,s,A))},S.destroy=function(){this.demuxer&&(this.demuxer.destroy(),this.demuxer=void 0),this.remuxer&&(this.remuxer.destroy(),this.remuxer=void 0)},S.transmux=function(n,s,A,_,D){var I;return s&&s.method==="SAMPLE-AES"?I=this.transmuxSampleAes(n,s,A,_,D):I=this.transmuxUnencrypted(n,A,_,D),I},S.transmuxUnencrypted=function(n,s,A,_){var D=this.demuxer.demux(n,s,!1,!this.config.progressive),I=D.audioTrack,w=D.avcTrack,B=D.id3Track,N=D.textTrack,W=this.remuxer.remux(I,w,B,N,s,A,!1,this.id);return{remuxResult:W,chunkMeta:_}},S.transmuxSampleAes=function(n,s,A,_,D){var I=this;return this.demuxer.demuxSampleAes(n,s,A).then(function(w){var B=I.remuxer.remux(w.audioTrack,w.avcTrack,w.id3Track,w.textTrack,A,_,!1,I.id);return{remuxResult:B,chunkMeta:D}})},S.configureTransmuxer=function(n,s){for(var A=this.config,_=this.observer,D=this.typeSupported,I=this.vendor,w=s.audioCodec,B=s.defaultInitPts,N=s.duration,W=s.initSegmentData,G=s.videoCodec,V,X=0,$=c.length;X<$;X++)if(c[X].demux.probe(n)){V=c[X];break}V||(d.logger.warn("Failed to find demuxer by probing frag, treating as mp4 passthrough"),V={demux:F.default,remux:C.default});var q=this.demuxer,Z=this.remuxer,ee=V.remux,ie=V.demux;(!Z||!(Z instanceof ee))&&(this.remuxer=new ee(_,A,D,I)),(!q||!(q instanceof ie))&&(this.demuxer=new ie(_,A,D),this.probe=ie.probe),this.resetInitSegment(W,w,G,N),this.resetInitialTimestamp(B)},S.needsProbing=function(n,s,A){return!this.demuxer||!this.remuxer||s||A},S.getDecrypter=function(){var n=this.decrypter;return n||(n=this.decrypter=new x.default(this.observer,this.config)),n},L}();function l(L,S){var v=null;return L.byteLength>0&&S!=null&&S.key!=null&&S.iv!==null&&S.method!=null&&(v=S),v}var p=function(S){return{remuxResult:{},chunkMeta:S}};function f(L){return"then"in L&&L.then instanceof Function}var h=function(S,v,n,s,A){this.audioCodec=void 0,this.videoCodec=void 0,this.initSegmentData=void 0,this.duration=void 0,this.defaultInitPts=void 0,this.audioCodec=S,this.videoCodec=v,this.initSegmentData=n,this.duration=s,this.defaultInitPts=A},m=function(S,v,n,s,A){this.discontinuity=void 0,this.contiguous=void 0,this.accurateTimeOffset=void 0,this.trackSwitch=void 0,this.timeOffset=void 0,this.discontinuity=S,this.contiguous=v,this.accurateTimeOffset=n,this.trackSwitch=s,this.timeOffset=A}},"./src/demux/tsdemuxer.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"discardEPB",function(){return p});var H=M("./src/demux/adts.ts"),k=M("./src/demux/mpegaudio.ts"),x=M("./src/demux/exp-golomb.ts"),j=M("./src/demux/id3.ts"),F=M("./src/demux/sample-aes.ts"),R=M("./src/events.ts"),O=M("./src/utils/mp4-tools.ts"),y=M("./src/utils/logger.ts"),C=M("./src/errors.ts"),P={video:1,audio:2,id3:3,text:4},u=function(){function f(m,L,S){this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.sampleAes=null,this.pmtParsed=!1,this.audioCodec=void 0,this.videoCodec=void 0,this._duration=0,this.aacLastPTS=null,this._initPTS=null,this._initDTS=null,this._pmtId=-1,this._avcTrack=void 0,this._audioTrack=void 0,this._id3Track=void 0,this._txtTrack=void 0,this.aacOverFlow=null,this.avcSample=null,this.remainderData=null,this.observer=m,this.config=L,this.typeSupported=S}f.probe=function(L){var S=f.syncOffset(L);return S<0?!1:(S&&y.logger.warn("MPEG2-TS detected but first sync word found @ offset "+S+", junk ahead ?"),!0)},f.syncOffset=function(L){for(var S=Math.min(1e3,L.length-3*188),v=0;v<S;){if(L[v]===71&&L[v+188]===71&&L[v+2*188]===71)return v;v++}return-1},f.createTrack=function(L,S){return{container:L==="video"||L==="audio"?"video/mp2t":void 0,type:L,id:P[L],pid:-1,inputTimeScale:9e4,sequenceNumber:0,samples:[],dropped:0,duration:L==="audio"?S:void 0}};var h=f.prototype;return h.resetInitSegment=function(L,S,v){this.pmtParsed=!1,this._pmtId=-1,this._avcTrack=f.createTrack("video",v),this._audioTrack=f.createTrack("audio",v),this._id3Track=f.createTrack("id3",v),this._txtTrack=f.createTrack("text",v),this._audioTrack.isAAC=!0,this.aacOverFlow=null,this.aacLastPTS=null,this.avcSample=null,this.audioCodec=L,this.videoCodec=S,this._duration=v},h.resetTimeStamp=function(){},h.resetContiguity=function(){var L=this._audioTrack,S=this._avcTrack,v=this._id3Track;L&&(L.pesData=null),S&&(S.pesData=null),v&&(v.pesData=null),this.aacOverFlow=null,this.aacLastPTS=null},h.demux=function(L,S,v,n){v===void 0&&(v=!1),n===void 0&&(n=!1),v||(this.sampleAes=null);var s,A=this._avcTrack,_=this._audioTrack,D=this._id3Track,I=A.pid,w=A.pesData,B=_.pid,N=D.pid,W=_.pesData,G=D.pesData,V=!1,X=this.pmtParsed,$=this._pmtId,q=L.length;if(this.remainderData&&(L=Object(O.appendUint8Array)(this.remainderData,L),q=L.length,this.remainderData=null),q<188&&!n)return this.remainderData=L,{audioTrack:_,avcTrack:A,id3Track:D,textTrack:this._txtTrack};var Z=Math.max(0,f.syncOffset(L));q-=(q+Z)%188,q<L.byteLength&&!n&&(this.remainderData=new Uint8Array(L.buffer,q,L.buffer.byteLength-q));for(var ee=Z;ee<q;ee+=188)if(L[ee]===71){var ie=!!(L[ee+1]&64),ue=((L[ee+1]&31)<<8)+L[ee+2],se=(L[ee+3]&48)>>4,le=void 0;if(se>1){if(le=ee+5+L[ee+4],le===ee+188)continue}else le=ee+4;switch(ue){case I:ie&&(w&&(s=a(w))&&this.parseAVCPES(s,!1),w={data:[],size:0}),w&&(w.data.push(L.subarray(le,ee+188)),w.size+=ee+188-le);break;case B:ie&&(W&&(s=a(W))&&(_.isAAC?this.parseAACPES(s):this.parseMPEGPES(s)),W={data:[],size:0}),W&&(W.data.push(L.subarray(le,ee+188)),W.size+=ee+188-le);break;case N:ie&&(G&&(s=a(G))&&this.parseID3PES(s),G={data:[],size:0}),G&&(G.data.push(L.subarray(le,ee+188)),G.size+=ee+188-le);break;case 0:ie&&(le+=L[le]+1),$=this._pmtId=E(L,le);break;case $:{ie&&(le+=L[le]+1);var ce=c(L,le,this.typeSupported.mpeg===!0||this.typeSupported.mp3===!0,v);I=ce.avc,I>0&&(A.pid=I),B=ce.audio,B>0&&(_.pid=B,_.isAAC=ce.isAAC),N=ce.id3,N>0&&(D.pid=N),V&&!X&&(y.logger.log("reparse from beginning"),V=!1,ee=Z-188),X=this.pmtParsed=!0;break}case 17:case 8191:break;default:V=!0;break}}else this.observer.emit(R.Events.ERROR,R.Events.ERROR,{type:C.ErrorTypes.MEDIA_ERROR,details:C.ErrorDetails.FRAG_PARSING_ERROR,fatal:!1,reason:"TS packet did not start with 0x47"});A.pesData=w,_.pesData=W,D.pesData=G;var me={audioTrack:_,avcTrack:A,id3Track:D,textTrack:this._txtTrack};return n&&this.extractRemainingSamples(me),me},h.flush=function(){var L=this.remainderData;this.remainderData=null;var S;return L?S=this.demux(L,-1,!1,!0):S={audioTrack:this._audioTrack,avcTrack:this._avcTrack,textTrack:this._txtTrack,id3Track:this._id3Track},this.extractRemainingSamples(S),this.sampleAes?this.decrypt(S,this.sampleAes):S},h.extractRemainingSamples=function(L){var S=L.audioTrack,v=L.avcTrack,n=L.id3Track,s=v.pesData,A=S.pesData,_=n.pesData,D;s&&(D=a(s))?(this.parseAVCPES(D,!0),v.pesData=null):v.pesData=s,A&&(D=a(A))?(S.isAAC?this.parseAACPES(D):this.parseMPEGPES(D),S.pesData=null):(A!=null&&A.size&&y.logger.log("last AAC PES packet truncated,might overlap between fragments"),S.pesData=A),_&&(D=a(_))?(this.parseID3PES(D),n.pesData=null):n.pesData=_},h.demuxSampleAes=function(L,S,v){var n=this.demux(L,v,!0,!this.config.progressive),s=this.sampleAes=new F.default(this.observer,this.config,S);return this.decrypt(n,s)},h.decrypt=function(L,S){return new Promise(function(v){var n=L.audioTrack,s=L.avcTrack;n.samples&&n.isAAC?S.decryptAacSamples(n.samples,0,function(){s.samples?S.decryptAvcSamples(s.samples,0,0,function(){v(L)}):v(L)}):s.samples&&S.decryptAvcSamples(s.samples,0,0,function(){v(L)})})},h.destroy=function(){this._initPTS=this._initDTS=null,this._duration=0},h.parseAVCPES=function(L,S){var v=this,n=this._avcTrack,s=this.parseAVCNALu(L.data),A=!1,_=this.avcSample,D,I=!1;L.data=null,_&&s.length&&!n.audFound&&(i(_,n),_=this.avcSample=d(!1,L.pts,L.dts,"")),s.forEach(function(w){switch(w.type){case 1:{D=!0,_||(_=v.avcSample=d(!0,L.pts,L.dts,"")),A&&(_.debug+="NDR "),_.frame=!0;var B=w.data;if(I&&B.length>4){var N=new x.default(B).readSliceType();(N===2||N===4||N===7||N===9)&&(_.key=!0)}break}case 5:D=!0,_||(_=v.avcSample=d(!0,L.pts,L.dts,"")),A&&(_.debug+="IDR "),_.key=!0,_.frame=!0;break;case 6:{D=!0,A&&_&&(_.debug+="SEI ");var W=new x.default(p(w.data));W.readUByte();for(var G=0,V=0,X=!1,$=0;!X&&W.bytesAvailable>1;){G=0;do $=W.readUByte(),G+=$;while($===255);V=0;do $=W.readUByte(),V+=$;while($===255);if(G===4&&W.bytesAvailable!==0){X=!0;var q=W.readUByte();if(q===181){var Z=W.readUShort();if(Z===49){var ee=W.readUInt();if(ee===1195456820){var ie=W.readUByte();if(ie===3){for(var ue=W.readUByte(),se=W.readUByte(),le=31&ue,ce=[ue,se],me=0;me<le;me++)ce.push(W.readUByte()),ce.push(W.readUByte()),ce.push(W.readUByte());l(v._txtTrack.samples,{type:3,pts:L.pts,bytes:ce})}}}}}else if(G===5&&W.bytesAvailable!==0){if(X=!0,V>16){for(var ye=[],Ee=0;Ee<16;Ee++)ye.push(W.readUByte().toString(16)),(Ee===3||Ee===5||Ee===7||Ee===9)&&ye.push("-");for(var ke=V-16,Ae=new Uint8Array(ke),Ie=0;Ie<ke;Ie++)Ae[Ie]=W.readUByte();l(v._txtTrack.samples,{pts:L.pts,payloadType:G,uuid:ye.join(""),userData:Object(j.utf8ArrayToStr)(Ae),userDataBytes:Ae})}}else if(V<W.bytesAvailable)for(var Le=0;Le<V;Le++)W.readUByte()}break}case 7:if(D=!0,I=!0,A&&_&&(_.debug+="SPS "),!n.sps){var Be=new x.default(w.data),Ne=Be.readSPS();n.width=Ne.width,n.height=Ne.height,n.pixelRatio=Ne.pixelRatio,n.sps=[w.data],n.duration=v._duration;for(var Ke=w.data.subarray(1,4),Te="avc1.",de=0;de<3;de++){var ge=Ke[de].toString(16);ge.length<2&&(ge="0"+ge),Te+=ge}n.codec=Te}break;case 8:D=!0,A&&_&&(_.debug+="PPS "),n.pps||(n.pps=[w.data]);break;case 9:D=!1,n.audFound=!0,_&&i(_,n),_=v.avcSample=d(!1,L.pts,L.dts,A?"AUD ":"");break;case 12:D=!1;break;default:D=!1,_&&(_.debug+="unknown NAL "+w.type+" ");break}if(_&&D){var ve=_.units;ve.push(w)}}),S&&_&&(i(_,n),this.avcSample=null)},h.getLastNalUnit=function(){var L,S=this.avcSample,v;if(!S||S.units.length===0){var n=this._avcTrack.samples;S=n[n.length-1]}if((L=S)!==null&&L!==void 0&&L.units){var s=S.units;v=s[s.length-1]}return v},h.parseAVCNALu=function(L){var S=L.byteLength,v=this._avcTrack,n=v.naluState||0,s=n,A=[],_=0,D,I,w,B=-1,N=0;for(n===-1&&(B=0,N=L[0]&31,n=0,_=1);_<S;){if(D=L[_++],!n){n=D?0:1;continue}if(n===1){n=D?0:2;continue}if(!D)n=3;else if(D===1){if(B>=0){var W={data:L.subarray(B,_-n-1),type:N};A.push(W)}else{var G=this.getLastNalUnit();if(G&&(s&&_<=4-s&&G.state&&(G.data=G.data.subarray(0,G.data.byteLength-s)),I=_-n-1,I>0)){var V=new Uint8Array(G.data.byteLength+I);V.set(G.data,0),V.set(L.subarray(0,I),G.data.byteLength),G.data=V}}_<S?(w=L[_]&31,B=_,N=w,n=0):n=-1}else n=0}if(B>=0&&n>=0){var X={data:L.subarray(B,S),type:N,state:n};A.push(X)}if(A.length===0){var $=this.getLastNalUnit();if($){var q=new Uint8Array($.data.byteLength+L.byteLength);q.set($.data,0),q.set(L,$.data.byteLength),$.data=q}}return v.naluState=n,A},h.parseAACPES=function(L){var S=0,v=this._audioTrack,n=this.aacOverFlow,s=L.data;if(n){this.aacOverFlow=null;var A=n.sample.unit.byteLength,_=Math.min(n.missing,A),D=A-_;n.sample.unit.set(s.subarray(0,_),D),v.samples.push(n.sample),S=n.missing}var I,w;for(I=S,w=s.length;I<w-1&&!H.isHeader(s,I);I++);if(I!==S){var B,N;if(I<w-1?(B="AAC PES did not start with ADTS header,offset:"+I,N=!1):(B="no ADTS header found in AAC PES",N=!0),y.logger.warn("parsing error:"+B),this.observer.emit(R.Events.ERROR,R.Events.ERROR,{type:C.ErrorTypes.MEDIA_ERROR,details:C.ErrorDetails.FRAG_PARSING_ERROR,fatal:N,reason:B}),N)return}H.initTrackConfig(v,this.observer,s,I,this.audioCodec);var W;if(L.pts!==void 0)W=L.pts;else if(n){var G=H.getFrameDuration(v.samplerate);W=n.sample.pts+G}else{y.logger.warn("[tsdemuxer]: AAC PES unknown PTS");return}for(var V=0;I<w;)if(H.isHeader(s,I)){if(I+5<w){var X=H.appendFrame(v,s,I,W,V);if(X)if(X.missing)this.aacOverFlow=X;else{I+=X.length,V++;continue}}break}else I++},h.parseMPEGPES=function(L){var S=L.data,v=S.length,n=0,s=0,A=L.pts;if(A===void 0){y.logger.warn("[tsdemuxer]: MPEG PES unknown PTS");return}for(;s<v;)if(k.isHeader(S,s)){var _=k.appendFrame(this._audioTrack,S,s,A,n);if(_)s+=_.length,n++;else break}else s++},h.parseID3PES=function(L){if(L.pts===void 0){y.logger.warn("[tsdemuxer]: ID3 PES unknown PTS");return}this._id3Track.samples.push(L)},f}();u.minProbeByteLength=188;function d(f,h,m,L){return{key:f,frame:!1,pts:h,dts:m,units:[],debug:L,length:0}}function E(f,h){return(f[h+10]&31)<<8|f[h+11]}function c(f,h,m,L){var S={audio:-1,avc:-1,id3:-1,isAAC:!0},v=(f[h+1]&15)<<8|f[h+2],n=h+3+v-4,s=(f[h+10]&15)<<8|f[h+11];for(h+=12+s;h<n;){var A=(f[h+1]&31)<<8|f[h+2];switch(f[h]){case 207:if(!L){y.logger.log("ADTS AAC with AES-128-CBC frame encryption found in unencrypted stream");break}case 15:S.audio===-1&&(S.audio=A);break;case 21:S.id3===-1&&(S.id3=A);break;case 219:if(!L){y.logger.log("H.264 with AES-128-CBC slice encryption found in unencrypted stream");break}case 27:S.avc===-1&&(S.avc=A);break;case 3:case 4:m?S.audio===-1&&(S.audio=A,S.isAAC=!1):y.logger.log("MPEG audio found, not supported in this browser");break;case 36:y.logger.warn("Unsupported HEVC stream type found");break;default:break}h+=((f[h+3]&15)<<8|f[h+4])+5}return S}function a(f){var h=0,m,L,S,v,n,s=f.data;if(!f||f.size===0)return null;for(;s[0].length<19&&s.length>1;){var A=new Uint8Array(s[0].length+s[1].length);A.set(s[0]),A.set(s[1],s[0].length),s[0]=A,s.splice(1,1)}m=s[0];var _=(m[0]<<16)+(m[1]<<8)+m[2];if(_===1){if(L=(m[4]<<8)+m[5],L&&L>f.size-6)return null;var D=m[7];D&192&&(v=(m[9]&14)*536870912+(m[10]&255)*4194304+(m[11]&254)*16384+(m[12]&255)*128+(m[13]&254)/2,D&64?(n=(m[14]&14)*536870912+(m[15]&255)*4194304+(m[16]&254)*16384+(m[17]&255)*128+(m[18]&254)/2,v-n>60*9e4&&(y.logger.warn(Math.round((v-n)/9e4)+"s delta between PTS and DTS, align them"),v=n)):n=v),S=m[8];var I=S+9;if(f.size<=I)return null;f.size-=I;for(var w=new Uint8Array(f.size),B=0,N=s.length;B<N;B++){m=s[B];var W=m.byteLength;if(I)if(I>W){I-=W;continue}else m=m.subarray(I),W-=I,I=0;w.set(m,h),h+=W}return L&&(L-=S+3),{data:w,pts:v,dts:n,len:L}}return null}function i(f,h){if(f.units.length&&f.frame){if(f.pts===void 0){var m=h.samples,L=m.length;if(L){var S=m[L-1];f.pts=S.pts,f.dts=S.dts}else{h.dropped++;return}}h.samples.push(f)}f.debug.length&&y.logger.log(f.pts+"/"+f.dts+":"+f.debug)}function l(f,h){var m=f.length;if(m>0){if(h.pts>=f[m-1].pts)f.push(h);else for(var L=m-1;L>=0;L--)if(h.pts<f[L].pts){f.splice(L,0,h);break}}else f.push(h)}function p(f){for(var h=f.byteLength,m=[],L=1;L<h-2;)f[L]===0&&f[L+1]===0&&f[L+2]===3?(m.push(L+2),L+=2):L++;if(m.length===0)return f;var S=h-m.length,v=new Uint8Array(S),n=0;for(L=0;L<S;n++,L++)n===m[0]&&(n++,m.shift()),v[L]=f[n];return v}K.default=u},"./src/errors.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"ErrorTypes",function(){return H}),M.d(K,"ErrorDetails",function(){return k});var H;(function(x){x.NETWORK_ERROR="networkError",x.MEDIA_ERROR="mediaError",x.KEY_SYSTEM_ERROR="keySystemError",x.MUX_ERROR="muxError",x.OTHER_ERROR="otherError"})(H||(H={}));var k;(function(x){x.KEY_SYSTEM_NO_KEYS="keySystemNoKeys",x.KEY_SYSTEM_NO_ACCESS="keySystemNoAccess",x.KEY_SYSTEM_NO_SESSION="keySystemNoSession",x.KEY_SYSTEM_LICENSE_REQUEST_FAILED="keySystemLicenseRequestFailed",x.KEY_SYSTEM_NO_INIT_DATA="keySystemNoInitData",x.MANIFEST_LOAD_ERROR="manifestLoadError",x.MANIFEST_LOAD_TIMEOUT="manifestLoadTimeOut",x.MANIFEST_PARSING_ERROR="manifestParsingError",x.MANIFEST_INCOMPATIBLE_CODECS_ERROR="manifestIncompatibleCodecsError",x.LEVEL_EMPTY_ERROR="levelEmptyError",x.LEVEL_LOAD_ERROR="levelLoadError",x.LEVEL_LOAD_TIMEOUT="levelLoadTimeOut",x.LEVEL_SWITCH_ERROR="levelSwitchError",x.AUDIO_TRACK_LOAD_ERROR="audioTrackLoadError",x.AUDIO_TRACK_LOAD_TIMEOUT="audioTrackLoadTimeOut",x.SUBTITLE_LOAD_ERROR="subtitleTrackLoadError",x.SUBTITLE_TRACK_LOAD_TIMEOUT="subtitleTrackLoadTimeOut",x.FRAG_LOAD_ERROR="fragLoadError",x.FRAG_LOAD_TIMEOUT="fragLoadTimeOut",x.FRAG_DECRYPT_ERROR="fragDecryptError",x.FRAG_PARSING_ERROR="fragParsingError",x.REMUX_ALLOC_ERROR="remuxAllocError",x.KEY_LOAD_ERROR="keyLoadError",x.KEY_LOAD_TIMEOUT="keyLoadTimeOut",x.BUFFER_ADD_CODEC_ERROR="bufferAddCodecError",x.BUFFER_INCOMPATIBLE_CODECS_ERROR="bufferIncompatibleCodecsError",x.BUFFER_APPEND_ERROR="bufferAppendError",x.BUFFER_APPENDING_ERROR="bufferAppendingError",x.BUFFER_STALLED_ERROR="bufferStalledError",x.BUFFER_FULL_ERROR="bufferFullError",x.BUFFER_SEEK_OVER_HOLE="bufferSeekOverHole",x.BUFFER_NUDGE_ON_STALL="bufferNudgeOnStall",x.INTERNAL_EXCEPTION="internalException",x.INTERNAL_ABORTED="aborted",x.UNKNOWN="unknown"})(k||(k={}))},"./src/events.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"Events",function(){return H});var H;(function(k){k.MEDIA_ATTACHING="hlsMediaAttaching",k.MEDIA_ATTACHED="hlsMediaAttached",k.MEDIA_DETACHING="hlsMediaDetaching",k.MEDIA_DETACHED="hlsMediaDetached",k.BUFFER_RESET="hlsBufferReset",k.BUFFER_CODECS="hlsBufferCodecs",k.BUFFER_CREATED="hlsBufferCreated",k.BUFFER_APPENDING="hlsBufferAppending",k.BUFFER_APPENDED="hlsBufferAppended",k.BUFFER_EOS="hlsBufferEos",k.BUFFER_FLUSHING="hlsBufferFlushing",k.BUFFER_FLUSHED="hlsBufferFlushed",k.MANIFEST_LOADING="hlsManifestLoading",k.MANIFEST_LOADED="hlsManifestLoaded",k.MANIFEST_PARSED="hlsManifestParsed",k.LEVEL_SWITCHING="hlsLevelSwitching",k.LEVEL_SWITCHED="hlsLevelSwitched",k.LEVEL_LOADING="hlsLevelLoading",k.LEVEL_LOADED="hlsLevelLoaded",k.LEVEL_UPDATED="hlsLevelUpdated",k.LEVEL_PTS_UPDATED="hlsLevelPtsUpdated",k.LEVELS_UPDATED="hlsLevelsUpdated",k.AUDIO_TRACKS_UPDATED="hlsAudioTracksUpdated",k.AUDIO_TRACK_SWITCHING="hlsAudioTrackSwitching",k.AUDIO_TRACK_SWITCHED="hlsAudioTrackSwitched",k.AUDIO_TRACK_LOADING="hlsAudioTrackLoading",k.AUDIO_TRACK_LOADED="hlsAudioTrackLoaded",k.SUBTITLE_TRACKS_UPDATED="hlsSubtitleTracksUpdated",k.SUBTITLE_TRACKS_CLEARED="hlsSubtitleTracksCleared",k.SUBTITLE_TRACK_SWITCH="hlsSubtitleTrackSwitch",k.SUBTITLE_TRACK_LOADING="hlsSubtitleTrackLoading",k.SUBTITLE_TRACK_LOADED="hlsSubtitleTrackLoaded",k.SUBTITLE_FRAG_PROCESSED="hlsSubtitleFragProcessed",k.CUES_PARSED="hlsCuesParsed",k.NON_NATIVE_TEXT_TRACKS_FOUND="hlsNonNativeTextTracksFound",k.INIT_PTS_FOUND="hlsInitPtsFound",k.FRAG_LOADING="hlsFragLoading",k.FRAG_LOAD_EMERGENCY_ABORTED="hlsFragLoadEmergencyAborted",k.FRAG_LOADED="hlsFragLoaded",k.FRAG_DECRYPTED="hlsFragDecrypted",k.FRAG_PARSING_INIT_SEGMENT="hlsFragParsingInitSegment",k.FRAG_PARSING_USERDATA="hlsFragParsingUserdata",k.FRAG_PARSING_METADATA="hlsFragParsingMetadata",k.FRAG_PARSED="hlsFragParsed",k.FRAG_BUFFERED="hlsFragBuffered",k.FRAG_CHANGED="hlsFragChanged",k.FPS_DROP="hlsFpsDrop",k.FPS_DROP_LEVEL_CAPPING="hlsFpsDropLevelCapping",k.ERROR="hlsError",k.DESTROYING="hlsDestroying",k.KEY_LOADING="hlsKeyLoading",k.KEY_LOADED="hlsKeyLoaded",k.LIVE_BACK_BUFFER_REACHED="hlsLiveBackBufferReached",k.BACK_BUFFER_REACHED="hlsBackBufferReached"})(H||(H={}))},"./src/hls.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"default",function(){return f});var H=M("./node_modules/url-toolkit/src/url-toolkit.js"),k=M.n(H),x=M("./src/loader/playlist-loader.ts"),j=M("./src/loader/key-loader.ts"),F=M("./src/controller/id3-track-controller.ts"),R=M("./src/controller/latency-controller.ts"),O=M("./src/controller/level-controller.ts"),y=M("./src/controller/fragment-tracker.ts"),C=M("./src/controller/stream-controller.ts"),P=M("./src/is-supported.ts"),u=M("./src/utils/logger.ts"),d=M("./src/config.ts"),E=M("./node_modules/eventemitter3/index.js"),c=M.n(E),a=M("./src/events.ts"),i=M("./src/errors.ts");function l(h,m){for(var L=0;L<m.length;L++){var S=m[L];S.enumerable=S.enumerable||!1,S.configurable=!0,"value"in S&&(S.writable=!0),Object.defineProperty(h,S.key,S)}}function p(h,m,L){return m&&l(h.prototype,m),L&&l(h,L),h}var f=function(){h.isSupported=function(){return Object(P.isSupported)()};function h(L){L===void 0&&(L={}),this.config=void 0,this.userConfig=void 0,this.coreComponents=void 0,this.networkControllers=void 0,this._emitter=new E.EventEmitter,this._autoLevelCapping=void 0,this.abrController=void 0,this.bufferController=void 0,this.capLevelController=void 0,this.latencyController=void 0,this.levelController=void 0,this.streamController=void 0,this.audioTrackController=void 0,this.subtitleTrackController=void 0,this.emeController=void 0,this._media=null,this.url=null;var S=this.config=Object(d.mergeConfig)(h.DefaultConfig,L);this.userConfig=L,Object(u.enableLogs)(S.debug),this._autoLevelCapping=-1,S.progressive&&Object(d.enableStreamingMode)(S);var v=S.abrController,n=S.bufferController,s=S.capLevelController,A=S.fpsController,_=this.abrController=new v(this),D=this.bufferController=new n(this),I=this.capLevelController=new s(this),w=new A(this),B=new x.default(this),N=new j.default(this),W=new F.default(this),G=this.levelController=new O.default(this),V=new y.FragmentTracker(this),X=this.streamController=new C.default(this,V);I.setStreamController(X),w.setStreamController(X);var $=[G,X];this.networkControllers=$;var q=[B,N,_,D,I,w,W,V];this.audioTrackController=this.createController(S.audioTrackController,null,$),this.createController(S.audioStreamController,V,$),this.subtitleTrackController=this.createController(S.subtitleTrackController,null,$),this.createController(S.subtitleStreamController,V,$),this.createController(S.timelineController,null,q),this.emeController=this.createController(S.emeController,null,q),this.latencyController=this.createController(R.default,null,q),this.coreComponents=q}var m=h.prototype;return m.createController=function(S,v,n){if(S){var s=v?new S(this,v):new S(this);return n&&n.push(s),s}return null},m.on=function(S,v,n){n===void 0&&(n=this),this._emitter.on(S,v,n)},m.once=function(S,v,n){n===void 0&&(n=this),this._emitter.once(S,v,n)},m.removeAllListeners=function(S){this._emitter.removeAllListeners(S)},m.off=function(S,v,n,s){n===void 0&&(n=this),this._emitter.off(S,v,n,s)},m.listeners=function(S){return this._emitter.listeners(S)},m.emit=function(S,v,n){return this._emitter.emit(S,v,n)},m.trigger=function(S,v){if(this.config.debug)return this.emit(S,S,v);try{return this.emit(S,S,v)}catch(n){u.logger.error("An internal error happened while handling event "+S+'. Error message: "'+n.message+'". Here is a stacktrace:',n),this.trigger(a.Events.ERROR,{type:i.ErrorTypes.OTHER_ERROR,details:i.ErrorDetails.INTERNAL_EXCEPTION,fatal:!1,event:S,error:n})}return!1},m.listenerCount=function(S){return this._emitter.listenerCount(S)},m.destroy=function(){u.logger.log("destroy"),this.trigger(a.Events.DESTROYING,void 0),this.detachMedia(),this.removeAllListeners(),this._autoLevelCapping=-1,this.url=null,this.networkControllers.forEach(function(S){return S.destroy()}),this.networkControllers.length=0,this.coreComponents.forEach(function(S){return S.destroy()}),this.coreComponents.length=0},m.attachMedia=function(S){u.logger.log("attachMedia"),this._media=S,this.trigger(a.Events.MEDIA_ATTACHING,{media:S})},m.detachMedia=function(){u.logger.log("detachMedia"),this.trigger(a.Events.MEDIA_DETACHING,void 0),this._media=null},m.loadSource=function(S){this.stopLoad();var v=this.media,n=this.url,s=this.url=H.buildAbsoluteURL(self.location.href,S,{alwaysNormalize:!0});u.logger.log("loadSource:"+s),v&&n&&n!==s&&this.bufferController.hasSourceTypes()&&(this.detachMedia(),this.attachMedia(v)),this.trigger(a.Events.MANIFEST_LOADING,{url:S})},m.startLoad=function(S){S===void 0&&(S=-1),u.logger.log("startLoad("+S+")"),this.networkControllers.forEach(function(v){v.startLoad(S)})},m.stopLoad=function(){u.logger.log("stopLoad"),this.networkControllers.forEach(function(S){S.stopLoad()})},m.swapAudioCodec=function(){u.logger.log("swapAudioCodec"),this.streamController.swapAudioCodec()},m.recoverMediaError=function(){u.logger.log("recoverMediaError");var S=this._media;this.detachMedia(),S&&this.attachMedia(S)},m.removeLevel=function(S,v){v===void 0&&(v=0),this.levelController.removeLevel(S,v)},p(h,[{key:"levels",get:function(){var S=this.levelController.levels;return S||[]}},{key:"currentLevel",get:function(){return this.streamController.currentLevel},set:function(S){u.logger.log("set currentLevel:"+S),this.loadLevel=S,this.abrController.clearTimer(),this.streamController.immediateLevelSwitch()}},{key:"nextLevel",get:function(){return this.streamController.nextLevel},set:function(S){u.logger.log("set nextLevel:"+S),this.levelController.manualLevel=S,this.streamController.nextLevelSwitch()}},{key:"loadLevel",get:function(){return this.levelController.level},set:function(S){u.logger.log("set loadLevel:"+S),this.levelController.manualLevel=S}},{key:"nextLoadLevel",get:function(){return this.levelController.nextLoadLevel},set:function(S){this.levelController.nextLoadLevel=S}},{key:"firstLevel",get:function(){return Math.max(this.levelController.firstLevel,this.minAutoLevel)},set:function(S){u.logger.log("set firstLevel:"+S),this.levelController.firstLevel=S}},{key:"startLevel",get:function(){return this.levelController.startLevel},set:function(S){u.logger.log("set startLevel:"+S),S!==-1&&(S=Math.max(S,this.minAutoLevel)),this.levelController.startLevel=S}},{key:"capLevelToPlayerSize",get:function(){return this.config.capLevelToPlayerSize},set:function(S){var v=!!S;v!==this.config.capLevelToPlayerSize&&(v?this.capLevelController.startCapping():(this.capLevelController.stopCapping(),this.autoLevelCapping=-1,this.streamController.nextLevelSwitch()),this.config.capLevelToPlayerSize=v)}},{key:"autoLevelCapping",get:function(){return this._autoLevelCapping},set:function(S){this._autoLevelCapping!==S&&(u.logger.log("set autoLevelCapping:"+S),this._autoLevelCapping=S)}},{key:"bandwidthEstimate",get:function(){var S=this.abrController.bwEstimator;return S?S.getEstimate():NaN}},{key:"autoLevelEnabled",get:function(){return this.levelController.manualLevel===-1}},{key:"manualLevel",get:function(){return this.levelController.manualLevel}},{key:"minAutoLevel",get:function(){var S=this.levels,v=this.config.minAutoBitrate;if(!S)return 0;for(var n=S.length,s=0;s<n;s++)if(S[s].maxBitrate>v)return s;return 0}},{key:"maxAutoLevel",get:function(){var S=this.levels,v=this.autoLevelCapping,n;return v===-1&&S&&S.length?n=S.length-1:n=v,n}},{key:"nextAutoLevel",get:function(){return Math.min(Math.max(this.abrController.nextAutoLevel,this.minAutoLevel),this.maxAutoLevel)},set:function(S){this.abrController.nextAutoLevel=Math.max(this.minAutoLevel,S)}},{key:"audioTracks",get:function(){var S=this.audioTrackController;return S?S.audioTracks:[]}},{key:"audioTrack",get:function(){var S=this.audioTrackController;return S?S.audioTrack:-1},set:function(S){var v=this.audioTrackController;v&&(v.audioTrack=S)}},{key:"subtitleTracks",get:function(){var S=this.subtitleTrackController;return S?S.subtitleTracks:[]}},{key:"subtitleTrack",get:function(){var S=this.subtitleTrackController;return S?S.subtitleTrack:-1},set:function(S){var v=this.subtitleTrackController;v&&(v.subtitleTrack=S)}},{key:"media",get:function(){return this._media}},{key:"subtitleDisplay",get:function(){var S=this.subtitleTrackController;return S?S.subtitleDisplay:!1},set:function(S){var v=this.subtitleTrackController;v&&(v.subtitleDisplay=S)}},{key:"lowLatencyMode",get:function(){return this.config.lowLatencyMode},set:function(S){this.config.lowLatencyMode=S}},{key:"liveSyncPosition",get:function(){return this.latencyController.liveSyncPosition}},{key:"latency",get:function(){return this.latencyController.latency}},{key:"maxLatency",get:function(){return this.latencyController.maxLatency}},{key:"targetLatency",get:function(){return this.latencyController.targetLatency}},{key:"drift",get:function(){return this.latencyController.drift}},{key:"forceStartLoad",get:function(){return this.streamController.forceStartLoad}}],[{key:"version",get:function(){return"1.0.7"}},{key:"Events",get:function(){return a.Events}},{key:"ErrorTypes",get:function(){return i.ErrorTypes}},{key:"ErrorDetails",get:function(){return i.ErrorDetails}},{key:"DefaultConfig",get:function(){return h.defaultConfig?h.defaultConfig:d.hlsDefaultConfig},set:function(S){h.defaultConfig=S}}]),h}();f.defaultConfig=void 0},"./src/is-supported.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"isSupported",function(){return x}),M.d(K,"changeTypeSupported",function(){return j});var H=M("./src/utils/mediasource-helper.ts");function k(){return self.SourceBuffer||self.WebKitSourceBuffer}function x(){var F=Object(H.getMediaSource)();if(!F)return!1;var R=k(),O=F&&typeof F.isTypeSupported=="function"&&F.isTypeSupported('video/mp4; codecs="avc1.42E01E,mp4a.40.2"'),y=!R||R.prototype&&typeof R.prototype.appendBuffer=="function"&&typeof R.prototype.remove=="function";return!!O&&!!y}function j(){var F,R=k();return typeof(R==null||(F=R.prototype)===null||F===void 0?void 0:F.changeType)=="function"}},"./src/loader/fragment-loader.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"default",function(){return u}),M.d(K,"LoadError",function(){return E});var H=M("./src/polyfills/number.ts"),k=M("./src/errors.ts");function x(c,a){c.prototype=Object.create(a.prototype),c.prototype.constructor=c,y(c,a)}function j(c){var a=typeof Map=="function"?new Map:void 0;return j=function(l){if(l===null||!O(l))return l;if(typeof l!="function")throw new TypeError("Super expression must either be null or a function");if(typeof a!="undefined"){if(a.has(l))return a.get(l);a.set(l,p)}function p(){return F(l,arguments,C(this).constructor)}return p.prototype=Object.create(l.prototype,{constructor:{value:p,enumerable:!1,writable:!0,configurable:!0}}),y(p,l)},j(c)}function F(c,a,i){return R()?F=Reflect.construct:F=function(p,f,h){var m=[null];m.push.apply(m,f);var L=Function.bind.apply(p,m),S=new L;return h&&y(S,h.prototype),S},F.apply(null,arguments)}function R(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(c){return!1}}function O(c){return Function.toString.call(c).indexOf("[native code]")!==-1}function y(c,a){return y=Object.setPrototypeOf||function(l,p){return l.__proto__=p,l},y(c,a)}function C(c){return C=Object.setPrototypeOf?Object.getPrototypeOf:function(i){return i.__proto__||Object.getPrototypeOf(i)},C(c)}var P=Math.pow(2,17),u=function(){function c(i){this.config=void 0,this.loader=null,this.partLoadTimeout=-1,this.config=i}var a=c.prototype;return a.destroy=function(){this.loader&&(this.loader.destroy(),this.loader=null)},a.abort=function(){this.loader&&this.loader.abort()},a.load=function(l,p){var f=this,h=l.url;if(!h)return Promise.reject(new E({type:k.ErrorTypes.NETWORK_ERROR,details:k.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:l,networkDetails:null},"Fragment does not have a "+(h?"part list":"url")));this.abort();var m=this.config,L=m.fLoader,S=m.loader;return new Promise(function(v,n){f.loader&&f.loader.destroy();var s=f.loader=l.loader=L?new L(m):new S(m),A=d(l),_={timeout:m.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:m.fragLoadingMaxRetryTimeout,highWaterMark:P};l.stats=s.stats,s.load(A,_,{onSuccess:function(I,w,B,N){f.resetLoader(l,s),v({frag:l,part:null,payload:I.data,networkDetails:N})},onError:function(I,w,B){f.resetLoader(l,s),n(new E({type:k.ErrorTypes.NETWORK_ERROR,details:k.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:l,response:I,networkDetails:B}))},onAbort:function(I,w,B){f.resetLoader(l,s),n(new E({type:k.ErrorTypes.NETWORK_ERROR,details:k.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:l,networkDetails:B}))},onTimeout:function(I,w,B){f.resetLoader(l,s),n(new E({type:k.ErrorTypes.NETWORK_ERROR,details:k.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:l,networkDetails:B}))},onProgress:function(I,w,B,N){p&&p({frag:l,part:null,payload:B,networkDetails:N})}})})},a.loadPart=function(l,p,f){var h=this;this.abort();var m=this.config,L=m.fLoader,S=m.loader;return new Promise(function(v,n){h.loader&&h.loader.destroy();var s=h.loader=l.loader=L?new L(m):new S(m),A=d(l,p),_={timeout:m.fragLoadingTimeOut,maxRetry:0,retryDelay:0,maxRetryDelay:m.fragLoadingMaxRetryTimeout,highWaterMark:P};p.stats=s.stats,s.load(A,_,{onSuccess:function(I,w,B,N){h.resetLoader(l,s),h.updateStatsFromPart(l,p);var W={frag:l,part:p,payload:I.data,networkDetails:N};f(W),v(W)},onError:function(I,w,B){h.resetLoader(l,s),n(new E({type:k.ErrorTypes.NETWORK_ERROR,details:k.ErrorDetails.FRAG_LOAD_ERROR,fatal:!1,frag:l,part:p,response:I,networkDetails:B}))},onAbort:function(I,w,B){l.stats.aborted=p.stats.aborted,h.resetLoader(l,s),n(new E({type:k.ErrorTypes.NETWORK_ERROR,details:k.ErrorDetails.INTERNAL_ABORTED,fatal:!1,frag:l,part:p,networkDetails:B}))},onTimeout:function(I,w,B){h.resetLoader(l,s),n(new E({type:k.ErrorTypes.NETWORK_ERROR,details:k.ErrorDetails.FRAG_LOAD_TIMEOUT,fatal:!1,frag:l,part:p,networkDetails:B}))}})})},a.updateStatsFromPart=function(l,p){var f=l.stats,h=p.stats,m=h.total;if(f.loaded+=h.loaded,m){var L=Math.round(l.duration/p.duration),S=Math.min(Math.round(f.loaded/m),L),v=L-S,n=v*Math.round(f.loaded/S);f.total=f.loaded+n}else f.total=Math.max(f.loaded,f.total);var s=f.loading,A=h.loading;s.start?s.first+=A.first-A.start:(s.start=A.start,s.first=A.first),s.end=A.end},a.resetLoader=function(l,p){l.loader=null,this.loader===p&&(self.clearTimeout(this.partLoadTimeout),this.loader=null),p.destroy()},c}();function d(c,a){a===void 0&&(a=null);var i=a||c,l={frag:c,part:a,responseType:"arraybuffer",url:i.url,rangeStart:0,rangeEnd:0},p=i.byteRangeStartOffset,f=i.byteRangeEndOffset;return Object(H.isFiniteNumber)(p)&&Object(H.isFiniteNumber)(f)&&(l.rangeStart=p,l.rangeEnd=f),l}var E=function(c){x(a,c);function a(i){for(var l,p=arguments.length,f=new Array(p>1?p-1:0),h=1;h<p;h++)f[h-1]=arguments[h];return l=c.call.apply(c,[this].concat(f))||this,l.data=void 0,l.data=i,l}return a}(j(Error))},"./src/loader/fragment.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"ElementaryStreamTypes",function(){return u}),M.d(K,"BaseSegment",function(){return d}),M.d(K,"Fragment",function(){return E}),M.d(K,"Part",function(){return c});var H=M("./src/polyfills/number.ts"),k=M("./node_modules/url-toolkit/src/url-toolkit.js"),x=M.n(k),j=M("./src/utils/logger.ts"),F=M("./src/loader/level-key.ts"),R=M("./src/loader/load-stats.ts");function O(a,i){a.prototype=Object.create(i.prototype),a.prototype.constructor=a,y(a,i)}function y(a,i){return y=Object.setPrototypeOf||function(p,f){return p.__proto__=f,p},y(a,i)}function C(a,i){for(var l=0;l<i.length;l++){var p=i[l];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(a,p.key,p)}}function P(a,i,l){return i&&C(a.prototype,i),l&&C(a,l),a}var u;(function(a){a.AUDIO="audio",a.VIDEO="video",a.AUDIOVIDEO="audiovideo"})(u||(u={}));var d=function(){function a(l){var p;this._byteRange=null,this._url=null,this.baseurl=void 0,this.relurl=void 0,this.elementaryStreams=(p={},p[u.AUDIO]=null,p[u.VIDEO]=null,p[u.AUDIOVIDEO]=null,p),this.baseurl=l}var i=a.prototype;return i.setByteRange=function(p,f){var h=p.split("@",2),m=[];h.length===1?m[0]=f?f.byteRangeEndOffset:0:m[0]=parseInt(h[1]),m[1]=parseInt(h[0])+m[0],this._byteRange=m},P(a,[{key:"byteRange",get:function(){return this._byteRange?this._byteRange:[]}},{key:"byteRangeStartOffset",get:function(){return this.byteRange[0]}},{key:"byteRangeEndOffset",get:function(){return this.byteRange[1]}},{key:"url",get:function(){return!this._url&&this.baseurl&&this.relurl&&(this._url=Object(k.buildAbsoluteURL)(this.baseurl,this.relurl,{alwaysNormalize:!0})),this._url||""},set:function(p){this._url=p}}]),a}(),E=function(a){O(i,a);function i(p,f){var h;return h=a.call(this,f)||this,h._decryptdata=null,h.rawProgramDateTime=null,h.programDateTime=null,h.tagList=[],h.duration=0,h.sn=0,h.levelkey=void 0,h.type=void 0,h.loader=null,h.level=-1,h.cc=0,h.startPTS=void 0,h.endPTS=void 0,h.appendedPTS=void 0,h.startDTS=void 0,h.endDTS=void 0,h.start=0,h.deltaPTS=void 0,h.maxStartPTS=void 0,h.minEndPTS=void 0,h.stats=new R.LoadStats,h.urlId=0,h.data=void 0,h.bitrateTest=!1,h.title=null,h.initSegment=null,h.type=p,h}var l=i.prototype;return l.createInitializationVector=function(f){for(var h=new Uint8Array(16),m=12;m<16;m++)h[m]=f>>8*(15-m)&255;return h},l.setDecryptDataFromLevelKey=function(f,h){var m=f;return(f==null?void 0:f.method)==="AES-128"&&f.uri&&!f.iv&&(m=F.LevelKey.fromURI(f.uri),m.method=f.method,m.iv=this.createInitializationVector(h),m.keyFormat="identity"),m},l.setElementaryStreamInfo=function(f,h,m,L,S,v){v===void 0&&(v=!1);var n=this.elementaryStreams,s=n[f];if(!s){n[f]={startPTS:h,endPTS:m,startDTS:L,endDTS:S,partial:v};return}s.startPTS=Math.min(s.startPTS,h),s.endPTS=Math.max(s.endPTS,m),s.startDTS=Math.min(s.startDTS,L),s.endDTS=Math.max(s.endDTS,S)},l.clearElementaryStreamInfo=function(){var f=this.elementaryStreams;f[u.AUDIO]=null,f[u.VIDEO]=null,f[u.AUDIOVIDEO]=null},P(i,[{key:"decryptdata",get:function(){if(!this.levelkey&&!this._decryptdata)return null;if(!this._decryptdata&&this.levelkey){var f=this.sn;typeof f!="number"&&(this.levelkey&&this.levelkey.method==="AES-128"&&!this.levelkey.iv&&j.logger.warn('missing IV for initialization segment with method="'+this.levelkey.method+'" - compliance issue'),f=0),this._decryptdata=this.setDecryptDataFromLevelKey(this.levelkey,f)}return this._decryptdata}},{key:"end",get:function(){return this.start+this.duration}},{key:"endProgramDateTime",get:function(){if(this.programDateTime===null||!Object(H.isFiniteNumber)(this.programDateTime))return null;var f=Object(H.isFiniteNumber)(this.duration)?this.duration:0;return this.programDateTime+f*1e3}},{key:"encrypted",get:function(){var f;return!!((f=this.decryptdata)!==null&&f!==void 0&&f.keyFormat&&this.decryptdata.uri)}}]),i}(d),c=function(a){O(i,a);function i(l,p,f,h,m){var L;L=a.call(this,f)||this,L.fragOffset=0,L.duration=0,L.gap=!1,L.independent=!1,L.relurl=void 0,L.fragment=void 0,L.index=void 0,L.stats=new R.LoadStats,L.duration=l.decimalFloatingPoint("DURATION"),L.gap=l.bool("GAP"),L.independent=l.bool("INDEPENDENT"),L.relurl=l.enumeratedString("URI"),L.fragment=p,L.index=h;var S=l.enumeratedString("BYTERANGE");return S&&L.setByteRange(S,m),m&&(L.fragOffset=m.fragOffset+m.duration),L}return P(i,[{key:"start",get:function(){return this.fragment.start+this.fragOffset}},{key:"end",get:function(){return this.start+this.duration}},{key:"loaded",get:function(){var p=this.elementaryStreams;return!!(p.audio||p.video||p.audiovideo)}}]),i}(d)},"./src/loader/key-loader.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"default",function(){return j});var H=M("./src/events.ts"),k=M("./src/errors.ts"),x=M("./src/utils/logger.ts"),j=function(){function F(O){this.hls=void 0,this.loaders={},this.decryptkey=null,this.decrypturl=null,this.hls=O,this._registerListeners()}var R=F.prototype;return R._registerListeners=function(){this.hls.on(H.Events.KEY_LOADING,this.onKeyLoading,this)},R._unregisterListeners=function(){this.hls.off(H.Events.KEY_LOADING,this.onKeyLoading)},R.destroy=function(){this._unregisterListeners();for(var y in this.loaders){var C=this.loaders[y];C&&C.destroy()}this.loaders={}},R.onKeyLoading=function(y,C){var P=C.frag,u=P.type,d=this.loaders[u];if(!P.decryptdata){x.logger.warn("Missing decryption data on fragment in onKeyLoading");return}var E=P.decryptdata.uri;if(E!==this.decrypturl||this.decryptkey===null){var c=this.hls.config;if(d&&(x.logger.warn("abort previous key loader for type:"+u),d.abort()),!E){x.logger.warn("key uri is falsy");return}var a=c.loader,i=P.loader=this.loaders[u]=new a(c);this.decrypturl=E,this.decryptkey=null;var l={url:E,frag:P,responseType:"arraybuffer"},p={timeout:c.fragLoadingTimeOut,maxRetry:0,retryDelay:c.fragLoadingRetryDelay,maxRetryDelay:c.fragLoadingMaxRetryTimeout,highWaterMark:0},f={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};i.load(l,p,f)}else this.decryptkey&&(P.decryptdata.key=this.decryptkey,this.hls.trigger(H.Events.KEY_LOADED,{frag:P}))},R.loadsuccess=function(y,C,P){var u=P.frag;if(!u.decryptdata){x.logger.error("after key load, decryptdata unset");return}this.decryptkey=u.decryptdata.key=new Uint8Array(y.data),u.loader=null,delete this.loaders[u.type],this.hls.trigger(H.Events.KEY_LOADED,{frag:u})},R.loaderror=function(y,C){var P=C.frag,u=P.loader;u&&u.abort(),delete this.loaders[P.type],this.hls.trigger(H.Events.ERROR,{type:k.ErrorTypes.NETWORK_ERROR,details:k.ErrorDetails.KEY_LOAD_ERROR,fatal:!1,frag:P,response:y})},R.loadtimeout=function(y,C){var P=C.frag,u=P.loader;u&&u.abort(),delete this.loaders[P.type],this.hls.trigger(H.Events.ERROR,{type:k.ErrorTypes.NETWORK_ERROR,details:k.ErrorDetails.KEY_LOAD_TIMEOUT,fatal:!1,frag:P})},F}()},"./src/loader/level-details.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"LevelDetails",function(){return F});var H=M("./src/polyfills/number.ts");function k(R,O){for(var y=0;y<O.length;y++){var C=O[y];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(R,C.key,C)}}function x(R,O,y){return O&&k(R.prototype,O),y&&k(R,y),R}var j=10,F=function(){function R(y){this.PTSKnown=!1,this.alignedSliding=!1,this.averagetargetduration=void 0,this.endCC=0,this.endSN=0,this.fragments=void 0,this.fragmentHint=void 0,this.partList=null,this.live=!0,this.ageHeader=0,this.advancedDateTime=void 0,this.updated=!0,this.advanced=!0,this.availabilityDelay=void 0,this.misses=0,this.needSidxRanges=!1,this.startCC=0,this.startSN=0,this.startTimeOffset=null,this.targetduration=0,this.totalduration=0,this.type=null,this.url=void 0,this.m3u8="",this.version=null,this.canBlockReload=!1,this.canSkipUntil=0,this.canSkipDateRanges=!1,this.skippedSegments=0,this.recentlyRemovedDateranges=void 0,this.partHoldBack=0,this.holdBack=0,this.partTarget=0,this.preloadHint=void 0,this.renditionReports=void 0,this.tuneInGoal=0,this.deltaUpdateFailed=void 0,this.driftStartTime=0,this.driftEndTime=0,this.driftStart=0,this.driftEnd=0,this.fragments=[],this.url=y}var O=R.prototype;return O.reloaded=function(C){if(!C){this.advanced=!0,this.updated=!0;return}var P=this.lastPartSn-C.lastPartSn,u=this.lastPartIndex-C.lastPartIndex;this.updated=this.endSN!==C.endSN||!!u||!!P,this.advanced=this.endSN>C.endSN||P>0||P===0&&u>0,this.updated||this.advanced?this.misses=Math.floor(C.misses*.6):this.misses=C.misses+1,this.availabilityDelay=C.availabilityDelay},x(R,[{key:"hasProgramDateTime",get:function(){return this.fragments.length?Object(H.isFiniteNumber)(this.fragments[this.fragments.length-1].programDateTime):!1}},{key:"levelTargetDuration",get:function(){return this.averagetargetduration||this.targetduration||j}},{key:"drift",get:function(){var C=this.driftEndTime-this.driftStartTime;if(C>0){var P=this.driftEnd-this.driftStart;return P*1e3/C}return 1}},{key:"edge",get:function(){return this.partEnd||this.fragmentEnd}},{key:"partEnd",get:function(){var C;return(C=this.partList)!==null&&C!==void 0&&C.length?this.partList[this.partList.length-1].end:this.fragmentEnd}},{key:"fragmentEnd",get:function(){var C;return(C=this.fragments)!==null&&C!==void 0&&C.length?this.fragments[this.fragments.length-1].end:0}},{key:"age",get:function(){return this.advancedDateTime?Math.max(Date.now()-this.advancedDateTime,0)/1e3:0}},{key:"lastPartIndex",get:function(){var C;return(C=this.partList)!==null&&C!==void 0&&C.length?this.partList[this.partList.length-1].index:-1}},{key:"lastPartSn",get:function(){var C;return(C=this.partList)!==null&&C!==void 0&&C.length?this.partList[this.partList.length-1].fragment.sn:this.endSN}}]),R}()},"./src/loader/level-key.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"LevelKey",function(){return F});var H=M("./node_modules/url-toolkit/src/url-toolkit.js"),k=M.n(H);function x(R,O){for(var y=0;y<O.length;y++){var C=O[y];C.enumerable=C.enumerable||!1,C.configurable=!0,"value"in C&&(C.writable=!0),Object.defineProperty(R,C.key,C)}}function j(R,O,y){return O&&x(R.prototype,O),y&&x(R,y),R}var F=function(){R.fromURL=function(y,C){return new R(y,C)},R.fromURI=function(y){return new R(y)};function R(O,y){this._uri=null,this.method=null,this.keyFormat=null,this.keyFormatVersions=null,this.keyID=null,this.key=null,this.iv=null,y?this._uri=Object(H.buildAbsoluteURL)(O,y,{alwaysNormalize:!0}):this._uri=O}return j(R,[{key:"uri",get:function(){return this._uri}}]),R}()},"./src/loader/load-stats.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"LoadStats",function(){return H});var H=function(){this.aborted=!1,this.loaded=0,this.retry=0,this.total=0,this.chunkCount=0,this.bwEstimate=0,this.loading={start:0,first:0,end:0},this.parsing={start:0,end:0},this.buffering={start:0,first:0,end:0}}},"./src/loader/m3u8-parser.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"default",function(){return i});var H=M("./src/polyfills/number.ts"),k=M("./node_modules/url-toolkit/src/url-toolkit.js"),x=M.n(k),j=M("./src/loader/fragment.ts"),F=M("./src/loader/level-details.ts"),R=M("./src/loader/level-key.ts"),O=M("./src/utils/attr-list.ts"),y=M("./src/utils/logger.ts"),C=M("./src/utils/codecs.ts"),P=/#EXT-X-STREAM-INF:([^\r\n]*)(?:[\r\n](?:#[^\r\n]*)?)*([^\r\n]+)|#EXT-X-SESSION-DATA:([^\r\n]*)[\r\n]+/g,u=/#EXT-X-MEDIA:(.*)/g,d=new RegExp([/#EXTINF:\s*(\d*(?:\.\d+)?)(?:,(.*)\s+)?/.source,/(?!#) *(\S[\S ]*)/.source,/#EXT-X-BYTERANGE:*(.+)/.source,/#EXT-X-PROGRAM-DATE-TIME:(.+)/.source,/#.*/.source].join("|"),"g"),E=new RegExp([/#(EXTM3U)/.source,/#EXT-X-(PLAYLIST-TYPE):(.+)/.source,/#EXT-X-(MEDIA-SEQUENCE): *(\d+)/.source,/#EXT-X-(SKIP):(.+)/.source,/#EXT-X-(TARGETDURATION): *(\d+)/.source,/#EXT-X-(KEY):(.+)/.source,/#EXT-X-(START):(.+)/.source,/#EXT-X-(ENDLIST)/.source,/#EXT-X-(DISCONTINUITY-SEQ)UENCE: *(\d+)/.source,/#EXT-X-(DIS)CONTINUITY/.source,/#EXT-X-(VERSION):(\d+)/.source,/#EXT-X-(MAP):(.+)/.source,/#EXT-X-(SERVER-CONTROL):(.+)/.source,/#EXT-X-(PART-INF):(.+)/.source,/#EXT-X-(GAP)/.source,/#EXT-X-(BITRATE):\s*(\d+)/.source,/#EXT-X-(PART):(.+)/.source,/#EXT-X-(PRELOAD-HINT):(.+)/.source,/#EXT-X-(RENDITION-REPORT):(.+)/.source,/(#)([^:]*):(.*)/.source,/(#)(.*)(?:.*)\r?\n?/.source].join("|")),c=/\.(mp4|m4s|m4v|m4a)$/i;function a(m){var L,S;return c.test((L=(S=k.parseURL(m))===null||S===void 0?void 0:S.path)!=null?L:"")}var i=function(){function m(){}return m.findGroup=function(S,v){for(var n=0;n<S.length;n++){var s=S[n];if(s.id===v)return s}},m.convertAVC1ToAVCOTI=function(S){var v=S.split(".");if(v.length>2){var n=v.shift()+".";return n+=parseInt(v.shift()).toString(16),n+=("000"+parseInt(v.shift()).toString(16)).substr(-4),n}return S},m.resolve=function(S,v){return k.buildAbsoluteURL(v,S,{alwaysNormalize:!0})},m.parseMasterPlaylist=function(S,v){var n=[],s={},A=!1;P.lastIndex=0;for(var _;(_=P.exec(S))!=null;)if(_[1]){var D=new O.AttrList(_[1]),I={attrs:D,bitrate:D.decimalInteger("AVERAGE-BANDWIDTH")||D.decimalInteger("BANDWIDTH"),name:D.NAME,url:m.resolve(_[2],v)},w=D.decimalResolution("RESOLUTION");w&&(I.width=w.width,I.height=w.height),l((D.CODECS||"").split(/[ ,]+/).filter(function(N){return N}),I),I.videoCodec&&I.videoCodec.indexOf("avc1")!==-1&&(I.videoCodec=m.convertAVC1ToAVCOTI(I.videoCodec)),n.push(I)}else if(_[3]){var B=new O.AttrList(_[3]);B["DATA-ID"]&&(A=!0,s[B["DATA-ID"]]=B)}return{levels:n,sessionData:A?s:null}},m.parseMasterPlaylistMedia=function(S,v,n,s){s===void 0&&(s=[]);var A,_=[],D=0;for(u.lastIndex=0;(A=u.exec(S))!==null;){var I=new O.AttrList(A[1]);if(I.TYPE===n){var w={attrs:I,bitrate:0,id:D++,groupId:I["GROUP-ID"],instreamId:I["INSTREAM-ID"],name:I.NAME||I.LANGUAGE||"",type:n,default:I.bool("DEFAULT"),autoselect:I.bool("AUTOSELECT"),forced:I.bool("FORCED"),lang:I.LANGUAGE,url:I.URI?m.resolve(I.URI,v):""};if(s.length){var B=m.findGroup(s,w.groupId)||s[0];p(w,B,"audioCodec"),p(w,B,"textCodec")}_.push(w)}}return _},m.parseLevelPlaylist=function(S,v,n,s,A){var _=new F.LevelDetails(v),D=_.fragments,I=null,w=0,B=0,N=0,W=0,G=null,V=new j.Fragment(s,v),X,$,q,Z=-1,ee=!1;for(d.lastIndex=0,_.m3u8=S;(X=d.exec(S))!==null;){ee&&(ee=!1,V=new j.Fragment(s,v),V.start=N,V.sn=w,V.cc=W,V.level=n,I&&(V.initSegment=I,V.rawProgramDateTime=I.rawProgramDateTime));var ie=X[1];if(ie){V.duration=parseFloat(ie);var ue=(" "+X[2]).slice(1);V.title=ue||null,V.tagList.push(ue?["INF",ie,ue]:["INF",ie])}else if(X[3])Object(H.isFiniteNumber)(V.duration)&&(V.start=N,q&&(V.levelkey=q),V.sn=w,V.level=n,V.cc=W,V.urlId=A,D.push(V),V.relurl=(" "+X[3]).slice(1),h(V,G),G=V,N+=V.duration,w++,B=0,ee=!0);else if(X[4]){var se=(" "+X[4]).slice(1);G?V.setByteRange(se,G):V.setByteRange(se)}else if(X[5])V.rawProgramDateTime=(" "+X[5]).slice(1),V.tagList.push(["PROGRAM-DATE-TIME",V.rawProgramDateTime]),Z===-1&&(Z=D.length);else{if(X=X[0].match(E),!X){y.logger.warn("No matches on slow regex match for level playlist!");continue}for($=1;$<X.length&&typeof X[$]=="undefined";$++);var le=(" "+X[$]).slice(1),ce=(" "+X[$+1]).slice(1),me=X[$+2]?(" "+X[$+2]).slice(1):"";switch(le){case"PLAYLIST-TYPE":_.type=ce.toUpperCase();break;case"MEDIA-SEQUENCE":w=_.startSN=parseInt(ce);break;case"SKIP":{var ye=new O.AttrList(ce),Ee=ye.decimalInteger("SKIPPED-SEGMENTS");if(Object(H.isFiniteNumber)(Ee)){_.skippedSegments=Ee;for(var ke=Ee;ke--;)D.unshift(null);w+=Ee}var Ae=ye.enumeratedString("RECENTLY-REMOVED-DATERANGES");Ae&&(_.recentlyRemovedDateranges=Ae.split("	"));break}case"TARGETDURATION":_.targetduration=parseFloat(ce);break;case"VERSION":_.version=parseInt(ce);break;case"EXTM3U":break;case"ENDLIST":_.live=!1;break;case"#":(ce||me)&&V.tagList.push(me?[ce,me]:[ce]);break;case"DIS":W++;case"GAP":V.tagList.push([le]);break;case"BITRATE":V.tagList.push([le,ce]);break;case"DISCONTINUITY-SEQ":W=parseInt(ce);break;case"KEY":{var Ie,Le=new O.AttrList(ce),Be=Le.enumeratedString("METHOD"),Ne=Le.URI,Ke=Le.hexadecimalInteger("IV"),Te=Le.enumeratedString("KEYFORMATVERSIONS"),de=Le.enumeratedString("KEYID"),ge=(Ie=Le.enumeratedString("KEYFORMAT"))!=null?Ie:"identity",ve=["com.apple.streamingkeydelivery","com.microsoft.playready","urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed","com.widevine"];if(ve.indexOf(ge)>-1){y.logger.warn("Keyformat "+ge+" is not supported from the manifest");continue}else if(ge!=="identity")continue;Be&&(q=R.LevelKey.fromURL(v,Ne),Ne&&["AES-128","SAMPLE-AES","SAMPLE-AES-CENC"].indexOf(Be)>=0&&(q.method=Be,q.keyFormat=ge,de&&(q.keyID=de),Te&&(q.keyFormatVersions=Te),q.iv=Ke));break}case"START":{var De=new O.AttrList(ce),Fe=De.decimalFloatingPoint("TIME-OFFSET");Object(H.isFiniteNumber)(Fe)&&(_.startTimeOffset=Fe);break}case"MAP":{var Pe=new O.AttrList(ce);V.relurl=Pe.URI,Pe.BYTERANGE&&V.setByteRange(Pe.BYTERANGE),V.level=n,V.sn="initSegment",q&&(V.levelkey=q),V.initSegment=null,I=V,ee=!0;break}case"SERVER-CONTROL":{var we=new O.AttrList(ce);_.canBlockReload=we.bool("CAN-BLOCK-RELOAD"),_.canSkipUntil=we.optionalFloat("CAN-SKIP-UNTIL",0),_.canSkipDateRanges=_.canSkipUntil>0&&we.bool("CAN-SKIP-DATERANGES"),_.partHoldBack=we.optionalFloat("PART-HOLD-BACK",0),_.holdBack=we.optionalFloat("HOLD-BACK",0);break}case"PART-INF":{var Ge=new O.AttrList(ce);_.partTarget=Ge.decimalFloatingPoint("PART-TARGET");break}case"PART":{var be=_.partList;be||(be=_.partList=[]);var Ce=B>0?be[be.length-1]:void 0,Me=B++,Je=new j.Part(new O.AttrList(ce),V,v,Me,Ce);be.push(Je),V.duration+=Je.duration;break}case"PRELOAD-HINT":{var it=new O.AttrList(ce);_.preloadHint=it;break}case"RENDITION-REPORT":{var Et=new O.AttrList(ce);_.renditionReports=_.renditionReports||[],_.renditionReports.push(Et);break}default:y.logger.warn("line parsed but not handled: "+X);break}}}G&&!G.relurl?(D.pop(),N-=G.duration,_.partList&&(_.fragmentHint=G)):_.partList&&(h(V,G),V.cc=W,_.fragmentHint=V);var ze=D.length,He=D[0],st=D[ze-1];if(N+=_.skippedSegments*_.targetduration,N>0&&ze&&st){_.averagetargetduration=N/ze;var vt=st.sn;_.endSN=vt!=="initSegment"?vt:0,He&&(_.startCC=He.cc,He.initSegment||_.fragments.every(function(_e){return _e.relurl&&a(_e.relurl)})&&(y.logger.warn("MP4 fragments found but no init segment (probably no MAP, incomplete M3U8), trying to fetch SIDX"),V=new j.Fragment(s,v),V.relurl=st.relurl,V.level=n,V.sn="initSegment",He.initSegment=V,_.needSidxRanges=!0))}else _.endSN=0,_.startCC=0;return _.fragmentHint&&(N+=_.fragmentHint.duration),_.totalduration=N,_.endCC=W,Z>0&&f(D,Z),_},m}();function l(m,L){["video","audio","text"].forEach(function(S){var v=m.filter(function(s){return Object(C.isCodecType)(s,S)});if(v.length){var n=v.filter(function(s){return s.lastIndexOf("avc1",0)===0||s.lastIndexOf("mp4a",0)===0});L[S+"Codec"]=n.length>0?n[0]:v[0],m=m.filter(function(s){return v.indexOf(s)===-1})}}),L.unknownCodecs=m}function p(m,L,S){var v=L[S];v&&(m[S]=v)}function f(m,L){for(var S=m[L],v=L;v--;){var n=m[v];if(!n)return;n.programDateTime=S.programDateTime-n.duration*1e3,S=n}}function h(m,L){m.rawProgramDateTime?m.programDateTime=Date.parse(m.rawProgramDateTime):L!=null&&L.programDateTime&&(m.programDateTime=L.endProgramDateTime),Object(H.isFiniteNumber)(m.programDateTime)||(m.programDateTime=null,m.rawProgramDateTime=null)}},"./src/loader/playlist-loader.ts":function(re,K,M){"use strict";M.r(K);var H=M("./src/polyfills/number.ts"),k=M("./src/events.ts"),x=M("./src/errors.ts"),j=M("./src/utils/logger.ts"),F=M("./src/utils/mp4-tools.ts"),R=M("./src/loader/m3u8-parser.ts"),O=M("./src/types/loader.ts"),y=M("./src/utils/attr-list.ts");function C(d){var E=d.type;switch(E){case O.PlaylistContextType.AUDIO_TRACK:return O.PlaylistLevelType.AUDIO;case O.PlaylistContextType.SUBTITLE_TRACK:return O.PlaylistLevelType.SUBTITLE;default:return O.PlaylistLevelType.MAIN}}function P(d,E){var c=d.url;return(c===void 0||c.indexOf("data:")===0)&&(c=E.url),c}var u=function(){function d(c){this.hls=void 0,this.loaders=Object.create(null),this.hls=c,this.registerListeners()}var E=d.prototype;return E.registerListeners=function(){var a=this.hls;a.on(k.Events.MANIFEST_LOADING,this.onManifestLoading,this),a.on(k.Events.LEVEL_LOADING,this.onLevelLoading,this),a.on(k.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),a.on(k.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},E.unregisterListeners=function(){var a=this.hls;a.off(k.Events.MANIFEST_LOADING,this.onManifestLoading,this),a.off(k.Events.LEVEL_LOADING,this.onLevelLoading,this),a.off(k.Events.AUDIO_TRACK_LOADING,this.onAudioTrackLoading,this),a.off(k.Events.SUBTITLE_TRACK_LOADING,this.onSubtitleTrackLoading,this)},E.createInternalLoader=function(a){var i=this.hls.config,l=i.pLoader,p=i.loader,f=l||p,h=new f(i);return a.loader=h,this.loaders[a.type]=h,h},E.getInternalLoader=function(a){return this.loaders[a.type]},E.resetInternalLoader=function(a){this.loaders[a]&&delete this.loaders[a]},E.destroyInternalLoaders=function(){for(var a in this.loaders){var i=this.loaders[a];i&&i.destroy(),this.resetInternalLoader(a)}},E.destroy=function(){this.unregisterListeners(),this.destroyInternalLoaders()},E.onManifestLoading=function(a,i){var l=i.url;this.load({id:null,groupId:null,level:0,responseType:"text",type:O.PlaylistContextType.MANIFEST,url:l,deliveryDirectives:null})},E.onLevelLoading=function(a,i){var l=i.id,p=i.level,f=i.url,h=i.deliveryDirectives;this.load({id:l,groupId:null,level:p,responseType:"text",type:O.PlaylistContextType.LEVEL,url:f,deliveryDirectives:h})},E.onAudioTrackLoading=function(a,i){var l=i.id,p=i.groupId,f=i.url,h=i.deliveryDirectives;this.load({id:l,groupId:p,level:null,responseType:"text",type:O.PlaylistContextType.AUDIO_TRACK,url:f,deliveryDirectives:h})},E.onSubtitleTrackLoading=function(a,i){var l=i.id,p=i.groupId,f=i.url,h=i.deliveryDirectives;this.load({id:l,groupId:p,level:null,responseType:"text",type:O.PlaylistContextType.SUBTITLE_TRACK,url:f,deliveryDirectives:h})},E.load=function(a){var i,l=this.hls.config,p=this.getInternalLoader(a);if(p){var f=p.context;if(f&&f.url===a.url){j.logger.trace("[playlist-loader]: playlist request ongoing");return}j.logger.log("[playlist-loader]: aborting previous loader for type: "+a.type),p.abort()}var h,m,L,S;switch(a.type){case O.PlaylistContextType.MANIFEST:h=l.manifestLoadingMaxRetry,m=l.manifestLoadingTimeOut,L=l.manifestLoadingRetryDelay,S=l.manifestLoadingMaxRetryTimeout;break;case O.PlaylistContextType.LEVEL:case O.PlaylistContextType.AUDIO_TRACK:case O.PlaylistContextType.SUBTITLE_TRACK:h=0,m=l.levelLoadingTimeOut;break;default:h=l.levelLoadingMaxRetry,m=l.levelLoadingTimeOut,L=l.levelLoadingRetryDelay,S=l.levelLoadingMaxRetryTimeout;break}if(p=this.createInternalLoader(a),(i=a.deliveryDirectives)!==null&&i!==void 0&&i.part){var v;if(a.type===O.PlaylistContextType.LEVEL&&a.level!==null?v=this.hls.levels[a.level].details:a.type===O.PlaylistContextType.AUDIO_TRACK&&a.id!==null?v=this.hls.audioTracks[a.id].details:a.type===O.PlaylistContextType.SUBTITLE_TRACK&&a.id!==null&&(v=this.hls.subtitleTracks[a.id].details),v){var n=v.partTarget,s=v.targetduration;n&&s&&(m=Math.min(Math.max(n*3,s*.8)*1e3,m))}}var A={timeout:m,maxRetry:h,retryDelay:L,maxRetryDelay:S,highWaterMark:0},_={onSuccess:this.loadsuccess.bind(this),onError:this.loaderror.bind(this),onTimeout:this.loadtimeout.bind(this)};p.load(a,A,_)},E.loadsuccess=function(a,i,l,p){if(p===void 0&&(p=null),l.isSidxRequest){this.handleSidxRequest(a,l),this.handlePlaylistLoaded(a,i,l,p);return}this.resetInternalLoader(l.type);var f=a.data;if(f.indexOf("#EXTM3U")!==0){this.handleManifestParsingError(a,l,"no EXTM3U delimiter",p);return}i.parsing.start=performance.now(),f.indexOf("#EXTINF:")>0||f.indexOf("#EXT-X-TARGETDURATION:")>0?this.handleTrackOrLevelPlaylist(a,i,l,p):this.handleMasterPlaylist(a,i,l,p)},E.loaderror=function(a,i,l){l===void 0&&(l=null),this.handleNetworkError(i,l,!1,a)},E.loadtimeout=function(a,i,l){l===void 0&&(l=null),this.handleNetworkError(i,l,!0)},E.handleMasterPlaylist=function(a,i,l,p){var f=this.hls,h=a.data,m=P(a,l),L=R.default.parseMasterPlaylist(h,m),S=L.levels,v=L.sessionData;if(!S.length){this.handleManifestParsingError(a,l,"no level found in manifest",p);return}var n=S.map(function(w){return{id:w.attrs.AUDIO,audioCodec:w.audioCodec}}),s=S.map(function(w){return{id:w.attrs.SUBTITLES,textCodec:w.textCodec}}),A=R.default.parseMasterPlaylistMedia(h,m,"AUDIO",n),_=R.default.parseMasterPlaylistMedia(h,m,"SUBTITLES",s),D=R.default.parseMasterPlaylistMedia(h,m,"CLOSED-CAPTIONS");if(A.length){var I=A.some(function(w){return!w.url});!I&&S[0].audioCodec&&!S[0].attrs.AUDIO&&(j.logger.log("[playlist-loader]: audio codec signaled in quality level, but no embedded audio track signaled, create one"),A.unshift({type:"main",name:"main",default:!1,autoselect:!1,forced:!1,id:-1,attrs:new y.AttrList({}),bitrate:0,url:""}))}f.trigger(k.Events.MANIFEST_LOADED,{levels:S,audioTracks:A,subtitles:_,captions:D,url:m,stats:i,networkDetails:p,sessionData:v})},E.handleTrackOrLevelPlaylist=function(a,i,l,p){var f=this.hls,h=l.id,m=l.level,L=l.type,S=P(a,l),v=Object(H.isFiniteNumber)(h)?h:0,n=Object(H.isFiniteNumber)(m)?m:v,s=C(l),A=R.default.parseLevelPlaylist(a.data,S,n,s,v);if(!A.fragments.length){f.trigger(k.Events.ERROR,{type:x.ErrorTypes.NETWORK_ERROR,details:x.ErrorDetails.LEVEL_EMPTY_ERROR,fatal:!1,url:S,reason:"no fragments found in level",level:typeof l.level=="number"?l.level:void 0});return}if(L===O.PlaylistContextType.MANIFEST){var _={attrs:new y.AttrList({}),bitrate:0,details:A,name:"",url:S};f.trigger(k.Events.MANIFEST_LOADED,{levels:[_],audioTracks:[],url:S,stats:i,networkDetails:p,sessionData:null})}if(i.parsing.end=performance.now(),A.needSidxRanges){var D,I=(D=A.fragments[0].initSegment)===null||D===void 0?void 0:D.url;this.load({url:I,isSidxRequest:!0,type:L,level:m,levelDetails:A,id:h,groupId:null,rangeStart:0,rangeEnd:2048,responseType:"arraybuffer",deliveryDirectives:null});return}l.levelDetails=A,this.handlePlaylistLoaded(a,i,l,p)},E.handleSidxRequest=function(a,i){var l=Object(F.parseSegmentIndex)(new Uint8Array(a.data));if(!!l){var p=l.references,f=i.levelDetails;p.forEach(function(h,m){var L=h.info,S=f.fragments[m];S.byteRange.length===0&&S.setByteRange(String(1+L.end-L.start)+"@"+String(L.start)),S.initSegment&&S.initSegment.setByteRange(String(l.moovEndOffset)+"@0")})}},E.handleManifestParsingError=function(a,i,l,p){this.hls.trigger(k.Events.ERROR,{type:x.ErrorTypes.NETWORK_ERROR,details:x.ErrorDetails.MANIFEST_PARSING_ERROR,fatal:i.type===O.PlaylistContextType.MANIFEST,url:a.url,reason:l,response:a,context:i,networkDetails:p})},E.handleNetworkError=function(a,i,l,p){l===void 0&&(l=!1),j.logger.warn("[playlist-loader]: A network "+(l?"timeout":"error")+" occurred while loading "+a.type+" level: "+a.level+" id: "+a.id+' group-id: "'+a.groupId+'"');var f=x.ErrorDetails.UNKNOWN,h=!1,m=this.getInternalLoader(a);switch(a.type){case O.PlaylistContextType.MANIFEST:f=l?x.ErrorDetails.MANIFEST_LOAD_TIMEOUT:x.ErrorDetails.MANIFEST_LOAD_ERROR,h=!0;break;case O.PlaylistContextType.LEVEL:f=l?x.ErrorDetails.LEVEL_LOAD_TIMEOUT:x.ErrorDetails.LEVEL_LOAD_ERROR,h=!1;break;case O.PlaylistContextType.AUDIO_TRACK:f=l?x.ErrorDetails.AUDIO_TRACK_LOAD_TIMEOUT:x.ErrorDetails.AUDIO_TRACK_LOAD_ERROR,h=!1;break;case O.PlaylistContextType.SUBTITLE_TRACK:f=l?x.ErrorDetails.SUBTITLE_TRACK_LOAD_TIMEOUT:x.ErrorDetails.SUBTITLE_LOAD_ERROR,h=!1;break}m&&this.resetInternalLoader(a.type);var L={type:x.ErrorTypes.NETWORK_ERROR,details:f,fatal:h,url:a.url,loader:m,context:a,networkDetails:i};p&&(L.response=p),this.hls.trigger(k.Events.ERROR,L)},E.handlePlaylistLoaded=function(a,i,l,p){var f=l.type,h=l.level,m=l.id,L=l.groupId,S=l.loader,v=l.levelDetails,n=l.deliveryDirectives;if(!(v!=null&&v.targetduration)){this.handleManifestParsingError(a,l,"invalid target duration",p);return}if(!!S)switch(v.live&&(S.getCacheAge&&(v.ageHeader=S.getCacheAge()||0),(!S.getCacheAge||isNaN(v.ageHeader))&&(v.ageHeader=0)),f){case O.PlaylistContextType.MANIFEST:case O.PlaylistContextType.LEVEL:this.hls.trigger(k.Events.LEVEL_LOADED,{details:v,level:h||0,id:m||0,stats:i,networkDetails:p,deliveryDirectives:n});break;case O.PlaylistContextType.AUDIO_TRACK:this.hls.trigger(k.Events.AUDIO_TRACK_LOADED,{details:v,id:m||0,groupId:L||"",stats:i,networkDetails:p,deliveryDirectives:n});break;case O.PlaylistContextType.SUBTITLE_TRACK:this.hls.trigger(k.Events.SUBTITLE_TRACK_LOADED,{details:v,id:m||0,groupId:L||"",stats:i,networkDetails:p,deliveryDirectives:n});break}},d}();K.default=u},"./src/polyfills/number.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"isFiniteNumber",function(){return H}),M.d(K,"MAX_SAFE_INTEGER",function(){return k});var H=Number.isFinite||function(x){return typeof x=="number"&&isFinite(x)},k=Number.MAX_SAFE_INTEGER||9007199254740991},"./src/remux/aac-helper.ts":function(re,K,M){"use strict";M.r(K);var H=function(){function k(){}return k.getSilentFrame=function(j,F){switch(j){case"mp4a.40.2":if(F===1)return new Uint8Array([0,200,0,128,35,128]);if(F===2)return new Uint8Array([33,0,73,144,2,25,0,35,128]);if(F===3)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,142]);if(F===4)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56]);if(F===5)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56]);if(F===6)return new Uint8Array([0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]);break;default:if(F===1)return new Uint8Array([1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(F===2)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);if(F===3)return new Uint8Array([1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94]);break}},k}();K.default=H},"./src/remux/mp4-generator.ts":function(re,K,M){"use strict";M.r(K);var H=Math.pow(2,32)-1,k=function(){function x(){}return x.init=function(){x.types={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],".mp3":[],mvex:[],mvhd:[],pasp:[],sdtp:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[],smhd:[]};var F;for(F in x.types)x.types.hasOwnProperty(F)&&(x.types[F]=[F.charCodeAt(0),F.charCodeAt(1),F.charCodeAt(2),F.charCodeAt(3)]);var R=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),O=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]);x.HDLR_TYPES={video:R,audio:O};var y=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),C=new Uint8Array([0,0,0,0,0,0,0,0]);x.STTS=x.STSC=x.STCO=C,x.STSZ=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),x.VMHD=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0]),x.SMHD=new Uint8Array([0,0,0,0,0,0,0,0]),x.STSD=new Uint8Array([0,0,0,0,0,0,0,1]);var P=new Uint8Array([105,115,111,109]),u=new Uint8Array([97,118,99,49]),d=new Uint8Array([0,0,0,1]);x.FTYP=x.box(x.types.ftyp,P,d,P,u),x.DINF=x.box(x.types.dinf,x.box(x.types.dref,y))},x.box=function(F){for(var R=8,O=arguments.length,y=new Array(O>1?O-1:0),C=1;C<O;C++)y[C-1]=arguments[C];for(var P=y.length,u=P;P--;)R+=y[P].byteLength;var d=new Uint8Array(R);for(d[0]=R>>24&255,d[1]=R>>16&255,d[2]=R>>8&255,d[3]=R&255,d.set(F,4),P=0,R=8;P<u;P++)d.set(y[P],R),R+=y[P].byteLength;return d},x.hdlr=function(F){return x.box(x.types.hdlr,x.HDLR_TYPES[F])},x.mdat=function(F){return x.box(x.types.mdat,F)},x.mdhd=function(F,R){R*=F;var O=Math.floor(R/(H+1)),y=Math.floor(R%(H+1));return x.box(x.types.mdhd,new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,F>>24&255,F>>16&255,F>>8&255,F&255,O>>24,O>>16&255,O>>8&255,O&255,y>>24,y>>16&255,y>>8&255,y&255,85,196,0,0]))},x.mdia=function(F){return x.box(x.types.mdia,x.mdhd(F.timescale,F.duration),x.hdlr(F.type),x.minf(F))},x.mfhd=function(F){return x.box(x.types.mfhd,new Uint8Array([0,0,0,0,F>>24,F>>16&255,F>>8&255,F&255]))},x.minf=function(F){return F.type==="audio"?x.box(x.types.minf,x.box(x.types.smhd,x.SMHD),x.DINF,x.stbl(F)):x.box(x.types.minf,x.box(x.types.vmhd,x.VMHD),x.DINF,x.stbl(F))},x.moof=function(F,R,O){return x.box(x.types.moof,x.mfhd(F),x.traf(O,R))},x.moov=function(F){for(var R=F.length,O=[];R--;)O[R]=x.trak(F[R]);return x.box.apply(null,[x.types.moov,x.mvhd(F[0].timescale,F[0].duration)].concat(O).concat(x.mvex(F)))},x.mvex=function(F){for(var R=F.length,O=[];R--;)O[R]=x.trex(F[R]);return x.box.apply(null,[x.types.mvex].concat(O))},x.mvhd=function(F,R){R*=F;var O=Math.floor(R/(H+1)),y=Math.floor(R%(H+1)),C=new Uint8Array([1,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,F>>24&255,F>>16&255,F>>8&255,F&255,O>>24,O>>16&255,O>>8&255,O&255,y>>24,y>>16&255,y>>8&255,y&255,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return x.box(x.types.mvhd,C)},x.sdtp=function(F){var R=F.samples||[],O=new Uint8Array(4+R.length),y,C;for(y=0;y<R.length;y++)C=R[y].flags,O[y+4]=C.dependsOn<<4|C.isDependedOn<<2|C.hasRedundancy;return x.box(x.types.sdtp,O)},x.stbl=function(F){return x.box(x.types.stbl,x.stsd(F),x.box(x.types.stts,x.STTS),x.box(x.types.stsc,x.STSC),x.box(x.types.stsz,x.STSZ),x.box(x.types.stco,x.STCO))},x.avc1=function(F){var R=[],O=[],y,C,P;for(y=0;y<F.sps.length;y++)C=F.sps[y],P=C.byteLength,R.push(P>>>8&255),R.push(P&255),R=R.concat(Array.prototype.slice.call(C));for(y=0;y<F.pps.length;y++)C=F.pps[y],P=C.byteLength,O.push(P>>>8&255),O.push(P&255),O=O.concat(Array.prototype.slice.call(C));var u=x.box(x.types.avcC,new Uint8Array([1,R[3],R[4],R[5],252|3,224|F.sps.length].concat(R).concat([F.pps.length]).concat(O))),d=F.width,E=F.height,c=F.pixelRatio[0],a=F.pixelRatio[1];return x.box(x.types.avc1,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,d>>8&255,d&255,E>>8&255,E&255,0,72,0,0,0,72,0,0,0,0,0,0,0,1,18,100,97,105,108,121,109,111,116,105,111,110,47,104,108,115,46,106,115,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),u,x.box(x.types.btrt,new Uint8Array([0,28,156,128,0,45,198,192,0,45,198,192])),x.box(x.types.pasp,new Uint8Array([c>>24,c>>16&255,c>>8&255,c&255,a>>24,a>>16&255,a>>8&255,a&255])))},x.esds=function(F){var R=F.config.length;return new Uint8Array([0,0,0,0,3,23+R,0,1,0,4,15+R,64,21,0,0,0,0,0,0,0,0,0,0,0,5].concat([R]).concat(F.config).concat([6,1,2]))},x.mp4a=function(F){var R=F.samplerate;return x.box(x.types.mp4a,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,F.channelCount,0,16,0,0,0,0,R>>8&255,R&255,0,0]),x.box(x.types.esds,x.esds(F)))},x.mp3=function(F){var R=F.samplerate;return x.box(x.types[".mp3"],new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,F.channelCount,0,16,0,0,0,0,R>>8&255,R&255,0,0]))},x.stsd=function(F){return F.type==="audio"?!F.isAAC&&F.codec==="mp3"?x.box(x.types.stsd,x.STSD,x.mp3(F)):x.box(x.types.stsd,x.STSD,x.mp4a(F)):x.box(x.types.stsd,x.STSD,x.avc1(F))},x.tkhd=function(F){var R=F.id,O=F.duration*F.timescale,y=F.width,C=F.height,P=Math.floor(O/(H+1)),u=Math.floor(O%(H+1));return x.box(x.types.tkhd,new Uint8Array([1,0,0,7,0,0,0,0,0,0,0,2,0,0,0,0,0,0,0,3,R>>24&255,R>>16&255,R>>8&255,R&255,0,0,0,0,P>>24,P>>16&255,P>>8&255,P&255,u>>24,u>>16&255,u>>8&255,u&255,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,y>>8&255,y&255,0,0,C>>8&255,C&255,0,0]))},x.traf=function(F,R){var O=x.sdtp(F),y=F.id,C=Math.floor(R/(H+1)),P=Math.floor(R%(H+1));return x.box(x.types.traf,x.box(x.types.tfhd,new Uint8Array([0,0,0,0,y>>24,y>>16&255,y>>8&255,y&255])),x.box(x.types.tfdt,new Uint8Array([1,0,0,0,C>>24,C>>16&255,C>>8&255,C&255,P>>24,P>>16&255,P>>8&255,P&255])),x.trun(F,O.length+16+20+8+16+8+8),O)},x.trak=function(F){return F.duration=F.duration||4294967295,x.box(x.types.trak,x.tkhd(F),x.mdia(F))},x.trex=function(F){var R=F.id;return x.box(x.types.trex,new Uint8Array([0,0,0,0,R>>24,R>>16&255,R>>8&255,R&255,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]))},x.trun=function(F,R){var O=F.samples||[],y=O.length,C=12+16*y,P=new Uint8Array(C),u,d,E,c,a,i;for(R+=8+C,P.set([0,0,15,1,y>>>24&255,y>>>16&255,y>>>8&255,y&255,R>>>24&255,R>>>16&255,R>>>8&255,R&255],0),u=0;u<y;u++)d=O[u],E=d.duration,c=d.size,a=d.flags,i=d.cts,P.set([E>>>24&255,E>>>16&255,E>>>8&255,E&255,c>>>24&255,c>>>16&255,c>>>8&255,c&255,a.isLeading<<2|a.dependsOn,a.isDependedOn<<6|a.hasRedundancy<<4|a.paddingValue<<1|a.isNonSync,a.degradPrio&240<<8,a.degradPrio&15,i>>>24&255,i>>>16&255,i>>>8&255,i&255],12+16*u);return x.box(x.types.trun,P)},x.initSegment=function(F){x.types||x.init();var R=x.moov(F),O=new Uint8Array(x.FTYP.byteLength+R.byteLength);return O.set(x.FTYP),O.set(R,x.FTYP.byteLength),O},x}();k.types=void 0,k.HDLR_TYPES=void 0,k.STTS=void 0,k.STSC=void 0,k.STCO=void 0,k.STSZ=void 0,k.VMHD=void 0,k.SMHD=void 0,k.STSD=void 0,k.FTYP=void 0,k.DINF=void 0,K.default=k},"./src/remux/mp4-remuxer.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"default",function(){return i}),M.d(K,"normalizePts",function(){return l});var H=M("./src/polyfills/number.ts"),k=M("./src/remux/aac-helper.ts"),x=M("./src/remux/mp4-generator.ts"),j=M("./src/events.ts"),F=M("./src/errors.ts"),R=M("./src/utils/logger.ts"),O=M("./src/types/loader.ts"),y=M("./src/utils/timescale-conversion.ts");function C(){return C=Object.assign||function(m){for(var L=1;L<arguments.length;L++){var S=arguments[L];for(var v in S)Object.prototype.hasOwnProperty.call(S,v)&&(m[v]=S[v])}return m},C.apply(this,arguments)}var P=10*1e3,u=1024,d=1152,E=null,c=null,a=!1,i=function(){function m(S,v,n,s){if(s===void 0&&(s=""),this.observer=void 0,this.config=void 0,this.typeSupported=void 0,this.ISGenerated=!1,this._initPTS=void 0,this._initDTS=void 0,this.nextAvcDts=null,this.nextAudioPts=null,this.isAudioContiguous=!1,this.isVideoContiguous=!1,this.observer=S,this.config=v,this.typeSupported=n,this.ISGenerated=!1,E===null){var A=navigator.userAgent||"",_=A.match(/Chrome\/(\d+)/i);E=_?parseInt(_[1]):0}if(c===null){var D=navigator.userAgent.match(/Safari\/(\d+)/i);c=D?parseInt(D[1]):0}a=!!E&&E<75||!!c&&c<600}var L=m.prototype;return L.destroy=function(){},L.resetTimeStamp=function(v){R.logger.log("[mp4-remuxer]: initPTS & initDTS reset"),this._initPTS=this._initDTS=v},L.resetNextTimestamp=function(){R.logger.log("[mp4-remuxer]: reset next timestamp"),this.isVideoContiguous=!1,this.isAudioContiguous=!1},L.resetInitSegment=function(){R.logger.log("[mp4-remuxer]: ISGenerated flag reset"),this.ISGenerated=!1},L.getVideoStartPts=function(v){var n=!1,s=v.reduce(function(A,_){var D=_.pts-A;return D<-4294967296?(n=!0,l(A,_.pts)):D>0?A:_.pts},v[0].pts);return n&&R.logger.debug("PTS rollover detected"),s},L.remux=function(v,n,s,A,_,D,I,w){var B,N,W,G,V,X,$=_,q=_,Z=v.pid>-1,ee=n.pid>-1,ie=n.samples.length,ue=v.samples.length>0,se=ie>1,le=(!Z||ue)&&(!ee||se)||this.ISGenerated||I;if(le){this.ISGenerated||(W=this.generateIS(v,n,_));var ce=this.isVideoContiguous,me=-1;if(se&&(me=p(n.samples),!ce&&this.config.forceKeyFrameOnDiscontinuity))if(X=!0,me>0){R.logger.warn("[mp4-remuxer]: Dropped "+me+" out of "+ie+" video samples due to a missing keyframe");var ye=this.getVideoStartPts(n.samples);n.samples=n.samples.slice(me),n.dropped+=me,q+=(n.samples[0].pts-ye)/(n.timescale||9e4)}else me===-1&&(R.logger.warn("[mp4-remuxer]: No keyframe found out of "+ie+" video samples"),X=!1);if(this.ISGenerated){if(ue&&se){var Ee=this.getVideoStartPts(n.samples),ke=l(v.samples[0].pts,Ee)-Ee,Ae=ke/n.inputTimeScale;$+=Math.max(0,Ae),q+=Math.max(0,-Ae)}if(ue){if(v.samplerate||(R.logger.warn("[mp4-remuxer]: regenerate InitSegment as audio detected"),W=this.generateIS(v,n,_)),N=this.remuxAudio(v,$,this.isAudioContiguous,D,ee||se||w===O.PlaylistLevelType.AUDIO?q:void 0),se){var Ie=N?N.endPTS-N.startPTS:0;n.inputTimeScale||(R.logger.warn("[mp4-remuxer]: regenerate InitSegment as video detected"),W=this.generateIS(v,n,_)),B=this.remuxVideo(n,q,ce,Ie)}}else se&&(B=this.remuxVideo(n,q,ce,0));B&&(B.firstKeyFrame=me,B.independent=me!==-1)}}return this.ISGenerated&&(s.samples.length&&(V=this.remuxID3(s,_)),A.samples.length&&(G=this.remuxText(A,_))),{audio:N,video:B,initSegment:W,independent:X,text:G,id3:V}},L.generateIS=function(v,n,s){var A=v.samples,_=n.samples,D=this.typeSupported,I={},w=!Object(H.isFiniteNumber)(this._initPTS),B="audio/mp4",N,W,G;if(w&&(N=W=Infinity),v.config&&A.length&&(v.timescale=v.samplerate,v.isAAC||(D.mpeg?(B="audio/mpeg",v.codec=""):D.mp3&&(v.codec="mp3")),I.audio={id:"audio",container:B,codec:v.codec,initSegment:!v.isAAC&&D.mpeg?new Uint8Array(0):x.default.initSegment([v]),metadata:{channelCount:v.channelCount}},w&&(G=v.inputTimeScale,N=W=A[0].pts-Math.round(G*s))),n.sps&&n.pps&&_.length&&(n.timescale=n.inputTimeScale,I.video={id:"main",container:"video/mp4",codec:n.codec,initSegment:x.default.initSegment([n]),metadata:{width:n.width,height:n.height}},w)){G=n.inputTimeScale;var V=this.getVideoStartPts(_),X=Math.round(G*s);W=Math.min(W,l(_[0].dts,V)-X),N=Math.min(N,V-X)}if(Object.keys(I).length)return this.ISGenerated=!0,w&&(this._initPTS=N,this._initDTS=W),{tracks:I,initPTS:N,timescale:G}},L.remuxVideo=function(v,n,s,A){var _=v.inputTimeScale,D=v.samples,I=[],w=D.length,B=this._initPTS,N=this.nextAvcDts,W=8,G,V,X,$=Number.POSITIVE_INFINITY,q=Number.NEGATIVE_INFINITY,Z=0,ee=!1;if(!s||N===null){var ie=n*_,ue=D[0].pts-l(D[0].dts,D[0].pts);N=ie-ue}for(var se=0;se<w;se++){var le=D[se];if(le.pts=l(le.pts-B,N),le.dts=l(le.dts-B,N),le.dts>le.pts){var ce=9e4*.2;Z=Math.max(Math.min(Z,le.pts-le.dts),-1*ce)}le.dts<D[se>0?se-1:se].dts&&(ee=!0)}ee&&D.sort(function(Ze,jt){var pt=Ze.dts-jt.dts,Dt=Ze.pts-jt.pts;return pt||Dt}),V=D[0].dts,X=D[D.length-1].dts;var me=Math.round((X-V)/(w-1));if(Z<0){if(Z<me*-2){R.logger.warn("PTS < DTS detected in video samples, offsetting DTS from PTS by "+Object(y.toMsFromMpegTsClock)(-me,!0)+" ms");for(var ye=Z,Ee=0;Ee<w;Ee++)D[Ee].dts=ye=Math.max(ye,D[Ee].pts-me),D[Ee].pts=Math.max(ye,D[Ee].pts)}else{R.logger.warn("PTS < DTS detected in video samples, shifting DTS by "+Object(y.toMsFromMpegTsClock)(Z,!0)+" ms to overcome this issue");for(var ke=0;ke<w;ke++)D[ke].dts=D[ke].dts+Z}V=D[0].dts}if(s){var Ae=V-N,Ie=Ae>me,Le=Ae<-1;if(Ie||Le){Ie?R.logger.warn("AVC: "+Object(y.toMsFromMpegTsClock)(Ae,!0)+" ms ("+Ae+"dts) hole between fragments detected, filling it"):R.logger.warn("AVC: "+Object(y.toMsFromMpegTsClock)(-Ae,!0)+" ms ("+Ae+"dts) overlapping between fragments detected"),V=N;var Be=D[0].pts-Ae;D[0].dts=V,D[0].pts=Be,R.logger.log("Video: First PTS/DTS adjusted: "+Object(y.toMsFromMpegTsClock)(Be,!0)+"/"+Object(y.toMsFromMpegTsClock)(V,!0)+", delta: "+Object(y.toMsFromMpegTsClock)(Ae,!0)+" ms")}}a&&(V=Math.max(0,V));for(var Ne=0,Ke=0,Te=0;Te<w;Te++){for(var de=D[Te],ge=de.units,ve=ge.length,De=0,Fe=0;Fe<ve;Fe++)De+=ge[Fe].data.length;Ke+=De,Ne+=ve,de.length=De,de.dts=Math.max(de.dts,V),de.pts=Math.max(de.pts,de.dts,0),$=Math.min(de.pts,$),q=Math.max(de.pts,q)}X=D[w-1].dts;var Pe=Ke+4*Ne+8,we;try{we=new Uint8Array(Pe)}catch(Ze){this.observer.emit(j.Events.ERROR,j.Events.ERROR,{type:F.ErrorTypes.MUX_ERROR,details:F.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:Pe,reason:"fail allocating video mdat "+Pe});return}var Ge=new DataView(we.buffer);Ge.setUint32(0,Pe),we.set(x.default.types.mdat,4);for(var be=0;be<w;be++){for(var Ce=D[be],Me=Ce.units,Je=0,it=0,Et=Me.length;it<Et;it++){var ze=Me[it],He=ze.data,st=ze.data.byteLength;Ge.setUint32(W,st),W+=4,we.set(He,W),W+=st,Je+=4+st}if(be<w-1)G=D[be+1].dts-Ce.dts;else{var vt=this.config,_e=Ce.dts-D[be>0?be-1:be].dts;if(vt.stretchShortVideoTrack&&this.nextAudioPts!==null){var ut=Math.floor(vt.maxBufferHole*_),Tt=(A?$+A*_:this.nextAudioPts)-Ce.pts;Tt>ut?(G=Tt-_e,G<0&&(G=_e),R.logger.log("[mp4-remuxer]: It is approximately "+Tt/90+" ms to the next segment; using duration "+G/90+" ms for the last video frame.")):G=_e}else G=_e}var ct=Math.round(Ce.pts-Ce.dts);I.push(new f(Ce.key,G,Je,ct))}if(I.length&&E&&E<70){var et=I[0].flags;et.dependsOn=2,et.isNonSync=0}console.assert(G!==void 0,"mp4SampleDuration must be computed"),this.nextAvcDts=N=X+G,this.isVideoContiguous=!0;var _t=x.default.moof(v.sequenceNumber++,V,C({},v,{samples:I})),Qt="video",Jt={data1:_t,data2:we,startPTS:$/_,endPTS:(q+G)/_,startDTS:V/_,endDTS:N/_,type:Qt,hasAudio:!1,hasVideo:!0,nb:I.length,dropped:v.dropped};return v.samples=[],v.dropped=0,console.assert(we.length,"MDAT length must not be zero"),Jt},L.remuxAudio=function(v,n,s,A,_){var D=v.inputTimeScale,I=v.samplerate?v.samplerate:D,w=D/I,B=v.isAAC?u:d,N=B*w,W=this._initPTS,G=!v.isAAC&&this.typeSupported.mpeg,V=[],X=v.samples,$=G?0:8,q=this.nextAudioPts||-1,Z=n*D;if(this.isAudioContiguous=s=s||X.length&&q>0&&(A&&Math.abs(Z-q)<9e3||Math.abs(l(X[0].pts-W,Z)-q)<20*N),X.forEach(function(He){He.pts=l(He.pts-W,Z)}),!s||q<0){if(X=X.filter(function(He){return He.pts>=0}),!X.length)return;_===0?q=0:A?q=Math.max(0,Z):q=X[0].pts}if(v.isAAC)for(var ee=_!==void 0,ie=this.config.maxAudioFramesDrift,ue=0,se=q;ue<X.length;ue++){var le=X[ue],ce=le.pts,me=ce-se,ye=Math.abs(1e3*me/D);if(me<=-ie*N&&ee)ue===0&&(R.logger.warn("Audio frame @ "+(ce/D).toFixed(3)+"s overlaps nextAudioPts by "+Math.round(1e3*me/D)+" ms."),this.nextAudioPts=q=se=ce);else if(me>=ie*N&&ye<P&&ee){var Ee=Math.round(me/N);se=ce-Ee*N,se<0&&(Ee--,se+=N),ue===0&&(this.nextAudioPts=q=se),R.logger.warn("[mp4-remuxer]: Injecting "+Ee+" audio frame @ "+(se/D).toFixed(3)+"s due to "+Math.round(1e3*me/D)+" ms gap.");for(var ke=0;ke<Ee;ke++){var Ae=Math.max(se,0),Ie=k.default.getSilentFrame(v.manifestCodec||v.codec,v.channelCount);Ie||(R.logger.log("[mp4-remuxer]: Unable to get silent frame for given audio codec; duplicating last frame instead."),Ie=le.unit.subarray()),X.splice(ue,0,{unit:Ie,pts:Ae}),se+=N,ue++}}le.pts=se,se+=N}for(var Le=null,Be=null,Ne,Ke=0,Te=X.length;Te--;)Ke+=X[Te].unit.byteLength;for(var de=0,ge=X.length;de<ge;de++){var ve=X[de],De=ve.unit,Fe=ve.pts;if(Be!==null){var Pe=V[de-1];Pe.duration=Math.round((Fe-Be)/w)}else if(s&&v.isAAC&&(Fe=q),Le=Fe,Ke>0){Ke+=$;try{Ne=new Uint8Array(Ke)}catch(He){this.observer.emit(j.Events.ERROR,j.Events.ERROR,{type:F.ErrorTypes.MUX_ERROR,details:F.ErrorDetails.REMUX_ALLOC_ERROR,fatal:!1,bytes:Ke,reason:"fail allocating audio mdat "+Ke});return}if(!G){var we=new DataView(Ne.buffer);we.setUint32(0,Ke),Ne.set(x.default.types.mdat,4)}}else return;Ne.set(De,$);var Ge=De.byteLength;$+=Ge,V.push(new f(!0,B,Ge,0)),Be=Fe}var be=V.length;if(!!be){var Ce=V[V.length-1];this.nextAudioPts=q=Be+w*Ce.duration;var Me=G?new Uint8Array(0):x.default.moof(v.sequenceNumber++,Le/w,C({},v,{samples:V}));v.samples=[];var Je=Le/D,it=q/D,Et="audio",ze={data1:Me,data2:Ne,startPTS:Je,endPTS:it,startDTS:Je,endDTS:it,type:Et,hasAudio:!0,hasVideo:!1,nb:be};return this.isAudioContiguous=!0,console.assert(Ne.length,"MDAT length must not be zero"),ze}},L.remuxEmptyAudio=function(v,n,s,A){var _=v.inputTimeScale,D=v.samplerate?v.samplerate:_,I=_/D,w=this.nextAudioPts,B=(w!==null?w:A.startDTS*_)+this._initDTS,N=A.endDTS*_+this._initDTS,W=I*u,G=Math.ceil((N-B)/W),V=k.default.getSilentFrame(v.manifestCodec||v.codec,v.channelCount);if(R.logger.warn("[mp4-remuxer]: remux empty Audio"),!V){R.logger.trace("[mp4-remuxer]: Unable to remuxEmptyAudio since we were unable to get a silent frame for given audio codec");return}for(var X=[],$=0;$<G;$++){var q=B+$*W;X.push({unit:V,pts:q,dts:q})}return v.samples=X,this.remuxAudio(v,n,s,!1)},L.remuxID3=function(v,n){var s=v.samples.length;if(!!s){for(var A=v.inputTimeScale,_=this._initPTS,D=this._initDTS,I=0;I<s;I++){var w=v.samples[I];w.pts=l(w.pts-_,n*A)/A,w.dts=l(w.dts-D,n*A)/A}var B=v.samples;return v.samples=[],{samples:B}}},L.remuxText=function(v,n){var s=v.samples.length;if(!!s){for(var A=v.inputTimeScale,_=this._initPTS,D=0;D<s;D++){var I=v.samples[D];I.pts=l(I.pts-_,n*A)/A}v.samples.sort(function(B,N){return B.pts-N.pts});var w=v.samples;return v.samples=[],{samples:w}}},m}();function l(m,L){var S;if(L===null)return m;for(L<m?S=-8589934592:S=8589934592;Math.abs(m-L)>4294967296;)m+=S;return m}function p(m){for(var L=0;L<m.length;L++)if(m[L].key)return L;return-1}var f=function(L,S,v,n){this.size=void 0,this.duration=void 0,this.cts=void 0,this.flags=void 0,this.duration=S,this.size=v,this.cts=n,this.flags=new h(L)},h=function(L){this.isLeading=0,this.isDependedOn=0,this.hasRedundancy=0,this.degradPrio=0,this.dependsOn=1,this.isNonSync=1,this.dependsOn=L?2:1,this.isNonSync=L?0:1}},"./src/remux/passthrough-remuxer.ts":function(re,K,M){"use strict";M.r(K);var H=M("./src/polyfills/number.ts"),k=M("./src/utils/mp4-tools.ts"),x=M("./src/loader/fragment.ts"),j=M("./src/utils/logger.ts"),F=function(){function y(){this.emitInitSegment=!1,this.audioCodec=void 0,this.videoCodec=void 0,this.initData=void 0,this.initPTS=void 0,this.initTracks=void 0,this.lastEndDTS=null}var C=y.prototype;return C.destroy=function(){},C.resetTimeStamp=function(u){this.initPTS=u,this.lastEndDTS=null},C.resetNextTimestamp=function(){this.lastEndDTS=null},C.resetInitSegment=function(u,d,E){this.audioCodec=d,this.videoCodec=E,this.generateInitSegment(u),this.emitInitSegment=!0},C.generateInitSegment=function(u){var d=this.audioCodec,E=this.videoCodec;if(!u||!u.byteLength){this.initTracks=void 0,this.initData=void 0;return}var c=this.initData=Object(k.parseInitSegment)(u);d||(d=O(c.audio,x.ElementaryStreamTypes.AUDIO)),E||(E=O(c.video,x.ElementaryStreamTypes.VIDEO));var a={};c.audio&&c.video?a.audiovideo={container:"video/mp4",codec:d+","+E,initSegment:u,id:"main"}:c.audio?a.audio={container:"audio/mp4",codec:d,initSegment:u,id:"audio"}:c.video?a.video={container:"video/mp4",codec:E,initSegment:u,id:"main"}:j.logger.warn("[passthrough-remuxer.ts]: initSegment does not contain moov or trak boxes."),this.initTracks=a},C.remux=function(u,d,E,c,a){var i=this.initPTS,l=this.lastEndDTS,p={audio:void 0,video:void 0,text:c,id3:E,initSegment:void 0};Object(H.isFiniteNumber)(l)||(l=this.lastEndDTS=a||0);var f=d.samples;if(!f||!f.length)return p;var h={initPTS:void 0,timescale:1},m=this.initData;if((!m||!m.length)&&(this.generateInitSegment(f),m=this.initData),!m||!m.length)return j.logger.warn("[passthrough-remuxer.ts]: Failed to generate initSegment."),p;this.emitInitSegment&&(h.tracks=this.initTracks,this.emitInitSegment=!1),Object(H.isFiniteNumber)(i)||(this.initPTS=h.initPTS=i=R(m,f,l));var L=Object(k.getDuration)(f,m),S=l,v=L+S;Object(k.offsetStartDTS)(m,f,i),L>0?this.lastEndDTS=v:(j.logger.warn("Duration parsed from mp4 should be greater than zero"),this.resetNextTimestamp());var n=!!m.audio,s=!!m.video,A="";n&&(A+="audio"),s&&(A+="video");var _={data1:f,startPTS:S,startDTS:S,endPTS:v,endDTS:v,type:A,hasAudio:n,hasVideo:s,nb:1,dropped:0};return p.audio=_.type==="audio"?_:void 0,p.video=_.type!=="audio"?_:void 0,p.text=c,p.id3=E,p.initSegment=h,p},y}(),R=function(C,P,u){return Object(k.getStartDTS)(C,P)-u};function O(y,C){var P=y==null?void 0:y.codec;return P&&P.length>4?P:P==="hvc1"?"hvc1.1.c.L120.90":P==="av01"?"av01.0.04M.08":P==="avc1"||C===x.ElementaryStreamTypes.VIDEO?"avc1.42e01e":"mp4a.40.5"}K.default=F},"./src/task-loop.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"default",function(){return H});var H=function(){function k(){this._boundTick=void 0,this._tickTimer=null,this._tickInterval=null,this._tickCallCount=0,this._boundTick=this.tick.bind(this)}var x=k.prototype;return x.destroy=function(){this.onHandlerDestroying(),this.onHandlerDestroyed()},x.onHandlerDestroying=function(){this.clearNextTick(),this.clearInterval()},x.onHandlerDestroyed=function(){},x.hasInterval=function(){return!!this._tickInterval},x.hasNextTick=function(){return!!this._tickTimer},x.setInterval=function(F){return this._tickInterval?!1:(this._tickInterval=self.setInterval(this._boundTick,F),!0)},x.clearInterval=function(){return this._tickInterval?(self.clearInterval(this._tickInterval),this._tickInterval=null,!0):!1},x.clearNextTick=function(){return this._tickTimer?(self.clearTimeout(this._tickTimer),this._tickTimer=null,!0):!1},x.tick=function(){this._tickCallCount++,this._tickCallCount===1&&(this.doTick(),this._tickCallCount>1&&this.tickImmediate(),this._tickCallCount=0)},x.tickImmediate=function(){this.clearNextTick(),this._tickTimer=self.setTimeout(this._boundTick,0)},x.doTick=function(){},k}()},"./src/types/level.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"HlsSkip",function(){return x}),M.d(K,"getSkipValue",function(){return j}),M.d(K,"HlsUrlParameters",function(){return F}),M.d(K,"Level",function(){return R});function H(O,y){for(var C=0;C<y.length;C++){var P=y[C];P.enumerable=P.enumerable||!1,P.configurable=!0,"value"in P&&(P.writable=!0),Object.defineProperty(O,P.key,P)}}function k(O,y,C){return y&&H(O.prototype,y),C&&H(O,C),O}var x;(function(O){O.No="",O.Yes="YES",O.v2="v2"})(x||(x={}));function j(O,y){var C=O.canSkipUntil,P=O.canSkipDateRanges,u=O.endSN,d=y!==void 0?y-u:0;return C&&d<C?P?x.v2:x.Yes:x.No}var F=function(){function O(C,P,u){this.msn=void 0,this.part=void 0,this.skip=void 0,this.msn=C,this.part=P,this.skip=u}var y=O.prototype;return y.addDirectives=function(P){var u=new self.URL(P);return this.msn!==void 0&&u.searchParams.set("_HLS_msn",this.msn.toString()),this.part!==void 0&&u.searchParams.set("_HLS_part",this.part.toString()),this.skip&&u.searchParams.set("_HLS_skip",this.skip),u.toString()},O}(),R=function(){function O(y){this.attrs=void 0,this.audioCodec=void 0,this.bitrate=void 0,this.codecSet=void 0,this.height=void 0,this.id=void 0,this.name=void 0,this.videoCodec=void 0,this.width=void 0,this.unknownCodecs=void 0,this.audioGroupIds=void 0,this.details=void 0,this.fragmentError=0,this.loadError=0,this.loaded=void 0,this.realBitrate=0,this.textGroupIds=void 0,this.url=void 0,this._urlId=0,this.url=[y.url],this.attrs=y.attrs,this.bitrate=y.bitrate,y.details&&(this.details=y.details),this.id=y.id||0,this.name=y.name,this.width=y.width||0,this.height=y.height||0,this.audioCodec=y.audioCodec,this.videoCodec=y.videoCodec,this.unknownCodecs=y.unknownCodecs,this.codecSet=[y.videoCodec,y.audioCodec].filter(function(C){return C}).join(",").replace(/\.[^.,]+/g,"")}return k(O,[{key:"maxBitrate",get:function(){return Math.max(this.realBitrate,this.bitrate)}},{key:"uri",get:function(){return this.url[this._urlId]||""}},{key:"urlId",get:function(){return this._urlId},set:function(C){var P=C%this.url.length;this._urlId!==P&&(this.details=void 0,this._urlId=P)}}]),O}()},"./src/types/loader.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"PlaylistContextType",function(){return H}),M.d(K,"PlaylistLevelType",function(){return k});var H;(function(x){x.MANIFEST="manifest",x.LEVEL="level",x.AUDIO_TRACK="audioTrack",x.SUBTITLE_TRACK="subtitleTrack"})(H||(H={}));var k;(function(x){x.MAIN="main",x.AUDIO="audio",x.SUBTITLE="subtitle"})(k||(k={}))},"./src/types/transmuxer.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"ChunkMetadata",function(){return H});var H=function(j,F,R,O,y,C){O===void 0&&(O=0),y===void 0&&(y=-1),C===void 0&&(C=!1),this.level=void 0,this.sn=void 0,this.part=void 0,this.id=void 0,this.size=void 0,this.partial=void 0,this.transmuxing=k(),this.buffering={audio:k(),video:k(),audiovideo:k()},this.level=j,this.sn=F,this.id=R,this.size=O,this.part=y,this.partial=C};function k(){return{start:0,executeStart:0,executeEnd:0,end:0}}},"./src/utils/attr-list.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"AttrList",function(){return x});var H=/^(\d+)x(\d+)$/,k=/\s*(.+?)\s*=((?:\".*?\")|.*?)(?:,|$)/g,x=function(){function j(R){typeof R=="string"&&(R=j.parseAttrList(R));for(var O in R)R.hasOwnProperty(O)&&(this[O]=R[O])}var F=j.prototype;return F.decimalInteger=function(O){var y=parseInt(this[O],10);return y>Number.MAX_SAFE_INTEGER?Infinity:y},F.hexadecimalInteger=function(O){if(this[O]){var y=(this[O]||"0x").slice(2);y=(y.length&1?"0":"")+y;for(var C=new Uint8Array(y.length/2),P=0;P<y.length/2;P++)C[P]=parseInt(y.slice(P*2,P*2+2),16);return C}else return null},F.hexadecimalIntegerAsNumber=function(O){var y=parseInt(this[O],16);return y>Number.MAX_SAFE_INTEGER?Infinity:y},F.decimalFloatingPoint=function(O){return parseFloat(this[O])},F.optionalFloat=function(O,y){var C=this[O];return C?parseFloat(C):y},F.enumeratedString=function(O){return this[O]},F.bool=function(O){return this[O]==="YES"},F.decimalResolution=function(O){var y=H.exec(this[O]);if(y!==null)return{width:parseInt(y[1],10),height:parseInt(y[2],10)}},j.parseAttrList=function(O){var y,C={},P='"';for(k.lastIndex=0;(y=k.exec(O))!==null;){var u=y[2];u.indexOf(P)===0&&u.lastIndexOf(P)===u.length-1&&(u=u.slice(1,-1)),C[y[1]]=u}return C},j}()},"./src/utils/binary-search.ts":function(re,K,M){"use strict";M.r(K);var H={search:function(x,j){for(var F=0,R=x.length-1,O=null,y=null;F<=R;){O=(F+R)/2|0,y=x[O];var C=j(y);if(C>0)F=O+1;else if(C<0)R=O-1;else return y}return null}};K.default=H},"./src/utils/buffer-helper.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"BufferHelper",function(){return x});var H=M("./src/utils/logger.ts"),k={length:0,start:function(){return 0},end:function(){return 0}},x=function(){function j(){}return j.isBuffered=function(R,O){try{if(R){for(var y=j.getBuffered(R),C=0;C<y.length;C++)if(O>=y.start(C)&&O<=y.end(C))return!0}}catch(P){}return!1},j.bufferInfo=function(R,O,y){try{if(R){var C=j.getBuffered(R),P=[],u;for(u=0;u<C.length;u++)P.push({start:C.start(u),end:C.end(u)});return this.bufferedInfo(P,O,y)}}catch(d){}return{len:0,start:O,end:O,nextStart:void 0}},j.bufferedInfo=function(R,O,y){O=Math.max(0,O),R.sort(function(h,m){var L=h.start-m.start;return L||m.end-h.end});var C=[];if(y)for(var P=0;P<R.length;P++){var u=C.length;if(u){var d=C[u-1].end;R[P].start-d<y?R[P].end>d&&(C[u-1].end=R[P].end):C.push(R[P])}else C.push(R[P])}else C=R;for(var E=0,c,a=O,i=O,l=0;l<C.length;l++){var p=C[l].start,f=C[l].end;if(O+y>=p&&O<f)a=p,i=f,E=i-O;else if(O+y<p){c=p;break}}return{len:E,start:a||0,end:i||0,nextStart:c}},j.getBuffered=function(R){try{return R.buffered}catch(O){return H.logger.log("failed to get media.buffered",O),k}},j}()},"./src/utils/cea-608-parser.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"Row",function(){return i}),M.d(K,"CaptionScreen",function(){return l});var H=M("./src/utils/logger.ts"),k={42:225,92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,127:9608,128:174,129:176,130:189,131:191,132:8482,133:162,134:163,135:9834,136:224,137:32,138:232,139:226,140:234,141:238,142:244,143:251,144:193,145:201,146:211,147:218,148:220,149:252,150:8216,151:161,152:42,153:8217,154:9473,155:169,156:8480,157:8226,158:8220,159:8221,160:192,161:194,162:199,163:200,164:202,165:203,166:235,167:206,168:207,169:239,170:212,171:217,172:249,173:219,174:171,175:187,176:195,177:227,178:205,179:204,180:236,181:210,182:242,183:213,184:245,185:123,186:125,187:92,188:94,189:95,190:124,191:8764,192:196,193:228,194:214,195:246,196:223,197:165,198:164,199:9475,200:197,201:229,202:216,203:248,204:9487,205:9491,206:9495,207:9499},x=function(v){var n=v;return k.hasOwnProperty(v)&&(n=k[v]),String.fromCharCode(n)},j=15,F=100,R={17:1,18:3,21:5,22:7,23:9,16:11,19:12,20:14},O={17:2,18:4,21:6,22:8,23:10,19:13,20:15},y={25:1,26:3,29:5,30:7,31:9,24:11,27:12,28:14},C={25:2,26:4,29:6,30:8,31:10,27:13,28:15},P=["white","green","blue","cyan","red","yellow","magenta","black","transparent"],u;(function(S){S[S.ERROR=0]="ERROR",S[S.TEXT=1]="TEXT",S[S.WARNING=2]="WARNING",S[S.INFO=2]="INFO",S[S.DEBUG=3]="DEBUG",S[S.DATA=3]="DATA"})(u||(u={}));var d=function(){function S(){this.time=null,this.verboseLevel=u.ERROR}var v=S.prototype;return v.log=function(s,A){this.verboseLevel>=s&&H.logger.log(this.time+" ["+s+"] "+A)},S}(),E=function(v){for(var n=[],s=0;s<v.length;s++)n.push(v[s].toString(16));return n},c=function(){function S(n,s,A,_,D){this.foreground=void 0,this.underline=void 0,this.italics=void 0,this.background=void 0,this.flash=void 0,this.foreground=n||"white",this.underline=s||!1,this.italics=A||!1,this.background=_||"black",this.flash=D||!1}var v=S.prototype;return v.reset=function(){this.foreground="white",this.underline=!1,this.italics=!1,this.background="black",this.flash=!1},v.setStyles=function(s){for(var A=["foreground","underline","italics","background","flash"],_=0;_<A.length;_++){var D=A[_];s.hasOwnProperty(D)&&(this[D]=s[D])}},v.isDefault=function(){return this.foreground==="white"&&!this.underline&&!this.italics&&this.background==="black"&&!this.flash},v.equals=function(s){return this.foreground===s.foreground&&this.underline===s.underline&&this.italics===s.italics&&this.background===s.background&&this.flash===s.flash},v.copy=function(s){this.foreground=s.foreground,this.underline=s.underline,this.italics=s.italics,this.background=s.background,this.flash=s.flash},v.toString=function(){return"color="+this.foreground+", underline="+this.underline+", italics="+this.italics+", background="+this.background+", flash="+this.flash},S}(),a=function(){function S(n,s,A,_,D,I){this.uchar=void 0,this.penState=void 0,this.uchar=n||" ",this.penState=new c(s,A,_,D,I)}var v=S.prototype;return v.reset=function(){this.uchar=" ",this.penState.reset()},v.setChar=function(s,A){this.uchar=s,this.penState.copy(A)},v.setPenState=function(s){this.penState.copy(s)},v.equals=function(s){return this.uchar===s.uchar&&this.penState.equals(s.penState)},v.copy=function(s){this.uchar=s.uchar,this.penState.copy(s.penState)},v.isEmpty=function(){return this.uchar===" "&&this.penState.isDefault()},S}(),i=function(){function S(n){this.chars=void 0,this.pos=void 0,this.currPenState=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chars=[];for(var s=0;s<F;s++)this.chars.push(new a);this.logger=n,this.pos=0,this.currPenState=new c}var v=S.prototype;return v.equals=function(s){for(var A=!0,_=0;_<F;_++)if(!this.chars[_].equals(s.chars[_])){A=!1;break}return A},v.copy=function(s){for(var A=0;A<F;A++)this.chars[A].copy(s.chars[A])},v.isEmpty=function(){for(var s=!0,A=0;A<F;A++)if(!this.chars[A].isEmpty()){s=!1;break}return s},v.setCursor=function(s){this.pos!==s&&(this.pos=s),this.pos<0?(this.logger.log(u.DEBUG,"Negative cursor position "+this.pos),this.pos=0):this.pos>F&&(this.logger.log(u.DEBUG,"Too large cursor position "+this.pos),this.pos=F)},v.moveCursor=function(s){var A=this.pos+s;if(s>1)for(var _=this.pos+1;_<A+1;_++)this.chars[_].setPenState(this.currPenState);this.setCursor(A)},v.backSpace=function(){this.moveCursor(-1),this.chars[this.pos].setChar(" ",this.currPenState)},v.insertChar=function(s){s>=144&&this.backSpace();var A=x(s);if(this.pos>=F){this.logger.log(u.ERROR,"Cannot insert "+s.toString(16)+" ("+A+") at position "+this.pos+". Skipping it!");return}this.chars[this.pos].setChar(A,this.currPenState),this.moveCursor(1)},v.clearFromPos=function(s){var A;for(A=s;A<F;A++)this.chars[A].reset()},v.clear=function(){this.clearFromPos(0),this.pos=0,this.currPenState.reset()},v.clearToEndOfRow=function(){this.clearFromPos(this.pos)},v.getTextString=function(){for(var s=[],A=!0,_=0;_<F;_++){var D=this.chars[_].uchar;D!==" "&&(A=!1),s.push(D)}return A?"":s.join("")},v.setPenStyles=function(s){this.currPenState.setStyles(s);var A=this.chars[this.pos];A.setPenState(this.currPenState)},S}(),l=function(){function S(n){this.rows=void 0,this.currRow=void 0,this.nrRollUpRows=void 0,this.lastOutputScreen=void 0,this.logger=void 0,this.rows=[];for(var s=0;s<j;s++)this.rows.push(new i(n));this.logger=n,this.currRow=j-1,this.nrRollUpRows=null,this.lastOutputScreen=null,this.reset()}var v=S.prototype;return v.reset=function(){for(var s=0;s<j;s++)this.rows[s].clear();this.currRow=j-1},v.equals=function(s){for(var A=!0,_=0;_<j;_++)if(!this.rows[_].equals(s.rows[_])){A=!1;break}return A},v.copy=function(s){for(var A=0;A<j;A++)this.rows[A].copy(s.rows[A])},v.isEmpty=function(){for(var s=!0,A=0;A<j;A++)if(!this.rows[A].isEmpty()){s=!1;break}return s},v.backSpace=function(){var s=this.rows[this.currRow];s.backSpace()},v.clearToEndOfRow=function(){var s=this.rows[this.currRow];s.clearToEndOfRow()},v.insertChar=function(s){var A=this.rows[this.currRow];A.insertChar(s)},v.setPen=function(s){var A=this.rows[this.currRow];A.setPenStyles(s)},v.moveCursor=function(s){var A=this.rows[this.currRow];A.moveCursor(s)},v.setCursor=function(s){this.logger.log(u.INFO,"setCursor: "+s);var A=this.rows[this.currRow];A.setCursor(s)},v.setPAC=function(s){this.logger.log(u.INFO,"pacData = "+JSON.stringify(s));var A=s.row-1;if(this.nrRollUpRows&&A<this.nrRollUpRows-1&&(A=this.nrRollUpRows-1),this.nrRollUpRows&&this.currRow!==A){for(var _=0;_<j;_++)this.rows[_].clear();var D=this.currRow+1-this.nrRollUpRows,I=this.lastOutputScreen;if(I){var w=I.rows[D].cueStartTime,B=this.logger.time;if(w&&B!==null&&w<B)for(var N=0;N<this.nrRollUpRows;N++)this.rows[A-this.nrRollUpRows+N+1].copy(I.rows[D+N])}}this.currRow=A;var W=this.rows[this.currRow];if(s.indent!==null){var G=s.indent,V=Math.max(G-1,0);W.setCursor(s.indent),s.color=W.chars[V].penState.foreground}var X={foreground:s.color,underline:s.underline,italics:s.italics,background:"black",flash:!1};this.setPen(X)},v.setBkgData=function(s){this.logger.log(u.INFO,"bkgData = "+JSON.stringify(s)),this.backSpace(),this.setPen(s),this.insertChar(32)},v.setRollUpRows=function(s){this.nrRollUpRows=s},v.rollUp=function(){if(this.nrRollUpRows===null){this.logger.log(u.DEBUG,"roll_up but nrRollUpRows not set yet");return}this.logger.log(u.TEXT,this.getDisplayText());var s=this.currRow+1-this.nrRollUpRows,A=this.rows.splice(s,1)[0];A.clear(),this.rows.splice(this.currRow,0,A),this.logger.log(u.INFO,"Rolling up")},v.getDisplayText=function(s){s=s||!1;for(var A=[],_="",D=-1,I=0;I<j;I++){var w=this.rows[I].getTextString();w&&(D=I+1,s?A.push("Row "+D+": '"+w+"'"):A.push(w.trim()))}return A.length>0&&(s?_="["+A.join(" | ")+"]":_=A.join(`
`)),_},v.getTextAndFormat=function(){return this.rows},S}(),p=function(){function S(n,s,A){this.chNr=void 0,this.outputFilter=void 0,this.mode=void 0,this.verbose=void 0,this.displayedMemory=void 0,this.nonDisplayedMemory=void 0,this.lastOutputScreen=void 0,this.currRollUpRow=void 0,this.writeScreen=void 0,this.cueStartTime=void 0,this.logger=void 0,this.chNr=n,this.outputFilter=s,this.mode=null,this.verbose=0,this.displayedMemory=new l(A),this.nonDisplayedMemory=new l(A),this.lastOutputScreen=new l(A),this.currRollUpRow=this.displayedMemory.rows[j-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null,this.logger=A}var v=S.prototype;return v.reset=function(){this.mode=null,this.displayedMemory.reset(),this.nonDisplayedMemory.reset(),this.lastOutputScreen.reset(),this.outputFilter.reset(),this.currRollUpRow=this.displayedMemory.rows[j-1],this.writeScreen=this.displayedMemory,this.mode=null,this.cueStartTime=null},v.getHandler=function(){return this.outputFilter},v.setHandler=function(s){this.outputFilter=s},v.setPAC=function(s){this.writeScreen.setPAC(s)},v.setBkgData=function(s){this.writeScreen.setBkgData(s)},v.setMode=function(s){s!==this.mode&&(this.mode=s,this.logger.log(u.INFO,"MODE="+s),this.mode==="MODE_POP-ON"?this.writeScreen=this.nonDisplayedMemory:(this.writeScreen=this.displayedMemory,this.writeScreen.reset()),this.mode!=="MODE_ROLL-UP"&&(this.displayedMemory.nrRollUpRows=null,this.nonDisplayedMemory.nrRollUpRows=null),this.mode=s)},v.insertChars=function(s){for(var A=0;A<s.length;A++)this.writeScreen.insertChar(s[A]);var _=this.writeScreen===this.displayedMemory?"DISP":"NON_DISP";this.logger.log(u.INFO,_+": "+this.writeScreen.getDisplayText(!0)),(this.mode==="MODE_PAINT-ON"||this.mode==="MODE_ROLL-UP")&&(this.logger.log(u.TEXT,"DISPLAYED: "+this.displayedMemory.getDisplayText(!0)),this.outputDataUpdate())},v.ccRCL=function(){this.logger.log(u.INFO,"RCL - Resume Caption Loading"),this.setMode("MODE_POP-ON")},v.ccBS=function(){this.logger.log(u.INFO,"BS - BackSpace"),this.mode!=="MODE_TEXT"&&(this.writeScreen.backSpace(),this.writeScreen===this.displayedMemory&&this.outputDataUpdate())},v.ccAOF=function(){},v.ccAON=function(){},v.ccDER=function(){this.logger.log(u.INFO,"DER- Delete to End of Row"),this.writeScreen.clearToEndOfRow(),this.outputDataUpdate()},v.ccRU=function(s){this.logger.log(u.INFO,"RU("+s+") - Roll Up"),this.writeScreen=this.displayedMemory,this.setMode("MODE_ROLL-UP"),this.writeScreen.setRollUpRows(s)},v.ccFON=function(){this.logger.log(u.INFO,"FON - Flash On"),this.writeScreen.setPen({flash:!0})},v.ccRDC=function(){this.logger.log(u.INFO,"RDC - Resume Direct Captioning"),this.setMode("MODE_PAINT-ON")},v.ccTR=function(){this.logger.log(u.INFO,"TR"),this.setMode("MODE_TEXT")},v.ccRTD=function(){this.logger.log(u.INFO,"RTD"),this.setMode("MODE_TEXT")},v.ccEDM=function(){this.logger.log(u.INFO,"EDM - Erase Displayed Memory"),this.displayedMemory.reset(),this.outputDataUpdate(!0)},v.ccCR=function(){this.logger.log(u.INFO,"CR - Carriage Return"),this.writeScreen.rollUp(),this.outputDataUpdate(!0)},v.ccENM=function(){this.logger.log(u.INFO,"ENM - Erase Non-displayed Memory"),this.nonDisplayedMemory.reset()},v.ccEOC=function(){if(this.logger.log(u.INFO,"EOC - End Of Caption"),this.mode==="MODE_POP-ON"){var s=this.displayedMemory;this.displayedMemory=this.nonDisplayedMemory,this.nonDisplayedMemory=s,this.writeScreen=this.nonDisplayedMemory,this.logger.log(u.TEXT,"DISP: "+this.displayedMemory.getDisplayText())}this.outputDataUpdate(!0)},v.ccTO=function(s){this.logger.log(u.INFO,"TO("+s+") - Tab Offset"),this.writeScreen.moveCursor(s)},v.ccMIDROW=function(s){var A={flash:!1};if(A.underline=s%2==1,A.italics=s>=46,A.italics)A.foreground="white";else{var _=Math.floor(s/2)-16,D=["white","green","blue","cyan","red","yellow","magenta"];A.foreground=D[_]}this.logger.log(u.INFO,"MIDROW: "+JSON.stringify(A)),this.writeScreen.setPen(A)},v.outputDataUpdate=function(s){s===void 0&&(s=!1);var A=this.logger.time;A!==null&&this.outputFilter&&(this.cueStartTime===null&&!this.displayedMemory.isEmpty()?this.cueStartTime=A:this.displayedMemory.equals(this.lastOutputScreen)||(this.outputFilter.newCue(this.cueStartTime,A,this.lastOutputScreen),s&&this.outputFilter.dispatchCue&&this.outputFilter.dispatchCue(),this.cueStartTime=this.displayedMemory.isEmpty()?null:A),this.lastOutputScreen.copy(this.displayedMemory))},v.cueSplitAtTime=function(s){this.outputFilter&&(this.displayedMemory.isEmpty()||(this.outputFilter.newCue&&this.outputFilter.newCue(this.cueStartTime,s,this.displayedMemory),this.cueStartTime=s))},S}(),f=function(){function S(n,s,A){this.channels=void 0,this.currentChannel=0,this.cmdHistory=void 0,this.logger=void 0;var _=new d;this.channels=[null,new p(n,s,_),new p(n+1,A,_)],this.cmdHistory=L(),this.logger=_}var v=S.prototype;return v.getHandler=function(s){return this.channels[s].getHandler()},v.setHandler=function(s,A){this.channels[s].setHandler(A)},v.addData=function(s,A){var _,D,I,w=!1;this.logger.time=s;for(var B=0;B<A.length;B+=2)if(D=A[B]&127,I=A[B+1]&127,!(D===0&&I===0)){if(this.logger.log(u.DATA,"["+E([A[B],A[B+1]])+"] -> ("+E([D,I])+")"),_=this.parseCmd(D,I),_||(_=this.parseMidrow(D,I)),_||(_=this.parsePAC(D,I)),_||(_=this.parseBackgroundAttributes(D,I)),!_&&(w=this.parseChars(D,I),w)){var N=this.currentChannel;if(N&&N>0){var W=this.channels[N];W.insertChars(w)}else this.logger.log(u.WARNING,"No channel found yet. TEXT-MODE?")}!_&&!w&&this.logger.log(u.WARNING,"Couldn't parse cleaned data "+E([D,I])+" orig: "+E([A[B],A[B+1]]))}},v.parseCmd=function(s,A){var _=this.cmdHistory,D=(s===20||s===28||s===21||s===29)&&A>=32&&A<=47,I=(s===23||s===31)&&A>=33&&A<=35;if(!(D||I))return!1;if(m(s,A,_))return h(null,null,_),this.logger.log(u.DEBUG,"Repeated command ("+E([s,A])+") is dropped"),!0;var w=s===20||s===21||s===23?1:2,B=this.channels[w];return s===20||s===21||s===28||s===29?A===32?B.ccRCL():A===33?B.ccBS():A===34?B.ccAOF():A===35?B.ccAON():A===36?B.ccDER():A===37?B.ccRU(2):A===38?B.ccRU(3):A===39?B.ccRU(4):A===40?B.ccFON():A===41?B.ccRDC():A===42?B.ccTR():A===43?B.ccRTD():A===44?B.ccEDM():A===45?B.ccCR():A===46?B.ccENM():A===47&&B.ccEOC():B.ccTO(A-32),h(s,A,_),this.currentChannel=w,!0},v.parseMidrow=function(s,A){var _=0;if((s===17||s===25)&&A>=32&&A<=47){if(s===17?_=1:_=2,_!==this.currentChannel)return this.logger.log(u.ERROR,"Mismatch channel in midrow parsing"),!1;var D=this.channels[_];return D?(D.ccMIDROW(A),this.logger.log(u.DEBUG,"MIDROW ("+E([s,A])+")"),!0):!1}return!1},v.parsePAC=function(s,A){var _,D=this.cmdHistory,I=(s>=17&&s<=23||s>=25&&s<=31)&&A>=64&&A<=127,w=(s===16||s===24)&&A>=64&&A<=95;if(!(I||w))return!1;if(m(s,A,D))return h(null,null,D),!0;var B=s<=23?1:2;A>=64&&A<=95?_=B===1?R[s]:y[s]:_=B===1?O[s]:C[s];var N=this.channels[B];return N?(N.setPAC(this.interpretPAC(_,A)),h(s,A,D),this.currentChannel=B,!0):!1},v.interpretPAC=function(s,A){var _,D={color:null,italics:!1,indent:null,underline:!1,row:s};return A>95?_=A-96:_=A-64,D.underline=(_&1)==1,_<=13?D.color=["white","green","blue","cyan","red","yellow","magenta","white"][Math.floor(_/2)]:_<=15?(D.italics=!0,D.color="white"):D.indent=Math.floor((_-16)/2)*4,D},v.parseChars=function(s,A){var _,D=null,I=null;if(s>=25?(_=2,I=s-8):(_=1,I=s),I>=17&&I<=19){var w;I===17?w=A+80:I===18?w=A+112:w=A+144,this.logger.log(u.INFO,"Special char '"+x(w)+"' in channel "+_),D=[w]}else s>=32&&s<=127&&(D=A===0?[s]:[s,A]);if(D){var B=E(D);this.logger.log(u.DEBUG,"Char codes =  "+B.join(",")),h(s,A,this.cmdHistory)}return D},v.parseBackgroundAttributes=function(s,A){var _=(s===16||s===24)&&A>=32&&A<=47,D=(s===23||s===31)&&A>=45&&A<=47;if(!(_||D))return!1;var I,w={};s===16||s===24?(I=Math.floor((A-32)/2),w.background=P[I],A%2==1&&(w.background=w.background+"_semi")):A===45?w.background="transparent":(w.foreground="black",A===47&&(w.underline=!0));var B=s<=23?1:2,N=this.channels[B];return N.setBkgData(w),h(s,A,this.cmdHistory),!0},v.reset=function(){for(var s=0;s<Object.keys(this.channels).length;s++){var A=this.channels[s];A&&A.reset()}this.cmdHistory=L()},v.cueSplitAtTime=function(s){for(var A=0;A<this.channels.length;A++){var _=this.channels[A];_&&_.cueSplitAtTime(s)}},S}();function h(S,v,n){n.a=S,n.b=v}function m(S,v,n){return n.a===S&&n.b===v}function L(){return{a:null,b:null}}K.default=f},"./src/utils/codecs.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"isCodecType",function(){return k}),M.d(K,"isCodecSupportedInMp4",function(){return x});var H={audio:{a3ds:!0,"ac-3":!0,"ac-4":!0,alac:!0,alaw:!0,dra1:!0,"dts+":!0,"dts-":!0,dtsc:!0,dtse:!0,dtsh:!0,"ec-3":!0,enca:!0,g719:!0,g726:!0,m4ae:!0,mha1:!0,mha2:!0,mhm1:!0,mhm2:!0,mlpa:!0,mp4a:!0,"raw ":!0,Opus:!0,samr:!0,sawb:!0,sawp:!0,sevc:!0,sqcp:!0,ssmv:!0,twos:!0,ulaw:!0},video:{avc1:!0,avc2:!0,avc3:!0,avc4:!0,avcp:!0,av01:!0,drac:!0,dvav:!0,dvhe:!0,encv:!0,hev1:!0,hvc1:!0,mjp2:!0,mp4v:!0,mvc1:!0,mvc2:!0,mvc3:!0,mvc4:!0,resv:!0,rv60:!0,s263:!0,svc1:!0,svc2:!0,"vc-1":!0,vp08:!0,vp09:!0},text:{stpp:!0,wvtt:!0}};function k(j,F){var R=H[F];return!!R&&R[j.slice(0,4)]===!0}function x(j,F){return MediaSource.isTypeSupported((F||"video")+'/mp4;codecs="'+j+'"')}},"./src/utils/cues.ts":function(re,K,M){"use strict";M.r(K);var H=M("./src/utils/vttparser.ts"),k=M("./src/utils/webvtt-parser.ts"),x=M("./src/utils/texttrack-utils.ts"),j=/\s/,F={newCue:function(O,y,C,P){for(var u=[],d,E,c,a,i,l=self.VTTCue||self.TextTrackCue,p=0;p<P.rows.length;p++)if(d=P.rows[p],c=!0,a=0,i="",!d.isEmpty()){for(var f=0;f<d.chars.length;f++)j.test(d.chars[f].uchar)&&c?a++:(i+=d.chars[f].uchar,c=!1);d.cueStartTime=y,y===C&&(C+=1e-4),a>=16?a--:a++;var h=Object(H.fixLineBreaks)(i.trim()),m=Object(k.generateCueId)(y,C,h);(!O||!O.cues||!O.cues.getCueById(m))&&(E=new l(y,C,h),E.id=m,E.line=p+1,E.align="left",E.position=10+Math.min(80,Math.floor(a*8/32)*10),u.push(E))}return O&&u.length&&(u.sort(function(L,S){return L.line==="auto"||S.line==="auto"?0:L.line>8&&S.line>8?S.line-L.line:L.line-S.line}),u.forEach(function(L){return Object(x.addCueToTrack)(O,L)})),u}};K.default=F},"./src/utils/discontinuities.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"findFirstFragWithCC",function(){return j}),M.d(K,"shouldAlignOnDiscontinuities",function(){return F}),M.d(K,"findDiscontinuousReferenceFrag",function(){return R}),M.d(K,"adjustSlidingStart",function(){return y}),M.d(K,"alignStream",function(){return C}),M.d(K,"alignPDT",function(){return u});var H=M("./src/polyfills/number.ts"),k=M("./src/utils/logger.ts"),x=M("./src/controller/level-helper.ts");function j(d,E){for(var c=null,a=0,i=d.length;a<i;a++){var l=d[a];if(l&&l.cc===E){c=l;break}}return c}function F(d,E,c){return!!(E.details&&(c.endCC>c.startCC||d&&d.cc<c.startCC))}function R(d,E){var c=d.fragments,a=E.fragments;if(!a.length||!c.length){k.logger.log("No fragments to align");return}var i=j(c,a[0].cc);if(!i||i&&!i.startPTS){k.logger.log("No frag in previous level to align on");return}return i}function O(d,E){if(d){var c=d.start+E;d.start=d.startPTS=c,d.endPTS=c+d.duration}}function y(d,E){for(var c=E.fragments,a=0,i=c.length;a<i;a++)O(c[a],d);E.fragmentHint&&O(E.fragmentHint,d),E.alignedSliding=!0}function C(d,E,c){!E||(P(d,c,E),!c.alignedSliding&&E.details&&u(c,E.details),!c.alignedSliding&&E.details&&!c.skippedSegments&&Object(x.adjustSliding)(E.details,c))}function P(d,E,c){if(F(d,c,E)){var a=R(c.details,E);a&&Object(H.isFiniteNumber)(a.start)&&(k.logger.log("Adjusting PTS using last level due to CC increase within current level "+E.url),y(a.start,E))}}function u(d,E){if(!(!E.fragments.length||!d.hasProgramDateTime||!E.hasProgramDateTime)){var c=E.fragments[0].programDateTime,a=d.fragments[0].programDateTime,i=(a-c)/1e3+E.fragments[0].start;i&&Object(H.isFiniteNumber)(i)&&(k.logger.log("Adjusting PTS using programDateTime delta "+(a-c)+"ms, sliding:"+i.toFixed(3)+" "+d.url+" "),y(i,d))}}},"./src/utils/ewma-bandwidth-estimator.ts":function(re,K,M){"use strict";M.r(K);var H=M("./src/utils/ewma.ts"),k=function(){function x(F,R,O){this.defaultEstimate_=void 0,this.minWeight_=void 0,this.minDelayMs_=void 0,this.slow_=void 0,this.fast_=void 0,this.defaultEstimate_=O,this.minWeight_=.001,this.minDelayMs_=50,this.slow_=new H.default(F),this.fast_=new H.default(R)}var j=x.prototype;return j.update=function(R,O){var y=this.slow_,C=this.fast_;this.slow_.halfLife!==R&&(this.slow_=new H.default(R,y.getEstimate(),y.getTotalWeight())),this.fast_.halfLife!==O&&(this.fast_=new H.default(O,C.getEstimate(),C.getTotalWeight()))},j.sample=function(R,O){R=Math.max(R,this.minDelayMs_);var y=8*O,C=R/1e3,P=y/C;this.fast_.sample(C,P),this.slow_.sample(C,P)},j.canEstimate=function(){var R=this.fast_;return R&&R.getTotalWeight()>=this.minWeight_},j.getEstimate=function(){return this.canEstimate()?Math.min(this.fast_.getEstimate(),this.slow_.getEstimate()):this.defaultEstimate_},j.destroy=function(){},x}();K.default=k},"./src/utils/ewma.ts":function(re,K,M){"use strict";M.r(K);var H=function(){function k(j,F,R){F===void 0&&(F=0),R===void 0&&(R=0),this.halfLife=void 0,this.alpha_=void 0,this.estimate_=void 0,this.totalWeight_=void 0,this.halfLife=j,this.alpha_=j?Math.exp(Math.log(.5)/j):0,this.estimate_=F,this.totalWeight_=R}var x=k.prototype;return x.sample=function(F,R){var O=Math.pow(this.alpha_,F);this.estimate_=R*(1-O)+O*this.estimate_,this.totalWeight_+=F},x.getTotalWeight=function(){return this.totalWeight_},x.getEstimate=function(){if(this.alpha_){var F=1-Math.pow(this.alpha_,this.totalWeight_);if(F)return this.estimate_/F}return this.estimate_},k}();K.default=H},"./src/utils/fetch-loader.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"fetchSupported",function(){return u});var H=M("./src/polyfills/number.ts"),k=M("./src/loader/load-stats.ts"),x=M("./src/demux/chunk-cache.ts");function j(i,l){i.prototype=Object.create(l.prototype),i.prototype.constructor=i,C(i,l)}function F(i){var l=typeof Map=="function"?new Map:void 0;return F=function(f){if(f===null||!y(f))return f;if(typeof f!="function")throw new TypeError("Super expression must either be null or a function");if(typeof l!="undefined"){if(l.has(f))return l.get(f);l.set(f,h)}function h(){return R(f,arguments,P(this).constructor)}return h.prototype=Object.create(f.prototype,{constructor:{value:h,enumerable:!1,writable:!0,configurable:!0}}),C(h,f)},F(i)}function R(i,l,p){return O()?R=Reflect.construct:R=function(h,m,L){var S=[null];S.push.apply(S,m);var v=Function.bind.apply(h,S),n=new v;return L&&C(n,L.prototype),n},R.apply(null,arguments)}function O(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(i){return!1}}function y(i){return Function.toString.call(i).indexOf("[native code]")!==-1}function C(i,l){return C=Object.setPrototypeOf||function(f,h){return f.__proto__=h,f},C(i,l)}function P(i){return P=Object.setPrototypeOf?Object.getPrototypeOf:function(p){return p.__proto__||Object.getPrototypeOf(p)},P(i)}function u(){if(self.fetch&&self.AbortController&&self.ReadableStream&&self.Request)try{return new self.ReadableStream({}),!0}catch(i){}return!1}var d=function(){function i(p){this.fetchSetup=void 0,this.requestTimeout=void 0,this.request=void 0,this.response=void 0,this.controller=void 0,this.context=void 0,this.config=null,this.callbacks=null,this.stats=void 0,this.loader=null,this.fetchSetup=p.fetchSetup||c,this.controller=new self.AbortController,this.stats=new k.LoadStats}var l=i.prototype;return l.destroy=function(){this.loader=this.callbacks=null,this.abortInternal()},l.abortInternal=function(){var f=this.response;(!f||!f.ok)&&(this.stats.aborted=!0,this.controller.abort())},l.abort=function(){var f;this.abortInternal(),(f=this.callbacks)!==null&&f!==void 0&&f.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.response)},l.load=function(f,h,m){var L=this,S=this.stats;if(S.loading.start)throw new Error("Loader can only be used once.");S.loading.start=self.performance.now();var v=E(f,this.controller.signal),n=m.onProgress,s=f.responseType==="arraybuffer",A=s?"byteLength":"length";this.context=f,this.config=h,this.callbacks=m,this.request=this.fetchSetup(f,v),self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(function(){L.abortInternal(),m.onTimeout(S,f,L.response)},h.timeout),self.fetch(this.request).then(function(_){if(L.response=L.loader=_,!_.ok){var D=_.status,I=_.statusText;throw new a(I||"fetch, bad network response",D,_)}return S.loading.first=Math.max(self.performance.now(),S.loading.start),S.total=parseInt(_.headers.get("Content-Length")||"0"),n&&Object(H.isFiniteNumber)(h.highWaterMark)?L.loadProgressively(_,S,f,h.highWaterMark,n):s?_.arrayBuffer():_.text()}).then(function(_){var D=L.response;self.clearTimeout(L.requestTimeout),S.loading.end=Math.max(self.performance.now(),S.loading.first),S.loaded=S.total=_[A];var I={url:D.url,data:_};n&&!Object(H.isFiniteNumber)(h.highWaterMark)&&n(S,f,_,D),m.onSuccess(I,S,f,D)}).catch(function(_){if(self.clearTimeout(L.requestTimeout),!S.aborted){var D=_.code||0;m.onError({code:D,text:_.message},f,_.details)}})},l.getCacheAge=function(){var f=null;if(this.response){var h=this.response.headers.get("age");f=h?parseFloat(h):null}return f},l.loadProgressively=function(f,h,m,L,S){L===void 0&&(L=0);var v=new x.default,n=f.body.getReader(),s=function A(){return n.read().then(function(_){if(_.done)return v.dataLength&&S(h,m,v.flush(),f),Promise.resolve(new ArrayBuffer(0));var D=_.value,I=D.length;return h.loaded+=I,I<L||v.dataLength?(v.push(D),v.dataLength>=L&&S(h,m,v.flush(),f)):S(h,m,D,f),A()}).catch(function(){return Promise.reject()})};return s()},i}();function E(i,l){var p={method:"GET",mode:"cors",credentials:"same-origin",signal:l};return i.rangeEnd&&(p.headers=new self.Headers({Range:"bytes="+i.rangeStart+"-"+String(i.rangeEnd-1)})),p}function c(i,l){return new self.Request(i.url,l)}var a=function(i){j(l,i);function l(p,f,h){var m;return m=i.call(this,p)||this,m.code=void 0,m.details=void 0,m.code=f,m.details=h,m}return l}(F(Error));K.default=d},"./src/utils/imsc1-ttml-parser.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"IMSC1_CODEC",function(){return y}),M.d(K,"parseIMSC1",function(){return d});var H=M("./src/utils/mp4-tools.ts"),k=M("./src/utils/vttparser.ts"),x=M("./src/utils/vttcue.ts"),j=M("./src/demux/id3.ts"),F=M("./src/utils/timescale-conversion.ts"),R=M("./src/utils/webvtt-parser.ts");function O(){return O=Object.assign||function(S){for(var v=1;v<arguments.length;v++){var n=arguments[v];for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(S[s]=n[s])}return S},O.apply(this,arguments)}var y="stpp.ttml.im1t",C=/^(\d{2,}):(\d{2}):(\d{2}):(\d{2})\.?(\d+)?$/,P=/^(\d*(?:\.\d*)?)(h|m|s|ms|f|t)$/,u={left:"start",center:"center",right:"end",start:"start",end:"end"};function d(S,v,n,s,A){var _=Object(H.findBox)(new Uint8Array(S),["mdat"]);if(_.length===0){A(new Error("Could not parse IMSC1 mdat"));return}var D=_[0],I=Object(j.utf8ArrayToStr)(new Uint8Array(S,D.start,D.end-D.start)),w=Object(F.toTimescaleFromScale)(v,1,n);try{s(E(I,w))}catch(B){A(B)}}function E(S,v){var n=new DOMParser,s=n.parseFromString(S,"text/xml"),A=s.getElementsByTagName("tt")[0];if(!A)throw new Error("Invalid ttml");var _={frameRate:30,subFrameRate:1,frameRateMultiplier:0,tickRate:0},D=Object.keys(_).reduce(function(W,G){return W[G]=A.getAttribute("ttp:"+G)||_[G],W},{}),I=A.getAttribute("xml:space")!=="preserve",w=a(c(A,"styling","style")),B=a(c(A,"layout","region")),N=c(A,"body","[begin]");return[].map.call(N,function(W){var G=i(W,I);if(!G||!W.hasAttribute("begin"))return null;var V=h(W.getAttribute("begin"),D),X=h(W.getAttribute("dur"),D),$=h(W.getAttribute("end"),D);if(V===null)throw f(W);if($===null){if(X===null)throw f(W);$=V+X}var q=new x.default(V-v,$-v,G);q.id=Object(R.generateCueId)(q.startTime,q.endTime,q.text);var Z=B[W.getAttribute("region")],ee=w[W.getAttribute("style")];q.position=10,q.size=80;var ie=l(Z,ee),ue=ie.textAlign;if(ue){var se=u[ue];se&&(q.lineAlign=se),q.align=ue}return O(q,ie),q}).filter(function(W){return W!==null})}function c(S,v,n){var s=S.getElementsByTagName(v)[0];return s?[].slice.call(s.querySelectorAll(n)):[]}function a(S){return S.reduce(function(v,n){var s=n.getAttribute("xml:id");return s&&(v[s]=n),v},{})}function i(S,v){return[].slice.call(S.childNodes).reduce(function(n,s,A){var _;return s.nodeName==="br"&&A?n+`
`:(_=s.childNodes)!==null&&_!==void 0&&_.length?i(s,v):v?n+s.textContent.trim().replace(/\s+/g," "):n+s.textContent},"")}function l(S,v){var n="http://www.w3.org/ns/ttml#styling",s=["displayAlign","textAlign","color","backgroundColor","fontSize","fontFamily"];return s.reduce(function(A,_){var D=p(v,n,_)||p(S,n,_);return D&&(A[_]=D),A},{})}function p(S,v,n){return S.hasAttributeNS(v,n)?S.getAttributeNS(v,n):null}function f(S){return new Error("Could not parse ttml timestamp "+S)}function h(S,v){if(!S)return null;var n=Object(k.parseTimeStamp)(S);return n===null&&(C.test(S)?n=m(S,v):P.test(S)&&(n=L(S,v))),n}function m(S,v){var n=C.exec(S),s=(n[4]|0)+(n[5]|0)/v.subFrameRate;return(n[1]|0)*3600+(n[2]|0)*60+(n[3]|0)+s/v.frameRate}function L(S,v){var n=P.exec(S),s=Number(n[1]),A=n[2];switch(A){case"h":return s*3600;case"m":return s*60;case"ms":return s*1e3;case"f":return s/v.frameRate;case"t":return s/v.tickRate}return s}},"./src/utils/logger.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"enableLogs",function(){return R}),M.d(K,"logger",function(){return O});var H=function(){},k={trace:H,debug:H,log:H,warn:H,info:H,error:H},x=k;function j(y){var C=self.console[y];return C?C.bind(self.console,"["+y+"] >"):H}function F(y){for(var C=arguments.length,P=new Array(C>1?C-1:0),u=1;u<C;u++)P[u-1]=arguments[u];P.forEach(function(d){x[d]=y[d]?y[d].bind(y):j(d)})}function R(y){if(self.console&&y===!0||typeof y=="object"){F(y,"debug","log","info","warn","error");try{x.log()}catch(C){x=k}}else x=k}var O=x},"./src/utils/mediakeys-helper.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"KeySystems",function(){return H}),M.d(K,"requestMediaKeySystemAccess",function(){return k});var H;(function(x){x.WIDEVINE="com.widevine.alpha",x.PLAYREADY="com.microsoft.playready"})(H||(H={}));var k=function(){return typeof self!="undefined"&&self.navigator&&self.navigator.requestMediaKeySystemAccess?self.navigator.requestMediaKeySystemAccess.bind(self.navigator):null}()},"./src/utils/mediasource-helper.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"getMediaSource",function(){return H});function H(){return self.MediaSource||self.WebKitMediaSource}},"./src/utils/mp4-tools.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"bin2str",function(){return F}),M.d(K,"readUint16",function(){return R}),M.d(K,"readUint32",function(){return O}),M.d(K,"writeUint32",function(){return y}),M.d(K,"findBox",function(){return C}),M.d(K,"parseSegmentIndex",function(){return P}),M.d(K,"parseInitSegment",function(){return u}),M.d(K,"getStartDTS",function(){return d}),M.d(K,"getDuration",function(){return E}),M.d(K,"computeRawDurationFromSamples",function(){return c}),M.d(K,"offsetStartDTS",function(){return a}),M.d(K,"segmentValidRange",function(){return i}),M.d(K,"appendUint8Array",function(){return l});var H=M("./src/utils/typed-array.ts"),k=M("./src/loader/fragment.ts"),x=Math.pow(2,32)-1,j=[].push;function F(p){return String.fromCharCode.apply(null,p)}function R(p,f){"data"in p&&(f+=p.start,p=p.data);var h=p[f]<<8|p[f+1];return h<0?65536+h:h}function O(p,f){"data"in p&&(f+=p.start,p=p.data);var h=p[f]<<24|p[f+1]<<16|p[f+2]<<8|p[f+3];return h<0?4294967296+h:h}function y(p,f,h){"data"in p&&(f+=p.start,p=p.data),p[f]=h>>24,p[f+1]=h>>16&255,p[f+2]=h>>8&255,p[f+3]=h&255}function C(p,f){var h=[];if(!f.length)return h;var m,L,S;"data"in p?(m=p.data,L=p.start,S=p.end):(m=p,L=0,S=m.byteLength);for(var v=L;v<S;){var n=O(m,v),s=F(m.subarray(v+4,v+8)),A=n>1?v+n:S;if(s===f[0])if(f.length===1)h.push({data:m,start:v+8,end:A});else{var _=C({data:m,start:v+8,end:A},f.slice(1));_.length&&j.apply(h,_)}v=A}return h}function P(p){var f=C(p,["moov"]),h=f[0],m=h?h.end:null,L=C(p,["sidx"]);if(!L||!L[0])return null;var S=[],v=L[0],n=v.data[0],s=n===0?8:16,A=O(v,s);s+=4;var _=0,D=0;n===0?s+=8:s+=16,s+=2;var I=v.end+D,w=R(v,s);s+=2;for(var B=0;B<w;B++){var N=s,W=O(v,N);N+=4;var G=W&2147483647,V=(W&2147483648)>>>31;if(V===1)return console.warn("SIDX has hierarchical references (not supported)"),null;var X=O(v,N);N+=4,S.push({referenceSize:G,subsegmentDuration:X,info:{duration:X/A,start:I,end:I+G-1}}),I+=G,N+=4,s=N}return{earliestPresentationTime:_,timescale:A,version:n,referencesCount:w,references:S,moovEndOffset:m}}function u(p){for(var f=[],h=C(p,["moov","trak"]),m=0;m<h.length;m++){var L=h[m],S=C(L,["tkhd"])[0];if(S){var v=S.data[S.start],n=v===0?12:20,s=O(S,n),A=C(L,["mdia","mdhd"])[0];if(A){v=A.data[A.start],n=v===0?12:20;var _=O(A,n),D=C(L,["mdia","hdlr"])[0];if(D){var I=F(D.data.subarray(D.start+8,D.start+12)),w={soun:k.ElementaryStreamTypes.AUDIO,vide:k.ElementaryStreamTypes.VIDEO}[I];if(w){var B=C(L,["mdia","minf","stbl","stsd"])[0],N=void 0;B&&(N=F(B.data.subarray(B.start+12,B.start+16))),f[s]={timescale:_,type:w},f[w]={timescale:_,id:s,codec:N}}}}}}var W=C(p,["moov","mvex","trex"]);return W.forEach(function(G){var V=O(G,4),X=f[V];X&&(X.default={duration:O(G,12),flags:O(G,20)})}),f}function d(p,f){return C(f,["moof","traf"]).reduce(function(h,m){var L=C(m,["tfdt"])[0],S=L.data[L.start],v=C(m,["tfhd"]).reduce(function(n,s){var A=O(s,4),_=p[A];if(_){var D=O(L,4);S===1&&(D*=Math.pow(2,32),D+=O(L,8));var I=_.timescale||9e4,w=D/I;if(isFinite(w)&&(n===null||w<n))return w}return n},null);return v!==null&&isFinite(v)&&(h===null||v<h)?v:h},null)||0}function E(p,f){for(var h=0,m=0,L=0,S=C(p,["moof","traf"]),v=0;v<S.length;v++){var n=S[v],s=C(n,["tfhd"])[0],A=O(s,4),_=f[A];if(!!_){var D=_.default,I=O(s,0)|(D==null?void 0:D.flags),w=D==null?void 0:D.duration;I&8&&(I&2?w=O(s,12):w=O(s,8));for(var B=_.timescale||9e4,N=C(n,["trun"]),W=0;W<N.length;W++){if(w){var G=O(N[W],4);h=w*G}else h=c(N[W]);_.type===k.ElementaryStreamTypes.VIDEO?m+=h/B:_.type===k.ElementaryStreamTypes.AUDIO&&(L+=h/B)}}}if(m===0&&L===0){var V=P(p);if(V!=null&&V.references)return V.references.reduce(function(X,$){return X+$.info.duration||0},0)}return m||L}function c(p){var f=O(p,0),h=8;f&1&&(h+=4),f&4&&(h+=4);for(var m=0,L=O(p,4),S=0;S<L;S++){if(f&256){var v=O(p,h);m+=v,h+=4}f&512&&(h+=4),f&1024&&(h+=4),f&2048&&(h+=4)}return m}function a(p,f,h){C(f,["moof","traf"]).forEach(function(m){C(m,["tfhd"]).forEach(function(L){var S=O(L,4),v=p[S];if(!!v){var n=v.timescale||9e4;C(m,["tfdt"]).forEach(function(s){var A=s.data[s.start],_=O(s,4);if(A===0)y(s,4,_-h*n);else{_*=Math.pow(2,32),_+=O(s,8),_-=h*n,_=Math.max(_,0);var D=Math.floor(_/(x+1)),I=Math.floor(_%(x+1));y(s,4,D),y(s,8,I)}})}})})}function i(p){var f={valid:null,remainder:null},h=C(p,["moof"]);if(h){if(h.length<2)return f.remainder=p,f}else return f;var m=h[h.length-1];return f.valid=Object(H.sliceUint8)(p,0,m.start-8),f.remainder=Object(H.sliceUint8)(p,m.start-8),f}function l(p,f){var h=new Uint8Array(p.length+f.length);return h.set(p),h.set(f,p.length),h}},"./src/utils/output-filter.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"default",function(){return H});var H=function(){function k(j,F){this.timelineController=void 0,this.cueRanges=[],this.trackName=void 0,this.startTime=null,this.endTime=null,this.screen=null,this.timelineController=j,this.trackName=F}var x=k.prototype;return x.dispatchCue=function(){this.startTime!==null&&(this.timelineController.addCues(this.trackName,this.startTime,this.endTime,this.screen,this.cueRanges),this.startTime=null)},x.newCue=function(F,R,O){(this.startTime===null||this.startTime>F)&&(this.startTime=F),this.endTime=R,this.screen=O,this.timelineController.createCaptionsTrack(this.trackName)},x.reset=function(){this.cueRanges=[]},k}()},"./src/utils/texttrack-utils.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"sendAddTrackEvent",function(){return k}),M.d(K,"addCueToTrack",function(){return x}),M.d(K,"clearCurrentCues",function(){return j}),M.d(K,"removeCuesInRange",function(){return F}),M.d(K,"getCuesInRange",function(){return O});var H=M("./src/utils/logger.ts");function k(y,C){var P;try{P=new Event("addtrack")}catch(u){P=document.createEvent("Event"),P.initEvent("addtrack",!1,!1)}P.track=y,C.dispatchEvent(P)}function x(y,C){var P=y.mode;if(P==="disabled"&&(y.mode="hidden"),y.cues&&!y.cues.getCueById(C.id))try{if(y.addCue(C),!y.cues.getCueById(C.id))throw new Error("addCue is failed for: "+C)}catch(d){H.logger.debug("[texttrack-utils]: "+d);var u=new self.TextTrackCue(C.startTime,C.endTime,C.text);u.id=C.id,y.addCue(u)}P==="disabled"&&(y.mode=P)}function j(y){var C=y.mode;if(C==="disabled"&&(y.mode="hidden"),y.cues)for(var P=y.cues.length;P--;)y.removeCue(y.cues[P]);C==="disabled"&&(y.mode=C)}function F(y,C,P){var u=y.mode;if(u==="disabled"&&(y.mode="hidden"),y.cues&&y.cues.length>0)for(var d=O(y.cues,C,P),E=0;E<d.length;E++)y.removeCue(d[E]);u==="disabled"&&(y.mode=u)}function R(y,C){if(C<y[0].startTime)return 0;var P=y.length-1;if(C>y[P].endTime)return-1;for(var u=0,d=P;u<=d;){var E=Math.floor((d+u)/2);if(C<y[E].startTime)d=E-1;else if(C>y[E].startTime&&u<P)u=E+1;else return E}return y[u].startTime-C<C-y[d].startTime?u:d}function O(y,C,P){var u=[],d=R(y,C);if(d>-1)for(var E=d,c=y.length;E<c;E++){var a=y[E];if(a.startTime>=C&&a.endTime<=P)u.push(a);else if(a.startTime>P)return u}return u}},"./src/utils/time-ranges.ts":function(re,K,M){"use strict";M.r(K);var H={toString:function(x){for(var j="",F=x.length,R=0;R<F;R++)j+="["+x.start(R).toFixed(3)+","+x.end(R).toFixed(3)+"]";return j}};K.default=H},"./src/utils/timescale-conversion.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"toTimescaleFromBase",function(){return k}),M.d(K,"toTimescaleFromScale",function(){return x}),M.d(K,"toMsFromMpegTsClock",function(){return j}),M.d(K,"toMpegTsClockFromTimescale",function(){return F});var H=9e4;function k(R,O,y,C){y===void 0&&(y=1),C===void 0&&(C=!1);var P=R*O*y;return C?Math.round(P):P}function x(R,O,y,C){return y===void 0&&(y=1),C===void 0&&(C=!1),k(R,O,1/y,C)}function j(R,O){return O===void 0&&(O=!1),k(R,1e3,1/H,O)}function F(R,O){return O===void 0&&(O=1),k(R,H,1/O)}},"./src/utils/typed-array.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"sliceUint8",function(){return H});function H(k,x,j){return Uint8Array.prototype.slice?k.slice(x,j):new Uint8Array(Array.prototype.slice.call(k,x,j))}},"./src/utils/vttcue.ts":function(re,K,M){"use strict";M.r(K),K.default=function(){if(typeof self!="undefined"&&self.VTTCue)return self.VTTCue;var H=["","lr","rl"],k=["start","middle","end","left","right"];function x(y,C){if(typeof C!="string"||!Array.isArray(y))return!1;var P=C.toLowerCase();return~y.indexOf(P)?P:!1}function j(y){return x(H,y)}function F(y){return x(k,y)}function R(y){for(var C=arguments.length,P=new Array(C>1?C-1:0),u=1;u<C;u++)P[u-1]=arguments[u];for(var d=1;d<arguments.length;d++){var E=arguments[d];for(var c in E)y[c]=E[c]}return y}function O(y,C,P){var u=this,d={enumerable:!0};u.hasBeenReset=!1;var E="",c=!1,a=y,i=C,l=P,p=null,f="",h=!0,m="auto",L="start",S=50,v="middle",n=50,s="middle";Object.defineProperty(u,"id",R({},d,{get:function(){return E},set:function(_){E=""+_}})),Object.defineProperty(u,"pauseOnExit",R({},d,{get:function(){return c},set:function(_){c=!!_}})),Object.defineProperty(u,"startTime",R({},d,{get:function(){return a},set:function(_){if(typeof _!="number")throw new TypeError("Start time must be set to a number.");a=_,this.hasBeenReset=!0}})),Object.defineProperty(u,"endTime",R({},d,{get:function(){return i},set:function(_){if(typeof _!="number")throw new TypeError("End time must be set to a number.");i=_,this.hasBeenReset=!0}})),Object.defineProperty(u,"text",R({},d,{get:function(){return l},set:function(_){l=""+_,this.hasBeenReset=!0}})),Object.defineProperty(u,"region",R({},d,{get:function(){return p},set:function(_){p=_,this.hasBeenReset=!0}})),Object.defineProperty(u,"vertical",R({},d,{get:function(){return f},set:function(_){var D=j(_);if(D===!1)throw new SyntaxError("An invalid or illegal string was specified.");f=D,this.hasBeenReset=!0}})),Object.defineProperty(u,"snapToLines",R({},d,{get:function(){return h},set:function(_){h=!!_,this.hasBeenReset=!0}})),Object.defineProperty(u,"line",R({},d,{get:function(){return m},set:function(_){if(typeof _!="number"&&_!=="auto")throw new SyntaxError("An invalid number or illegal string was specified.");m=_,this.hasBeenReset=!0}})),Object.defineProperty(u,"lineAlign",R({},d,{get:function(){return L},set:function(_){var D=F(_);if(!D)throw new SyntaxError("An invalid or illegal string was specified.");L=D,this.hasBeenReset=!0}})),Object.defineProperty(u,"position",R({},d,{get:function(){return S},set:function(_){if(_<0||_>100)throw new Error("Position must be between 0 and 100.");S=_,this.hasBeenReset=!0}})),Object.defineProperty(u,"positionAlign",R({},d,{get:function(){return v},set:function(_){var D=F(_);if(!D)throw new SyntaxError("An invalid or illegal string was specified.");v=D,this.hasBeenReset=!0}})),Object.defineProperty(u,"size",R({},d,{get:function(){return n},set:function(_){if(_<0||_>100)throw new Error("Size must be between 0 and 100.");n=_,this.hasBeenReset=!0}})),Object.defineProperty(u,"align",R({},d,{get:function(){return s},set:function(_){var D=F(_);if(!D)throw new SyntaxError("An invalid or illegal string was specified.");s=D,this.hasBeenReset=!0}})),u.displayState=void 0}return O.prototype.getCueAsHTML=function(){var y=self.WebVTT;return y.convertCueToDOMTree(self,this.text)},O}()},"./src/utils/vttparser.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"parseTimeStamp",function(){return x}),M.d(K,"fixLineBreaks",function(){return C}),M.d(K,"VTTParser",function(){return P});var H=M("./src/utils/vttcue.ts"),k=function(){function u(){}var d=u.prototype;return d.decode=function(c,a){if(!c)return"";if(typeof c!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(c))},u}();function x(u){function d(c,a,i,l){return(c|0)*3600+(a|0)*60+(i|0)+parseFloat(l||0)}var E=u.match(/^(?:(\d+):)?(\d{2}):(\d{2})(\.\d+)?/);return E?parseFloat(E[2])>59?d(E[2],E[3],0,E[4]):d(E[1],E[2],E[3],E[4]):null}var j=function(){function u(){this.values=Object.create(null)}var d=u.prototype;return d.set=function(c,a){!this.get(c)&&a!==""&&(this.values[c]=a)},d.get=function(c,a,i){return i?this.has(c)?this.values[c]:a[i]:this.has(c)?this.values[c]:a},d.has=function(c){return c in this.values},d.alt=function(c,a,i){for(var l=0;l<i.length;++l)if(a===i[l]){this.set(c,a);break}},d.integer=function(c,a){/^-?\d+$/.test(a)&&this.set(c,parseInt(a,10))},d.percent=function(c,a){if(/^([\d]{1,3})(\.[\d]*)?%$/.test(a)){var i=parseFloat(a);if(i>=0&&i<=100)return this.set(c,i),!0}return!1},u}();function F(u,d,E,c){var a=c?u.split(c):[u];for(var i in a)if(typeof a[i]=="string"){var l=a[i].split(E);if(l.length===2){var p=l[0],f=l[1];d(p,f)}}}var R=new H.default(0,0,""),O=R.align==="middle"?"middle":"center";function y(u,d,E){var c=u;function a(){var p=x(u);if(p===null)throw new Error("Malformed timestamp: "+c);return u=u.replace(/^[^\sa-zA-Z-]+/,""),p}function i(p,f){var h=new j;F(p,function(S,v){var n;switch(S){case"region":for(var s=E.length-1;s>=0;s--)if(E[s].id===v){h.set(S,E[s].region);break}break;case"vertical":h.alt(S,v,["rl","lr"]);break;case"line":n=v.split(","),h.integer(S,n[0]),h.percent(S,n[0])&&h.set("snapToLines",!1),h.alt(S,n[0],["auto"]),n.length===2&&h.alt("lineAlign",n[1],["start",O,"end"]);break;case"position":n=v.split(","),h.percent(S,n[0]),n.length===2&&h.alt("positionAlign",n[1],["start",O,"end","line-left","line-right","auto"]);break;case"size":h.percent(S,v);break;case"align":h.alt(S,v,["start",O,"end","left","right"]);break}},/:/,/\s/),f.region=h.get("region",null),f.vertical=h.get("vertical","");var m=h.get("line","auto");m==="auto"&&R.line===-1&&(m=-1),f.line=m,f.lineAlign=h.get("lineAlign","start"),f.snapToLines=h.get("snapToLines",!0),f.size=h.get("size",100),f.align=h.get("align",O);var L=h.get("position","auto");L==="auto"&&R.position===50&&(L=f.align==="start"||f.align==="left"?0:f.align==="end"||f.align==="right"?100:50),f.position=L}function l(){u=u.replace(/^\s+/,"")}if(l(),d.startTime=a(),l(),u.substr(0,3)!=="-->")throw new Error("Malformed time stamp (time stamps must be separated by '-->'): "+c);u=u.substr(3),l(),d.endTime=a(),l(),i(u,d)}function C(u){return u.replace(/<br(?: \/)?>/gi,`
`)}var P=function(){function u(){this.state="INITIAL",this.buffer="",this.decoder=new k,this.regionList=[],this.cue=null,this.oncue=void 0,this.onparsingerror=void 0,this.onflush=void 0}var d=u.prototype;return d.parse=function(c){var a=this;c&&(a.buffer+=a.decoder.decode(c,{stream:!0}));function i(){var L=a.buffer,S=0;for(L=C(L);S<L.length&&L[S]!=="\r"&&L[S]!==`
`;)++S;var v=L.substr(0,S);return L[S]==="\r"&&++S,L[S]===`
`&&++S,a.buffer=L.substr(S),v}function l(L){F(L,function(S,v){},/:/)}try{var p="";if(a.state==="INITIAL"){if(!/\r\n|\n/.test(a.buffer))return this;p=i();var f=p.match(/^(√Ø¬ª¬ø)?WEBVTT([ \t].*)?$/);if(!f||!f[0])throw new Error("Malformed WebVTT signature.");a.state="HEADER"}for(var h=!1;a.buffer;){if(!/\r\n|\n/.test(a.buffer))return this;switch(h?h=!1:p=i(),a.state){case"HEADER":/:/.test(p)?l(p):p||(a.state="ID");continue;case"NOTE":p||(a.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(p)){a.state="NOTE";break}if(!p)continue;if(a.cue=new H.default(0,0,""),a.state="CUE",p.indexOf("-->")===-1){a.cue.id=p;continue}case"CUE":if(!a.cue){a.state="BADCUE";continue}try{y(p,a.cue,a.regionList)}catch(L){a.cue=null,a.state="BADCUE";continue}a.state="CUETEXT";continue;case"CUETEXT":{var m=p.indexOf("-->")!==-1;if(!p||m&&(h=!0)){a.oncue&&a.cue&&a.oncue(a.cue),a.cue=null,a.state="ID";continue}if(a.cue===null)continue;a.cue.text&&(a.cue.text+=`
`),a.cue.text+=p}continue;case"BADCUE":p||(a.state="ID")}}}catch(L){a.state==="CUETEXT"&&a.cue&&a.oncue&&a.oncue(a.cue),a.cue=null,a.state=a.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},d.flush=function(){var c=this;try{if((c.cue||c.state==="HEADER")&&(c.buffer+=`

`,c.parse()),c.state==="INITIAL"||c.state==="BADWEBVTT")throw new Error("Malformed WebVTT signature.")}catch(a){c.onparsingerror&&c.onparsingerror(a)}return c.onflush&&c.onflush(),this},u}()},"./src/utils/webvtt-parser.ts":function(re,K,M){"use strict";M.r(K),M.d(K,"generateCueId",function(){return P}),M.d(K,"parseWebVTT",function(){return d});var H=M("./src/polyfills/number.ts"),k=M("./src/utils/vttparser.ts"),x=M("./src/demux/id3.ts"),j=M("./src/utils/timescale-conversion.ts"),F=M("./src/remux/mp4-remuxer.ts"),R=/\r\n|\n\r|\n|\r/g,O=function(c,a,i){return i===void 0&&(i=0),c.substr(i,a.length)===a},y=function(c){var a=parseInt(c.substr(-3)),i=parseInt(c.substr(-6,2)),l=parseInt(c.substr(-9,2)),p=c.length>9?parseInt(c.substr(0,c.indexOf(":"))):0;if(!Object(H.isFiniteNumber)(a)||!Object(H.isFiniteNumber)(i)||!Object(H.isFiniteNumber)(l)||!Object(H.isFiniteNumber)(p))throw Error("Malformed X-TIMESTAMP-MAP: Local:"+c);return a+=1e3*i,a+=60*1e3*l,a+=60*60*1e3*p,a},C=function(c){for(var a=5381,i=c.length;i;)a=a*33^c.charCodeAt(--i);return(a>>>0).toString()};function P(E,c,a){return C(E.toString())+C(c.toString())+C(a)}var u=function(c,a,i){var l=c[a],p=c[l.prevCC];if(!p||!p.new&&l.new){c.ccOffset=c.presentationOffset=l.start,l.new=!1;return}for(;(f=p)!==null&&f!==void 0&&f.new;){var f;c.ccOffset+=l.start-p.start,l.new=!1,l=p,p=c[l.prevCC]}c.presentationOffset=i};function d(E,c,a,i,l,p,f,h){var m=new k.VTTParser,L=Object(x.utf8ArrayToStr)(new Uint8Array(E)).trim().replace(R,`
`).split(`
`),S=[],v=Object(j.toMpegTsClockFromTimescale)(c,a),n="00:00.000",s=0,A=0,_,D=!0,I=!1;m.oncue=function(w){var B=i[l],N=i.ccOffset,W=(s-v)/9e4;if(B!=null&&B.new&&(A!==void 0?N=i.ccOffset=B.start:u(i,l,W)),W&&(N=W-i.presentationOffset),I){var G=w.endTime-w.startTime,V=Object(F.normalizePts)((w.startTime+N-A)*9e4,p*9e4)/9e4;w.startTime=V,w.endTime=V+G}var X=w.text.trim();w.text=decodeURIComponent(encodeURIComponent(X)),w.id||(w.id=P(w.startTime,w.endTime,X)),w.endTime>0&&S.push(w)},m.onparsingerror=function(w){_=w},m.onflush=function(){if(_){h(_);return}f(S)},L.forEach(function(w){if(D)if(O(w,"X-TIMESTAMP-MAP=")){D=!1,I=!0,w.substr(16).split(",").forEach(function(B){O(B,"LOCAL:")?n=B.substr(6):O(B,"MPEGTS:")&&(s=parseInt(B.substr(7)))});try{A=y(n)/1e3}catch(B){I=!1,_=B}return}else w===""&&(D=!1);m.parse(w+`
`)}),m.flush()}},"./src/utils/xhr-loader.ts":function(re,K,M){"use strict";M.r(K);var H=M("./src/utils/logger.ts"),k=M("./src/loader/load-stats.ts"),x=/^age:\s*[\d.]+\s*$/m,j=function(){function F(O){this.xhrSetup=void 0,this.requestTimeout=void 0,this.retryTimeout=void 0,this.retryDelay=void 0,this.config=null,this.callbacks=null,this.context=void 0,this.loader=null,this.stats=void 0,this.xhrSetup=O?O.xhrSetup:null,this.stats=new k.LoadStats,this.retryDelay=0}var R=F.prototype;return R.destroy=function(){this.callbacks=null,this.abortInternal(),this.loader=null,this.config=null},R.abortInternal=function(){var y=this.loader;self.clearTimeout(this.requestTimeout),self.clearTimeout(this.retryTimeout),y&&(y.onreadystatechange=null,y.onprogress=null,y.readyState!==4&&(this.stats.aborted=!0,y.abort()))},R.abort=function(){var y;this.abortInternal(),(y=this.callbacks)!==null&&y!==void 0&&y.onAbort&&this.callbacks.onAbort(this.stats,this.context,this.loader)},R.load=function(y,C,P){if(this.stats.loading.start)throw new Error("Loader can only be used once.");this.stats.loading.start=self.performance.now(),this.context=y,this.config=C,this.callbacks=P,this.retryDelay=C.retryDelay,this.loadInternal()},R.loadInternal=function(){var y=this.config,C=this.context;if(!!y){var P=this.loader=new self.XMLHttpRequest,u=this.stats;u.loading.first=0,u.loaded=0;var d=this.xhrSetup;try{if(d)try{d(P,C.url)}catch(E){P.open("GET",C.url,!0),d(P,C.url)}P.readyState||P.open("GET",C.url,!0)}catch(E){this.callbacks.onError({code:P.status,text:E.message},C,P);return}C.rangeEnd&&P.setRequestHeader("Range","bytes="+C.rangeStart+"-"+(C.rangeEnd-1)),P.onreadystatechange=this.readystatechange.bind(this),P.onprogress=this.loadprogress.bind(this),P.responseType=C.responseType,self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),y.timeout),P.send()}},R.readystatechange=function(){var y=this.context,C=this.loader,P=this.stats;if(!(!y||!C)){var u=C.readyState,d=this.config;if(!P.aborted&&u>=2)if(self.clearTimeout(this.requestTimeout),P.loading.first===0&&(P.loading.first=Math.max(self.performance.now(),P.loading.start)),u===4){C.onreadystatechange=null,C.onprogress=null;var E=C.status;if(E>=200&&E<300){P.loading.end=Math.max(self.performance.now(),P.loading.first);var c,a;if(y.responseType==="arraybuffer"?(c=C.response,a=c.byteLength):(c=C.responseText,a=c.length),P.loaded=P.total=a,!this.callbacks)return;var i=this.callbacks.onProgress;if(i&&i(P,y,c,C),!this.callbacks)return;var l={url:C.responseURL,data:c};this.callbacks.onSuccess(l,P,y,C)}else P.retry>=d.maxRetry||E>=400&&E<499?(H.logger.error(E+" while loading "+y.url),this.callbacks.onError({code:E,text:C.statusText},y,C)):(H.logger.warn(E+" while loading "+y.url+", retrying in "+this.retryDelay+"..."),this.abortInternal(),this.loader=null,self.clearTimeout(this.retryTimeout),this.retryTimeout=self.setTimeout(this.loadInternal.bind(this),this.retryDelay),this.retryDelay=Math.min(2*this.retryDelay,d.maxRetryDelay),P.retry++)}else self.clearTimeout(this.requestTimeout),this.requestTimeout=self.setTimeout(this.loadtimeout.bind(this),d.timeout)}},R.loadtimeout=function(){H.logger.warn("timeout while loading "+this.context.url);var y=this.callbacks;y&&(this.abortInternal(),y.onTimeout(this.stats,this.context,this.loader))},R.loadprogress=function(y){var C=this.stats;C.loaded=y.loaded,y.lengthComputable&&(C.total=y.total)},R.getCacheAge=function(){var y=null;if(this.loader&&x.test(this.loader.getAllResponseHeaders())){var C=this.loader.getResponseHeader("age");y=C?parseFloat(C):null}return y},F}();K.default=j}}).default})},988:oe=>{oe.exports=K;var re=Object.prototype.toString;function K(M){if(!M)return!1;var H=re.call(M);return H==="[object Function]"||typeof M=="function"&&H!=="[object RegExp]"||typeof window!="undefined"&&(M===window.setTimeout||M===window.alert||M===window.confirm||M===window.prompt)}},642:(oe,re)=>{function K(F){if(F&&typeof F=="object"){var R=F.which||F.keyCode||F.charCode;R&&(F=R)}if(typeof F=="number")return x[F];var O=String(F),y=M[O.toLowerCase()];if(y)return y;var y=H[O.toLowerCase()];if(y)return y;if(O.length===1)return O.charCodeAt(0)}K.isEventKey=function(R,O){if(R&&typeof R=="object"){var y=R.which||R.keyCode||R.charCode;if(y==null)return!1;if(typeof O=="string"){var C=M[O.toLowerCase()];if(C)return C===y;var C=H[O.toLowerCase()];if(C)return C===y}else if(typeof O=="number")return O===y;return!1}},re=oe.exports=K;var M=re.code=re.codes={backspace:8,tab:9,enter:13,shift:16,ctrl:17,alt:18,"pause/break":19,"caps lock":20,esc:27,space:32,"page up":33,"page down":34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,delete:46,command:91,"left command":91,"right command":93,"numpad *":106,"numpad +":107,"numpad -":109,"numpad .":110,"numpad /":111,"num lock":144,"scroll lock":145,"my computer":182,"my calculator":183,";":186,"=":187,",":188,"-":189,".":190,"/":191,"`":192,"[":219,"\\":220,"]":221,"'":222},H=re.aliases={windows:91,"\u21E7":16,"\u2325":18,"\u2303":17,"\u2318":91,ctl:17,control:17,option:18,pause:19,break:19,caps:20,return:13,escape:27,spc:32,spacebar:32,pgup:33,pgdn:34,ins:45,del:46,cmd:91};/*!
 * Programatically add the following
 */for(k=97;k<123;k++)M[String.fromCharCode(k)]=k-32;for(var k=48;k<58;k++)M[k-48]=k;for(k=1;k<13;k++)M["f"+k]=k+111;for(k=0;k<10;k++)M["numpad "+k]=k+96;var x=re.names=re.title={};for(k in M)x[M[k]]=k;for(var j in H)M[j]=H[j]},54:oe=>{oe.exports=re;function re(K,M){var H,k=null;try{H=JSON.parse(K,M)}catch(x){k=x}return[k,H]}},207:(oe,re,K)=>{"use strict";/**
 * @license
 * Video.js 7.17.0 <http://videojs.com/>
 * Copyright Brightcove, Inc. <https://www.brightcove.com/>
 * Available under Apache License Version 2.0
 * <https://github.com/videojs/video.js/blob/main/LICENSE>
 *
 * Includes vtt.js <https://github.com/mozilla/vtt.js>
 * Available under Apache License Version 2.0
 * <https://github.com/mozilla/vtt.js/blob/main/LICENSE>
 */var M=K(697),H=K(675),k=K(723),x=K(477),j=K(743),F=K(54),R=K(642),O=K(424),y=K(497),C=K(811),P=K(324);function u(g){return g&&typeof g=="object"&&"default"in g?g:{default:g}}for(var d=u(M),E=u(H),c=u(k),a=u(x),i=u(j),l=u(F),p=u(R),f=u(O),h=u(y),m=u(C),L=u(P),S="7.17.0",v={},n=function(T,o){return v[T]=v[T]||[],o&&(v[T]=v[T].concat(o)),v[T]},s=function(T,o){n(T,o)},A=function(T,o){var r=n(T).indexOf(o);return r<=-1?!1:(v[T]=v[T].slice(),v[T].splice(r,1),!0)},_=function(T,o){n(T,[].concat(o).map(function(r){var e=function t(){return A(T,t),r.apply(void 0,arguments)};return e}))},D={prefixed:!0},I=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror","fullscreen"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror","-webkit-full-screen"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror","-moz-full-screen"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError","-ms-fullscreen"]],w=I[0],B,N=0;N<I.length;N++)if(I[N][1]in E.default){B=I[N];break}if(B){for(var W=0;W<B.length;W++)D[w[W]]=B[W];D.prefixed=B[0]!==w[0]}var G=[],V=function(T,o){return function(r,e,t){var b=o.levels[e],U=new RegExp("^("+b+")$");if(r!=="log"&&t.unshift(r.toUpperCase()+":"),t.unshift(T+":"),G){G.push([].concat(t));var z=G.length-1e3;G.splice(0,z>0?z:0)}if(!!d.default.console){var Y=d.default.console[r];!Y&&r==="debug"&&(Y=d.default.console.info||d.default.console.log),!(!Y||!b||!U.test(r))&&Y[Array.isArray(t)?"apply":"call"](d.default.console,t)}}};function X(g){var T="info",o,r=function(){for(var t=arguments.length,b=new Array(t),U=0;U<t;U++)b[U]=arguments[U];o("log",T,b)};return o=V(g,r),r.createLogger=function(e){return X(g+": "+e)},r.levels={all:"debug|log|warn|error",off:"",debug:"debug|log|warn|error",info:"log|warn|error",warn:"warn|error",error:"error",DEFAULT:T},r.level=function(e){if(typeof e=="string"){if(!r.levels.hasOwnProperty(e))throw new Error('"'+e+'" in not a valid log level');T=e}return T},r.history=function(){return G?[].concat(G):[]},r.history.filter=function(e){return(G||[]).filter(function(t){return new RegExp(".*"+e+".*").test(t[0])})},r.history.clear=function(){G&&(G.length=0)},r.history.disable=function(){G!==null&&(G.length=0,G=null)},r.history.enable=function(){G===null&&(G=[])},r.error=function(){for(var e=arguments.length,t=new Array(e),b=0;b<e;b++)t[b]=arguments[b];return o("error",T,t)},r.warn=function(){for(var e=arguments.length,t=new Array(e),b=0;b<e;b++)t[b]=arguments[b];return o("warn",T,t)},r.debug=function(){for(var e=arguments.length,t=new Array(e),b=0;b<e;b++)t[b]=arguments[b];return o("debug",T,t)},r}var $=X("VIDEOJS"),q=$.createLogger,Z=Object.prototype.toString,ee=function(T){return le(T)?Object.keys(T):[]};function ie(g,T){ee(g).forEach(function(o){return T(g[o],o)})}function ue(g,T,o){return o===void 0&&(o=0),ee(g).reduce(function(r,e){return T(r,g[e],e)},o)}function se(g){for(var T=arguments.length,o=new Array(T>1?T-1:0),r=1;r<T;r++)o[r-1]=arguments[r];return Object.assign?c.default.apply(void 0,[g].concat(o)):(o.forEach(function(e){!e||ie(e,function(t,b){g[b]=t})}),g)}function le(g){return!!g&&typeof g=="object"}function ce(g){return le(g)&&Z.call(g)==="[object Object]"&&g.constructor===Object}function me(g,T){if(!g||!T)return"";if(typeof d.default.getComputedStyle=="function"){var o;try{o=d.default.getComputedStyle(g)}catch(r){return""}return o?o.getPropertyValue(T)||o[T]:""}return""}var ye=d.default.navigator&&d.default.navigator.userAgent||"",Ee=/AppleWebKit\/([\d.]+)/i.exec(ye),ke=Ee?parseFloat(Ee.pop()):null,Ae=/iPod/i.test(ye),Ie=function(){var g=ye.match(/OS (\d+)_/i);return g&&g[1]?g[1]:null}(),Le=/Android/i.test(ye),Be=function(){var g=ye.match(/Android (\d+)(?:\.(\d+))?(?:\.(\d+))*/i);if(!g)return null;var T=g[1]&&parseFloat(g[1]),o=g[2]&&parseFloat(g[2]);return T&&o?parseFloat(g[1]+"."+g[2]):T||null}(),Ne=Le&&Be<5&&ke<537,Ke=/Firefox/i.test(ye),Te=/Edg/i.test(ye),de=!Te&&(/Chrome/i.test(ye)||/CriOS/i.test(ye)),ge=function(){var g=ye.match(/(Chrome|CriOS)\/(\d+)/);return g&&g[2]?parseFloat(g[2]):null}(),ve=function(){var g=/MSIE\s(\d+)\.\d/.exec(ye),T=g&&parseFloat(g[1]);return!T&&/Trident\/7.0/i.test(ye)&&/rv:11.0/.test(ye)&&(T=11),T}(),De=/Safari/i.test(ye)&&!de&&!Le&&!Te,Fe=/Windows/i.test(ye),Pe=Boolean(ze()&&("ontouchstart"in d.default||d.default.navigator.maxTouchPoints||d.default.DocumentTouch&&d.default.document instanceof d.default.DocumentTouch)),we=/iPad/i.test(ye)||De&&Pe&&!/iPhone/i.test(ye),Ge=/iPhone/i.test(ye)&&!we,be=Ge||we||Ae,Ce=(De||be)&&!de,Me=Object.freeze({__proto__:null,IS_IPOD:Ae,IOS_VERSION:Ie,IS_ANDROID:Le,ANDROID_VERSION:Be,IS_NATIVE_ANDROID:Ne,IS_FIREFOX:Ke,IS_EDGE:Te,IS_CHROME:de,CHROME_VERSION:ge,IE_VERSION:ve,IS_SAFARI:De,IS_WINDOWS:Fe,TOUCH_ENABLED:Pe,IS_IPAD:we,IS_IPHONE:Ge,IS_IOS:be,IS_ANY_SAFARI:Ce});function Je(g){return typeof g=="string"&&Boolean(g.trim())}function it(g){if(g.indexOf(" ")>=0)throw new Error("class has illegal whitespace characters")}function Et(g){return new RegExp("(^|\\s)"+g+"($|\\s)")}function ze(){return E.default===d.default.document}function He(g){return le(g)&&g.nodeType===1}function st(){try{return d.default.parent!==d.default.self}catch(g){return!0}}function vt(g){return function(T,o){if(!Je(T))return E.default[g](null);Je(o)&&(o=E.default.querySelector(o));var r=He(o)?o:E.default;return r[g]&&r[g](T)}}function _e(g,T,o,r){g===void 0&&(g="div"),T===void 0&&(T={}),o===void 0&&(o={});var e=E.default.createElement(g);return Object.getOwnPropertyNames(T).forEach(function(t){var b=T[t];t.indexOf("aria-")!==-1||t==="role"||t==="type"?($.warn(`Setting attributes in the second argument of createEl()
has been deprecated. Use the third argument instead.
`+("createEl(type, properties, attributes). Attempting to set "+t+" to "+b+".")),e.setAttribute(t,b)):t==="textContent"?ut(e,b):(e[t]!==b||t==="tabIndex")&&(e[t]=b)}),Object.getOwnPropertyNames(o).forEach(function(t){e.setAttribute(t,o[t])}),r&&_r(e,r),e}function ut(g,T){return typeof g.textContent=="undefined"?g.innerText=T:g.textContent=T,g}function Tt(g,T){T.firstChild?T.insertBefore(g,T.firstChild):T.appendChild(g)}function ct(g,T){return it(T),g.classList?g.classList.contains(T):Et(T).test(g.className)}function et(g,T){return g.classList?g.classList.add(T):ct(g,T)||(g.className=(g.className+" "+T).trim()),g}function _t(g,T){return g?(g.classList?g.classList.remove(T):(it(T),g.className=g.className.split(/\s+/).filter(function(o){return o!==T}).join(" ")),g):($.warn("removeClass was called with an element that doesn't exist"),null)}function Qt(g,T,o){var r=ct(g,T);if(typeof o=="function"&&(o=o(g,T)),typeof o!="boolean"&&(o=!r),o!==r)return o?et(g,T):_t(g,T),g}function Jt(g,T){Object.getOwnPropertyNames(T).forEach(function(o){var r=T[o];r===null||typeof r=="undefined"||r===!1?g.removeAttribute(o):g.setAttribute(o,r===!0?"":r)})}function Ze(g){var T={},o=",autoplay,controls,playsinline,loop,muted,default,defaultMuted,";if(g&&g.attributes&&g.attributes.length>0)for(var r=g.attributes,e=r.length-1;e>=0;e--){var t=r[e].name,b=r[e].value;(typeof g[t]=="boolean"||o.indexOf(","+t+",")!==-1)&&(b=b!==null),T[t]=b}return T}function jt(g,T){return g.getAttribute(T)}function pt(g,T,o){g.setAttribute(T,o)}function Dt(g,T){g.removeAttribute(T)}function gi(){E.default.body.focus(),E.default.onselectstart=function(){return!1}}function mi(){E.default.onselectstart=function(){return!0}}function Pt(g){if(g&&g.getBoundingClientRect&&g.parentNode){var T=g.getBoundingClientRect(),o={};return["bottom","height","left","right","top","width"].forEach(function(r){T[r]!==void 0&&(o[r]=T[r])}),o.height||(o.height=parseFloat(me(g,"height"))),o.width||(o.width=parseFloat(me(g,"width"))),o}}function Kt(g){if(!g||g&&!g.offsetParent)return{left:0,top:0,width:0,height:0};for(var T=g.offsetWidth,o=g.offsetHeight,r=0,e=0;g.offsetParent&&g!==E.default[D.fullscreenElement];)r+=g.offsetLeft,e+=g.offsetTop,g=g.offsetParent;return{left:r,top:e,width:T,height:o}}function Zt(g,T){var o={x:0,y:0};if(be)for(var r=g;r&&r.nodeName.toLowerCase()!=="html";){var e=me(r,"transform");if(/^matrix/.test(e)){var t=e.slice(7,-1).split(/,\s/).map(Number);o.x+=t[4],o.y+=t[5]}else if(/^matrix3d/.test(e)){var b=e.slice(9,-1).split(/,\s/).map(Number);o.x+=b[12],o.y+=b[13]}r=r.parentNode}var U={},z=Kt(T.target),Y=Kt(g),J=Y.width,te=Y.height,Q=T.offsetY-(Y.top-z.top),ne=T.offsetX-(Y.left-z.left);return T.changedTouches&&(ne=T.changedTouches[0].pageX-Y.left,Q=T.changedTouches[0].pageY+Y.top,be&&(ne-=o.x,Q-=o.y)),U.y=1-Math.max(0,Math.min(1,Q/te)),U.x=Math.max(0,Math.min(1,ne/J)),U}function yi(g){return le(g)&&g.nodeType===3}function Tr(g){for(;g.firstChild;)g.removeChild(g.firstChild);return g}function Ei(g){return typeof g=="function"&&(g=g()),(Array.isArray(g)?g:[g]).map(function(T){if(typeof T=="function"&&(T=T()),He(T)||yi(T))return T;if(typeof T=="string"&&/\S/.test(T))return E.default.createTextNode(T)}).filter(function(T){return T})}function _r(g,T){return Ei(T).forEach(function(o){return g.appendChild(o)}),g}function Ti(g,T){return _r(Tr(g),T)}function Ht(g){return g.button===void 0&&g.buttons===void 0||g.button===0&&g.buttons===void 0||g.type==="mouseup"&&g.button===0&&g.buttons===0?!0:!(g.button!==0||g.buttons!==1)}var gt=vt("querySelector"),_i=vt("querySelectorAll"),Si=Object.freeze({__proto__:null,isReal:ze,isEl:He,isInFrame:st,createEl:_e,textContent:ut,prependTo:Tt,hasClass:ct,addClass:et,removeClass:_t,toggleClass:Qt,setAttributes:Jt,getAttributes:Ze,getAttribute:jt,setAttribute:pt,removeAttribute:Dt,blockTextSelection:gi,unblockTextSelection:mi,getBoundingClientRect:Pt,findPosition:Kt,getPointerPosition:Zt,isTextNode:yi,emptyEl:Tr,normalizeContent:Ei,appendContent:_r,insertContent:Ti,isSingleLeftClick:Ht,$:gt,$$:_i}),bi=!1,Sr,wn=function(){if(Sr.options.autoSetup!==!1){var T=Array.prototype.slice.call(E.default.getElementsByTagName("video")),o=Array.prototype.slice.call(E.default.getElementsByTagName("audio")),r=Array.prototype.slice.call(E.default.getElementsByTagName("video-js")),e=T.concat(o,r);if(e&&e.length>0)for(var t=0,b=e.length;t<b;t++){var U=e[t];if(U&&U.getAttribute){if(U.player===void 0){var z=U.getAttribute("data-setup");z!==null&&Sr(U)}}else{br(1);break}}else bi||br(1)}};function br(g,T){!ze()||(T&&(Sr=T),d.default.setTimeout(wn,g))}function Cr(){bi=!0,d.default.removeEventListener("load",Cr)}ze()&&(E.default.readyState==="complete"?Cr():d.default.addEventListener("load",Cr));var Ci=function(T){var o=E.default.createElement("style");return o.className=T,o},Ai=function(T,o){T.styleSheet?T.styleSheet.cssText=o:T.textContent=o},Fn=3,Bn=Fn;function mt(){return Bn++}var Li;d.default.WeakMap||(Li=function(){function g(){this.vdata="vdata"+Math.floor(d.default.performance&&d.default.performance.now()||Date.now()),this.data={}}var T=g.prototype;return T.set=function(r,e){var t=r[this.vdata]||mt();return r[this.vdata]||(r[this.vdata]=t),this.data[t]=e,this},T.get=function(r){var e=r[this.vdata];if(e)return this.data[e];$("We have no data for this element",r)},T.has=function(r){var e=r[this.vdata];return e in this.data},T.delete=function(r){var e=r[this.vdata];e&&(delete this.data[e],delete r[this.vdata])},g}());var Ye=d.default.WeakMap?new WeakMap:new Li;function Di(g,T){if(!!Ye.has(g)){var o=Ye.get(g);o.handlers[T].length===0&&(delete o.handlers[T],g.removeEventListener?g.removeEventListener(T,o.dispatcher,!1):g.detachEvent&&g.detachEvent("on"+T,o.dispatcher)),Object.getOwnPropertyNames(o.handlers).length<=0&&(delete o.handlers,delete o.dispatcher,delete o.disabled),Object.getOwnPropertyNames(o).length===0&&Ye.delete(g)}}function Ar(g,T,o,r){o.forEach(function(e){g(T,e,r)})}function qt(g){if(g.fixed_)return g;function T(){return!0}function o(){return!1}if(!g||!g.isPropagationStopped||!g.isImmediatePropagationStopped){var r=g||d.default.event;g={};for(var e in r)e!=="layerX"&&e!=="layerY"&&e!=="keyLocation"&&e!=="webkitMovementX"&&e!=="webkitMovementY"&&(e==="returnValue"&&r.preventDefault||(g[e]=r[e]));if(g.target||(g.target=g.srcElement||E.default),g.relatedTarget||(g.relatedTarget=g.fromElement===g.target?g.toElement:g.fromElement),g.preventDefault=function(){r.preventDefault&&r.preventDefault(),g.returnValue=!1,r.returnValue=!1,g.defaultPrevented=!0},g.defaultPrevented=!1,g.stopPropagation=function(){r.stopPropagation&&r.stopPropagation(),g.cancelBubble=!0,r.cancelBubble=!0,g.isPropagationStopped=T},g.isPropagationStopped=o,g.stopImmediatePropagation=function(){r.stopImmediatePropagation&&r.stopImmediatePropagation(),g.isImmediatePropagationStopped=T,g.stopPropagation()},g.isImmediatePropagationStopped=o,g.clientX!==null&&g.clientX!==void 0){var t=E.default.documentElement,b=E.default.body;g.pageX=g.clientX+(t&&t.scrollLeft||b&&b.scrollLeft||0)-(t&&t.clientLeft||b&&b.clientLeft||0),g.pageY=g.clientY+(t&&t.scrollTop||b&&b.scrollTop||0)-(t&&t.clientTop||b&&b.clientTop||0)}g.which=g.charCode||g.keyCode,g.button!==null&&g.button!==void 0&&(g.button=g.button&1?0:g.button&4?1:g.button&2?2:0)}return g.fixed_=!0,g}var er,Nn=function(){if(typeof er!="boolean"){er=!1;try{var T=Object.defineProperty({},"passive",{get:function(){er=!0}});d.default.addEventListener("test",null,T),d.default.removeEventListener("test",null,T)}catch(o){}}return er},Un=["touchstart","touchmove"];function qe(g,T,o){if(Array.isArray(T))return Ar(qe,g,T,o);Ye.has(g)||Ye.set(g,{});var r=Ye.get(g);if(r.handlers||(r.handlers={}),r.handlers[T]||(r.handlers[T]=[]),o.guid||(o.guid=mt()),r.handlers[T].push(o),r.dispatcher||(r.disabled=!1,r.dispatcher=function(t,b){if(!r.disabled){t=qt(t);var U=r.handlers[t.type];if(U)for(var z=U.slice(0),Y=0,J=z.length;Y<J&&!t.isImmediatePropagationStopped();Y++)try{z[Y].call(g,t,b)}catch(te){$.error(te)}}}),r.handlers[T].length===1)if(g.addEventListener){var e=!1;Nn()&&Un.indexOf(T)>-1&&(e={passive:!0}),g.addEventListener(T,r.dispatcher,e)}else g.attachEvent&&g.attachEvent("on"+T,r.dispatcher)}function Ve(g,T,o){if(!!Ye.has(g)){var r=Ye.get(g);if(!!r.handlers){if(Array.isArray(T))return Ar(Ve,g,T,o);var e=function(Y,J){r.handlers[J]=[],Di(Y,J)};if(T===void 0){for(var t in r.handlers)Object.prototype.hasOwnProperty.call(r.handlers||{},t)&&e(g,t);return}var b=r.handlers[T];if(!!b){if(!o){e(g,T);return}if(o.guid)for(var U=0;U<b.length;U++)b[U].guid===o.guid&&b.splice(U--,1);Di(g,T)}}}}function Ot(g,T,o){var r=Ye.has(g)?Ye.get(g):{},e=g.parentNode||g.ownerDocument;if(typeof T=="string"?T={type:T,target:g}:T.target||(T.target=g),T=qt(T),r.dispatcher&&r.dispatcher.call(g,T,o),e&&!T.isPropagationStopped()&&T.bubbles===!0)Ot.call(null,e,T,o);else if(!e&&!T.defaultPrevented&&T.target&&T.target[T.type]){Ye.has(T.target)||Ye.set(T.target,{});var t=Ye.get(T.target);T.target[T.type]&&(t.disabled=!0,typeof T.target[T.type]=="function"&&T.target[T.type](),t.disabled=!1)}return!T.defaultPrevented}function tr(g,T,o){if(Array.isArray(T))return Ar(tr,g,T,o);var r=function e(){Ve(g,T,e),o.apply(this,arguments)};r.guid=o.guid=o.guid||mt(),qe(g,T,r)}function Pi(g,T,o){var r=function e(){Ve(g,T,e),o.apply(this,arguments)};r.guid=o.guid=o.guid||mt(),qe(g,T,r)}var jn=Object.freeze({__proto__:null,fixEvent:qt,on:qe,off:Ve,trigger:Ot,one:tr,any:Pi}),nt=30,Oe=function(T,o,r){o.guid||(o.guid=mt());var e=o.bind(T);return e.guid=r?r+"_"+o.guid:o.guid,e},dt=function(T,o){var r=d.default.performance.now(),e=function(){var b=d.default.performance.now();b-r>=o&&(T.apply(void 0,arguments),r=b)};return e},Kn=function(T,o,r,e){e===void 0&&(e=d.default);var t,b=function(){e.clearTimeout(t),t=null},U=function(){var Y=this,J=arguments,te=function(){t=null,te=null,r||T.apply(Y,J)};!t&&r&&T.apply(Y,J),e.clearTimeout(t),t=e.setTimeout(te,o)};return U.cancel=b,U},We=function(){};We.prototype.allowedEvents_={},We.prototype.on=function(g,T){var o=this.addEventListener;this.addEventListener=function(){},qe(this,g,T),this.addEventListener=o},We.prototype.addEventListener=We.prototype.on,We.prototype.off=function(g,T){Ve(this,g,T)},We.prototype.removeEventListener=We.prototype.off,We.prototype.one=function(g,T){var o=this.addEventListener;this.addEventListener=function(){},tr(this,g,T),this.addEventListener=o},We.prototype.any=function(g,T){var o=this.addEventListener;this.addEventListener=function(){},Pi(this,g,T),this.addEventListener=o},We.prototype.trigger=function(g){var T=g.type||g;typeof g=="string"&&(g={type:T}),g=qt(g),this.allowedEvents_[T]&&this["on"+T]&&this["on"+T](g),Ot(this,g)},We.prototype.dispatchEvent=We.prototype.trigger;var Wt;We.prototype.queueTrigger=function(g){var T=this;Wt||(Wt=new Map);var o=g.type||g,r=Wt.get(this);r||(r=new Map,Wt.set(this,r));var e=r.get(o);r.delete(o),d.default.clearTimeout(e);var t=d.default.setTimeout(function(){r.size===0&&(r=null,Wt.delete(T)),T.trigger(g)},0);r.set(o,t)};var rr=function(T){return typeof T.name=="function"?T.name():typeof T.name=="string"?T.name:T.name_?T.name_:T.constructor&&T.constructor.name?T.constructor.name:typeof T},ft=function(T){return T instanceof We||!!T.eventBusEl_&&["on","one","off","trigger"].every(function(o){return typeof T[o]=="function"})},Hn=function(T,o){ft(T)?o():(T.eventedCallbacks||(T.eventedCallbacks=[]),T.eventedCallbacks.push(o))},Lr=function(T){return typeof T=="string"&&/\S/.test(T)||Array.isArray(T)&&!!T.length},ir=function(T,o,r){if(!T||!T.nodeName&&!ft(T))throw new Error("Invalid target for "+rr(o)+"#"+r+"; must be a DOM node or evented object.")},Oi=function(T,o,r){if(!Lr(T))throw new Error("Invalid event type for "+rr(o)+"#"+r+"; must be a non-empty string or array.")},Ri=function(T,o,r){if(typeof T!="function")throw new Error("Invalid listener for "+rr(o)+"#"+r+"; must be a function.")},Dr=function(T,o,r){var e=o.length<3||o[0]===T||o[0]===T.eventBusEl_,t,b,U;return e?(t=T.eventBusEl_,o.length>=3&&o.shift(),b=o[0],U=o[1]):(t=o[0],b=o[1],U=o[2]),ir(t,T,r),Oi(b,T,r),Ri(U,T,r),U=Oe(T,U),{isTargetingSelf:e,target:t,type:b,listener:U}},St=function(T,o,r,e){ir(T,T,o),T.nodeName?jn[o](T,r,e):T[o](r,e)},Wn={on:function(){for(var T=this,o=arguments.length,r=new Array(o),e=0;e<o;e++)r[e]=arguments[e];var t=Dr(this,r,"on"),b=t.isTargetingSelf,U=t.target,z=t.type,Y=t.listener;if(St(U,"on",z,Y),!b){var J=function(){return T.off(U,z,Y)};J.guid=Y.guid;var te=function(){return T.off("dispose",J)};te.guid=Y.guid,St(this,"on","dispose",J),St(U,"on","dispose",te)}},one:function(){for(var T=this,o=arguments.length,r=new Array(o),e=0;e<o;e++)r[e]=arguments[e];var t=Dr(this,r,"one"),b=t.isTargetingSelf,U=t.target,z=t.type,Y=t.listener;if(b)St(U,"one",z,Y);else{var J=function te(){T.off(U,z,te);for(var Q=arguments.length,ne=new Array(Q),fe=0;fe<Q;fe++)ne[fe]=arguments[fe];Y.apply(null,ne)};J.guid=Y.guid,St(U,"one",z,J)}},any:function(){for(var T=this,o=arguments.length,r=new Array(o),e=0;e<o;e++)r[e]=arguments[e];var t=Dr(this,r,"any"),b=t.isTargetingSelf,U=t.target,z=t.type,Y=t.listener;if(b)St(U,"any",z,Y);else{var J=function te(){T.off(U,z,te);for(var Q=arguments.length,ne=new Array(Q),fe=0;fe<Q;fe++)ne[fe]=arguments[fe];Y.apply(null,ne)};J.guid=Y.guid,St(U,"any",z,J)}},off:function(T,o,r){if(!T||Lr(T))Ve(this.eventBusEl_,T,o);else{var e=T,t=o;ir(e,this,"off"),Oi(t,this,"off"),Ri(r,this,"off"),r=Oe(this,r),this.off("dispose",r),e.nodeName?(Ve(e,t,r),Ve(e,"dispose",r)):ft(e)&&(e.off(t,r),e.off("dispose",r))}},trigger:function(T,o){ir(this.eventBusEl_,this,"trigger");var r=T&&typeof T!="string"?T.type:T;if(!Lr(r)){var e="Invalid event type for "+rr(this)+"#trigger; must be a non-empty string or object with a type key that has a non-empty value.";if(T)(this.log||$).error(e);else throw new Error(e)}return Ot(this.eventBusEl_,T,o)}};function Pr(g,T){T===void 0&&(T={});var o=T,r=o.eventBusKey;if(r){if(!g[r].nodeName)throw new Error('The eventBusKey "'+r+'" does not refer to an element.');g.eventBusEl_=g[r]}else g.eventBusEl_=_e("span",{className:"vjs-event-bus"});return se(g,Wn),g.eventedCallbacks&&g.eventedCallbacks.forEach(function(e){e()}),g.on("dispose",function(){g.off(),[g,g.el_,g.eventBusEl_].forEach(function(e){e&&Ye.has(e)&&Ye.delete(e)}),d.default.setTimeout(function(){g.eventBusEl_=null},0)}),g}var Gn={state:{},setState:function(T){var o=this;typeof T=="function"&&(T=T());var r;return ie(T,function(e,t){o.state[t]!==e&&(r=r||{},r[t]={from:o.state[t],to:e}),o.state[t]=e}),r&&ft(this)&&this.trigger({changes:r,type:"statechanged"}),r}};function Ii(g,T){return se(g,Gn),g.state=se({},g.state,T),typeof g.handleStateChanged=="function"&&ft(g)&&g.on("statechanged",g.handleStateChanged),g}var nr=function(T){return typeof T!="string"?T:T.replace(/./,function(o){return o.toLowerCase()})},Ue=function(T){return typeof T!="string"?T:T.replace(/./,function(o){return o.toUpperCase()})},Vn=function(T,o){return Ue(T)===Ue(o)};function xe(){for(var g={},T=arguments.length,o=new Array(T),r=0;r<T;r++)o[r]=arguments[r];return o.forEach(function(e){!e||ie(e,function(t,b){if(!ce(t)){g[b]=t;return}ce(g[b])||(g[b]={}),g[b]=xe(g[b],t)})}),g}var zn=function(){function g(){this.map_={}}var T=g.prototype;return T.has=function(r){return r in this.map_},T.delete=function(r){var e=this.has(r);return delete this.map_[r],e},T.set=function(r,e){return this.map_[r]=e,this},T.forEach=function(r,e){for(var t in this.map_)r.call(e,this.map_[t],t,this)},g}(),Yn=d.default.Map?d.default.Map:zn,Xn=function(){function g(){this.set_={}}var T=g.prototype;return T.has=function(r){return r in this.set_},T.delete=function(r){var e=this.has(r);return delete this.set_[r],e},T.add=function(r){return this.set_[r]=1,this},T.forEach=function(r,e){for(var t in this.set_)r.call(e,t,t,this)},g}(),Or=d.default.Set?d.default.Set:Xn,ae=function(){function g(o,r,e){if(!o&&this.play?this.player_=o=this:this.player_=o,this.isDisposed_=!1,this.parentComponent_=null,this.options_=xe({},this.options_),r=this.options_=xe(this.options_,r),this.id_=r.id||r.el&&r.el.id,!this.id_){var t=o&&o.id&&o.id()||"no_player";this.id_=t+"_component_"+mt()}this.name_=r.name||null,r.el?this.el_=r.el:r.createEl!==!1&&(this.el_=this.createEl()),r.evented!==!1&&(Pr(this,{eventBusKey:this.el_?"el_":null}),this.handleLanguagechange=this.handleLanguagechange.bind(this),this.on(this.player_,"languagechange",this.handleLanguagechange)),Ii(this,this.constructor.defaultState),this.children_=[],this.childIndex_={},this.childNameIndex_={},this.setTimeoutIds_=new Or,this.setIntervalIds_=new Or,this.rafIds_=new Or,this.namedRafs_=new Yn,this.clearingTimersOnDispose_=!1,r.initChildren!==!1&&this.initChildren(),this.ready(e),r.reportTouchActivity!==!1&&this.enableTouchActivity()}var T=g.prototype;return T.dispose=function(){if(!this.isDisposed_){if(this.readyQueue_&&(this.readyQueue_.length=0),this.trigger({type:"dispose",bubbles:!1}),this.isDisposed_=!0,this.children_)for(var r=this.children_.length-1;r>=0;r--)this.children_[r].dispose&&this.children_[r].dispose();this.children_=null,this.childIndex_=null,this.childNameIndex_=null,this.parentComponent_=null,this.el_&&(this.el_.parentNode&&this.el_.parentNode.removeChild(this.el_),this.el_=null),this.player_=null}},T.isDisposed=function(){return Boolean(this.isDisposed_)},T.player=function(){return this.player_},T.options=function(r){return r?(this.options_=xe(this.options_,r),this.options_):this.options_},T.el=function(){return this.el_},T.createEl=function(r,e,t){return _e(r,e,t)},T.localize=function(r,e,t){t===void 0&&(t=r);var b=this.player_.language&&this.player_.language(),U=this.player_.languages&&this.player_.languages(),z=U&&U[b],Y=b&&b.split("-")[0],J=U&&U[Y],te=t;return z&&z[r]?te=z[r]:J&&J[r]&&(te=J[r]),e&&(te=te.replace(/\{(\d+)\}/g,function(Q,ne){var fe=e[ne-1],Se=fe;return typeof fe=="undefined"&&(Se=Q),Se})),te},T.handleLanguagechange=function(){},T.contentEl=function(){return this.contentEl_||this.el_},T.id=function(){return this.id_},T.name=function(){return this.name_},T.children=function(){return this.children_},T.getChildById=function(r){return this.childIndex_[r]},T.getChild=function(r){if(!!r)return this.childNameIndex_[r]},T.getDescendant=function(){for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];e=e.reduce(function(z,Y){return z.concat(Y)},[]);for(var b=this,U=0;U<e.length;U++)if(b=b.getChild(e[U]),!b||!b.getChild)return;return b},T.addChild=function(r,e,t){e===void 0&&(e={}),t===void 0&&(t=this.children_.length);var b,U;if(typeof r=="string"){U=Ue(r);var z=e.componentClass||U;e.name=U;var Y=g.getComponent(z);if(!Y)throw new Error("Component "+z+" does not exist");if(typeof Y!="function")return null;b=new Y(this.player_||this,e)}else b=r;if(b.parentComponent_&&b.parentComponent_.removeChild(b),this.children_.splice(t,0,b),b.parentComponent_=this,typeof b.id=="function"&&(this.childIndex_[b.id()]=b),U=U||b.name&&Ue(b.name()),U&&(this.childNameIndex_[U]=b,this.childNameIndex_[nr(U)]=b),typeof b.el=="function"&&b.el()){var J=null;this.children_[t+1]&&(this.children_[t+1].el_?J=this.children_[t+1].el_:He(this.children_[t+1])&&(J=this.children_[t+1])),this.contentEl().insertBefore(b.el(),J)}return b},T.removeChild=function(r){if(typeof r=="string"&&(r=this.getChild(r)),!(!r||!this.children_)){for(var e=!1,t=this.children_.length-1;t>=0;t--)if(this.children_[t]===r){e=!0,this.children_.splice(t,1);break}if(!!e){r.parentComponent_=null,this.childIndex_[r.id()]=null,this.childNameIndex_[Ue(r.name())]=null,this.childNameIndex_[nr(r.name())]=null;var b=r.el();b&&b.parentNode===this.contentEl()&&this.contentEl().removeChild(r.el())}}},T.initChildren=function(){var r=this,e=this.options_.children;if(e){var t=this.options_,b=function(J){var te=J.name,Q=J.opts;if(t[te]!==void 0&&(Q=t[te]),Q!==!1){Q===!0&&(Q={}),Q.playerOptions=r.options_.playerOptions;var ne=r.addChild(te,Q);ne&&(r[te]=ne)}},U,z=g.getComponent("Tech");Array.isArray(e)?U=e:U=Object.keys(e),U.concat(Object.keys(this.options_).filter(function(Y){return!U.some(function(J){return typeof J=="string"?Y===J:Y===J.name})})).map(function(Y){var J,te;return typeof Y=="string"?(J=Y,te=e[J]||r.options_[J]||{}):(J=Y.name,te=Y),{name:J,opts:te}}).filter(function(Y){var J=g.getComponent(Y.opts.componentClass||Ue(Y.name));return J&&!z.isTech(J)}).forEach(b)}},T.buildCSSClass=function(){return""},T.ready=function(r,e){if(e===void 0&&(e=!1),!!r){if(!this.isReady_){this.readyQueue_=this.readyQueue_||[],this.readyQueue_.push(r);return}e?r.call(this):this.setTimeout(r,1)}},T.triggerReady=function(){this.isReady_=!0,this.setTimeout(function(){var r=this.readyQueue_;this.readyQueue_=[],r&&r.length>0&&r.forEach(function(e){e.call(this)},this),this.trigger("ready")},1)},T.$=function(r,e){return gt(r,e||this.contentEl())},T.$$=function(r,e){return _i(r,e||this.contentEl())},T.hasClass=function(r){return ct(this.el_,r)},T.addClass=function(r){et(this.el_,r)},T.removeClass=function(r){_t(this.el_,r)},T.toggleClass=function(r,e){Qt(this.el_,r,e)},T.show=function(){this.removeClass("vjs-hidden")},T.hide=function(){this.addClass("vjs-hidden")},T.lockShowing=function(){this.addClass("vjs-lock-showing")},T.unlockShowing=function(){this.removeClass("vjs-lock-showing")},T.getAttribute=function(r){return jt(this.el_,r)},T.setAttribute=function(r,e){pt(this.el_,r,e)},T.removeAttribute=function(r){Dt(this.el_,r)},T.width=function(r,e){return this.dimension("width",r,e)},T.height=function(r,e){return this.dimension("height",r,e)},T.dimensions=function(r,e){this.width(r,!0),this.height(e)},T.dimension=function(r,e,t){if(e!==void 0){(e===null||e!==e)&&(e=0),(""+e).indexOf("%")!==-1||(""+e).indexOf("px")!==-1?this.el_.style[r]=e:e==="auto"?this.el_.style[r]="":this.el_.style[r]=e+"px",t||this.trigger("componentresize");return}if(!this.el_)return 0;var b=this.el_.style[r],U=b.indexOf("px");return U!==-1?parseInt(b.slice(0,U),10):parseInt(this.el_["offset"+Ue(r)],10)},T.currentDimension=function(r){var e=0;if(r!=="width"&&r!=="height")throw new Error("currentDimension only accepts width or height value");if(e=me(this.el_,r),e=parseFloat(e),e===0||isNaN(e)){var t="offset"+Ue(r);e=this.el_[t]}return e},T.currentDimensions=function(){return{width:this.currentDimension("width"),height:this.currentDimension("height")}},T.currentWidth=function(){return this.currentDimension("width")},T.currentHeight=function(){return this.currentDimension("height")},T.focus=function(){this.el_.focus()},T.blur=function(){this.el_.blur()},T.handleKeyDown=function(r){this.player_&&(r.stopPropagation(),this.player_.handleKeyDown(r))},T.handleKeyPress=function(r){this.handleKeyDown(r)},T.emitTapEvents=function(){var r=0,e=null,t=10,b=200,U;this.on("touchstart",function(Y){Y.touches.length===1&&(e={pageX:Y.touches[0].pageX,pageY:Y.touches[0].pageY},r=d.default.performance.now(),U=!0)}),this.on("touchmove",function(Y){if(Y.touches.length>1)U=!1;else if(e){var J=Y.touches[0].pageX-e.pageX,te=Y.touches[0].pageY-e.pageY,Q=Math.sqrt(J*J+te*te);Q>t&&(U=!1)}});var z=function(){U=!1};this.on("touchleave",z),this.on("touchcancel",z),this.on("touchend",function(Y){if(e=null,U===!0){var J=d.default.performance.now()-r;J<b&&(Y.preventDefault(),this.trigger("tap"))}})},T.enableTouchActivity=function(){if(!(!this.player()||!this.player().reportUserActivity)){var r=Oe(this.player(),this.player().reportUserActivity),e;this.on("touchstart",function(){r(),this.clearInterval(e),e=this.setInterval(r,250)});var t=function(U){r(),this.clearInterval(e)};this.on("touchmove",r),this.on("touchend",t),this.on("touchcancel",t)}},T.setTimeout=function(r,e){var t=this,b;return r=Oe(this,r),this.clearTimersOnDispose_(),b=d.default.setTimeout(function(){t.setTimeoutIds_.has(b)&&t.setTimeoutIds_.delete(b),r()},e),this.setTimeoutIds_.add(b),b},T.clearTimeout=function(r){return this.setTimeoutIds_.has(r)&&(this.setTimeoutIds_.delete(r),d.default.clearTimeout(r)),r},T.setInterval=function(r,e){r=Oe(this,r),this.clearTimersOnDispose_();var t=d.default.setInterval(r,e);return this.setIntervalIds_.add(t),t},T.clearInterval=function(r){return this.setIntervalIds_.has(r)&&(this.setIntervalIds_.delete(r),d.default.clearInterval(r)),r},T.requestAnimationFrame=function(r){var e=this;if(!this.supportsRaf_)return this.setTimeout(r,1e3/60);this.clearTimersOnDispose_();var t;return r=Oe(this,r),t=d.default.requestAnimationFrame(function(){e.rafIds_.has(t)&&e.rafIds_.delete(t),r()}),this.rafIds_.add(t),t},T.requestNamedAnimationFrame=function(r,e){var t=this;if(!this.namedRafs_.has(r)){this.clearTimersOnDispose_(),e=Oe(this,e);var b=this.requestAnimationFrame(function(){e(),t.namedRafs_.has(r)&&t.namedRafs_.delete(r)});return this.namedRafs_.set(r,b),r}},T.cancelNamedAnimationFrame=function(r){!this.namedRafs_.has(r)||(this.cancelAnimationFrame(this.namedRafs_.get(r)),this.namedRafs_.delete(r))},T.cancelAnimationFrame=function(r){return this.supportsRaf_?(this.rafIds_.has(r)&&(this.rafIds_.delete(r),d.default.cancelAnimationFrame(r)),r):this.clearTimeout(r)},T.clearTimersOnDispose_=function(){var r=this;this.clearingTimersOnDispose_||(this.clearingTimersOnDispose_=!0,this.one("dispose",function(){[["namedRafs_","cancelNamedAnimationFrame"],["rafIds_","cancelAnimationFrame"],["setTimeoutIds_","clearTimeout"],["setIntervalIds_","clearInterval"]].forEach(function(e){var t=e[0],b=e[1];r[t].forEach(function(U,z){return r[b](z)})}),r.clearingTimersOnDispose_=!1}))},g.registerComponent=function(r,e){if(typeof r!="string"||!r)throw new Error('Illegal component name, "'+r+'"; must be a non-empty string.');var t=g.getComponent("Tech"),b=t&&t.isTech(e),U=g===e||g.prototype.isPrototypeOf(e.prototype);if(b||!U){var z;throw b?z="techs must be registered using Tech.registerTech()":z="must be a Component subclass",new Error('Illegal component, "'+r+'"; '+z+".")}r=Ue(r),g.components_||(g.components_={});var Y=g.getComponent("Player");if(r==="Player"&&Y&&Y.players){var J=Y.players,te=Object.keys(J);if(J&&te.length>0&&te.map(function(Q){return J[Q]}).every(Boolean))throw new Error("Can not register Player component after player has been created.")}return g.components_[r]=e,g.components_[nr(r)]=e,e},g.getComponent=function(r){if(!(!r||!g.components_))return g.components_[r]},g}();ae.prototype.supportsRaf_=typeof d.default.requestAnimationFrame=="function"&&typeof d.default.cancelAnimationFrame=="function",ae.registerComponent("Component",ae);function $n(g,T,o){if(typeof T!="number"||T<0||T>o)throw new Error("Failed to execute '"+g+"' on 'TimeRanges': The index provided ("+T+") is non-numeric or out of bounds (0-"+o+").")}function Mi(g,T,o,r){return $n(g,r,o.length-1),o[r][T]}function Rr(g){var T;return g===void 0||g.length===0?T={length:0,start:function(){throw new Error("This TimeRanges object is empty")},end:function(){throw new Error("This TimeRanges object is empty")}}:T={length:g.length,start:Mi.bind(null,"start",0,g),end:Mi.bind(null,"end",1,g)},d.default.Symbol&&d.default.Symbol.iterator&&(T[d.default.Symbol.iterator]=function(){return(g||[]).values()}),T}function bt(g,T){return Array.isArray(g)?Rr(g):g===void 0||T===void 0?Rr():Rr([[g,T]])}function xi(g,T){var o=0,r,e;if(!T)return 0;(!g||!g.length)&&(g=bt(0,0));for(var t=0;t<g.length;t++)r=g.start(t),e=g.end(t),e>T&&(e=T),o+=e-r;return o/T}function Xe(g){if(g instanceof Xe)return g;typeof g=="number"?this.code=g:typeof g=="string"?this.message=g:le(g)&&(typeof g.code=="number"&&(this.code=g.code),se(this,g)),this.message||(this.message=Xe.defaultMessages[this.code]||"")}Xe.prototype.code=0,Xe.prototype.message="",Xe.prototype.status=null,Xe.errorTypes=["MEDIA_ERR_CUSTOM","MEDIA_ERR_ABORTED","MEDIA_ERR_NETWORK","MEDIA_ERR_DECODE","MEDIA_ERR_SRC_NOT_SUPPORTED","MEDIA_ERR_ENCRYPTED"],Xe.defaultMessages={1:"You aborted the media playback",2:"A network error caused the media download to fail part-way.",3:"The media playback was aborted due to a corruption problem or because the media used features your browser did not support.",4:"The media could not be loaded, either because the server or network failed or because the format is not supported.",5:"The media is encrypted and we do not have the keys to decrypt it."};for(var Rt=0;Rt<Xe.errorTypes.length;Rt++)Xe[Xe.errorTypes[Rt]]=Rt,Xe.prototype[Xe.errorTypes[Rt]]=Rt;function Gt(g){return g!=null&&typeof g.then=="function"}function ot(g){Gt(g)&&g.then(null,function(T){})}var Ir=function(T){var o=["kind","label","language","id","inBandMetadataTrackDispatchType","mode","src"].reduce(function(r,e,t){return T[e]&&(r[e]=T[e]),r},{cues:T.cues&&Array.prototype.map.call(T.cues,function(r){return{startTime:r.startTime,endTime:r.endTime,text:r.text,id:r.id}})});return o},Qn=function(T){var o=T.$$("track"),r=Array.prototype.map.call(o,function(t){return t.track}),e=Array.prototype.map.call(o,function(t){var b=Ir(t.track);return t.src&&(b.src=t.src),b});return e.concat(Array.prototype.filter.call(T.textTracks(),function(t){return r.indexOf(t)===-1}).map(Ir))},Jn=function(T,o){return T.forEach(function(r){var e=o.addRemoteTextTrack(r).track;!r.src&&r.cues&&r.cues.forEach(function(t){return e.addCue(t)})}),o.textTracks()},ki={textTracksToJson:Qn,jsonToTextTracks:Jn,trackToJson_:Ir},Mr="vjs-modal-dialog",It=function(g){i.default(T,g);function T(r,e){var t;return t=g.call(this,r,e)||this,t.handleKeyDown_=function(b){return t.handleKeyDown(b)},t.close_=function(b){return t.close(b)},t.opened_=t.hasBeenOpened_=t.hasBeenFilled_=!1,t.closeable(!t.options_.uncloseable),t.content(t.options_.content),t.contentEl_=_e("div",{className:Mr+"-content"},{role:"document"}),t.descEl_=_e("p",{className:Mr+"-description vjs-control-text",id:t.el().getAttribute("aria-describedby")}),ut(t.descEl_,t.description()),t.el_.appendChild(t.descEl_),t.el_.appendChild(t.contentEl_),t}var o=T.prototype;return o.createEl=function(){return g.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),tabIndex:-1},{"aria-describedby":this.id()+"_description","aria-hidden":"true","aria-label":this.label(),role:"dialog"})},o.dispose=function(){this.contentEl_=null,this.descEl_=null,this.previouslyActiveEl_=null,g.prototype.dispose.call(this)},o.buildCSSClass=function(){return Mr+" vjs-hidden "+g.prototype.buildCSSClass.call(this)},o.label=function(){return this.localize(this.options_.label||"Modal Window")},o.description=function(){var e=this.options_.description||this.localize("This is a modal window.");return this.closeable()&&(e+=" "+this.localize("This modal can be closed by pressing the Escape key or activating the close button.")),e},o.open=function(){if(!this.opened_){var e=this.player();this.trigger("beforemodalopen"),this.opened_=!0,(this.options_.fillAlways||!this.hasBeenOpened_&&!this.hasBeenFilled_)&&this.fill(),this.wasPlaying_=!e.paused(),this.options_.pauseOnOpen&&this.wasPlaying_&&e.pause(),this.on("keydown",this.handleKeyDown_),this.hadControls_=e.controls(),e.controls(!1),this.show(),this.conditionalFocus_(),this.el().setAttribute("aria-hidden","false"),this.trigger("modalopen"),this.hasBeenOpened_=!0}},o.opened=function(e){return typeof e=="boolean"&&this[e?"open":"close"](),this.opened_},o.close=function(){if(!!this.opened_){var e=this.player();this.trigger("beforemodalclose"),this.opened_=!1,this.wasPlaying_&&this.options_.pauseOnOpen&&e.play(),this.off("keydown",this.handleKeyDown_),this.hadControls_&&e.controls(!0),this.hide(),this.el().setAttribute("aria-hidden","true"),this.trigger("modalclose"),this.conditionalBlur_(),this.options_.temporary&&this.dispose()}},o.closeable=function(e){if(typeof e=="boolean"){var t=this.closeable_=!!e,b=this.getChild("closeButton");if(t&&!b){var U=this.contentEl_;this.contentEl_=this.el_,b=this.addChild("closeButton",{controlText:"Close Modal Dialog"}),this.contentEl_=U,this.on(b,"close",this.close_)}!t&&b&&(this.off(b,"close",this.close_),this.removeChild(b),b.dispose())}return this.closeable_},o.fill=function(){this.fillWith(this.content())},o.fillWith=function(e){var t=this.contentEl(),b=t.parentNode,U=t.nextSibling;this.trigger("beforemodalfill"),this.hasBeenFilled_=!0,b.removeChild(t),this.empty(),Ti(t,e),this.trigger("modalfill"),U?b.insertBefore(t,U):b.appendChild(t);var z=this.getChild("closeButton");z&&b.appendChild(z.el_)},o.empty=function(){this.trigger("beforemodalempty"),Tr(this.contentEl()),this.trigger("modalempty")},o.content=function(e){return typeof e!="undefined"&&(this.content_=e),this.content_},o.conditionalFocus_=function(){var e=E.default.activeElement,t=this.player_.el_;this.previouslyActiveEl_=null,(t.contains(e)||t===e)&&(this.previouslyActiveEl_=e,this.focus())},o.conditionalBlur_=function(){this.previouslyActiveEl_&&(this.previouslyActiveEl_.focus(),this.previouslyActiveEl_=null)},o.handleKeyDown=function(e){if(e.stopPropagation(),p.default.isEventKey(e,"Escape")&&this.closeable()){e.preventDefault(),this.close();return}if(!!p.default.isEventKey(e,"Tab")){for(var t=this.focusableEls_(),b=this.el_.querySelector(":focus"),U,z=0;z<t.length;z++)if(b===t[z]){U=z;break}E.default.activeElement===this.el_&&(U=0),e.shiftKey&&U===0?(t[t.length-1].focus(),e.preventDefault()):!e.shiftKey&&U===t.length-1&&(t[0].focus(),e.preventDefault())}},o.focusableEls_=function(){var e=this.el_.querySelectorAll("*");return Array.prototype.filter.call(e,function(t){return(t instanceof d.default.HTMLAnchorElement||t instanceof d.default.HTMLAreaElement)&&t.hasAttribute("href")||(t instanceof d.default.HTMLInputElement||t instanceof d.default.HTMLSelectElement||t instanceof d.default.HTMLTextAreaElement||t instanceof d.default.HTMLButtonElement)&&!t.hasAttribute("disabled")||t instanceof d.default.HTMLIFrameElement||t instanceof d.default.HTMLObjectElement||t instanceof d.default.HTMLEmbedElement||t.hasAttribute("tabindex")&&t.getAttribute("tabindex")!==-1||t.hasAttribute("contenteditable")})},T}(ae);It.prototype.options_={pauseOnOpen:!0,temporary:!0},ae.registerComponent("ModalDialog",It);var Mt=function(g){i.default(T,g);function T(r){var e;r===void 0&&(r=[]),e=g.call(this)||this,e.tracks_=[],Object.defineProperty(a.default(e),"length",{get:function(){return this.tracks_.length}});for(var t=0;t<r.length;t++)e.addTrack(r[t]);return e}var o=T.prototype;return o.addTrack=function(e){var t=this,b=this.tracks_.length;""+b in this||Object.defineProperty(this,b,{get:function(){return this.tracks_[b]}}),this.tracks_.indexOf(e)===-1&&(this.tracks_.push(e),this.trigger({track:e,type:"addtrack",target:this})),e.labelchange_=function(){t.trigger({track:e,type:"labelchange",target:t})},ft(e)&&e.addEventListener("labelchange",e.labelchange_)},o.removeTrack=function(e){for(var t,b=0,U=this.length;b<U;b++)if(this[b]===e){t=this[b],t.off&&t.off(),this.tracks_.splice(b,1);break}!t||this.trigger({track:t,type:"removetrack",target:this})},o.getTrackById=function(e){for(var t=null,b=0,U=this.length;b<U;b++){var z=this[b];if(z.id===e){t=z;break}}return t},T}(We);Mt.prototype.allowedEvents_={change:"change",addtrack:"addtrack",removetrack:"removetrack",labelchange:"labelchange"};for(var Zn in Mt.prototype.allowedEvents_)Mt.prototype["on"+Zn]=null;var xr=function(T,o){for(var r=0;r<T.length;r++)!Object.keys(T[r]).length||o.id===T[r].id||(T[r].enabled=!1)},qn=function(g){i.default(T,g);function T(r){var e;r===void 0&&(r=[]);for(var t=r.length-1;t>=0;t--)if(r[t].enabled){xr(r,r[t]);break}return e=g.call(this,r)||this,e.changing_=!1,e}var o=T.prototype;return o.addTrack=function(e){var t=this;e.enabled&&xr(this,e),g.prototype.addTrack.call(this,e),!!e.addEventListener&&(e.enabledChange_=function(){t.changing_||(t.changing_=!0,xr(t,e),t.changing_=!1,t.trigger("change"))},e.addEventListener("enabledchange",e.enabledChange_))},o.removeTrack=function(e){g.prototype.removeTrack.call(this,e),e.removeEventListener&&e.enabledChange_&&(e.removeEventListener("enabledchange",e.enabledChange_),e.enabledChange_=null)},T}(Mt),kr=function(T,o){for(var r=0;r<T.length;r++)!Object.keys(T[r]).length||o.id===T[r].id||(T[r].selected=!1)},ea=function(g){i.default(T,g);function T(r){var e;r===void 0&&(r=[]);for(var t=r.length-1;t>=0;t--)if(r[t].selected){kr(r,r[t]);break}return e=g.call(this,r)||this,e.changing_=!1,Object.defineProperty(a.default(e),"selectedIndex",{get:function(){for(var U=0;U<this.length;U++)if(this[U].selected)return U;return-1},set:function(){}}),e}var o=T.prototype;return o.addTrack=function(e){var t=this;e.selected&&kr(this,e),g.prototype.addTrack.call(this,e),!!e.addEventListener&&(e.selectedChange_=function(){t.changing_||(t.changing_=!0,kr(t,e),t.changing_=!1,t.trigger("change"))},e.addEventListener("selectedchange",e.selectedChange_))},o.removeTrack=function(e){g.prototype.removeTrack.call(this,e),e.removeEventListener&&e.selectedChange_&&(e.removeEventListener("selectedchange",e.selectedChange_),e.selectedChange_=null)},T}(Mt),wi=function(g){i.default(T,g);function T(){return g.apply(this,arguments)||this}var o=T.prototype;return o.addTrack=function(e){var t=this;g.prototype.addTrack.call(this,e),this.queueChange_||(this.queueChange_=function(){return t.queueTrigger("change")}),this.triggerSelectedlanguagechange||(this.triggerSelectedlanguagechange_=function(){return t.trigger("selectedlanguagechange")}),e.addEventListener("modechange",this.queueChange_);var b=["metadata","chapters"];b.indexOf(e.kind)===-1&&e.addEventListener("modechange",this.triggerSelectedlanguagechange_)},o.removeTrack=function(e){g.prototype.removeTrack.call(this,e),e.removeEventListener&&(this.queueChange_&&e.removeEventListener("modechange",this.queueChange_),this.selectedlanguagechange_&&e.removeEventListener("modechange",this.triggerSelectedlanguagechange_))},T}(Mt),ta=function(){function g(o){o===void 0&&(o=[]),this.trackElements_=[],Object.defineProperty(this,"length",{get:function(){return this.trackElements_.length}});for(var r=0,e=o.length;r<e;r++)this.addTrackElement_(o[r])}var T=g.prototype;return T.addTrackElement_=function(r){var e=this.trackElements_.length;""+e in this||Object.defineProperty(this,e,{get:function(){return this.trackElements_[e]}}),this.trackElements_.indexOf(r)===-1&&this.trackElements_.push(r)},T.getTrackElementByTrack_=function(r){for(var e,t=0,b=this.trackElements_.length;t<b;t++)if(r===this.trackElements_[t].track){e=this.trackElements_[t];break}return e},T.removeTrackElement_=function(r){for(var e=0,t=this.trackElements_.length;e<t;e++)if(r===this.trackElements_[e]){this.trackElements_[e].track&&typeof this.trackElements_[e].track.off=="function"&&this.trackElements_[e].track.off(),typeof this.trackElements_[e].off=="function"&&this.trackElements_[e].off(),this.trackElements_.splice(e,1);break}},g}(),Fi=function(){function g(o){g.prototype.setCues_.call(this,o),Object.defineProperty(this,"length",{get:function(){return this.length_}})}var T=g.prototype;return T.setCues_=function(r){var e=this.length||0,t=0,b=r.length;this.cues_=r,this.length_=r.length;var U=function(Y){""+Y in this||Object.defineProperty(this,""+Y,{get:function(){return this.cues_[Y]}})};if(e<b)for(t=e;t<b;t++)U.call(this,t)},T.getCueById=function(r){for(var e=null,t=0,b=this.length;t<b;t++){var U=this[t];if(U.id===r){e=U;break}}return e},g}(),ra={alternative:"alternative",captions:"captions",main:"main",sign:"sign",subtitles:"subtitles",commentary:"commentary"},ia={alternative:"alternative",descriptions:"descriptions",main:"main","main-desc":"main-desc",translation:"translation",commentary:"commentary"},na={subtitles:"subtitles",captions:"captions",descriptions:"descriptions",chapters:"chapters",metadata:"metadata"},Bi={disabled:"disabled",hidden:"hidden",showing:"showing"},wr=function(g){i.default(T,g);function T(o){var r;o===void 0&&(o={}),r=g.call(this)||this;var e={id:o.id||"vjs_track_"+mt(),kind:o.kind||"",language:o.language||""},t=o.label||"",b=function(Y){Object.defineProperty(a.default(r),Y,{get:function(){return e[Y]},set:function(){}})};for(var U in e)b(U);return Object.defineProperty(a.default(r),"label",{get:function(){return t},set:function(Y){Y!==t&&(t=Y,this.trigger("labelchange"))}}),r}return T}(We),Fr=function(T){var o=["protocol","hostname","port","pathname","search","hash","host"],r=E.default.createElement("a");r.href=T;for(var e={},t=0;t<o.length;t++)e[o[t]]=r[o[t]];return e.protocol==="http:"&&(e.host=e.host.replace(/:80$/,"")),e.protocol==="https:"&&(e.host=e.host.replace(/:443$/,"")),e.protocol||(e.protocol=d.default.location.protocol),e.host||(e.host=d.default.location.host),e},Ni=function(T){if(!T.match(/^https?:\/\//)){var o=E.default.createElement("a");o.href=T,T=o.href}return T},Br=function(T){if(typeof T=="string"){var o=/^(\/?)([\s\S]*?)((?:\.{1,2}|[^\/]+?)(\.([^\.\/\?]+)))(?:[\/]*|[\?].*)$/,r=o.exec(T);if(r)return r.pop().toLowerCase()}return""},ar=function(T,o){o===void 0&&(o=d.default.location);var r=Fr(T),e=r.protocol===":"?o.protocol:r.protocol,t=e+r.host!==o.protocol+o.host;return t},aa=Object.freeze({__proto__:null,parseUrl:Fr,getAbsoluteURL:Ni,getFileExtension:Br,isCrossOrigin:ar}),Ui=function(T,o){var r=new d.default.WebVTT.Parser(d.default,d.default.vttjs,d.default.WebVTT.StringDecoder()),e=[];r.oncue=function(t){o.addCue(t)},r.onparsingerror=function(t){e.push(t)},r.onflush=function(){o.trigger({type:"loadeddata",target:o})},r.parse(T),e.length>0&&(d.default.console&&d.default.console.groupCollapsed&&d.default.console.groupCollapsed("Text Track parsing errors for "+o.src),e.forEach(function(t){return $.error(t)}),d.default.console&&d.default.console.groupEnd&&d.default.console.groupEnd()),r.flush()},ji=function(T,o){var r={uri:T},e=ar(T);e&&(r.cors=e);var t=o.tech_.crossOrigin()==="use-credentials";t&&(r.withCredentials=t),f.default(r,Oe(this,function(b,U,z){if(b)return $.error(b,U);o.loaded_=!0,typeof d.default.WebVTT!="function"?o.tech_&&o.tech_.any(["vttjsloaded","vttjserror"],function(Y){if(Y.type==="vttjserror"){$.error("vttjs failed to load, stopping trying to process "+o.src);return}return Ui(z,o)}):Ui(z,o)}))},Vt=function(g){i.default(T,g);function T(r){var e;if(r===void 0&&(r={}),!r.tech)throw new Error("A tech was not provided.");var t=xe(r,{kind:na[r.kind]||"subtitles",language:r.language||r.srclang||""}),b=Bi[t.mode]||"disabled",U=t.default;(t.kind==="metadata"||t.kind==="chapters")&&(b="hidden"),e=g.call(this,t)||this,e.tech_=t.tech,e.cues_=[],e.activeCues_=[],e.preload_=e.tech_.preloadTextTracks!==!1;var z=new Fi(e.cues_),Y=new Fi(e.activeCues_),J=!1,te=Oe(a.default(e),function(){!this.tech_.isReady_||this.tech_.isDisposed()||(this.activeCues=this.activeCues,J&&(this.trigger("cuechange"),J=!1))}),Q=function(){e.tech_.off("timeupdate",te)};return e.tech_.one("dispose",Q),b!=="disabled"&&e.tech_.on("timeupdate",te),Object.defineProperties(a.default(e),{default:{get:function(){return U},set:function(){}},mode:{get:function(){return b},set:function(fe){!Bi[fe]||b!==fe&&(b=fe,!this.preload_&&b!=="disabled"&&this.cues.length===0&&ji(this.src,this),this.tech_.off("timeupdate",te),b!=="disabled"&&this.tech_.on("timeupdate",te),this.trigger("modechange"))}},cues:{get:function(){return this.loaded_?z:null},set:function(){}},activeCues:{get:function(){if(!this.loaded_)return null;if(this.cues.length===0)return Y;for(var fe=this.tech_.currentTime(),Se=[],ht=0,hi=this.cues.length;ht<hi;ht++){var yt=this.cues[ht];(yt.startTime<=fe&&yt.endTime>=fe||yt.startTime===yt.endTime&&yt.startTime<=fe&&yt.startTime+.5>=fe)&&Se.push(yt)}if(J=!1,Se.length!==this.activeCues_.length)J=!0;else for(var vi=0;vi<Se.length;vi++)this.activeCues_.indexOf(Se[vi])===-1&&(J=!0);return this.activeCues_=Se,Y.setCues_(this.activeCues_),Y},set:function(){}}}),t.src?(e.src=t.src,e.preload_||(e.loaded_=!0),(e.preload_||t.kind!=="subtitles"&&t.kind!=="captions")&&ji(e.src,a.default(e))):e.loaded_=!0,e}var o=T.prototype;return o.addCue=function(e){var t=e;if(d.default.vttjs&&!(e instanceof d.default.vttjs.VTTCue)){t=new d.default.vttjs.VTTCue(e.startTime,e.endTime,e.text);for(var b in e)b in t||(t[b]=e[b]);t.id=e.id,t.originalCue_=e}for(var U=this.tech_.textTracks(),z=0;z<U.length;z++)U[z]!==this&&U[z].removeCue(t);this.cues_.push(t),this.cues.setCues_(this.cues_)},o.removeCue=function(e){for(var t=this.cues_.length;t--;){var b=this.cues_[t];if(b===e||b.originalCue_&&b.originalCue_===e){this.cues_.splice(t,1),this.cues.setCues_(this.cues_);break}}},T}(wr);Vt.prototype.allowedEvents_={cuechange:"cuechange"};var Ki=function(g){i.default(T,g);function T(o){var r;o===void 0&&(o={});var e=xe(o,{kind:ia[o.kind]||""});r=g.call(this,e)||this;var t=!1;return Object.defineProperty(a.default(r),"enabled",{get:function(){return t},set:function(U){typeof U!="boolean"||U===t||(t=U,this.trigger("enabledchange"))}}),e.enabled&&(r.enabled=e.enabled),r.loaded_=!0,r}return T}(wr),Hi=function(g){i.default(T,g);function T(o){var r;o===void 0&&(o={});var e=xe(o,{kind:ra[o.kind]||""});r=g.call(this,e)||this;var t=!1;return Object.defineProperty(a.default(r),"selected",{get:function(){return t},set:function(U){typeof U!="boolean"||U===t||(t=U,this.trigger("selectedchange"))}}),e.selected&&(r.selected=e.selected),r}return T}(wr),Wi=0,sa=1,Gi=2,oa=3,xt=function(g){i.default(T,g);function T(o){var r;o===void 0&&(o={}),r=g.call(this)||this;var e,t=new Vt(o);return r.kind=t.kind,r.src=t.src,r.srclang=t.language,r.label=t.label,r.default=t.default,Object.defineProperties(a.default(r),{readyState:{get:function(){return e}},track:{get:function(){return t}}}),e=Wi,t.addEventListener("loadeddata",function(){e=Gi,r.trigger({type:"load",target:a.default(r)})}),r}return T}(We);xt.prototype.allowedEvents_={load:"load"},xt.NONE=Wi,xt.LOADING=sa,xt.LOADED=Gi,xt.ERROR=oa;var tt={audio:{ListClass:qn,TrackClass:Ki,capitalName:"Audio"},video:{ListClass:ea,TrackClass:Hi,capitalName:"Video"},text:{ListClass:wi,TrackClass:Vt,capitalName:"Text"}};Object.keys(tt).forEach(function(g){tt[g].getterName=g+"Tracks",tt[g].privateName=g+"Tracks_"});var kt={remoteText:{ListClass:wi,TrackClass:Vt,capitalName:"RemoteText",getterName:"remoteTextTracks",privateName:"remoteTextTracks_"},remoteTextEl:{ListClass:ta,TrackClass:xt,capitalName:"RemoteTextTrackEls",getterName:"remoteTextTrackEls",privateName:"remoteTextTrackEls_"}},$e=c.default({},tt,kt);kt.names=Object.keys(kt),tt.names=Object.keys(tt),$e.names=[].concat(kt.names).concat(tt.names);function la(g,T,o,r,e){e===void 0&&(e={});var t=g.textTracks();e.kind=T,o&&(e.label=o),r&&(e.language=r),e.tech=g;var b=new $e.text.TrackClass(e);return t.addTrack(b),b}var Re=function(g){i.default(T,g);function T(r,e){var t;return r===void 0&&(r={}),e===void 0&&(e=function(){}),r.reportTouchActivity=!1,t=g.call(this,null,r,e)||this,t.onDurationChange_=function(b){return t.onDurationChange(b)},t.trackProgress_=function(b){return t.trackProgress(b)},t.trackCurrentTime_=function(b){return t.trackCurrentTime(b)},t.stopTrackingCurrentTime_=function(b){return t.stopTrackingCurrentTime(b)},t.disposeSourceHandler_=function(b){return t.disposeSourceHandler(b)},t.hasStarted_=!1,t.on("playing",function(){this.hasStarted_=!0}),t.on("loadstart",function(){this.hasStarted_=!1}),$e.names.forEach(function(b){var U=$e[b];r&&r[U.getterName]&&(t[U.privateName]=r[U.getterName])}),t.featuresProgressEvents||t.manualProgressOn(),t.featuresTimeupdateEvents||t.manualTimeUpdatesOn(),["Text","Audio","Video"].forEach(function(b){r["native"+b+"Tracks"]===!1&&(t["featuresNative"+b+"Tracks"]=!1)}),r.nativeCaptions===!1||r.nativeTextTracks===!1?t.featuresNativeTextTracks=!1:(r.nativeCaptions===!0||r.nativeTextTracks===!0)&&(t.featuresNativeTextTracks=!0),t.featuresNativeTextTracks||t.emulateTextTracks(),t.preloadTextTracks=r.preloadTextTracks!==!1,t.autoRemoteTextTracks_=new $e.text.ListClass,t.initTrackListeners(),r.nativeControlsForTouch||t.emitTapEvents(),t.constructor&&(t.name_=t.constructor.name||"Unknown Tech"),t}var o=T.prototype;return o.triggerSourceset=function(e){var t=this;this.isReady_||this.one("ready",function(){return t.setTimeout(function(){return t.triggerSourceset(e)},1)}),this.trigger({src:e,type:"sourceset"})},o.manualProgressOn=function(){this.on("durationchange",this.onDurationChange_),this.manualProgress=!0,this.one("ready",this.trackProgress_)},o.manualProgressOff=function(){this.manualProgress=!1,this.stopTrackingProgress(),this.off("durationchange",this.onDurationChange_)},o.trackProgress=function(e){this.stopTrackingProgress(),this.progressInterval=this.setInterval(Oe(this,function(){var t=this.bufferedPercent();this.bufferedPercent_!==t&&this.trigger("progress"),this.bufferedPercent_=t,t===1&&this.stopTrackingProgress()}),500)},o.onDurationChange=function(e){this.duration_=this.duration()},o.buffered=function(){return bt(0,0)},o.bufferedPercent=function(){return xi(this.buffered(),this.duration_)},o.stopTrackingProgress=function(){this.clearInterval(this.progressInterval)},o.manualTimeUpdatesOn=function(){this.manualTimeUpdates=!0,this.on("play",this.trackCurrentTime_),this.on("pause",this.stopTrackingCurrentTime_)},o.manualTimeUpdatesOff=function(){this.manualTimeUpdates=!1,this.stopTrackingCurrentTime(),this.off("play",this.trackCurrentTime_),this.off("pause",this.stopTrackingCurrentTime_)},o.trackCurrentTime=function(){this.currentTimeInterval&&this.stopTrackingCurrentTime(),this.currentTimeInterval=this.setInterval(function(){this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},250)},o.stopTrackingCurrentTime=function(){this.clearInterval(this.currentTimeInterval),this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},o.dispose=function(){this.clearTracks(tt.names),this.manualProgress&&this.manualProgressOff(),this.manualTimeUpdates&&this.manualTimeUpdatesOff(),g.prototype.dispose.call(this)},o.clearTracks=function(e){var t=this;e=[].concat(e),e.forEach(function(b){for(var U=t[b+"Tracks"]()||[],z=U.length;z--;){var Y=U[z];b==="text"&&t.removeRemoteTextTrack(Y),U.removeTrack(Y)}})},o.cleanupAutoTextTracks=function(){for(var e=this.autoRemoteTextTracks_||[],t=e.length;t--;){var b=e[t];this.removeRemoteTextTrack(b)}},o.reset=function(){},o.crossOrigin=function(){},o.setCrossOrigin=function(){},o.error=function(e){return e!==void 0&&(this.error_=new Xe(e),this.trigger("error")),this.error_},o.played=function(){return this.hasStarted_?bt(0,0):bt()},o.play=function(){},o.setScrubbing=function(){},o.scrubbing=function(){},o.setCurrentTime=function(){this.manualTimeUpdates&&this.trigger({type:"timeupdate",target:this,manuallyTriggered:!0})},o.initTrackListeners=function(){var e=this;tt.names.forEach(function(t){var b=tt[t],U=function(){e.trigger(t+"trackchange")},z=e[b.getterName]();z.addEventListener("removetrack",U),z.addEventListener("addtrack",U),e.on("dispose",function(){z.removeEventListener("removetrack",U),z.removeEventListener("addtrack",U)})})},o.addWebVttScript_=function(){var e=this;if(!d.default.WebVTT)if(E.default.body.contains(this.el())){if(!this.options_["vtt.js"]&&ce(h.default)&&Object.keys(h.default).length>0){this.trigger("vttjsloaded");return}var t=E.default.createElement("script");t.src=this.options_["vtt.js"]||"https://vjs.zencdn.net/vttjs/0.14.1/vtt.min.js",t.onload=function(){e.trigger("vttjsloaded")},t.onerror=function(){e.trigger("vttjserror")},this.on("dispose",function(){t.onload=null,t.onerror=null}),d.default.WebVTT=!0,this.el().parentNode.appendChild(t)}else this.ready(this.addWebVttScript_)},o.emulateTextTracks=function(){var e=this,t=this.textTracks(),b=this.remoteTextTracks(),U=function(Q){return t.addTrack(Q.track)},z=function(Q){return t.removeTrack(Q.track)};b.on("addtrack",U),b.on("removetrack",z),this.addWebVttScript_();var Y=function(){return e.trigger("texttrackchange")},J=function(){Y();for(var Q=0;Q<t.length;Q++){var ne=t[Q];ne.removeEventListener("cuechange",Y),ne.mode==="showing"&&ne.addEventListener("cuechange",Y)}};J(),t.addEventListener("change",J),t.addEventListener("addtrack",J),t.addEventListener("removetrack",J),this.on("dispose",function(){b.off("addtrack",U),b.off("removetrack",z),t.removeEventListener("change",J),t.removeEventListener("addtrack",J),t.removeEventListener("removetrack",J);for(var te=0;te<t.length;te++){var Q=t[te];Q.removeEventListener("cuechange",Y)}})},o.addTextTrack=function(e,t,b){if(!e)throw new Error("TextTrack kind is required but was not provided");return la(this,e,t,b)},o.createRemoteTextTrack=function(e){var t=xe(e,{tech:this});return new kt.remoteTextEl.TrackClass(t)},o.addRemoteTextTrack=function(e,t){var b=this;e===void 0&&(e={});var U=this.createRemoteTextTrack(e);return t!==!0&&t!==!1&&($.warn('Calling addRemoteTextTrack without explicitly setting the "manualCleanup" parameter to `true` is deprecated and default to `false` in future version of video.js'),t=!0),this.remoteTextTrackEls().addTrackElement_(U),this.remoteTextTracks().addTrack(U.track),t!==!0&&this.ready(function(){return b.autoRemoteTextTracks_.addTrack(U.track)}),U},o.removeRemoteTextTrack=function(e){var t=this.remoteTextTrackEls().getTrackElementByTrack_(e);this.remoteTextTrackEls().removeTrackElement_(t),this.remoteTextTracks().removeTrack(e),this.autoRemoteTextTracks_.removeTrack(e)},o.getVideoPlaybackQuality=function(){return{}},o.requestPictureInPicture=function(){var e=this.options_.Promise||d.default.Promise;if(e)return e.reject()},o.disablePictureInPicture=function(){return!0},o.setDisablePictureInPicture=function(){},o.setPoster=function(){},o.playsinline=function(){},o.setPlaysinline=function(){},o.overrideNativeAudioTracks=function(){},o.overrideNativeVideoTracks=function(){},o.canPlayType=function(){return""},T.canPlayType=function(){return""},T.canPlaySource=function(e,t){return T.canPlayType(e.type)},T.isTech=function(e){return e.prototype instanceof T||e instanceof T||e===T},T.registerTech=function(e,t){if(T.techs_||(T.techs_={}),!T.isTech(t))throw new Error("Tech "+e+" must be a Tech");if(!T.canPlayType)throw new Error("Techs must have a static canPlayType method on them");if(!T.canPlaySource)throw new Error("Techs must have a static canPlaySource method on them");return e=Ue(e),T.techs_[e]=t,T.techs_[nr(e)]=t,e!=="Tech"&&T.defaultTechOrder_.push(e),t},T.getTech=function(e){if(!!e){if(T.techs_&&T.techs_[e])return T.techs_[e];if(e=Ue(e),d.default&&d.default.videojs&&d.default.videojs[e])return $.warn("The "+e+" tech was added to the videojs object when it should be registered using videojs.registerTech(name, tech)"),d.default.videojs[e]}},T}(ae);$e.names.forEach(function(g){var T=$e[g];Re.prototype[T.getterName]=function(){return this[T.privateName]=this[T.privateName]||new T.ListClass,this[T.privateName]}}),Re.prototype.featuresVolumeControl=!0,Re.prototype.featuresMuteControl=!0,Re.prototype.featuresFullscreenResize=!1,Re.prototype.featuresPlaybackRate=!1,Re.prototype.featuresProgressEvents=!1,Re.prototype.featuresSourceset=!1,Re.prototype.featuresTimeupdateEvents=!1,Re.prototype.featuresNativeTextTracks=!1,Re.withSourceHandlers=function(g){g.registerSourceHandler=function(o,r){var e=g.sourceHandlers;e||(e=g.sourceHandlers=[]),r===void 0&&(r=e.length),e.splice(r,0,o)},g.canPlayType=function(o){for(var r=g.sourceHandlers||[],e,t=0;t<r.length;t++)if(e=r[t].canPlayType(o),e)return e;return""},g.selectSourceHandler=function(o,r){for(var e=g.sourceHandlers||[],t,b=0;b<e.length;b++)if(t=e[b].canHandleSource(o,r),t)return e[b];return null},g.canPlaySource=function(o,r){var e=g.selectSourceHandler(o,r);return e?e.canHandleSource(o,r):""};var T=["seekable","seeking","duration"];T.forEach(function(o){var r=this[o];typeof r=="function"&&(this[o]=function(){return this.sourceHandler_&&this.sourceHandler_[o]?this.sourceHandler_[o].apply(this.sourceHandler_,arguments):r.apply(this,arguments)})},g.prototype),g.prototype.setSource=function(o){var r=g.selectSourceHandler(o,this.options_);r||(g.nativeSourceHandler?r=g.nativeSourceHandler:$.error("No source handler found for the current source.")),this.disposeSourceHandler(),this.off("dispose",this.disposeSourceHandler_),r!==g.nativeSourceHandler&&(this.currentSource_=o),this.sourceHandler_=r.handleSource(o,this,this.options_),this.one("dispose",this.disposeSourceHandler_)},g.prototype.disposeSourceHandler=function(){this.currentSource_&&(this.clearTracks(["audio","video"]),this.currentSource_=null),this.cleanupAutoTextTracks(),this.sourceHandler_&&(this.sourceHandler_.dispose&&this.sourceHandler_.dispose(),this.sourceHandler_=null)}},ae.registerComponent("Tech",Re),Re.registerTech("Tech",Re),Re.defaultTechOrder_=[];var Ct={},Nr={},sr={};function ua(g,T){Ct[g]=Ct[g]||[],Ct[g].push(T)}function ca(g,T,o){g.setTimeout(function(){return At(T,Ct[T.type],o,g)},1)}function da(g,T){g.forEach(function(o){return o.setTech&&o.setTech(T)})}function fa(g,T,o){return g.reduceRight(Ur(o),T[o]())}function ha(g,T,o,r){return T[o](g.reduce(Ur(o),r))}function Vi(g,T,o,r){r===void 0&&(r=null);var e="call"+Ue(o),t=g.reduce(Ur(e),r),b=t===sr,U=b?null:T[o](t);return ga(g,o,U,b),U}var va={buffered:1,currentTime:1,duration:1,muted:1,played:1,paused:1,seekable:1,volume:1,ended:1},pa={setCurrentTime:1,setMuted:1,setVolume:1},zi={play:1,pause:1};function Ur(g){return function(T,o){return T===sr?sr:o[g]?o[g](T):T}}function ga(g,T,o,r){for(var e=g.length-1;e>=0;e--){var t=g[e];t[T]&&t[T](r,o)}}function ma(g){Nr[g.id()]=null}function ya(g,T){var o=Nr[g.id()],r=null;if(o==null)return r=T(g),Nr[g.id()]=[[T,r]],r;for(var e=0;e<o.length;e++){var t=o[e],b=t[0],U=t[1];b===T&&(r=U)}return r===null&&(r=T(g),o.push([T,r])),r}function At(g,T,o,r,e,t){g===void 0&&(g={}),T===void 0&&(T=[]),e===void 0&&(e=[]),t===void 0&&(t=!1);var b=T,U=b[0],z=b.slice(1);if(typeof U=="string")At(g,Ct[U],o,r,e,t);else if(U){var Y=ya(r,U);if(!Y.setSource)return e.push(Y),At(g,z,o,r,e,t);Y.setSource(se({},g),function(J,te){if(J)return At(g,z,o,r,e,t);e.push(Y),At(te,g.type===te.type?z:Ct[te.type],o,r,e,t)})}else z.length?At(g,z,o,r,e,t):t?o(g,e):At(g,Ct["*"],o,r,e,!0)}var Ea={opus:"video/ogg",ogv:"video/ogg",mp4:"video/mp4",mov:"video/mp4",m4v:"video/mp4",mkv:"video/x-matroska",m4a:"audio/mp4",mp3:"audio/mpeg",aac:"audio/aac",caf:"audio/x-caf",flac:"audio/flac",oga:"audio/ogg",wav:"audio/wav",m3u8:"application/x-mpegURL",jpg:"image/jpeg",jpeg:"image/jpeg",gif:"image/gif",png:"image/png",svg:"image/svg+xml",webp:"image/webp"},or=function(T){T===void 0&&(T="");var o=Br(T),r=Ea[o.toLowerCase()];return r||""},Ta=function(T,o){if(!o)return"";if(T.cache_.source.src===o&&T.cache_.source.type)return T.cache_.source.type;var r=T.cache_.sources.filter(function(U){return U.src===o});if(r.length)return r[0].type;for(var e=T.$$("source"),t=0;t<e.length;t++){var b=e[t];if(b.type&&b.src&&b.src===o)return b.type}return or(o)},_a=function g(T){if(Array.isArray(T)){var o=[];T.forEach(function(r){r=g(r),Array.isArray(r)?o=o.concat(r):le(r)&&o.push(r)}),T=o}else typeof T=="string"&&T.trim()?T=[Yi({src:T})]:le(T)&&typeof T.src=="string"&&T.src&&T.src.trim()?T=[Yi(T)]:T=[];return T};function Yi(g){if(!g.type){var T=or(g.src);T&&(g.type=T)}return g}var Sa=function(g){i.default(T,g);function T(o,r,e){var t,b=xe({createEl:!1},r);if(t=g.call(this,o,b,e)||this,!r.playerOptions.sources||r.playerOptions.sources.length===0)for(var U=0,z=r.playerOptions.techOrder;U<z.length;U++){var Y=Ue(z[U]),J=Re.getTech(Y);if(Y||(J=ae.getComponent(Y)),J&&J.isSupported()){o.loadTech_(Y);break}}else o.src(r.playerOptions.sources);return t}return T}(ae);ae.registerComponent("MediaLoader",Sa);var lr=function(g){i.default(T,g);function T(r,e){var t;return t=g.call(this,r,e)||this,t.handleMouseOver_=function(b){return t.handleMouseOver(b)},t.handleMouseOut_=function(b){return t.handleMouseOut(b)},t.handleClick_=function(b){return t.handleClick(b)},t.handleKeyDown_=function(b){return t.handleKeyDown(b)},t.emitTapEvents(),t.enable(),t}var o=T.prototype;return o.createEl=function(e,t,b){e===void 0&&(e="div"),t===void 0&&(t={}),b===void 0&&(b={}),t=se({className:this.buildCSSClass(),tabIndex:0},t),e==="button"&&$.error("Creating a ClickableComponent with an HTML element of "+e+" is not supported; use a Button instead."),b=se({role:"button"},b),this.tabIndex_=t.tabIndex;var U=_e(e,t,b);return U.appendChild(_e("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(U),U},o.dispose=function(){this.controlTextEl_=null,g.prototype.dispose.call(this)},o.createControlTextEl=function(e){return this.controlTextEl_=_e("span",{className:"vjs-control-text"},{"aria-live":"polite"}),e&&e.appendChild(this.controlTextEl_),this.controlText(this.controlText_,e),this.controlTextEl_},o.controlText=function(e,t){if(t===void 0&&(t=this.el()),e===void 0)return this.controlText_||"Need Text";var b=this.localize(e);this.controlText_=e,ut(this.controlTextEl_,b),!this.nonIconControl&&!this.player_.options_.noUITitleAttributes&&t.setAttribute("title",b)},o.buildCSSClass=function(){return"vjs-control vjs-button "+g.prototype.buildCSSClass.call(this)},o.enable=function(){this.enabled_||(this.enabled_=!0,this.removeClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","false"),typeof this.tabIndex_!="undefined"&&this.el_.setAttribute("tabIndex",this.tabIndex_),this.on(["tap","click"],this.handleClick_),this.on("keydown",this.handleKeyDown_))},o.disable=function(){this.enabled_=!1,this.addClass("vjs-disabled"),this.el_.setAttribute("aria-disabled","true"),typeof this.tabIndex_!="undefined"&&this.el_.removeAttribute("tabIndex"),this.off("mouseover",this.handleMouseOver_),this.off("mouseout",this.handleMouseOut_),this.off(["tap","click"],this.handleClick_),this.off("keydown",this.handleKeyDown_)},o.handleLanguagechange=function(){this.controlText(this.controlText_)},o.handleClick=function(e){this.options_.clickHandler&&this.options_.clickHandler.call(this,arguments)},o.handleKeyDown=function(e){p.default.isEventKey(e,"Space")||p.default.isEventKey(e,"Enter")?(e.preventDefault(),e.stopPropagation(),this.trigger("click")):g.prototype.handleKeyDown.call(this,e)},T}(ae);ae.registerComponent("ClickableComponent",lr);var ba=function(g){i.default(T,g);function T(r,e){var t;return t=g.call(this,r,e)||this,t.update(),t.update_=function(b){return t.update(b)},r.on("posterchange",t.update_),t}var o=T.prototype;return o.dispose=function(){this.player().off("posterchange",this.update_),g.prototype.dispose.call(this)},o.createEl=function(){var e=_e("div",{className:"vjs-poster",tabIndex:-1});return e},o.update=function(e){var t=this.player().poster();this.setSrc(t),t?this.show():this.hide()},o.setSrc=function(e){var t="";e&&(t='url("'+e+'")'),this.el_.style.backgroundImage=t},o.handleClick=function(e){if(!!this.player_.controls()){var t=this.player_.usingPlugin("eme")&&this.player_.eme.sessions&&this.player_.eme.sessions.length>0;this.player_.tech(!0)&&!((ve||Te)&&t)&&this.player_.tech(!0).focus(),this.player_.paused()?ot(this.player_.play()):this.player_.pause()}},T}(lr);ae.registerComponent("PosterImage",ba);var rt="#222",Xi="#ccc",Ca={monospace:"monospace",sansSerif:"sans-serif",serif:"serif",monospaceSansSerif:'"Andale Mono", "Lucida Console", monospace',monospaceSerif:'"Courier New", monospace',proportionalSansSerif:"sans-serif",proportionalSerif:"serif",casual:'"Comic Sans MS", Impact, fantasy',script:'"Monotype Corsiva", cursive',smallcaps:'"Andale Mono", "Lucida Console", monospace, sans-serif'};function jr(g,T){var o;if(g.length===4)o=g[1]+g[1]+g[2]+g[2]+g[3]+g[3];else if(g.length===7)o=g.slice(1);else throw new Error("Invalid color code provided, "+g+"; must be formatted as e.g. #f0e or #f604e2.");return"rgba("+parseInt(o.slice(0,2),16)+","+parseInt(o.slice(2,4),16)+","+parseInt(o.slice(4,6),16)+","+T+")"}function Kr(g,T,o){try{g.style[T]=o}catch(r){return}}var Aa=function(g){i.default(T,g);function T(r,e,t){var b;b=g.call(this,r,e,t)||this;var U=function(Y){return b.updateDisplay(Y)};return r.on("loadstart",function(z){return b.toggleDisplay(z)}),r.on("texttrackchange",U),r.on("loadedmetadata",function(z){return b.preselectTrack(z)}),r.ready(Oe(a.default(b),function(){if(r.tech_&&r.tech_.featuresNativeTextTracks){this.hide();return}r.on("fullscreenchange",U),r.on("playerresize",U),d.default.addEventListener("orientationchange",U),r.on("dispose",function(){return d.default.removeEventListener("orientationchange",U)});for(var z=this.options_.playerOptions.tracks||[],Y=0;Y<z.length;Y++)this.player_.addRemoteTextTrack(z[Y],!0);this.preselectTrack()})),b}var o=T.prototype;return o.preselectTrack=function(){for(var e={captions:1,subtitles:1},t=this.player_.textTracks(),b=this.player_.cache_.selectedLanguage,U,z,Y,J=0;J<t.length;J++){var te=t[J];b&&b.enabled&&b.language&&b.language===te.language&&te.kind in e?te.kind===b.kind?Y=te:Y||(Y=te):b&&!b.enabled?(Y=null,U=null,z=null):te.default&&(te.kind==="descriptions"&&!U?U=te:te.kind in e&&!z&&(z=te))}Y?Y.mode="showing":z?z.mode="showing":U&&(U.mode="showing")},o.toggleDisplay=function(){this.player_.tech_&&this.player_.tech_.featuresNativeTextTracks?this.hide():this.show()},o.createEl=function(){return g.prototype.createEl.call(this,"div",{className:"vjs-text-track-display"},{translate:"yes","aria-live":"off","aria-atomic":"true"})},o.clearDisplay=function(){typeof d.default.WebVTT=="function"&&d.default.WebVTT.processCues(d.default,[],this.el_)},o.updateDisplay=function(){var e=this.player_.textTracks(),t=this.options_.allowMultipleShowingTracks;if(this.clearDisplay(),t){for(var b=[],U=0;U<e.length;++U){var z=e[U];z.mode==="showing"&&b.push(z)}this.updateForTrack(b);return}for(var Y=null,J=null,te=e.length;te--;){var Q=e[te];Q.mode==="showing"&&(Q.kind==="descriptions"?Y=Q:J=Q)}J?(this.getAttribute("aria-live")!=="off"&&this.setAttribute("aria-live","off"),this.updateForTrack(J)):Y&&(this.getAttribute("aria-live")!=="assertive"&&this.setAttribute("aria-live","assertive"),this.updateForTrack(Y))},o.updateDisplayState=function(e){for(var t=this.player_.textTrackSettings.getValues(),b=e.activeCues,U=b.length;U--;){var z=b[U];if(!!z){var Y=z.displayState;if(t.color&&(Y.firstChild.style.color=t.color),t.textOpacity&&Kr(Y.firstChild,"color",jr(t.color||"#fff",t.textOpacity)),t.backgroundColor&&(Y.firstChild.style.backgroundColor=t.backgroundColor),t.backgroundOpacity&&Kr(Y.firstChild,"backgroundColor",jr(t.backgroundColor||"#000",t.backgroundOpacity)),t.windowColor&&(t.windowOpacity?Kr(Y,"backgroundColor",jr(t.windowColor,t.windowOpacity)):Y.style.backgroundColor=t.windowColor),t.edgeStyle&&(t.edgeStyle==="dropshadow"?Y.firstChild.style.textShadow="2px 2px 3px "+rt+", 2px 2px 4px "+rt+", 2px 2px 5px "+rt:t.edgeStyle==="raised"?Y.firstChild.style.textShadow="1px 1px "+rt+", 2px 2px "+rt+", 3px 3px "+rt:t.edgeStyle==="depressed"?Y.firstChild.style.textShadow="1px 1px "+Xi+", 0 1px "+Xi+", -1px -1px "+rt+", 0 -1px "+rt:t.edgeStyle==="uniform"&&(Y.firstChild.style.textShadow="0 0 4px "+rt+", 0 0 4px "+rt+", 0 0 4px "+rt+", 0 0 4px "+rt)),t.fontPercent&&t.fontPercent!==1){var J=d.default.parseFloat(Y.style.fontSize);Y.style.fontSize=J*t.fontPercent+"px",Y.style.height="auto",Y.style.top="auto"}t.fontFamily&&t.fontFamily!=="default"&&(t.fontFamily==="small-caps"?Y.firstChild.style.fontVariant="small-caps":Y.firstChild.style.fontFamily=Ca[t.fontFamily])}}},o.updateForTrack=function(e){if(Array.isArray(e)||(e=[e]),!(typeof d.default.WebVTT!="function"||e.every(function(ne){return!ne.activeCues}))){for(var t=[],b=0;b<e.length;++b)for(var U=e[b],z=0;z<U.activeCues.length;++z)t.push(U.activeCues[z]);d.default.WebVTT.processCues(d.default,t,this.el_);for(var Y=0;Y<e.length;++Y){for(var J=e[Y],te=0;te<J.activeCues.length;++te){var Q=J.activeCues[te].displayState;et(Q,"vjs-text-track-cue"),et(Q,"vjs-text-track-cue-"+(J.language?J.language:Y)),J.language&&pt(Q,"lang",J.language)}this.player_.textTrackSettings&&this.updateDisplayState(J)}}},T}(ae);ae.registerComponent("TextTrackDisplay",Aa);var La=function(g){i.default(T,g);function T(){return g.apply(this,arguments)||this}var o=T.prototype;return o.createEl=function(){var e=this.player_.isAudio(),t=this.localize(e?"Audio Player":"Video Player"),b=_e("span",{className:"vjs-control-text",textContent:this.localize("{1} is loading.",[t])}),U=g.prototype.createEl.call(this,"div",{className:"vjs-loading-spinner",dir:"ltr"});return U.appendChild(b),U},T}(ae);ae.registerComponent("LoadingSpinner",La);var at=function(g){i.default(T,g);function T(){return g.apply(this,arguments)||this}var o=T.prototype;return o.createEl=function(e,t,b){t===void 0&&(t={}),b===void 0&&(b={}),e="button",t=se({className:this.buildCSSClass()},t),b=se({type:"button"},b);var U=_e(e,t,b);return U.appendChild(_e("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),this.createControlTextEl(U),U},o.addChild=function(e,t){t===void 0&&(t={});var b=this.constructor.name;return $.warn("Adding an actionable (user controllable) child to a Button ("+b+") is not supported; use a ClickableComponent instead."),ae.prototype.addChild.call(this,e,t)},o.enable=function(){g.prototype.enable.call(this),this.el_.removeAttribute("disabled")},o.disable=function(){g.prototype.disable.call(this),this.el_.setAttribute("disabled","disabled")},o.handleKeyDown=function(e){if(p.default.isEventKey(e,"Space")||p.default.isEventKey(e,"Enter")){e.stopPropagation();return}g.prototype.handleKeyDown.call(this,e)},T}(lr);ae.registerComponent("Button",at);var $i=function(g){i.default(T,g);function T(r,e){var t;return t=g.call(this,r,e)||this,t.mouseused_=!1,t.on("mousedown",function(b){return t.handleMouseDown(b)}),t}var o=T.prototype;return o.buildCSSClass=function(){return"vjs-big-play-button"},o.handleClick=function(e){var t=this.player_.play();if(this.mouseused_&&e.clientX&&e.clientY){var b=this.player_.usingPlugin("eme")&&this.player_.eme.sessions&&this.player_.eme.sessions.length>0;ot(t),this.player_.tech(!0)&&!((ve||Te)&&b)&&this.player_.tech(!0).focus();return}var U=this.player_.getChild("controlBar"),z=U&&U.getChild("playToggle");if(!z){this.player_.tech(!0).focus();return}var Y=function(){return z.focus()};Gt(t)?t.then(Y,function(){}):this.setTimeout(Y,1)},o.handleKeyDown=function(e){this.mouseused_=!1,g.prototype.handleKeyDown.call(this,e)},o.handleMouseDown=function(e){this.mouseused_=!0},T}(at);$i.prototype.controlText_="Play Video",ae.registerComponent("BigPlayButton",$i);var Da=function(g){i.default(T,g);function T(r,e){var t;return t=g.call(this,r,e)||this,t.controlText(e&&e.controlText||t.localize("Close")),t}var o=T.prototype;return o.buildCSSClass=function(){return"vjs-close-button "+g.prototype.buildCSSClass.call(this)},o.handleClick=function(e){this.trigger({type:"close",bubbles:!1})},o.handleKeyDown=function(e){p.default.isEventKey(e,"Esc")?(e.preventDefault(),e.stopPropagation(),this.trigger("click")):g.prototype.handleKeyDown.call(this,e)},T}(at);ae.registerComponent("CloseButton",Da);var Qi=function(g){i.default(T,g);function T(r,e){var t;return e===void 0&&(e={}),t=g.call(this,r,e)||this,e.replay=e.replay===void 0||e.replay,t.on(r,"play",function(b){return t.handlePlay(b)}),t.on(r,"pause",function(b){return t.handlePause(b)}),e.replay&&t.on(r,"ended",function(b){return t.handleEnded(b)}),t}var o=T.prototype;return o.buildCSSClass=function(){return"vjs-play-control "+g.prototype.buildCSSClass.call(this)},o.handleClick=function(e){this.player_.paused()?ot(this.player_.play()):this.player_.pause()},o.handleSeeked=function(e){this.removeClass("vjs-ended"),this.player_.paused()?this.handlePause(e):this.handlePlay(e)},o.handlePlay=function(e){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.controlText("Pause")},o.handlePause=function(e){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.controlText("Play")},o.handleEnded=function(e){var t=this;this.removeClass("vjs-playing"),this.addClass("vjs-ended"),this.controlText("Replay"),this.one(this.player_,"seeked",function(b){return t.handleSeeked(b)})},T}(at);Qi.prototype.controlText_="Play",ae.registerComponent("PlayToggle",Qi);var Ji=function(T,o){T=T<0?0:T;var r=Math.floor(T%60),e=Math.floor(T/60%60),t=Math.floor(T/3600),b=Math.floor(o/60%60),U=Math.floor(o/3600);return(isNaN(T)||T===Infinity)&&(t=e=r="-"),t=t>0||U>0?t+":":"",e=((t||b>=10)&&e<10?"0"+e:e)+":",r=r<10?"0"+r:r,t+e+r},Hr=Ji;function Pa(g){Hr=g}function Oa(){Hr=Ji}function wt(g,T){return T===void 0&&(T=g),Hr(g,T)}var Ft=function(g){i.default(T,g);function T(r,e){var t;return t=g.call(this,r,e)||this,t.on(r,["timeupdate","ended"],function(b){return t.updateContent(b)}),t.updateTextNode_(),t}var o=T.prototype;return o.createEl=function(){var e=this.buildCSSClass(),t=g.prototype.createEl.call(this,"div",{className:e+" vjs-time-control vjs-control"}),b=_e("span",{className:"vjs-control-text",textContent:this.localize(this.labelText_)+"\xA0"},{role:"presentation"});return t.appendChild(b),this.contentEl_=_e("span",{className:e+"-display"},{"aria-live":"off",role:"presentation"}),t.appendChild(this.contentEl_),t},o.dispose=function(){this.contentEl_=null,this.textNode_=null,g.prototype.dispose.call(this)},o.updateTextNode_=function(e){var t=this;e===void 0&&(e=0),e=wt(e),this.formattedTime_!==e&&(this.formattedTime_=e,this.requestNamedAnimationFrame("TimeDisplay#updateTextNode_",function(){if(!!t.contentEl_){var b=t.textNode_;b&&t.contentEl_.firstChild!==b&&(b=null,$.warn("TimeDisplay#updateTextnode_: Prevented replacement of text node element since it was no longer a child of this node. Appending a new node instead.")),t.textNode_=E.default.createTextNode(t.formattedTime_),!!t.textNode_&&(b?t.contentEl_.replaceChild(t.textNode_,b):t.contentEl_.appendChild(t.textNode_))}}))},o.updateContent=function(e){},T}(ae);Ft.prototype.labelText_="Time",Ft.prototype.controlText_="Time",ae.registerComponent("TimeDisplay",Ft);var Wr=function(g){i.default(T,g);function T(){return g.apply(this,arguments)||this}var o=T.prototype;return o.buildCSSClass=function(){return"vjs-current-time"},o.updateContent=function(e){var t;this.player_.ended()?t=this.player_.duration():t=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime(),this.updateTextNode_(t)},T}(Ft);Wr.prototype.labelText_="Current Time",Wr.prototype.controlText_="Current Time",ae.registerComponent("CurrentTimeDisplay",Wr);var Gr=function(g){i.default(T,g);function T(r,e){var t;t=g.call(this,r,e)||this;var b=function(z){return t.updateContent(z)};return t.on(r,"durationchange",b),t.on(r,"loadstart",b),t.on(r,"loadedmetadata",b),t}var o=T.prototype;return o.buildCSSClass=function(){return"vjs-duration"},o.updateContent=function(e){var t=this.player_.duration();this.updateTextNode_(t)},T}(Ft);Gr.prototype.labelText_="Duration",Gr.prototype.controlText_="Duration",ae.registerComponent("DurationDisplay",Gr);var Ra=function(g){i.default(T,g);function T(){return g.apply(this,arguments)||this}var o=T.prototype;return o.createEl=function(){var e=g.prototype.createEl.call(this,"div",{className:"vjs-time-control vjs-time-divider"},{"aria-hidden":!0}),t=g.prototype.createEl.call(this,"div"),b=g.prototype.createEl.call(this,"span",{textContent:"/"});return t.appendChild(b),e.appendChild(t),e},T}(ae);ae.registerComponent("TimeDivider",Ra);var Vr=function(g){i.default(T,g);function T(r,e){var t;return t=g.call(this,r,e)||this,t.on(r,"durationchange",function(b){return t.updateContent(b)}),t}var o=T.prototype;return o.buildCSSClass=function(){return"vjs-remaining-time"},o.createEl=function(){var e=g.prototype.createEl.call(this);return e.insertBefore(_e("span",{},{"aria-hidden":!0},"-"),this.contentEl_),e},o.updateContent=function(e){if(typeof this.player_.duration()=="number"){var t;this.player_.ended()?t=0:this.player_.remainingTimeDisplay?t=this.player_.remainingTimeDisplay():t=this.player_.remainingTime(),this.updateTextNode_(t)}},T}(Ft);Vr.prototype.labelText_="Remaining Time",Vr.prototype.controlText_="Remaining Time",ae.registerComponent("RemainingTimeDisplay",Vr);var Ia=function(g){i.default(T,g);function T(r,e){var t;return t=g.call(this,r,e)||this,t.updateShowing(),t.on(t.player(),"durationchange",function(b){return t.updateShowing(b)}),t}var o=T.prototype;return o.createEl=function(){var e=g.prototype.createEl.call(this,"div",{className:"vjs-live-control vjs-control"});return this.contentEl_=_e("div",{className:"vjs-live-display"},{"aria-live":"off"}),this.contentEl_.appendChild(_e("span",{className:"vjs-control-text",textContent:this.localize("Stream Type")+"\xA0"})),this.contentEl_.appendChild(E.default.createTextNode(this.localize("LIVE"))),e.appendChild(this.contentEl_),e},o.dispose=function(){this.contentEl_=null,g.prototype.dispose.call(this)},o.updateShowing=function(e){this.player().duration()===Infinity?this.show():this.hide()},T}(ae);ae.registerComponent("LiveDisplay",Ia);var Zi=function(g){i.default(T,g);function T(r,e){var t;return t=g.call(this,r,e)||this,t.updateLiveEdgeStatus(),t.player_.liveTracker&&(t.updateLiveEdgeStatusHandler_=function(b){return t.updateLiveEdgeStatus(b)},t.on(t.player_.liveTracker,"liveedgechange",t.updateLiveEdgeStatusHandler_)),t}var o=T.prototype;return o.createEl=function(){var e=g.prototype.createEl.call(this,"button",{className:"vjs-seek-to-live-control vjs-control"});return this.textEl_=_e("span",{className:"vjs-seek-to-live-text",textContent:this.localize("LIVE")},{"aria-hidden":"true"}),e.appendChild(this.textEl_),e},o.updateLiveEdgeStatus=function(){!this.player_.liveTracker||this.player_.liveTracker.atLiveEdge()?(this.setAttribute("aria-disabled",!0),this.addClass("vjs-at-live-edge"),this.controlText("Seek to live, currently playing live")):(this.setAttribute("aria-disabled",!1),this.removeClass("vjs-at-live-edge"),this.controlText("Seek to live, currently behind live"))},o.handleClick=function(){this.player_.liveTracker.seekToLiveEdge()},o.dispose=function(){this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.updateLiveEdgeStatusHandler_),this.textEl_=null,g.prototype.dispose.call(this)},T}(at);Zi.prototype.controlText_="Seek to live, currently playing live",ae.registerComponent("SeekToLive",Zi);var ur=function(T,o,r){return T=Number(T),Math.min(r,Math.max(o,isNaN(T)?o:T))},zr=function(g){i.default(T,g);function T(r,e){var t;return t=g.call(this,r,e)||this,t.handleMouseDown_=function(b){return t.handleMouseDown(b)},t.handleMouseUp_=function(b){return t.handleMouseUp(b)},t.handleKeyDown_=function(b){return t.handleKeyDown(b)},t.handleClick_=function(b){return t.handleClick(b)},t.handleMouseMove_=function(b){return t.handleMouseMove(b)},t.update_=function(b){return t.update(b)},t.bar=t.getChild(t.options_.barName),t.vertical(!!t.options_.vertical),t.enable(),t}var o=T.prototype;return o.enabled=function(){return this.enabled_},o.enable=function(){this.enabled()||(this.on("mousedown",this.handleMouseDown_),this.on("touchstart",this.handleMouseDown_),this.on("keydown",this.handleKeyDown_),this.on("click",this.handleClick_),this.on(this.player_,"controlsvisible",this.update),this.playerEvent&&this.on(this.player_,this.playerEvent,this.update),this.removeClass("disabled"),this.setAttribute("tabindex",0),this.enabled_=!0)},o.disable=function(){if(!!this.enabled()){var e=this.bar.el_.ownerDocument;this.off("mousedown",this.handleMouseDown_),this.off("touchstart",this.handleMouseDown_),this.off("keydown",this.handleKeyDown_),this.off("click",this.handleClick_),this.off(this.player_,"controlsvisible",this.update_),this.off(e,"mousemove",this.handleMouseMove_),this.off(e,"mouseup",this.handleMouseUp_),this.off(e,"touchmove",this.handleMouseMove_),this.off(e,"touchend",this.handleMouseUp_),this.removeAttribute("tabindex"),this.addClass("disabled"),this.playerEvent&&this.off(this.player_,this.playerEvent,this.update),this.enabled_=!1}},o.createEl=function(e,t,b){return t===void 0&&(t={}),b===void 0&&(b={}),t.className=t.className+" vjs-slider",t=se({tabIndex:0},t),b=se({role:"slider","aria-valuenow":0,"aria-valuemin":0,"aria-valuemax":100,tabIndex:0},b),g.prototype.createEl.call(this,e,t,b)},o.handleMouseDown=function(e){var t=this.bar.el_.ownerDocument;e.type==="mousedown"&&e.preventDefault(),e.type==="touchstart"&&!de&&e.preventDefault(),gi(),this.addClass("vjs-sliding"),this.trigger("slideractive"),this.on(t,"mousemove",this.handleMouseMove_),this.on(t,"mouseup",this.handleMouseUp_),this.on(t,"touchmove",this.handleMouseMove_),this.on(t,"touchend",this.handleMouseUp_),this.handleMouseMove(e)},o.handleMouseMove=function(e){},o.handleMouseUp=function(){var e=this.bar.el_.ownerDocument;mi(),this.removeClass("vjs-sliding"),this.trigger("sliderinactive"),this.off(e,"mousemove",this.handleMouseMove_),this.off(e,"mouseup",this.handleMouseUp_),this.off(e,"touchmove",this.handleMouseMove_),this.off(e,"touchend",this.handleMouseUp_),this.update()},o.update=function(){var e=this;if(!(!this.el_||!this.bar)){var t=this.getProgress();return t===this.progress_||(this.progress_=t,this.requestNamedAnimationFrame("Slider#update",function(){var b=e.vertical()?"height":"width";e.bar.el().style[b]=(t*100).toFixed(2)+"%"})),t}},o.getProgress=function(){return Number(ur(this.getPercent(),0,1).toFixed(4))},o.calculateDistance=function(e){var t=Zt(this.el_,e);return this.vertical()?t.y:t.x},o.handleKeyDown=function(e){p.default.isEventKey(e,"Left")||p.default.isEventKey(e,"Down")?(e.preventDefault(),e.stopPropagation(),this.stepBack()):p.default.isEventKey(e,"Right")||p.default.isEventKey(e,"Up")?(e.preventDefault(),e.stopPropagation(),this.stepForward()):g.prototype.handleKeyDown.call(this,e)},o.handleClick=function(e){e.stopPropagation(),e.preventDefault()},o.vertical=function(e){if(e===void 0)return this.vertical_||!1;this.vertical_=!!e,this.vertical_?this.addClass("vjs-slider-vertical"):this.addClass("vjs-slider-horizontal")},T}(ae);ae.registerComponent("Slider",zr);var Yr=function(T,o){return ur(T/o*100,0,100).toFixed(2)+"%"},Ma=function(g){i.default(T,g);function T(r,e){var t;return t=g.call(this,r,e)||this,t.partEls_=[],t.on(r,"progress",function(b){return t.update(b)}),t}var o=T.prototype;return o.createEl=function(){var e=g.prototype.createEl.call(this,"div",{className:"vjs-load-progress"}),t=_e("span",{className:"vjs-control-text"}),b=_e("span",{textContent:this.localize("Loaded")}),U=E.default.createTextNode(": ");return this.percentageEl_=_e("span",{className:"vjs-control-text-loaded-percentage",textContent:"0%"}),e.appendChild(t),t.appendChild(b),t.appendChild(U),t.appendChild(this.percentageEl_),e},o.dispose=function(){this.partEls_=null,this.percentageEl_=null,g.prototype.dispose.call(this)},o.update=function(e){var t=this;this.requestNamedAnimationFrame("LoadProgressBar#update",function(){var b=t.player_.liveTracker,U=t.player_.buffered(),z=b&&b.isLive()?b.seekableEnd():t.player_.duration(),Y=t.player_.bufferedEnd(),J=t.partEls_,te=Yr(Y,z);t.percent_!==te&&(t.el_.style.width=te,ut(t.percentageEl_,te),t.percent_=te);for(var Q=0;Q<U.length;Q++){var ne=U.start(Q),fe=U.end(Q),Se=J[Q];Se||(Se=t.el_.appendChild(_e()),J[Q]=Se),!(Se.dataset.start===ne&&Se.dataset.end===fe)&&(Se.dataset.start=ne,Se.dataset.end=fe,Se.style.left=Yr(ne,Y),Se.style.width=Yr(fe-ne,Y))}for(var ht=J.length;ht>U.length;ht--)t.el_.removeChild(J[ht-1]);J.length=U.length})},T}(ae);ae.registerComponent("LoadProgressBar",Ma);var xa=function(g){i.default(T,g);function T(r,e){var t;return t=g.call(this,r,e)||this,t.update=dt(Oe(a.default(t),t.update),nt),t}var o=T.prototype;return o.createEl=function(){return g.prototype.createEl.call(this,"div",{className:"vjs-time-tooltip"},{"aria-hidden":"true"})},o.update=function(e,t,b){var U=Kt(this.el_),z=Pt(this.player_.el()),Y=e.width*t;if(!(!z||!U)){var J=e.left-z.left+Y,te=e.width-Y+(z.right-e.right),Q=U.width/2;J<Q?Q+=Q-J:te<Q&&(Q=te),Q<0?Q=0:Q>U.width&&(Q=U.width),Q=Math.round(Q),this.el_.style.right="-"+Q+"px",this.write(b)}},o.write=function(e){ut(this.el_,e)},o.updateTime=function(e,t,b,U){var z=this;this.requestNamedAnimationFrame("TimeTooltip#updateTime",function(){var Y,J=z.player_.duration();if(z.player_.liveTracker&&z.player_.liveTracker.isLive()){var te=z.player_.liveTracker.liveWindow(),Q=te-t*te;Y=(Q<1?"":"-")+wt(Q,te)}else Y=wt(b,J);z.update(e,t,Y),U&&U()})},T}(ae);ae.registerComponent("TimeTooltip",xa);var Xr=function(g){i.default(T,g);function T(r,e){var t;return t=g.call(this,r,e)||this,t.update=dt(Oe(a.default(t),t.update),nt),t}var o=T.prototype;return o.createEl=function(){return g.prototype.createEl.call(this,"div",{className:"vjs-play-progress vjs-slider-bar"},{"aria-hidden":"true"})},o.update=function(e,t){var b=this.getChild("timeTooltip");if(!!b){var U=this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime();b.updateTime(e,t,U)}},T}(ae);Xr.prototype.options_={children:[]},!be&&!Le&&Xr.prototype.options_.children.push("timeTooltip"),ae.registerComponent("PlayProgressBar",Xr);var qi=function(g){i.default(T,g);function T(r,e){var t;return t=g.call(this,r,e)||this,t.update=dt(Oe(a.default(t),t.update),nt),t}var o=T.prototype;return o.createEl=function(){return g.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})},o.update=function(e,t){var b=this,U=t*this.player_.duration();this.getChild("timeTooltip").updateTime(e,t,U,function(){b.el_.style.left=e.width*t+"px"})},T}(ae);qi.prototype.options_={children:["timeTooltip"]},ae.registerComponent("MouseTimeDisplay",qi);var cr=5,en=12,$r=function(g){i.default(T,g);function T(r,e){var t;return t=g.call(this,r,e)||this,t.setEventHandlers_(),t}var o=T.prototype;return o.setEventHandlers_=function(){var e=this;this.update_=Oe(this,this.update),this.update=dt(this.update_,nt),this.on(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.on(this.player_.liveTracker,"liveedgechange",this.update),this.updateInterval=null,this.enableIntervalHandler_=function(t){return e.enableInterval_(t)},this.disableIntervalHandler_=function(t){return e.disableInterval_(t)},this.on(this.player_,["playing"],this.enableIntervalHandler_),this.on(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in E.default&&"visibilityState"in E.default&&this.on(E.default,"visibilitychange",this.toggleVisibility_)},o.toggleVisibility_=function(e){E.default.visibilityState==="hidden"?(this.cancelNamedAnimationFrame("SeekBar#update"),this.cancelNamedAnimationFrame("Slider#update"),this.disableInterval_(e)):(!this.player_.ended()&&!this.player_.paused()&&this.enableInterval_(),this.update())},o.enableInterval_=function(){this.updateInterval||(this.updateInterval=this.setInterval(this.update,nt))},o.disableInterval_=function(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&e&&e.type!=="ended"||!this.updateInterval||(this.clearInterval(this.updateInterval),this.updateInterval=null)},o.createEl=function(){return g.prototype.createEl.call(this,"div",{className:"vjs-progress-holder"},{"aria-label":this.localize("Progress Bar")})},o.update=function(e){var t=this;if(E.default.visibilityState!=="hidden"){var b=g.prototype.update.call(this);return this.requestNamedAnimationFrame("SeekBar#update",function(){var U=t.player_.ended()?t.player_.duration():t.getCurrentTime_(),z=t.player_.liveTracker,Y=t.player_.duration();z&&z.isLive()&&(Y=t.player_.liveTracker.liveCurrentTime()),t.percent_!==b&&(t.el_.setAttribute("aria-valuenow",(b*100).toFixed(2)),t.percent_=b),(t.currentTime_!==U||t.duration_!==Y)&&(t.el_.setAttribute("aria-valuetext",t.localize("progress bar timing: currentTime={1} duration={2}",[wt(U,Y),wt(Y,Y)],"{1} of {2}")),t.currentTime_=U,t.duration_=Y),t.bar&&t.bar.update(Pt(t.el()),t.getProgress())}),b}},o.userSeek_=function(e){this.player_.liveTracker&&this.player_.liveTracker.isLive()&&this.player_.liveTracker.nextSeekedFromUser(),this.player_.currentTime(e)},o.getCurrentTime_=function(){return this.player_.scrubbing()?this.player_.getCache().currentTime:this.player_.currentTime()},o.getPercent=function(){var e=this.getCurrentTime_(),t,b=this.player_.liveTracker;return b&&b.isLive()?(t=(e-b.seekableStart())/b.liveWindow(),b.atLiveEdge()&&(t=1)):t=e/this.player_.duration(),t},o.handleMouseDown=function(e){!Ht(e)||(e.stopPropagation(),this.player_.scrubbing(!0),this.videoWasPlaying=!this.player_.paused(),this.player_.pause(),g.prototype.handleMouseDown.call(this,e))},o.handleMouseMove=function(e){if(!!Ht(e)){var t,b=this.calculateDistance(e),U=this.player_.liveTracker;if(!U||!U.isLive())t=b*this.player_.duration(),t===this.player_.duration()&&(t=t-.1);else{if(b>=.99){U.seekToLiveEdge();return}var z=U.seekableStart(),Y=U.liveCurrentTime();if(t=z+b*U.liveWindow(),t>=Y&&(t=Y),t<=z&&(t=z+.1),t===Infinity)return}this.userSeek_(t)}},o.enable=function(){g.prototype.enable.call(this);var e=this.getChild("mouseTimeDisplay");!e||e.show()},o.disable=function(){g.prototype.disable.call(this);var e=this.getChild("mouseTimeDisplay");!e||e.hide()},o.handleMouseUp=function(e){g.prototype.handleMouseUp.call(this,e),e&&e.stopPropagation(),this.player_.scrubbing(!1),this.player_.trigger({type:"timeupdate",target:this,manuallyTriggered:!0}),this.videoWasPlaying?ot(this.player_.play()):this.update_()},o.stepForward=function(){this.userSeek_(this.player_.currentTime()+cr)},o.stepBack=function(){this.userSeek_(this.player_.currentTime()-cr)},o.handleAction=function(e){this.player_.paused()?this.player_.play():this.player_.pause()},o.handleKeyDown=function(e){var t=this.player_.liveTracker;if(p.default.isEventKey(e,"Space")||p.default.isEventKey(e,"Enter"))e.preventDefault(),e.stopPropagation(),this.handleAction(e);else if(p.default.isEventKey(e,"Home"))e.preventDefault(),e.stopPropagation(),this.userSeek_(0);else if(p.default.isEventKey(e,"End"))e.preventDefault(),e.stopPropagation(),t&&t.isLive()?this.userSeek_(t.liveCurrentTime()):this.userSeek_(this.player_.duration());else if(/^[0-9]$/.test(p.default(e))){e.preventDefault(),e.stopPropagation();var b=(p.default.codes[p.default(e)]-p.default.codes["0"])*10/100;t&&t.isLive()?this.userSeek_(t.seekableStart()+t.liveWindow()*b):this.userSeek_(this.player_.duration()*b)}else p.default.isEventKey(e,"PgDn")?(e.preventDefault(),e.stopPropagation(),this.userSeek_(this.player_.currentTime()-cr*en)):p.default.isEventKey(e,"PgUp")?(e.preventDefault(),e.stopPropagation(),this.userSeek_(this.player_.currentTime()+cr*en)):g.prototype.handleKeyDown.call(this,e)},o.dispose=function(){this.disableInterval_(),this.off(this.player_,["ended","durationchange","timeupdate"],this.update),this.player_.liveTracker&&this.off(this.player_.liveTracker,"liveedgechange",this.update),this.off(this.player_,["playing"],this.enableIntervalHandler_),this.off(this.player_,["ended","pause","waiting"],this.disableIntervalHandler_),"hidden"in E.default&&"visibilityState"in E.default&&this.off(E.default,"visibilitychange",this.toggleVisibility_),g.prototype.dispose.call(this)},T}(zr);$r.prototype.options_={children:["loadProgressBar","playProgressBar"],barName:"playProgressBar"},!be&&!Le&&$r.prototype.options_.children.splice(1,0,"mouseTimeDisplay"),ae.registerComponent("SeekBar",$r);var tn=function(g){i.default(T,g);function T(r,e){var t;return t=g.call(this,r,e)||this,t.handleMouseMove=dt(Oe(a.default(t),t.handleMouseMove),nt),t.throttledHandleMouseSeek=dt(Oe(a.default(t),t.handleMouseSeek),nt),t.handleMouseUpHandler_=function(b){return t.handleMouseUp(b)},t.handleMouseDownHandler_=function(b){return t.handleMouseDown(b)},t.enable(),t}var o=T.prototype;return o.createEl=function(){return g.prototype.createEl.call(this,"div",{className:"vjs-progress-control vjs-control"})},o.handleMouseMove=function(e){var t=this.getChild("seekBar");if(!!t){var b=t.getChild("playProgressBar"),U=t.getChild("mouseTimeDisplay");if(!(!b&&!U)){var z=t.el(),Y=Kt(z),J=Zt(z,e).x;J=ur(J,0,1),U&&U.update(Y,J),b&&b.update(Y,t.getProgress())}}},o.handleMouseSeek=function(e){var t=this.getChild("seekBar");t&&t.handleMouseMove(e)},o.enabled=function(){return this.enabled_},o.disable=function(){if(this.children().forEach(function(t){return t.disable&&t.disable()}),!!this.enabled()&&(this.off(["mousedown","touchstart"],this.handleMouseDownHandler_),this.off(this.el_,"mousemove",this.handleMouseMove),this.removeListenersAddedOnMousedownAndTouchstart(),this.addClass("disabled"),this.enabled_=!1,this.player_.scrubbing())){var e=this.getChild("seekBar");this.player_.scrubbing(!1),e.videoWasPlaying&&ot(this.player_.play())}},o.enable=function(){this.children().forEach(function(e){return e.enable&&e.enable()}),!this.enabled()&&(this.on(["mousedown","touchstart"],this.handleMouseDownHandler_),this.on(this.el_,"mousemove",this.handleMouseMove),this.removeClass("disabled"),this.enabled_=!0)},o.removeListenersAddedOnMousedownAndTouchstart=function(){var e=this.el_.ownerDocument;this.off(e,"mousemove",this.throttledHandleMouseSeek),this.off(e,"touchmove",this.throttledHandleMouseSeek),this.off(e,"mouseup",this.handleMouseUpHandler_),this.off(e,"touchend",this.handleMouseUpHandler_)},o.handleMouseDown=function(e){var t=this.el_.ownerDocument,b=this.getChild("seekBar");b&&b.handleMouseDown(e),this.on(t,"mousemove",this.throttledHandleMouseSeek),this.on(t,"touchmove",this.throttledHandleMouseSeek),this.on(t,"mouseup",this.handleMouseUpHandler_),this.on(t,"touchend",this.handleMouseUpHandler_)},o.handleMouseUp=function(e){var t=this.getChild("seekBar");t&&t.handleMouseUp(e),this.removeListenersAddedOnMousedownAndTouchstart()},T}(ae);tn.prototype.options_={children:["seekBar"]},ae.registerComponent("ProgressControl",tn);var rn=function(g){i.default(T,g);function T(r,e){var t;return t=g.call(this,r,e)||this,t.on(r,["enterpictureinpicture","leavepictureinpicture"],function(b){return t.handlePictureInPictureChange(b)}),t.on(r,["disablepictureinpicturechanged","loadedmetadata"],function(b){return t.handlePictureInPictureEnabledChange(b)}),t.disable(),t}var o=T.prototype;return o.buildCSSClass=function(){return"vjs-picture-in-picture-control "+g.prototype.buildCSSClass.call(this)},o.handlePictureInPictureEnabledChange=function(){E.default.pictureInPictureEnabled&&this.player_.disablePictureInPicture()===!1?this.enable():this.disable()},o.handlePictureInPictureChange=function(e){this.player_.isInPictureInPicture()?this.controlText("Exit Picture-in-Picture"):this.controlText("Picture-in-Picture"),this.handlePictureInPictureEnabledChange()},o.handleClick=function(e){this.player_.isInPictureInPicture()?this.player_.exitPictureInPicture():this.player_.requestPictureInPicture()},T}(at);rn.prototype.controlText_="Picture-in-Picture",ae.registerComponent("PictureInPictureToggle",rn);var nn=function(g){i.default(T,g);function T(r,e){var t;return t=g.call(this,r,e)||this,t.on(r,"fullscreenchange",function(b){return t.handleFullscreenChange(b)}),E.default[r.fsApi_.fullscreenEnabled]===!1&&t.disable(),t}var o=T.prototype;return o.buildCSSClass=function(){return"vjs-fullscreen-control "+g.prototype.buildCSSClass.call(this)},o.handleFullscreenChange=function(e){this.player_.isFullscreen()?this.controlText("Non-Fullscreen"):this.controlText("Fullscreen")},o.handleClick=function(e){this.player_.isFullscreen()?this.player_.exitFullscreen():this.player_.requestFullscreen()},T}(at);nn.prototype.controlText_="Fullscreen",ae.registerComponent("FullscreenToggle",nn);var ka=function(T,o){o.tech_&&!o.tech_.featuresVolumeControl&&T.addClass("vjs-hidden"),T.on(o,"loadstart",function(){o.tech_.featuresVolumeControl?T.removeClass("vjs-hidden"):T.addClass("vjs-hidden")})},wa=function(g){i.default(T,g);function T(){return g.apply(this,arguments)||this}var o=T.prototype;return o.createEl=function(){var e=g.prototype.createEl.call(this,"div",{className:"vjs-volume-level"});return e.appendChild(g.prototype.createEl.call(this,"span",{className:"vjs-control-text"})),e},T}(ae);ae.registerComponent("VolumeLevel",wa);var Fa=function(g){i.default(T,g);function T(r,e){var t;return t=g.call(this,r,e)||this,t.update=dt(Oe(a.default(t),t.update),nt),t}var o=T.prototype;return o.createEl=function(){return g.prototype.createEl.call(this,"div",{className:"vjs-volume-tooltip"},{"aria-hidden":"true"})},o.update=function(e,t,b,U){if(!b){var z=Pt(this.el_),Y=Pt(this.player_.el()),J=e.width*t;if(!Y||!z)return;var te=e.left-Y.left+J,Q=e.width-J+(Y.right-e.right),ne=z.width/2;te<ne?ne+=ne-te:Q<ne&&(ne=Q),ne<0?ne=0:ne>z.width&&(ne=z.width),this.el_.style.right="-"+ne+"px"}this.write(U+"%")},o.write=function(e){ut(this.el_,e)},o.updateVolume=function(e,t,b,U,z){var Y=this;this.requestNamedAnimationFrame("VolumeLevelTooltip#updateVolume",function(){Y.update(e,t,b,U.toFixed(0)),z&&z()})},T}(ae);ae.registerComponent("VolumeLevelTooltip",Fa);var an=function(g){i.default(T,g);function T(r,e){var t;return t=g.call(this,r,e)||this,t.update=dt(Oe(a.default(t),t.update),nt),t}var o=T.prototype;return o.createEl=function(){return g.prototype.createEl.call(this,"div",{className:"vjs-mouse-display"})},o.update=function(e,t,b){var U=this,z=100*t;this.getChild("volumeLevelTooltip").updateVolume(e,t,b,z,function(){b?U.el_.style.bottom=e.height*t+"px":U.el_.style.left=e.width*t+"px"})},T}(ae);an.prototype.options_={children:["volumeLevelTooltip"]},ae.registerComponent("MouseVolumeLevelDisplay",an);var dr=function(g){i.default(T,g);function T(r,e){var t;return t=g.call(this,r,e)||this,t.on("slideractive",function(b){return t.updateLastVolume_(b)}),t.on(r,"volumechange",function(b){return t.updateARIAAttributes(b)}),r.ready(function(){return t.updateARIAAttributes()}),t}var o=T.prototype;return o.createEl=function(){return g.prototype.createEl.call(this,"div",{className:"vjs-volume-bar vjs-slider-bar"},{"aria-label":this.localize("Volume Level"),"aria-live":"polite"})},o.handleMouseDown=function(e){!Ht(e)||g.prototype.handleMouseDown.call(this,e)},o.handleMouseMove=function(e){var t=this.getChild("mouseVolumeLevelDisplay");if(t){var b=this.el(),U=Pt(b),z=this.vertical(),Y=Zt(b,e);Y=z?Y.y:Y.x,Y=ur(Y,0,1),t.update(U,Y,z)}!Ht(e)||(this.checkMuted(),this.player_.volume(this.calculateDistance(e)))},o.checkMuted=function(){this.player_.muted()&&this.player_.muted(!1)},o.getPercent=function(){return this.player_.muted()?0:this.player_.volume()},o.stepForward=function(){this.checkMuted(),this.player_.volume(this.player_.volume()+.1)},o.stepBack=function(){this.checkMuted(),this.player_.volume(this.player_.volume()-.1)},o.updateARIAAttributes=function(e){var t=this.player_.muted()?0:this.volumeAsPercentage_();this.el_.setAttribute("aria-valuenow",t),this.el_.setAttribute("aria-valuetext",t+"%")},o.volumeAsPercentage_=function(){return Math.round(this.player_.volume()*100)},o.updateLastVolume_=function(){var e=this,t=this.player_.volume();this.one("sliderinactive",function(){e.player_.volume()===0&&e.player_.lastVolume_(t)})},T}(zr);dr.prototype.options_={children:["volumeLevel"],barName:"volumeLevel"},!be&&!Le&&dr.prototype.options_.children.splice(0,0,"mouseVolumeLevelDisplay"),dr.prototype.playerEvent="volumechange",ae.registerComponent("VolumeBar",dr);var sn=function(g){i.default(T,g);function T(r,e){var t;return e===void 0&&(e={}),e.vertical=e.vertical||!1,(typeof e.volumeBar=="undefined"||ce(e.volumeBar))&&(e.volumeBar=e.volumeBar||{},e.volumeBar.vertical=e.vertical),t=g.call(this,r,e)||this,ka(a.default(t),r),t.throttledHandleMouseMove=dt(Oe(a.default(t),t.handleMouseMove),nt),t.handleMouseUpHandler_=function(b){return t.handleMouseUp(b)},t.on("mousedown",function(b){return t.handleMouseDown(b)}),t.on("touchstart",function(b){return t.handleMouseDown(b)}),t.on("mousemove",function(b){return t.handleMouseMove(b)}),t.on(t.volumeBar,["focus","slideractive"],function(){t.volumeBar.addClass("vjs-slider-active"),t.addClass("vjs-slider-active"),t.trigger("slideractive")}),t.on(t.volumeBar,["blur","sliderinactive"],function(){t.volumeBar.removeClass("vjs-slider-active"),t.removeClass("vjs-slider-active"),t.trigger("sliderinactive")}),t}var o=T.prototype;return o.createEl=function(){var e="vjs-volume-horizontal";return this.options_.vertical&&(e="vjs-volume-vertical"),g.prototype.createEl.call(this,"div",{className:"vjs-volume-control vjs-control "+e})},o.handleMouseDown=function(e){var t=this.el_.ownerDocument;this.on(t,"mousemove",this.throttledHandleMouseMove),this.on(t,"touchmove",this.throttledHandleMouseMove),this.on(t,"mouseup",this.handleMouseUpHandler_),this.on(t,"touchend",this.handleMouseUpHandler_)},o.handleMouseUp=function(e){var t=this.el_.ownerDocument;this.off(t,"mousemove",this.throttledHandleMouseMove),this.off(t,"touchmove",this.throttledHandleMouseMove),this.off(t,"mouseup",this.handleMouseUpHandler_),this.off(t,"touchend",this.handleMouseUpHandler_)},o.handleMouseMove=function(e){this.volumeBar.handleMouseMove(e)},T}(ae);sn.prototype.options_={children:["volumeBar"]},ae.registerComponent("VolumeControl",sn);var Ba=function(T,o){o.tech_&&!o.tech_.featuresMuteControl&&T.addClass("vjs-hidden"),T.on(o,"loadstart",function(){o.tech_.featuresMuteControl?T.removeClass("vjs-hidden"):T.addClass("vjs-hidden")})},on=function(g){i.default(T,g);function T(r,e){var t;return t=g.call(this,r,e)||this,Ba(a.default(t),r),t.on(r,["loadstart","volumechange"],function(b){return t.update(b)}),t}var o=T.prototype;return o.buildCSSClass=function(){return"vjs-mute-control "+g.prototype.buildCSSClass.call(this)},o.handleClick=function(e){var t=this.player_.volume(),b=this.player_.lastVolume_();if(t===0){var U=b<.1?.1:b;this.player_.volume(U),this.player_.muted(!1)}else this.player_.muted(!this.player_.muted())},o.update=function(e){this.updateIcon_(),this.updateControlText_()},o.updateIcon_=function(){var e=this.player_.volume(),t=3;be&&this.player_.tech_&&this.player_.tech_.el_&&this.player_.muted(this.player_.tech_.el_.muted),e===0||this.player_.muted()?t=0:e<.33?t=1:e<.67&&(t=2);for(var b=0;b<4;b++)_t(this.el_,"vjs-vol-"+b);et(this.el_,"vjs-vol-"+t)},o.updateControlText_=function(){var e=this.player_.muted()||this.player_.volume()===0,t=e?"Unmute":"Mute";this.controlText()!==t&&this.controlText(t)},T}(at);on.prototype.controlText_="Mute",ae.registerComponent("MuteToggle",on);var ln=function(g){i.default(T,g);function T(r,e){var t;return e===void 0&&(e={}),typeof e.inline!="undefined"?e.inline=e.inline:e.inline=!0,(typeof e.volumeControl=="undefined"||ce(e.volumeControl))&&(e.volumeControl=e.volumeControl||{},e.volumeControl.vertical=!e.inline),t=g.call(this,r,e)||this,t.handleKeyPressHandler_=function(b){return t.handleKeyPress(b)},t.on(r,["loadstart"],function(b){return t.volumePanelState_(b)}),t.on(t.muteToggle,"keyup",function(b){return t.handleKeyPress(b)}),t.on(t.volumeControl,"keyup",function(b){return t.handleVolumeControlKeyUp(b)}),t.on("keydown",function(b){return t.handleKeyPress(b)}),t.on("mouseover",function(b){return t.handleMouseOver(b)}),t.on("mouseout",function(b){return t.handleMouseOut(b)}),t.on(t.volumeControl,["slideractive"],t.sliderActive_),t.on(t.volumeControl,["sliderinactive"],t.sliderInactive_),t}var o=T.prototype;return o.sliderActive_=function(){this.addClass("vjs-slider-active")},o.sliderInactive_=function(){this.removeClass("vjs-slider-active")},o.volumePanelState_=function(){this.volumeControl.hasClass("vjs-hidden")&&this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-hidden"),this.volumeControl.hasClass("vjs-hidden")&&!this.muteToggle.hasClass("vjs-hidden")&&this.addClass("vjs-mute-toggle-only")},o.createEl=function(){var e="vjs-volume-panel-horizontal";return this.options_.inline||(e="vjs-volume-panel-vertical"),g.prototype.createEl.call(this,"div",{className:"vjs-volume-panel vjs-control "+e})},o.dispose=function(){this.handleMouseOut(),g.prototype.dispose.call(this)},o.handleVolumeControlKeyUp=function(e){p.default.isEventKey(e,"Esc")&&this.muteToggle.focus()},o.handleMouseOver=function(e){this.addClass("vjs-hover"),qe(E.default,"keyup",this.handleKeyPressHandler_)},o.handleMouseOut=function(e){this.removeClass("vjs-hover"),Ve(E.default,"keyup",this.handleKeyPressHandler_)},o.handleKeyPress=function(e){p.default.isEventKey(e,"Esc")&&this.handleMouseOut()},T}(ae);ln.prototype.options_={children:["muteToggle","volumeControl"]},ae.registerComponent("VolumePanel",ln);var un=function(g){i.default(T,g);function T(r,e){var t;return t=g.call(this,r,e)||this,e&&(t.menuButton_=e.menuButton),t.focusedChild_=-1,t.on("keydown",function(b){return t.handleKeyDown(b)}),t.boundHandleBlur_=function(b){return t.handleBlur(b)},t.boundHandleTapClick_=function(b){return t.handleTapClick(b)},t}var o=T.prototype;return o.addEventListenerForItem=function(e){e instanceof ae&&(this.on(e,"blur",this.boundHandleBlur_),this.on(e,["tap","click"],this.boundHandleTapClick_))},o.removeEventListenerForItem=function(e){e instanceof ae&&(this.off(e,"blur",this.boundHandleBlur_),this.off(e,["tap","click"],this.boundHandleTapClick_))},o.removeChild=function(e){typeof e=="string"&&(e=this.getChild(e)),this.removeEventListenerForItem(e),g.prototype.removeChild.call(this,e)},o.addItem=function(e){var t=this.addChild(e);t&&this.addEventListenerForItem(t)},o.createEl=function(){var e=this.options_.contentElType||"ul";this.contentEl_=_e(e,{className:"vjs-menu-content"}),this.contentEl_.setAttribute("role","menu");var t=g.prototype.createEl.call(this,"div",{append:this.contentEl_,className:"vjs-menu"});return t.appendChild(this.contentEl_),qe(t,"click",function(b){b.preventDefault(),b.stopImmediatePropagation()}),t},o.dispose=function(){this.contentEl_=null,this.boundHandleBlur_=null,this.boundHandleTapClick_=null,g.prototype.dispose.call(this)},o.handleBlur=function(e){var t=e.relatedTarget||E.default.activeElement;if(!this.children().some(function(U){return U.el()===t})){var b=this.menuButton_;b&&b.buttonPressed_&&t!==b.el().firstChild&&b.unpressButton()}},o.handleTapClick=function(e){if(this.menuButton_){this.menuButton_.unpressButton();var t=this.children();if(!Array.isArray(t))return;var b=t.filter(function(U){return U.el()===e.target})[0];if(!b)return;b.name()!=="CaptionSettingsMenuItem"&&this.menuButton_.focus()}},o.handleKeyDown=function(e){p.default.isEventKey(e,"Left")||p.default.isEventKey(e,"Down")?(e.preventDefault(),e.stopPropagation(),this.stepForward()):(p.default.isEventKey(e,"Right")||p.default.isEventKey(e,"Up"))&&(e.preventDefault(),e.stopPropagation(),this.stepBack())},o.stepForward=function(){var e=0;this.focusedChild_!==void 0&&(e=this.focusedChild_+1),this.focus(e)},o.stepBack=function(){var e=0;this.focusedChild_!==void 0&&(e=this.focusedChild_-1),this.focus(e)},o.focus=function(e){e===void 0&&(e=0);var t=this.children().slice(),b=t.length&&t[0].hasClass("vjs-menu-title");b&&t.shift(),t.length>0&&(e<0?e=0:e>=t.length&&(e=t.length-1),this.focusedChild_=e,t[e].el_.focus())},T}(ae);ae.registerComponent("Menu",un);var Qr=function(g){i.default(T,g);function T(r,e){var t;e===void 0&&(e={}),t=g.call(this,r,e)||this,t.menuButton_=new at(r,e),t.menuButton_.controlText(t.controlText_),t.menuButton_.el_.setAttribute("aria-haspopup","true");var b=at.prototype.buildCSSClass();t.menuButton_.el_.className=t.buildCSSClass()+" "+b,t.menuButton_.removeClass("vjs-control"),t.addChild(t.menuButton_),t.update(),t.enabled_=!0;var U=function(Y){return t.handleClick(Y)};return t.handleMenuKeyUp_=function(z){return t.handleMenuKeyUp(z)},t.on(t.menuButton_,"tap",U),t.on(t.menuButton_,"click",U),t.on(t.menuButton_,"keydown",function(z){return t.handleKeyDown(z)}),t.on(t.menuButton_,"mouseenter",function(){t.addClass("vjs-hover"),t.menu.show(),qe(E.default,"keyup",t.handleMenuKeyUp_)}),t.on("mouseleave",function(z){return t.handleMouseLeave(z)}),t.on("keydown",function(z){return t.handleSubmenuKeyDown(z)}),t}var o=T.prototype;return o.update=function(){var e=this.createMenu();this.menu&&(this.menu.dispose(),this.removeChild(this.menu)),this.menu=e,this.addChild(e),this.buttonPressed_=!1,this.menuButton_.el_.setAttribute("aria-expanded","false"),this.items&&this.items.length<=this.hideThreshold_?this.hide():this.show()},o.createMenu=function(){var e=new un(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title){var t=_e("li",{className:"vjs-menu-title",textContent:Ue(this.options_.title),tabIndex:-1}),b=new ae(this.player_,{el:t});e.addItem(b)}if(this.items=this.createItems(),this.items)for(var U=0;U<this.items.length;U++)e.addItem(this.items[U]);return e},o.createItems=function(){},o.createEl=function(){return g.prototype.createEl.call(this,"div",{className:this.buildWrapperCSSClass()},{})},o.buildWrapperCSSClass=function(){var e="vjs-menu-button";this.options_.inline===!0?e+="-inline":e+="-popup";var t=at.prototype.buildCSSClass();return"vjs-menu-button "+e+" "+t+" "+g.prototype.buildCSSClass.call(this)},o.buildCSSClass=function(){var e="vjs-menu-button";return this.options_.inline===!0?e+="-inline":e+="-popup","vjs-menu-button "+e+" "+g.prototype.buildCSSClass.call(this)},o.controlText=function(e,t){return t===void 0&&(t=this.menuButton_.el()),this.menuButton_.controlText(e,t)},o.dispose=function(){this.handleMouseLeave(),g.prototype.dispose.call(this)},o.handleClick=function(e){this.buttonPressed_?this.unpressButton():this.pressButton()},o.handleMouseLeave=function(e){this.removeClass("vjs-hover"),Ve(E.default,"keyup",this.handleMenuKeyUp_)},o.focus=function(){this.menuButton_.focus()},o.blur=function(){this.menuButton_.blur()},o.handleKeyDown=function(e){p.default.isEventKey(e,"Esc")||p.default.isEventKey(e,"Tab")?(this.buttonPressed_&&this.unpressButton(),p.default.isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus())):(p.default.isEventKey(e,"Up")||p.default.isEventKey(e,"Down"))&&(this.buttonPressed_||(e.preventDefault(),this.pressButton()))},o.handleMenuKeyUp=function(e){(p.default.isEventKey(e,"Esc")||p.default.isEventKey(e,"Tab"))&&this.removeClass("vjs-hover")},o.handleSubmenuKeyPress=function(e){this.handleSubmenuKeyDown(e)},o.handleSubmenuKeyDown=function(e){(p.default.isEventKey(e,"Esc")||p.default.isEventKey(e,"Tab"))&&(this.buttonPressed_&&this.unpressButton(),p.default.isEventKey(e,"Tab")||(e.preventDefault(),this.menuButton_.focus()))},o.pressButton=function(){if(this.enabled_){if(this.buttonPressed_=!0,this.menu.show(),this.menu.lockShowing(),this.menuButton_.el_.setAttribute("aria-expanded","true"),be&&st())return;this.menu.focus()}},o.unpressButton=function(){this.enabled_&&(this.buttonPressed_=!1,this.menu.unlockShowing(),this.menu.hide(),this.menuButton_.el_.setAttribute("aria-expanded","false"))},o.disable=function(){this.unpressButton(),this.enabled_=!1,this.addClass("vjs-disabled"),this.menuButton_.disable()},o.enable=function(){this.enabled_=!0,this.removeClass("vjs-disabled"),this.menuButton_.enable()},T}(ae);ae.registerComponent("MenuButton",Qr);var Jr=function(g){i.default(T,g);function T(o,r){var e,t=r.tracks;if(e=g.call(this,o,r)||this,e.items.length<=1&&e.hide(),!t)return a.default(e);var b=Oe(a.default(e),e.update);return t.addEventListener("removetrack",b),t.addEventListener("addtrack",b),t.addEventListener("labelchange",b),e.player_.on("ready",b),e.player_.on("dispose",function(){t.removeEventListener("removetrack",b),t.removeEventListener("addtrack",b),t.removeEventListener("labelchange",b)}),e}return T}(Qr);ae.registerComponent("TrackButton",Jr);var Na=["Tab","Esc","Up","Down","Right","Left"],zt=function(g){i.default(T,g);function T(r,e){var t;return t=g.call(this,r,e)||this,t.selectable=e.selectable,t.isSelected_=e.selected||!1,t.multiSelectable=e.multiSelectable,t.selected(t.isSelected_),t.selectable?t.multiSelectable?t.el_.setAttribute("role","menuitemcheckbox"):t.el_.setAttribute("role","menuitemradio"):t.el_.setAttribute("role","menuitem"),t}var o=T.prototype;return o.createEl=function(e,t,b){this.nonIconControl=!0;var U=g.prototype.createEl.call(this,"li",se({className:"vjs-menu-item",tabIndex:-1},t),b);return U.replaceChild(_e("span",{className:"vjs-menu-item-text",textContent:this.localize(this.options_.label)}),U.querySelector(".vjs-icon-placeholder")),U},o.handleKeyDown=function(e){Na.some(function(t){return p.default.isEventKey(e,t)})||g.prototype.handleKeyDown.call(this,e)},o.handleClick=function(e){this.selected(!0)},o.selected=function(e){this.selectable&&(e?(this.addClass("vjs-selected"),this.el_.setAttribute("aria-checked","true"),this.controlText(", selected"),this.isSelected_=!0):(this.removeClass("vjs-selected"),this.el_.setAttribute("aria-checked","false"),this.controlText(""),this.isSelected_=!1))},T}(lr);ae.registerComponent("MenuItem",zt);var Yt=function(g){i.default(T,g);function T(r,e){var t,b=e.track,U=r.textTracks();e.label=b.label||b.language||"Unknown",e.selected=b.mode==="showing",t=g.call(this,r,e)||this,t.track=b,t.kinds=(e.kinds||[e.kind||t.track.kind]).filter(Boolean);var z=function(){for(var Q=arguments.length,ne=new Array(Q),fe=0;fe<Q;fe++)ne[fe]=arguments[fe];t.handleTracksChange.apply(a.default(t),ne)},Y=function(){for(var Q=arguments.length,ne=new Array(Q),fe=0;fe<Q;fe++)ne[fe]=arguments[fe];t.handleSelectedLanguageChange.apply(a.default(t),ne)};if(r.on(["loadstart","texttrackchange"],z),U.addEventListener("change",z),U.addEventListener("selectedlanguagechange",Y),t.on("dispose",function(){r.off(["loadstart","texttrackchange"],z),U.removeEventListener("change",z),U.removeEventListener("selectedlanguagechange",Y)}),U.onchange===void 0){var J;t.on(["tap","click"],function(){if(typeof d.default.Event!="object")try{J=new d.default.Event("change")}catch(te){}J||(J=E.default.createEvent("Event"),J.initEvent("change",!0,!0)),U.dispatchEvent(J)})}return t.handleTracksChange(),t}var o=T.prototype;return o.handleClick=function(e){var t=this.track,b=this.player_.textTracks();if(g.prototype.handleClick.call(this,e),!!b)for(var U=0;U<b.length;U++){var z=b[U];this.kinds.indexOf(z.kind)!==-1&&(z===t?z.mode!=="showing"&&(z.mode="showing"):z.mode!=="disabled"&&(z.mode="disabled"))}},o.handleTracksChange=function(e){var t=this.track.mode==="showing";t!==this.isSelected_&&this.selected(t)},o.handleSelectedLanguageChange=function(e){if(this.track.mode==="showing"){var t=this.player_.cache_.selectedLanguage;if(t&&t.enabled&&t.language===this.track.language&&t.kind!==this.track.kind)return;this.player_.cache_.selectedLanguage={enabled:!0,language:this.track.language,kind:this.track.kind}}},o.dispose=function(){this.track=null,g.prototype.dispose.call(this)},T}(zt);ae.registerComponent("TextTrackMenuItem",Yt);var cn=function(g){i.default(T,g);function T(r,e){return e.track={player:r,kind:e.kind,kinds:e.kinds,default:!1,mode:"disabled"},e.kinds||(e.kinds=[e.kind]),e.label?e.track.label=e.label:e.track.label=e.kinds.join(" and ")+" off",e.selectable=!0,e.multiSelectable=!1,g.call(this,r,e)||this}var o=T.prototype;return o.handleTracksChange=function(e){for(var t=this.player().textTracks(),b=!0,U=0,z=t.length;U<z;U++){var Y=t[U];if(this.options_.kinds.indexOf(Y.kind)>-1&&Y.mode==="showing"){b=!1;break}}b!==this.isSelected_&&this.selected(b)},o.handleSelectedLanguageChange=function(e){for(var t=this.player().textTracks(),b=!0,U=0,z=t.length;U<z;U++){var Y=t[U];if(["captions","descriptions","subtitles"].indexOf(Y.kind)>-1&&Y.mode==="showing"){b=!1;break}}b&&(this.player_.cache_.selectedLanguage={enabled:!1})},T}(Yt);ae.registerComponent("OffTextTrackMenuItem",cn);var Bt=function(g){i.default(T,g);function T(r,e){return e===void 0&&(e={}),e.tracks=r.textTracks(),g.call(this,r,e)||this}var o=T.prototype;return o.createItems=function(e,t){e===void 0&&(e=[]),t===void 0&&(t=Yt);var b;this.label_&&(b=this.label_+" off"),e.push(new cn(this.player_,{kinds:this.kinds_,kind:this.kind_,label:b})),this.hideThreshold_+=1;var U=this.player_.textTracks();Array.isArray(this.kinds_)||(this.kinds_=[this.kind_]);for(var z=0;z<U.length;z++){var Y=U[z];if(this.kinds_.indexOf(Y.kind)>-1){var J=new t(this.player_,{track:Y,kinds:this.kinds_,kind:this.kind_,selectable:!0,multiSelectable:!1});J.addClass("vjs-"+Y.kind+"-menu-item"),e.push(J)}}return e},T}(Jr);ae.registerComponent("TextTrackButton",Bt);var dn=function(g){i.default(T,g);function T(r,e){var t,b=e.track,U=e.cue,z=r.currentTime();return e.selectable=!0,e.multiSelectable=!1,e.label=U.text,e.selected=U.startTime<=z&&z<U.endTime,t=g.call(this,r,e)||this,t.track=b,t.cue=U,b.addEventListener("cuechange",Oe(a.default(t),t.update)),t}var o=T.prototype;return o.handleClick=function(e){g.prototype.handleClick.call(this),this.player_.currentTime(this.cue.startTime),this.update(this.cue.startTime)},o.update=function(e){var t=this.cue,b=this.player_.currentTime();this.selected(t.startTime<=b&&b<t.endTime)},T}(zt);ae.registerComponent("ChaptersTrackMenuItem",dn);var Zr=function(g){i.default(T,g);function T(r,e,t){return g.call(this,r,e,t)||this}var o=T.prototype;return o.buildCSSClass=function(){return"vjs-chapters-button "+g.prototype.buildCSSClass.call(this)},o.buildWrapperCSSClass=function(){return"vjs-chapters-button "+g.prototype.buildWrapperCSSClass.call(this)},o.update=function(e){(!this.track_||e&&(e.type==="addtrack"||e.type==="removetrack"))&&this.setTrack(this.findChaptersTrack()),g.prototype.update.call(this)},o.setTrack=function(e){if(this.track_!==e){if(this.updateHandler_||(this.updateHandler_=this.update.bind(this)),this.track_){var t=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);t&&t.removeEventListener("load",this.updateHandler_),this.track_=null}if(this.track_=e,this.track_){this.track_.mode="hidden";var b=this.player_.remoteTextTrackEls().getTrackElementByTrack_(this.track_);b&&b.addEventListener("load",this.updateHandler_)}}},o.findChaptersTrack=function(){for(var e=this.player_.textTracks()||[],t=e.length-1;t>=0;t--){var b=e[t];if(b.kind===this.kind_)return b}},o.getMenuCaption=function(){return this.track_&&this.track_.label?this.track_.label:this.localize(Ue(this.kind_))},o.createMenu=function(){return this.options_.title=this.getMenuCaption(),g.prototype.createMenu.call(this)},o.createItems=function(){var e=[];if(!this.track_)return e;var t=this.track_.cues;if(!t)return e;for(var b=0,U=t.length;b<U;b++){var z=t[b],Y=new dn(this.player_,{track:this.track_,cue:z});e.push(Y)}return e},T}(Bt);Zr.prototype.kind_="chapters",Zr.prototype.controlText_="Chapters",ae.registerComponent("ChaptersButton",Zr);var qr=function(g){i.default(T,g);function T(r,e,t){var b;b=g.call(this,r,e,t)||this;var U=r.textTracks(),z=Oe(a.default(b),b.handleTracksChange);return U.addEventListener("change",z),b.on("dispose",function(){U.removeEventListener("change",z)}),b}var o=T.prototype;return o.handleTracksChange=function(e){for(var t=this.player().textTracks(),b=!1,U=0,z=t.length;U<z;U++){var Y=t[U];if(Y.kind!==this.kind_&&Y.mode==="showing"){b=!0;break}}b?this.disable():this.enable()},o.buildCSSClass=function(){return"vjs-descriptions-button "+g.prototype.buildCSSClass.call(this)},o.buildWrapperCSSClass=function(){return"vjs-descriptions-button "+g.prototype.buildWrapperCSSClass.call(this)},T}(Bt);qr.prototype.kind_="descriptions",qr.prototype.controlText_="Descriptions",ae.registerComponent("DescriptionsButton",qr);var ei=function(g){i.default(T,g);function T(r,e,t){return g.call(this,r,e,t)||this}var o=T.prototype;return o.buildCSSClass=function(){return"vjs-subtitles-button "+g.prototype.buildCSSClass.call(this)},o.buildWrapperCSSClass=function(){return"vjs-subtitles-button "+g.prototype.buildWrapperCSSClass.call(this)},T}(Bt);ei.prototype.kind_="subtitles",ei.prototype.controlText_="Subtitles",ae.registerComponent("SubtitlesButton",ei);var ti=function(g){i.default(T,g);function T(r,e){var t;return e.track={player:r,kind:e.kind,label:e.kind+" settings",selectable:!1,default:!1,mode:"disabled"},e.selectable=!1,e.name="CaptionSettingsMenuItem",t=g.call(this,r,e)||this,t.addClass("vjs-texttrack-settings"),t.controlText(", opens "+e.kind+" settings dialog"),t}var o=T.prototype;return o.handleClick=function(e){this.player().getChild("textTrackSettings").open()},T}(Yt);ae.registerComponent("CaptionSettingsMenuItem",ti);var ri=function(g){i.default(T,g);function T(r,e,t){return g.call(this,r,e,t)||this}var o=T.prototype;return o.buildCSSClass=function(){return"vjs-captions-button "+g.prototype.buildCSSClass.call(this)},o.buildWrapperCSSClass=function(){return"vjs-captions-button "+g.prototype.buildWrapperCSSClass.call(this)},o.createItems=function(){var e=[];return!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")&&(e.push(new ti(this.player_,{kind:this.kind_})),this.hideThreshold_+=1),g.prototype.createItems.call(this,e)},T}(Bt);ri.prototype.kind_="captions",ri.prototype.controlText_="Captions",ae.registerComponent("CaptionsButton",ri);var fn=function(g){i.default(T,g);function T(){return g.apply(this,arguments)||this}var o=T.prototype;return o.createEl=function(e,t,b){var U=g.prototype.createEl.call(this,e,t,b),z=U.querySelector(".vjs-menu-item-text");return this.options_.track.kind==="captions"&&(z.appendChild(_e("span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),z.appendChild(_e("span",{className:"vjs-control-text",textContent:" "+this.localize("Captions")}))),U},T}(Yt);ae.registerComponent("SubsCapsMenuItem",fn);var ii=function(g){i.default(T,g);function T(r,e){var t;return e===void 0&&(e={}),t=g.call(this,r,e)||this,t.label_="subtitles",["en","en-us","en-ca","fr-ca"].indexOf(t.player_.language_)>-1&&(t.label_="captions"),t.menuButton_.controlText(Ue(t.label_)),t}var o=T.prototype;return o.buildCSSClass=function(){return"vjs-subs-caps-button "+g.prototype.buildCSSClass.call(this)},o.buildWrapperCSSClass=function(){return"vjs-subs-caps-button "+g.prototype.buildWrapperCSSClass.call(this)},o.createItems=function(){var e=[];return!(this.player().tech_&&this.player().tech_.featuresNativeTextTracks)&&this.player().getChild("textTrackSettings")&&(e.push(new ti(this.player_,{kind:this.label_})),this.hideThreshold_+=1),e=g.prototype.createItems.call(this,e,fn),e},T}(Bt);ii.prototype.kinds_=["captions","subtitles"],ii.prototype.controlText_="Subtitles",ae.registerComponent("SubsCapsButton",ii);var hn=function(g){i.default(T,g);function T(r,e){var t,b=e.track,U=r.audioTracks();e.label=b.label||b.language||"Unknown",e.selected=b.enabled,t=g.call(this,r,e)||this,t.track=b,t.addClass("vjs-"+b.kind+"-menu-item");var z=function(){for(var J=arguments.length,te=new Array(J),Q=0;Q<J;Q++)te[Q]=arguments[Q];t.handleTracksChange.apply(a.default(t),te)};return U.addEventListener("change",z),t.on("dispose",function(){U.removeEventListener("change",z)}),t}var o=T.prototype;return o.createEl=function(e,t,b){var U=g.prototype.createEl.call(this,e,t,b),z=U.querySelector(".vjs-menu-item-text");return this.options_.track.kind==="main-desc"&&(z.appendChild(g.prototype.createEl.call(this,"span",{className:"vjs-icon-placeholder"},{"aria-hidden":!0})),z.appendChild(g.prototype.createEl.call(this,"span",{className:"vjs-control-text",textContent:this.localize("Descriptions")}))),U},o.handleClick=function(e){g.prototype.handleClick.call(this,e),this.track.enabled=!0},o.handleTracksChange=function(e){this.selected(this.track.enabled)},T}(zt);ae.registerComponent("AudioTrackMenuItem",hn);var vn=function(g){i.default(T,g);function T(r,e){return e===void 0&&(e={}),e.tracks=r.audioTracks(),g.call(this,r,e)||this}var o=T.prototype;return o.buildCSSClass=function(){return"vjs-audio-button "+g.prototype.buildCSSClass.call(this)},o.buildWrapperCSSClass=function(){return"vjs-audio-button "+g.prototype.buildWrapperCSSClass.call(this)},o.createItems=function(e){e===void 0&&(e=[]),this.hideThreshold_=1;for(var t=this.player_.audioTracks(),b=0;b<t.length;b++){var U=t[b];e.push(new hn(this.player_,{track:U,selectable:!0,multiSelectable:!1}))}return e},T}(Jr);vn.prototype.controlText_="Audio Track",ae.registerComponent("AudioTrackButton",vn);var ni=function(g){i.default(T,g);function T(r,e){var t,b=e.rate,U=parseFloat(b,10);return e.label=b,e.selected=U===r.playbackRate(),e.selectable=!0,e.multiSelectable=!1,t=g.call(this,r,e)||this,t.label=b,t.rate=U,t.on(r,"ratechange",function(z){return t.update(z)}),t}var o=T.prototype;return o.handleClick=function(e){g.prototype.handleClick.call(this),this.player().playbackRate(this.rate)},o.update=function(e){this.selected(this.player().playbackRate()===this.rate)},T}(zt);ni.prototype.contentElType="button",ae.registerComponent("PlaybackRateMenuItem",ni);var pn=function(g){i.default(T,g);function T(r,e){var t;return t=g.call(this,r,e)||this,t.menuButton_.el_.setAttribute("aria-describedby",t.labelElId_),t.updateVisibility(),t.updateLabel(),t.on(r,"loadstart",function(b){return t.updateVisibility(b)}),t.on(r,"ratechange",function(b){return t.updateLabel(b)}),t.on(r,"playbackrateschange",function(b){return t.handlePlaybackRateschange(b)}),t}var o=T.prototype;return o.createEl=function(){var e=g.prototype.createEl.call(this);return this.labelElId_="vjs-playback-rate-value-label-"+this.id_,this.labelEl_=_e("div",{className:"vjs-playback-rate-value",id:this.labelElId_,textContent:"1x"}),e.appendChild(this.labelEl_),e},o.dispose=function(){this.labelEl_=null,g.prototype.dispose.call(this)},o.buildCSSClass=function(){return"vjs-playback-rate "+g.prototype.buildCSSClass.call(this)},o.buildWrapperCSSClass=function(){return"vjs-playback-rate "+g.prototype.buildWrapperCSSClass.call(this)},o.createItems=function(){for(var e=this.playbackRates(),t=[],b=e.length-1;b>=0;b--)t.push(new ni(this.player(),{rate:e[b]+"x"}));return t},o.updateARIAAttributes=function(){this.el().setAttribute("aria-valuenow",this.player().playbackRate())},o.handleClick=function(e){for(var t=this.player().playbackRate(),b=this.playbackRates(),U=b[0],z=0;z<b.length;z++)if(b[z]>t){U=b[z];break}this.player().playbackRate(U)},o.handlePlaybackRateschange=function(e){this.update()},o.playbackRates=function(){var e=this.player();return e.playbackRates&&e.playbackRates()||[]},o.playbackRateSupported=function(){return this.player().tech_&&this.player().tech_.featuresPlaybackRate&&this.playbackRates()&&this.playbackRates().length>0},o.updateVisibility=function(e){this.playbackRateSupported()?this.removeClass("vjs-hidden"):this.addClass("vjs-hidden")},o.updateLabel=function(e){this.playbackRateSupported()&&(this.labelEl_.textContent=this.player().playbackRate()+"x")},T}(Qr);pn.prototype.controlText_="Playback Rate",ae.registerComponent("PlaybackRateMenuButton",pn);var gn=function(g){i.default(T,g);function T(){return g.apply(this,arguments)||this}var o=T.prototype;return o.buildCSSClass=function(){return"vjs-spacer "+g.prototype.buildCSSClass.call(this)},o.createEl=function(e,t,b){return e===void 0&&(e="div"),t===void 0&&(t={}),b===void 0&&(b={}),t.className||(t.className=this.buildCSSClass()),g.prototype.createEl.call(this,e,t,b)},T}(ae);ae.registerComponent("Spacer",gn);var Ua=function(g){i.default(T,g);function T(){return g.apply(this,arguments)||this}var o=T.prototype;return o.buildCSSClass=function(){return"vjs-custom-control-spacer "+g.prototype.buildCSSClass.call(this)},o.createEl=function(){return g.prototype.createEl.call(this,"div",{className:this.buildCSSClass(),textContent:"\xA0"})},T}(gn);ae.registerComponent("CustomControlSpacer",Ua);var fr=function(g){i.default(T,g);function T(){return g.apply(this,arguments)||this}var o=T.prototype;return o.createEl=function(){return g.prototype.createEl.call(this,"div",{className:"vjs-control-bar",dir:"ltr"})},T}(ae);fr.prototype.options_={children:["playToggle","volumePanel","currentTimeDisplay","timeDivider","durationDisplay","progressControl","liveDisplay","seekToLive","remainingTimeDisplay","customControlSpacer","playbackRateMenuButton","chaptersButton","descriptionsButton","subsCapsButton","audioTrackButton","fullscreenToggle"]},"exitPictureInPicture"in E.default&&fr.prototype.options_.children.splice(fr.prototype.options_.children.length-1,0,"pictureInPictureToggle"),ae.registerComponent("ControlBar",fr);var mn=function(g){i.default(T,g);function T(r,e){var t;return t=g.call(this,r,e)||this,t.on(r,"error",function(b){return t.open(b)}),t}var o=T.prototype;return o.buildCSSClass=function(){return"vjs-error-display "+g.prototype.buildCSSClass.call(this)},o.content=function(){var e=this.player().error();return e?this.localize(e.message):""},T}(It);mn.prototype.options_=c.default({},It.prototype.options_,{pauseOnOpen:!1,fillAlways:!0,temporary:!1,uncloseable:!0}),ae.registerComponent("ErrorDisplay",mn);var ai="vjs-text-track-settings",yn=["#000","Black"],En=["#00F","Blue"],Tn=["#0FF","Cyan"],_n=["#0F0","Green"],Sn=["#F0F","Magenta"],bn=["#F00","Red"],Cn=["#FFF","White"],An=["#FF0","Yellow"],si=["1","Opaque"],oi=["0.5","Semi-Transparent"],Ln=["0","Transparent"],Lt={backgroundColor:{selector:".vjs-bg-color > select",id:"captions-background-color-%s",label:"Color",options:[yn,Cn,bn,_n,En,An,Sn,Tn]},backgroundOpacity:{selector:".vjs-bg-opacity > select",id:"captions-background-opacity-%s",label:"Transparency",options:[si,oi,Ln]},color:{selector:".vjs-fg-color > select",id:"captions-foreground-color-%s",label:"Color",options:[Cn,yn,bn,_n,En,An,Sn,Tn]},edgeStyle:{selector:".vjs-edge-style > select",id:"%s",label:"Text Edge Style",options:[["none","None"],["raised","Raised"],["depressed","Depressed"],["uniform","Uniform"],["dropshadow","Dropshadow"]]},fontFamily:{selector:".vjs-font-family > select",id:"captions-font-family-%s",label:"Font Family",options:[["proportionalSansSerif","Proportional Sans-Serif"],["monospaceSansSerif","Monospace Sans-Serif"],["proportionalSerif","Proportional Serif"],["monospaceSerif","Monospace Serif"],["casual","Casual"],["script","Script"],["small-caps","Small Caps"]]},fontPercent:{selector:".vjs-font-percent > select",id:"captions-font-size-%s",label:"Font Size",options:[["0.50","50%"],["0.75","75%"],["1.00","100%"],["1.25","125%"],["1.50","150%"],["1.75","175%"],["2.00","200%"],["3.00","300%"],["4.00","400%"]],default:2,parser:function(T){return T==="1.00"?null:Number(T)}},textOpacity:{selector:".vjs-text-opacity > select",id:"captions-foreground-opacity-%s",label:"Transparency",options:[si,oi]},windowColor:{selector:".vjs-window-color > select",id:"captions-window-color-%s",label:"Color"},windowOpacity:{selector:".vjs-window-opacity > select",id:"captions-window-opacity-%s",label:"Transparency",options:[Ln,oi,si]}};Lt.windowColor.options=Lt.backgroundColor.options;function Dn(g,T){if(T&&(g=T(g)),g&&g!=="none")return g}function ja(g,T){var o=g.options[g.options.selectedIndex].value;return Dn(o,T)}function Ka(g,T,o){if(!!T){for(var r=0;r<g.options.length;r++)if(Dn(g.options[r].value,o)===T){g.selectedIndex=r;break}}}var Ha=function(g){i.default(T,g);function T(r,e){var t;return e.temporary=!1,t=g.call(this,r,e)||this,t.updateDisplay=t.updateDisplay.bind(a.default(t)),t.fill(),t.hasBeenOpened_=t.hasBeenFilled_=!0,t.endDialog=_e("p",{className:"vjs-control-text",textContent:t.localize("End of dialog window.")}),t.el().appendChild(t.endDialog),t.setDefaults(),e.persistTextTrackSettings===void 0&&(t.options_.persistTextTrackSettings=t.options_.playerOptions.persistTextTrackSettings),t.on(t.$(".vjs-done-button"),"click",function(){t.saveSettings(),t.close()}),t.on(t.$(".vjs-default-button"),"click",function(){t.setDefaults(),t.updateDisplay()}),ie(Lt,function(b){t.on(t.$(b.selector),"change",t.updateDisplay)}),t.options_.persistTextTrackSettings&&t.restoreSettings(),t}var o=T.prototype;return o.dispose=function(){this.endDialog=null,g.prototype.dispose.call(this)},o.createElSelect_=function(e,t,b){var U=this;t===void 0&&(t=""),b===void 0&&(b="label");var z=Lt[e],Y=z.id.replace("%s",this.id_),J=[t,Y].join(" ").trim();return["<"+b+' id="'+Y+'" class="'+(b==="label"?"vjs-label":"")+'">',this.localize(z.label),"</"+b+">",'<select aria-labelledby="'+J+'">'].concat(z.options.map(function(te){var Q=Y+"-"+te[1].replace(/\W+/g,"");return['<option id="'+Q+'" value="'+te[0]+'" ','aria-labelledby="'+J+" "+Q+'">',U.localize(te[1]),"</option>"].join("")})).concat("</select>").join("")},o.createElFgColor_=function(){var e="captions-text-legend-"+this.id_;return['<fieldset class="vjs-fg-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Text"),"</legend>",this.createElSelect_("color",e),'<span class="vjs-text-opacity vjs-opacity">',this.createElSelect_("textOpacity",e),"</span>","</fieldset>"].join("")},o.createElBgColor_=function(){var e="captions-background-"+this.id_;return['<fieldset class="vjs-bg-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Background"),"</legend>",this.createElSelect_("backgroundColor",e),'<span class="vjs-bg-opacity vjs-opacity">',this.createElSelect_("backgroundOpacity",e),"</span>","</fieldset>"].join("")},o.createElWinColor_=function(){var e="captions-window-"+this.id_;return['<fieldset class="vjs-window-color vjs-track-setting">','<legend id="'+e+'">',this.localize("Window"),"</legend>",this.createElSelect_("windowColor",e),'<span class="vjs-window-opacity vjs-opacity">',this.createElSelect_("windowOpacity",e),"</span>","</fieldset>"].join("")},o.createElColors_=function(){return _e("div",{className:"vjs-track-settings-colors",innerHTML:[this.createElFgColor_(),this.createElBgColor_(),this.createElWinColor_()].join("")})},o.createElFont_=function(){return _e("div",{className:"vjs-track-settings-font",innerHTML:['<fieldset class="vjs-font-percent vjs-track-setting">',this.createElSelect_("fontPercent","","legend"),"</fieldset>",'<fieldset class="vjs-edge-style vjs-track-setting">',this.createElSelect_("edgeStyle","","legend"),"</fieldset>",'<fieldset class="vjs-font-family vjs-track-setting">',this.createElSelect_("fontFamily","","legend"),"</fieldset>"].join("")})},o.createElControls_=function(){var e=this.localize("restore all settings to the default values");return _e("div",{className:"vjs-track-settings-controls",innerHTML:['<button type="button" class="vjs-default-button" title="'+e+'">',this.localize("Reset"),'<span class="vjs-control-text"> '+e+"</span>","</button>",'<button type="button" class="vjs-done-button">'+this.localize("Done")+"</button>"].join("")})},o.content=function(){return[this.createElColors_(),this.createElFont_(),this.createElControls_()]},o.label=function(){return this.localize("Caption Settings Dialog")},o.description=function(){return this.localize("Beginning of dialog window. Escape will cancel and close the window.")},o.buildCSSClass=function(){return g.prototype.buildCSSClass.call(this)+" vjs-text-track-settings"},o.getValues=function(){var e=this;return ue(Lt,function(t,b,U){var z=ja(e.$(b.selector),b.parser);return z!==void 0&&(t[U]=z),t},{})},o.setValues=function(e){var t=this;ie(Lt,function(b,U){Ka(t.$(b.selector),e[U],b.parser)})},o.setDefaults=function(){var e=this;ie(Lt,function(t){var b=t.hasOwnProperty("default")?t.default:0;e.$(t.selector).selectedIndex=b})},o.restoreSettings=function(){var e;try{e=JSON.parse(d.default.localStorage.getItem(ai))}catch(t){$.warn(t)}e&&this.setValues(e)},o.saveSettings=function(){if(!!this.options_.persistTextTrackSettings){var e=this.getValues();try{Object.keys(e).length?d.default.localStorage.setItem(ai,JSON.stringify(e)):d.default.localStorage.removeItem(ai)}catch(t){$.warn(t)}}},o.updateDisplay=function(){var e=this.player_.getChild("textTrackDisplay");e&&e.updateDisplay()},o.conditionalBlur_=function(){this.previouslyActiveEl_=null;var e=this.player_.controlBar,t=e&&e.subsCapsButton,b=e&&e.captionsButton;t?t.focus():b&&b.focus()},T}(It);ae.registerComponent("TextTrackSettings",Ha);var Wa=function(g){i.default(T,g);function T(r,e){var t,b=e.ResizeObserver||d.default.ResizeObserver;e.ResizeObserver===null&&(b=!1);var U=xe({createEl:!b,reportTouchActivity:!1},e);return t=g.call(this,r,U)||this,t.ResizeObserver=e.ResizeObserver||d.default.ResizeObserver,t.loadListener_=null,t.resizeObserver_=null,t.debouncedHandler_=Kn(function(){t.resizeHandler()},100,!1,a.default(t)),b?(t.resizeObserver_=new t.ResizeObserver(t.debouncedHandler_),t.resizeObserver_.observe(r.el())):(t.loadListener_=function(){if(!(!t.el_||!t.el_.contentWindow)){var z=t.debouncedHandler_,Y=t.unloadListener_=function(){Ve(this,"resize",z),Ve(this,"unload",Y),Y=null};qe(t.el_.contentWindow,"unload",Y),qe(t.el_.contentWindow,"resize",z)}},t.one("load",t.loadListener_)),t}var o=T.prototype;return o.createEl=function(){return g.prototype.createEl.call(this,"iframe",{className:"vjs-resize-manager",tabIndex:-1},{"aria-hidden":"true"})},o.resizeHandler=function(){!this.player_||!this.player_.trigger||this.player_.trigger("playerresize")},o.dispose=function(){this.debouncedHandler_&&this.debouncedHandler_.cancel(),this.resizeObserver_&&(this.player_.el()&&this.resizeObserver_.unobserve(this.player_.el()),this.resizeObserver_.disconnect()),this.loadListener_&&this.off("load",this.loadListener_),this.el_&&this.el_.contentWindow&&this.unloadListener_&&this.unloadListener_.call(this.el_.contentWindow),this.ResizeObserver=null,this.resizeObserver=null,this.debouncedHandler_=null,this.loadListener_=null,g.prototype.dispose.call(this)},T}(ae);ae.registerComponent("ResizeManager",Wa);var Ga={trackingThreshold:20,liveTolerance:15},Va=function(g){i.default(T,g);function T(r,e){var t,b=xe(Ga,e,{createEl:!1});return t=g.call(this,r,b)||this,t.handleVisibilityChange_=function(U){return t.handleVisibilityChange(U)},t.trackLiveHandler_=function(){return t.trackLive_()},t.handlePlay_=function(U){return t.handlePlay(U)},t.handleFirstTimeupdate_=function(U){return t.handleFirstTimeupdate(U)},t.handleSeeked_=function(U){return t.handleSeeked(U)},t.seekToLiveEdge_=function(U){return t.seekToLiveEdge(U)},t.reset_(),t.on(t.player_,"durationchange",function(U){return t.handleDurationchange(U)}),t.one(t.player_,"canplay",function(){return t.toggleTracking()}),ve&&"hidden"in E.default&&"visibilityState"in E.default&&t.on(E.default,"visibilitychange",t.handleVisibilityChange_),t}var o=T.prototype;return o.handleVisibilityChange=function(){this.player_.duration()===Infinity&&(E.default.hidden?this.stopTracking():this.startTracking())},o.trackLive_=function(){var e=this.player_.seekable();if(!(!e||!e.length)){var t=Number(d.default.performance.now().toFixed(4)),b=this.lastTime_===-1?0:(t-this.lastTime_)/1e3;this.lastTime_=t,this.pastSeekEnd_=this.pastSeekEnd()+b;var U=this.liveCurrentTime(),z=this.player_.currentTime(),Y=this.player_.paused()||this.seekedBehindLive_||Math.abs(U-z)>this.options_.liveTolerance;(!this.timeupdateSeen_||U===Infinity)&&(Y=!1),Y!==this.behindLiveEdge_&&(this.behindLiveEdge_=Y,this.trigger("liveedgechange"))}},o.handleDurationchange=function(){this.toggleTracking()},o.toggleTracking=function(){this.player_.duration()===Infinity&&this.liveWindow()>=this.options_.trackingThreshold?(this.player_.options_.liveui&&this.player_.addClass("vjs-liveui"),this.startTracking()):(this.player_.removeClass("vjs-liveui"),this.stopTracking())},o.startTracking=function(){this.isTracking()||(this.timeupdateSeen_||(this.timeupdateSeen_=this.player_.hasStarted()),this.trackingInterval_=this.setInterval(this.trackLiveHandler_,nt),this.trackLive_(),this.on(this.player_,["play","pause"],this.trackLiveHandler_),this.timeupdateSeen_?this.on(this.player_,"seeked",this.handleSeeked_):(this.one(this.player_,"play",this.handlePlay_),this.one(this.player_,"timeupdate",this.handleFirstTimeupdate_)))},o.handleFirstTimeupdate=function(){this.timeupdateSeen_=!0,this.on(this.player_,"seeked",this.handleSeeked_)},o.handleSeeked=function(){var e=Math.abs(this.liveCurrentTime()-this.player_.currentTime());this.seekedBehindLive_=this.nextSeekedFromUser_&&e>2,this.nextSeekedFromUser_=!1,this.trackLive_()},o.handlePlay=function(){this.one(this.player_,"timeupdate",this.seekToLiveEdge_)},o.reset_=function(){this.lastTime_=-1,this.pastSeekEnd_=0,this.lastSeekEnd_=-1,this.behindLiveEdge_=!0,this.timeupdateSeen_=!1,this.seekedBehindLive_=!1,this.nextSeekedFromUser_=!1,this.clearInterval(this.trackingInterval_),this.trackingInterval_=null,this.off(this.player_,["play","pause"],this.trackLiveHandler_),this.off(this.player_,"seeked",this.handleSeeked_),this.off(this.player_,"play",this.handlePlay_),this.off(this.player_,"timeupdate",this.handleFirstTimeupdate_),this.off(this.player_,"timeupdate",this.seekToLiveEdge_)},o.nextSeekedFromUser=function(){this.nextSeekedFromUser_=!0},o.stopTracking=function(){!this.isTracking()||(this.reset_(),this.trigger("liveedgechange"))},o.seekableEnd=function(){for(var e=this.player_.seekable(),t=[],b=e?e.length:0;b--;)t.push(e.end(b));return t.length?t.sort()[t.length-1]:Infinity},o.seekableStart=function(){for(var e=this.player_.seekable(),t=[],b=e?e.length:0;b--;)t.push(e.start(b));return t.length?t.sort()[0]:0},o.liveWindow=function(){var e=this.liveCurrentTime();return e===Infinity?0:e-this.seekableStart()},o.isLive=function(){return this.isTracking()},o.atLiveEdge=function(){return!this.behindLiveEdge()},o.liveCurrentTime=function(){return this.pastSeekEnd()+this.seekableEnd()},o.pastSeekEnd=function(){var e=this.seekableEnd();return this.lastSeekEnd_!==-1&&e!==this.lastSeekEnd_&&(this.pastSeekEnd_=0),this.lastSeekEnd_=e,this.pastSeekEnd_},o.behindLiveEdge=function(){return this.behindLiveEdge_},o.isTracking=function(){return typeof this.trackingInterval_=="number"},o.seekToLiveEdge=function(){this.seekedBehindLive_=!1,!this.atLiveEdge()&&(this.nextSeekedFromUser_=!1,this.player_.currentTime(this.liveCurrentTime()))},o.dispose=function(){this.off(E.default,"visibilitychange",this.handleVisibilityChange_),this.stopTracking(),g.prototype.dispose.call(this)},T}(ae);ae.registerComponent("LiveTracker",Va);var li=function(T){var o=T.el();if(o.hasAttribute("src"))return T.triggerSourceset(o.src),!0;var r=T.$$("source"),e=[],t="";if(!r.length)return!1;for(var b=0;b<r.length;b++){var U=r[b].src;U&&e.indexOf(U)===-1&&e.push(U)}return e.length?(e.length===1&&(t=e[0]),T.triggerSourceset(t),!0):!1},za=Object.defineProperty({},"innerHTML",{get:function(){return this.cloneNode(!0).innerHTML},set:function(T){var o=E.default.createElement(this.nodeName.toLowerCase());o.innerHTML=T;for(var r=E.default.createDocumentFragment();o.childNodes.length;)r.appendChild(o.childNodes[0]);return this.innerText="",d.default.Element.prototype.appendChild.call(this,r),this.innerHTML}}),Pn=function(T,o){for(var r={},e=0;e<T.length&&(r=Object.getOwnPropertyDescriptor(T[e],o),!(r&&r.set&&r.get));e++);return r.enumerable=!0,r.configurable=!0,r},Ya=function(T){return Pn([T.el(),d.default.HTMLMediaElement.prototype,d.default.Element.prototype,za],"innerHTML")},On=function(T){var o=T.el();if(!o.resetSourceWatch_){var r={},e=Ya(T),t=function(U){return function(){for(var z=arguments.length,Y=new Array(z),J=0;J<z;J++)Y[J]=arguments[J];var te=U.apply(o,Y);return li(T),te}};["append","appendChild","insertAdjacentHTML"].forEach(function(b){!o[b]||(r[b]=o[b],o[b]=t(r[b]))}),Object.defineProperty(o,"innerHTML",xe(e,{set:t(e.set)})),o.resetSourceWatch_=function(){o.resetSourceWatch_=null,Object.keys(r).forEach(function(b){o[b]=r[b]}),Object.defineProperty(o,"innerHTML",e)},T.one("sourceset",o.resetSourceWatch_)}},Xa=Object.defineProperty({},"src",{get:function(){return this.hasAttribute("src")?Ni(d.default.Element.prototype.getAttribute.call(this,"src")):""},set:function(T){return d.default.Element.prototype.setAttribute.call(this,"src",T),T}}),$a=function(T){return Pn([T.el(),d.default.HTMLMediaElement.prototype,Xa],"src")},Qa=function(T){if(!!T.featuresSourceset){var o=T.el();if(!o.resetSourceset_){var r=$a(T),e=o.setAttribute,t=o.load;Object.defineProperty(o,"src",xe(r,{set:function(U){var z=r.set.call(o,U);return T.triggerSourceset(o.src),z}})),o.setAttribute=function(b,U){var z=e.call(o,b,U);return/src/i.test(b)&&T.triggerSourceset(o.src),z},o.load=function(){var b=t.call(o);return li(T)||(T.triggerSourceset(""),On(T)),b},o.currentSrc?T.triggerSourceset(o.currentSrc):li(T)||On(T),o.resetSourceset_=function(){o.resetSourceset_=null,o.load=t,o.setAttribute=e,Object.defineProperty(o,"src",r),o.resetSourceWatch_&&o.resetSourceWatch_()}}}},ui=function(T,o,r,e){e===void 0&&(e=!0);var t=function(z){return Object.defineProperty(T,o,{value:z,enumerable:!0,writable:!0})},b={configurable:!0,enumerable:!0,get:function(){var z=r();return t(z),z}};return e&&(b.set=t),Object.defineProperty(T,o,b)},he=function(g){i.default(T,g);function T(r,e){var t;t=g.call(this,r,e)||this;var b=r.source,U=!1;if(b&&(t.el_.currentSrc!==b.src||r.tag&&r.tag.initNetworkState_===3)?t.setSource(b):t.handleLateInit_(t.el_),r.enableSourceset&&t.setupSourcesetHandling_(),t.isScrubbing_=!1,t.el_.hasChildNodes()){for(var z=t.el_.childNodes,Y=z.length,J=[];Y--;){var te=z[Y],Q=te.nodeName.toLowerCase();Q==="track"&&(t.featuresNativeTextTracks?(t.remoteTextTrackEls().addTrackElement_(te),t.remoteTextTracks().addTrack(te.track),t.textTracks().addTrack(te.track),!U&&!t.el_.hasAttribute("crossorigin")&&ar(te.src)&&(U=!0)):J.push(te))}for(var ne=0;ne<J.length;ne++)t.el_.removeChild(J[ne])}return t.proxyNativeTracks_(),t.featuresNativeTextTracks&&U&&$.warn(`Text Tracks are being loaded from another origin but the crossorigin attribute isn't used.
This may prevent text tracks from loading.`),t.restoreMetadataTracksInIOSNativePlayer_(),(Pe||Ge||Ne)&&r.nativeControlsForTouch===!0&&t.setControls(!0),t.proxyWebkitFullscreen_(),t.triggerReady(),t}var o=T.prototype;return o.dispose=function(){this.el_&&this.el_.resetSourceset_&&this.el_.resetSourceset_(),T.disposeMediaElement(this.el_),this.options_=null,g.prototype.dispose.call(this)},o.setupSourcesetHandling_=function(){Qa(this)},o.restoreMetadataTracksInIOSNativePlayer_=function(){var e=this.textTracks(),t,b=function(){t=[];for(var Y=0;Y<e.length;Y++){var J=e[Y];J.kind==="metadata"&&t.push({track:J,storedMode:J.mode})}};b(),e.addEventListener("change",b),this.on("dispose",function(){return e.removeEventListener("change",b)});var U=function z(){for(var Y=0;Y<t.length;Y++){var J=t[Y];J.track.mode==="disabled"&&J.track.mode!==J.storedMode&&(J.track.mode=J.storedMode)}e.removeEventListener("change",z)};this.on("webkitbeginfullscreen",function(){e.removeEventListener("change",b),e.removeEventListener("change",U),e.addEventListener("change",U)}),this.on("webkitendfullscreen",function(){e.removeEventListener("change",b),e.addEventListener("change",b),e.removeEventListener("change",U)})},o.overrideNative_=function(e,t){var b=this;if(t===this["featuresNative"+e+"Tracks"]){var U=e.toLowerCase();this[U+"TracksListeners_"]&&Object.keys(this[U+"TracksListeners_"]).forEach(function(z){var Y=b.el()[U+"Tracks"];Y.removeEventListener(z,b[U+"TracksListeners_"][z])}),this["featuresNative"+e+"Tracks"]=!t,this[U+"TracksListeners_"]=null,this.proxyNativeTracksForType_(U)}},o.overrideNativeAudioTracks=function(e){this.overrideNative_("Audio",e)},o.overrideNativeVideoTracks=function(e){this.overrideNative_("Video",e)},o.proxyNativeTracksForType_=function(e){var t=this,b=tt[e],U=this.el()[b.getterName],z=this[b.getterName]();if(!(!this["featuresNative"+b.capitalName+"Tracks"]||!U||!U.addEventListener)){var Y={change:function(Q){var ne={type:"change",target:z,currentTarget:z,srcElement:z};z.trigger(ne),e==="text"&&t[kt.remoteText.getterName]().trigger(ne)},addtrack:function(Q){z.addTrack(Q.track)},removetrack:function(Q){z.removeTrack(Q.track)}},J=function(){for(var Q=[],ne=0;ne<z.length;ne++){for(var fe=!1,Se=0;Se<U.length;Se++)if(U[Se]===z[ne]){fe=!0;break}fe||Q.push(z[ne])}for(;Q.length;)z.removeTrack(Q.shift())};this[b.getterName+"Listeners_"]=Y,Object.keys(Y).forEach(function(te){var Q=Y[te];U.addEventListener(te,Q),t.on("dispose",function(ne){return U.removeEventListener(te,Q)})}),this.on("loadstart",J),this.on("dispose",function(te){return t.off("loadstart",J)})}},o.proxyNativeTracks_=function(){var e=this;tt.names.forEach(function(t){e.proxyNativeTracksForType_(t)})},o.createEl=function(){var e=this.options_.tag;if(!e||!(this.options_.playerElIngest||this.movingMediaElementInDOM)){if(e){var t=e.cloneNode(!0);e.parentNode&&e.parentNode.insertBefore(t,e),T.disposeMediaElement(e),e=t}else{e=E.default.createElement("video");var b=this.options_.tag&&Ze(this.options_.tag),U=xe({},b);(!Pe||this.options_.nativeControlsForTouch!==!0)&&delete U.controls,Jt(e,se(U,{id:this.options_.techId,class:"vjs-tech"}))}e.playerId=this.options_.playerId}typeof this.options_.preload!="undefined"&&pt(e,"preload",this.options_.preload),this.options_.disablePictureInPicture!==void 0&&(e.disablePictureInPicture=this.options_.disablePictureInPicture);for(var z=["loop","muted","playsinline","autoplay"],Y=0;Y<z.length;Y++){var J=z[Y],te=this.options_[J];typeof te!="undefined"&&(te?pt(e,J,J):Dt(e,J),e[J]=te)}return e},o.handleLateInit_=function(e){if(!(e.networkState===0||e.networkState===3)){if(e.readyState===0){var t=!1,b=function(){t=!0};this.on("loadstart",b);var U=function(){t||this.trigger("loadstart")};this.on("loadedmetadata",U),this.ready(function(){this.off("loadstart",b),this.off("loadedmetadata",U),t||this.trigger("loadstart")});return}var z=["loadstart"];z.push("loadedmetadata"),e.readyState>=2&&z.push("loadeddata"),e.readyState>=3&&z.push("canplay"),e.readyState>=4&&z.push("canplaythrough"),this.ready(function(){z.forEach(function(Y){this.trigger(Y)},this)})}},o.setScrubbing=function(e){this.isScrubbing_=e},o.scrubbing=function(){return this.isScrubbing_},o.setCurrentTime=function(e){try{this.isScrubbing_&&this.el_.fastSeek&&Ce?this.el_.fastSeek(e):this.el_.currentTime=e}catch(t){$(t,"Video is not ready. (Video.js)")}},o.duration=function(){var e=this;if(this.el_.duration===Infinity&&Le&&de&&this.el_.currentTime===0){var t=function b(){e.el_.currentTime>0&&(e.el_.duration===Infinity&&e.trigger("durationchange"),e.off("timeupdate",b))};return this.on("timeupdate",t),NaN}return this.el_.duration||NaN},o.width=function(){return this.el_.offsetWidth},o.height=function(){return this.el_.offsetHeight},o.proxyWebkitFullscreen_=function(){var e=this;if("webkitDisplayingFullscreen"in this.el_){var t=function(){this.trigger("fullscreenchange",{isFullscreen:!1})},b=function(){"webkitPresentationMode"in this.el_&&this.el_.webkitPresentationMode!=="picture-in-picture"&&(this.one("webkitendfullscreen",t),this.trigger("fullscreenchange",{isFullscreen:!0,nativeIOSFullscreen:!0}))};this.on("webkitbeginfullscreen",b),this.on("dispose",function(){e.off("webkitbeginfullscreen",b),e.off("webkitendfullscreen",t)})}},o.supportsFullScreen=function(){if(typeof this.el_.webkitEnterFullScreen=="function"){var e=d.default.navigator&&d.default.navigator.userAgent||"";if(/Android/.test(e)||!/Chrome|Mac OS X 10.5/.test(e))return!0}return!1},o.enterFullScreen=function(){var e=this.el_;if(e.paused&&e.networkState<=e.HAVE_METADATA)ot(this.el_.play()),this.setTimeout(function(){e.pause();try{e.webkitEnterFullScreen()}catch(t){this.trigger("fullscreenerror",t)}},0);else try{e.webkitEnterFullScreen()}catch(t){this.trigger("fullscreenerror",t)}},o.exitFullScreen=function(){if(!this.el_.webkitDisplayingFullscreen){this.trigger("fullscreenerror",new Error("The video is not fullscreen"));return}this.el_.webkitExitFullScreen()},o.requestPictureInPicture=function(){return this.el_.requestPictureInPicture()},o.src=function(e){if(e===void 0)return this.el_.src;this.setSrc(e)},o.reset=function(){T.resetMediaElement(this.el_)},o.currentSrc=function(){return this.currentSource_?this.currentSource_.src:this.el_.currentSrc},o.setControls=function(e){this.el_.controls=!!e},o.addTextTrack=function(e,t,b){return this.featuresNativeTextTracks?this.el_.addTextTrack(e,t,b):g.prototype.addTextTrack.call(this,e,t,b)},o.createRemoteTextTrack=function(e){if(!this.featuresNativeTextTracks)return g.prototype.createRemoteTextTrack.call(this,e);var t=E.default.createElement("track");return e.kind&&(t.kind=e.kind),e.label&&(t.label=e.label),(e.language||e.srclang)&&(t.srclang=e.language||e.srclang),e.default&&(t.default=e.default),e.id&&(t.id=e.id),e.src&&(t.src=e.src),t},o.addRemoteTextTrack=function(e,t){var b=g.prototype.addRemoteTextTrack.call(this,e,t);return this.featuresNativeTextTracks&&this.el().appendChild(b),b},o.removeRemoteTextTrack=function(e){if(g.prototype.removeRemoteTextTrack.call(this,e),this.featuresNativeTextTracks)for(var t=this.$$("track"),b=t.length;b--;)(e===t[b]||e===t[b].track)&&this.el().removeChild(t[b])},o.getVideoPlaybackQuality=function(){if(typeof this.el().getVideoPlaybackQuality=="function")return this.el().getVideoPlaybackQuality();var e={};return typeof this.el().webkitDroppedFrameCount!="undefined"&&typeof this.el().webkitDecodedFrameCount!="undefined"&&(e.droppedVideoFrames=this.el().webkitDroppedFrameCount,e.totalVideoFrames=this.el().webkitDecodedFrameCount),d.default.performance&&typeof d.default.performance.now=="function"?e.creationTime=d.default.performance.now():d.default.performance&&d.default.performance.timing&&typeof d.default.performance.timing.navigationStart=="number"&&(e.creationTime=d.default.Date.now()-d.default.performance.timing.navigationStart),e},T}(Re);ui(he,"TEST_VID",function(){if(!!ze()){var g=E.default.createElement("video"),T=E.default.createElement("track");return T.kind="captions",T.srclang="en",T.label="English",g.appendChild(T),g}}),he.isSupported=function(){try{he.TEST_VID.volume=.5}catch(g){return!1}return!!(he.TEST_VID&&he.TEST_VID.canPlayType)},he.canPlayType=function(g){return he.TEST_VID.canPlayType(g)},he.canPlaySource=function(g,T){return he.canPlayType(g.type)},he.canControlVolume=function(){try{var g=he.TEST_VID.volume;return he.TEST_VID.volume=g/2+.1,g!==he.TEST_VID.volume}catch(T){return!1}},he.canMuteVolume=function(){try{var g=he.TEST_VID.muted;return he.TEST_VID.muted=!g,he.TEST_VID.muted?pt(he.TEST_VID,"muted","muted"):Dt(he.TEST_VID,"muted","muted"),g!==he.TEST_VID.muted}catch(T){return!1}},he.canControlPlaybackRate=function(){if(Le&&de&&ge<58)return!1;try{var g=he.TEST_VID.playbackRate;return he.TEST_VID.playbackRate=g/2+.1,g!==he.TEST_VID.playbackRate}catch(T){return!1}},he.canOverrideAttributes=function(){try{var g=function(){};Object.defineProperty(E.default.createElement("video"),"src",{get:g,set:g}),Object.defineProperty(E.default.createElement("audio"),"src",{get:g,set:g}),Object.defineProperty(E.default.createElement("video"),"innerHTML",{get:g,set:g}),Object.defineProperty(E.default.createElement("audio"),"innerHTML",{get:g,set:g})}catch(T){return!1}return!0},he.supportsNativeTextTracks=function(){return Ce||be&&de},he.supportsNativeVideoTracks=function(){return!!(he.TEST_VID&&he.TEST_VID.videoTracks)},he.supportsNativeAudioTracks=function(){return!!(he.TEST_VID&&he.TEST_VID.audioTracks)},he.Events=["loadstart","suspend","abort","error","emptied","stalled","loadedmetadata","loadeddata","canplay","canplaythrough","playing","waiting","seeking","seeked","ended","durationchange","timeupdate","progress","play","pause","ratechange","resize","volumechange"],[["featuresVolumeControl","canControlVolume"],["featuresMuteControl","canMuteVolume"],["featuresPlaybackRate","canControlPlaybackRate"],["featuresSourceset","canOverrideAttributes"],["featuresNativeTextTracks","supportsNativeTextTracks"],["featuresNativeVideoTracks","supportsNativeVideoTracks"],["featuresNativeAudioTracks","supportsNativeAudioTracks"]].forEach(function(g){var T=g[0],o=g[1];ui(he.prototype,T,function(){return he[o]()},!0)}),he.prototype.movingMediaElementInDOM=!be,he.prototype.featuresFullscreenResize=!0,he.prototype.featuresProgressEvents=!0,he.prototype.featuresTimeupdateEvents=!0;var hr;he.patchCanPlayType=function(){Be>=4&&!Ke&&!de&&(hr=he.TEST_VID&&he.TEST_VID.constructor.prototype.canPlayType,he.TEST_VID.constructor.prototype.canPlayType=function(g){var T=/^application\/(?:x-|vnd\.apple\.)mpegurl/i;return g&&T.test(g)?"maybe":hr.call(this,g)})},he.unpatchCanPlayType=function(){var g=he.TEST_VID.constructor.prototype.canPlayType;return hr&&(he.TEST_VID.constructor.prototype.canPlayType=hr),g},he.patchCanPlayType(),he.disposeMediaElement=function(g){if(!!g){for(g.parentNode&&g.parentNode.removeChild(g);g.hasChildNodes();)g.removeChild(g.firstChild);g.removeAttribute("src"),typeof g.load=="function"&&function(){try{g.load()}catch(T){}}()}},he.resetMediaElement=function(g){if(!!g){for(var T=g.querySelectorAll("source"),o=T.length;o--;)g.removeChild(T[o]);g.removeAttribute("src"),typeof g.load=="function"&&function(){try{g.load()}catch(r){}}()}},["muted","defaultMuted","autoplay","controls","loop","playsinline"].forEach(function(g){he.prototype[g]=function(){return this.el_[g]||this.el_.hasAttribute(g)}}),["muted","defaultMuted","autoplay","loop","playsinline"].forEach(function(g){he.prototype["set"+Ue(g)]=function(T){this.el_[g]=T,T?this.el_.setAttribute(g,g):this.el_.removeAttribute(g)}}),["paused","currentTime","buffered","volume","poster","preload","error","seeking","seekable","ended","playbackRate","defaultPlaybackRate","disablePictureInPicture","played","networkState","readyState","videoWidth","videoHeight","crossOrigin"].forEach(function(g){he.prototype[g]=function(){return this.el_[g]}}),["volume","src","poster","preload","playbackRate","defaultPlaybackRate","disablePictureInPicture","crossOrigin"].forEach(function(g){he.prototype["set"+Ue(g)]=function(T){this.el_[g]=T}}),["pause","load","play"].forEach(function(g){he.prototype[g]=function(){return this.el_[g]()}}),Re.withSourceHandlers(he),he.nativeSourceHandler={},he.nativeSourceHandler.canPlayType=function(g){try{return he.TEST_VID.canPlayType(g)}catch(T){return""}},he.nativeSourceHandler.canHandleSource=function(g,T){if(g.type)return he.nativeSourceHandler.canPlayType(g.type);if(g.src){var o=Br(g.src);return he.nativeSourceHandler.canPlayType("video/"+o)}return""},he.nativeSourceHandler.handleSource=function(g,T,o){T.setSrc(g.src)},he.nativeSourceHandler.dispose=function(){},he.registerSourceHandler(he.nativeSourceHandler),Re.registerTech("Html5",he);var Rn=["progress","abort","suspend","emptied","stalled","loadedmetadata","loadeddata","timeupdate","resize","volumechange","texttrackchange"],ci={canplay:"CanPlay",canplaythrough:"CanPlayThrough",playing:"Playing",seeked:"Seeked"},di=["tiny","xsmall","small","medium","large","xlarge","huge"],vr={};di.forEach(function(g){var T=g.charAt(0)==="x"?"x-"+g.substring(1):g;vr[g]="vjs-layout-"+T});var Ja={tiny:210,xsmall:320,small:425,medium:768,large:1440,xlarge:2560,huge:Infinity},je=function(g){i.default(T,g);function T(r,e,t){var b;if(r.id=r.id||e.id||"vjs_video_"+mt(),e=se(T.getTagSettings(r),e),e.initChildren=!1,e.createEl=!1,e.evented=!1,e.reportTouchActivity=!1,!e.language)if(typeof r.closest=="function"){var U=r.closest("[lang]");U&&U.getAttribute&&(e.language=U.getAttribute("lang"))}else for(var z=r;z&&z.nodeType===1;){if(Ze(z).hasOwnProperty("lang")){e.language=z.getAttribute("lang");break}z=z.parentNode}if(b=g.call(this,null,e,t)||this,b.boundDocumentFullscreenChange_=function(Q){return b.documentFullscreenChange_(Q)},b.boundFullWindowOnEscKey_=function(Q){return b.fullWindowOnEscKey(Q)},b.boundUpdateStyleEl_=function(Q){return b.updateStyleEl_(Q)},b.boundApplyInitTime_=function(Q){return b.applyInitTime_(Q)},b.boundUpdateCurrentBreakpoint_=function(Q){return b.updateCurrentBreakpoint_(Q)},b.boundHandleTechClick_=function(Q){return b.handleTechClick_(Q)},b.boundHandleTechDoubleClick_=function(Q){return b.handleTechDoubleClick_(Q)},b.boundHandleTechTouchStart_=function(Q){return b.handleTechTouchStart_(Q)},b.boundHandleTechTouchMove_=function(Q){return b.handleTechTouchMove_(Q)},b.boundHandleTechTouchEnd_=function(Q){return b.handleTechTouchEnd_(Q)},b.boundHandleTechTap_=function(Q){return b.handleTechTap_(Q)},b.isFullscreen_=!1,b.log=q(b.id_),b.fsApi_=D,b.isPosterFromTech_=!1,b.queuedCallbacks_=[],b.isReady_=!1,b.hasStarted_=!1,b.userActive_=!1,b.debugEnabled_=!1,!b.options_||!b.options_.techOrder||!b.options_.techOrder.length)throw new Error("No techOrder specified. Did you overwrite videojs.options instead of just changing the properties you want to override?");if(b.tag=r,b.tagAttributes=r&&Ze(r),b.language(b.options_.language),e.languages){var Y={};Object.getOwnPropertyNames(e.languages).forEach(function(Q){Y[Q.toLowerCase()]=e.languages[Q]}),b.languages_=Y}else b.languages_=T.prototype.options_.languages;b.resetCache_(),b.poster_=e.poster||"",b.controls_=!!e.controls,r.controls=!1,r.removeAttribute("controls"),b.changingSrc_=!1,b.playCallbacks_=[],b.playTerminatedQueue_=[],r.hasAttribute("autoplay")?b.autoplay(!0):b.autoplay(b.options_.autoplay),e.plugins&&Object.keys(e.plugins).forEach(function(Q){if(typeof b[Q]!="function")throw new Error('plugin "'+Q+'" does not exist')}),b.scrubbing_=!1,b.el_=b.createEl(),Pr(a.default(b),{eventBusKey:"el_"}),b.fsApi_.requestFullscreen&&(qe(E.default,b.fsApi_.fullscreenchange,b.boundDocumentFullscreenChange_),b.on(b.fsApi_.fullscreenchange,b.boundDocumentFullscreenChange_)),b.fluid_&&b.on(["playerreset","resize"],b.boundUpdateStyleEl_);var J=xe(b.options_);e.plugins&&Object.keys(e.plugins).forEach(function(Q){b[Q](e.plugins[Q])}),e.debug&&b.debug(!0),b.options_.playerOptions=J,b.middleware_=[],b.playbackRates(e.playbackRates),b.initChildren(),b.isAudio(r.nodeName.toLowerCase()==="audio"),b.controls()?b.addClass("vjs-controls-enabled"):b.addClass("vjs-controls-disabled"),b.el_.setAttribute("role","region"),b.isAudio()?b.el_.setAttribute("aria-label",b.localize("Audio Player")):b.el_.setAttribute("aria-label",b.localize("Video Player")),b.isAudio()&&b.addClass("vjs-audio"),b.flexNotSupported_()&&b.addClass("vjs-no-flex"),Pe&&b.addClass("vjs-touch-enabled"),be||b.addClass("vjs-workinghover"),T.players[b.id_]=a.default(b);var te=S.split(".")[0];return b.addClass("vjs-v"+te),b.userActive(!0),b.reportUserActivity(),b.one("play",function(Q){return b.listenForUserActivity_(Q)}),b.on("stageclick",function(Q){return b.handleStageClick_(Q)}),b.on("keydown",function(Q){return b.handleKeyDown(Q)}),b.on("languagechange",function(Q){return b.handleLanguagechange(Q)}),b.breakpoints(b.options_.breakpoints),b.responsive(b.options_.responsive),b}var o=T.prototype;return o.dispose=function(){var e=this;this.trigger("dispose"),this.off("dispose"),Ve(E.default,this.fsApi_.fullscreenchange,this.boundDocumentFullscreenChange_),Ve(E.default,"keydown",this.boundFullWindowOnEscKey_),this.styleEl_&&this.styleEl_.parentNode&&(this.styleEl_.parentNode.removeChild(this.styleEl_),this.styleEl_=null),T.players[this.id_]=null,this.tag&&this.tag.player&&(this.tag.player=null),this.el_&&this.el_.player&&(this.el_.player=null),this.tech_&&(this.tech_.dispose(),this.isPosterFromTech_=!1,this.poster_=""),this.playerElIngest_&&(this.playerElIngest_=null),this.tag&&(this.tag=null),ma(this),$e.names.forEach(function(t){var b=$e[t],U=e[b.getterName]();U&&U.off&&U.off()}),g.prototype.dispose.call(this)},o.createEl=function(){var e=this.tag,t,b=this.playerElIngest_=e.parentNode&&e.parentNode.hasAttribute&&e.parentNode.hasAttribute("data-vjs-player"),U=this.tag.tagName.toLowerCase()==="video-js";b?t=this.el_=e.parentNode:U||(t=this.el_=g.prototype.createEl.call(this,"div"));var z=Ze(e);if(U){for(t=this.el_=e,e=this.tag=E.default.createElement("video");t.children.length;)e.appendChild(t.firstChild);ct(t,"video-js")||et(t,"video-js"),t.appendChild(e),b=this.playerElIngest_=t,Object.keys(t).forEach(function(fe){try{e[fe]=t[fe]}catch(Se){}})}if(e.setAttribute("tabindex","-1"),z.tabindex="-1",(ve||de&&Fe)&&(e.setAttribute("role","application"),z.role="application"),e.removeAttribute("width"),e.removeAttribute("height"),"width"in z&&delete z.width,"height"in z&&delete z.height,Object.getOwnPropertyNames(z).forEach(function(fe){U&&fe==="class"||t.setAttribute(fe,z[fe]),U&&e.setAttribute(fe,z[fe])}),e.playerId=e.id,e.id+="_html5_api",e.className="vjs-tech",e.player=t.player=this,this.addClass("vjs-paused"),d.default.VIDEOJS_NO_DYNAMIC_STYLE!==!0){this.styleEl_=Ci("vjs-styles-dimensions");var Y=gt(".vjs-styles-defaults"),J=gt("head");J.insertBefore(this.styleEl_,Y?Y.nextSibling:J.firstChild)}this.fill_=!1,this.fluid_=!1,this.width(this.options_.width),this.height(this.options_.height),this.fill(this.options_.fill),this.fluid(this.options_.fluid),this.aspectRatio(this.options_.aspectRatio),this.crossOrigin(this.options_.crossOrigin||this.options_.crossorigin);for(var te=e.getElementsByTagName("a"),Q=0;Q<te.length;Q++){var ne=te.item(Q);et(ne,"vjs-hidden"),ne.setAttribute("hidden","hidden")}return e.initNetworkState_=e.networkState,e.parentNode&&!b&&e.parentNode.insertBefore(t,e),Tt(e,t),this.children_.unshift(e),this.el_.setAttribute("lang",this.language_),this.el_.setAttribute("translate","no"),this.el_=t,t},o.crossOrigin=function(e){if(!e)return this.techGet_("crossOrigin");if(e!=="anonymous"&&e!=="use-credentials"){$.warn('crossOrigin must be "anonymous" or "use-credentials", given "'+e+'"');return}this.techCall_("setCrossOrigin",e)},o.width=function(e){return this.dimension("width",e)},o.height=function(e){return this.dimension("height",e)},o.dimension=function(e,t){var b=e+"_";if(t===void 0)return this[b]||0;if(t===""||t==="auto"){this[b]=void 0,this.updateStyleEl_();return}var U=parseFloat(t);if(isNaN(U)){$.error('Improper value "'+t+'" supplied for for '+e);return}this[b]=U,this.updateStyleEl_()},o.fluid=function(e){var t=this;if(e===void 0)return!!this.fluid_;this.fluid_=!!e,ft(this)&&this.off(["playerreset","resize"],this.boundUpdateStyleEl_),e?(this.addClass("vjs-fluid"),this.fill(!1),Hn(this,function(){t.on(["playerreset","resize"],t.boundUpdateStyleEl_)})):this.removeClass("vjs-fluid"),this.updateStyleEl_()},o.fill=function(e){if(e===void 0)return!!this.fill_;this.fill_=!!e,e?(this.addClass("vjs-fill"),this.fluid(!1)):this.removeClass("vjs-fill")},o.aspectRatio=function(e){if(e===void 0)return this.aspectRatio_;if(!/^\d+\:\d+$/.test(e))throw new Error("Improper value supplied for aspect ratio. The format should be width:height, for example 16:9.");this.aspectRatio_=e,this.fluid(!0),this.updateStyleEl_()},o.updateStyleEl_=function(){if(d.default.VIDEOJS_NO_DYNAMIC_STYLE===!0){var e=typeof this.width_=="number"?this.width_:this.options_.width,t=typeof this.height_=="number"?this.height_:this.options_.height,b=this.tech_&&this.tech_.el();b&&(e>=0&&(b.width=e),t>=0&&(b.height=t));return}var U,z,Y,J;this.aspectRatio_!==void 0&&this.aspectRatio_!=="auto"?Y=this.aspectRatio_:this.videoWidth()>0?Y=this.videoWidth()+":"+this.videoHeight():Y="16:9";var te=Y.split(":"),Q=te[1]/te[0];this.width_!==void 0?U=this.width_:this.height_!==void 0?U=this.height_/Q:U=this.videoWidth()||300,this.height_!==void 0?z=this.height_:z=U*Q,/^[^a-zA-Z]/.test(this.id())?J="dimensions-"+this.id():J=this.id()+"-dimensions",this.addClass(J),Ai(this.styleEl_,`
      .`+J+` {
        width: `+U+`px;
        height: `+z+`px;
      }

      .`+J+`.vjs-fluid {
        padding-top: `+Q*100+`%;
      }
    `)},o.loadTech_=function(e,t){var b=this;this.tech_&&this.unloadTech_();var U=Ue(e),z=e.charAt(0).toLowerCase()+e.slice(1);U!=="Html5"&&this.tag&&(Re.getTech("Html5").disposeMediaElement(this.tag),this.tag.player=null,this.tag=null),this.techName_=U,this.isReady_=!1;var Y=this.autoplay();(typeof this.autoplay()=="string"||this.autoplay()===!0&&this.options_.normalizeAutoplay)&&(Y=!1);var J={source:t,autoplay:Y,nativeControlsForTouch:this.options_.nativeControlsForTouch,playerId:this.id(),techId:this.id()+"_"+z+"_api",playsinline:this.options_.playsinline,preload:this.options_.preload,loop:this.options_.loop,disablePictureInPicture:this.options_.disablePictureInPicture,muted:this.options_.muted,poster:this.poster(),language:this.language(),playerElIngest:this.playerElIngest_||!1,"vtt.js":this.options_["vtt.js"],canOverridePoster:!!this.options_.techCanOverridePoster,enableSourceset:this.options_.enableSourceset,Promise:this.options_.Promise};$e.names.forEach(function(Q){var ne=$e[Q];J[ne.getterName]=b[ne.privateName]}),se(J,this.options_[U]),se(J,this.options_[z]),se(J,this.options_[e.toLowerCase()]),this.tag&&(J.tag=this.tag),t&&t.src===this.cache_.src&&this.cache_.currentTime>0&&(J.startTime=this.cache_.currentTime);var te=Re.getTech(e);if(!te)throw new Error("No Tech named '"+U+"' exists! '"+U+"' should be registered using videojs.registerTech()'");this.tech_=new te(J),this.tech_.ready(Oe(this,this.handleTechReady_),!0),ki.jsonToTextTracks(this.textTracksJson_||[],this.tech_),Rn.forEach(function(Q){b.on(b.tech_,Q,function(ne){return b["handleTech"+Ue(Q)+"_"](ne)})}),Object.keys(ci).forEach(function(Q){b.on(b.tech_,Q,function(ne){if(b.tech_.playbackRate()===0&&b.tech_.seeking()){b.queuedCallbacks_.push({callback:b["handleTech"+ci[Q]+"_"].bind(b),event:ne});return}b["handleTech"+ci[Q]+"_"](ne)})}),this.on(this.tech_,"loadstart",function(Q){return b.handleTechLoadStart_(Q)}),this.on(this.tech_,"sourceset",function(Q){return b.handleTechSourceset_(Q)}),this.on(this.tech_,"waiting",function(Q){return b.handleTechWaiting_(Q)}),this.on(this.tech_,"ended",function(Q){return b.handleTechEnded_(Q)}),this.on(this.tech_,"seeking",function(Q){return b.handleTechSeeking_(Q)}),this.on(this.tech_,"play",function(Q){return b.handleTechPlay_(Q)}),this.on(this.tech_,"firstplay",function(Q){return b.handleTechFirstPlay_(Q)}),this.on(this.tech_,"pause",function(Q){return b.handleTechPause_(Q)}),this.on(this.tech_,"durationchange",function(Q){return b.handleTechDurationChange_(Q)}),this.on(this.tech_,"fullscreenchange",function(Q,ne){return b.handleTechFullscreenChange_(Q,ne)}),this.on(this.tech_,"fullscreenerror",function(Q,ne){return b.handleTechFullscreenError_(Q,ne)}),this.on(this.tech_,"enterpictureinpicture",function(Q){return b.handleTechEnterPictureInPicture_(Q)}),this.on(this.tech_,"leavepictureinpicture",function(Q){return b.handleTechLeavePictureInPicture_(Q)}),this.on(this.tech_,"error",function(Q){return b.handleTechError_(Q)}),this.on(this.tech_,"posterchange",function(Q){return b.handleTechPosterChange_(Q)}),this.on(this.tech_,"textdata",function(Q){return b.handleTechTextData_(Q)}),this.on(this.tech_,"ratechange",function(Q){return b.handleTechRateChange_(Q)}),this.on(this.tech_,"loadedmetadata",this.boundUpdateStyleEl_),this.usingNativeControls(this.techGet_("controls")),this.controls()&&!this.usingNativeControls()&&this.addTechControlsListeners_(),this.tech_.el().parentNode!==this.el()&&(U!=="Html5"||!this.tag)&&Tt(this.tech_.el(),this.el()),this.tag&&(this.tag.player=null,this.tag=null)},o.unloadTech_=function(){var e=this;$e.names.forEach(function(t){var b=$e[t];e[b.privateName]=e[b.getterName]()}),this.textTracksJson_=ki.textTracksToJson(this.tech_),this.isReady_=!1,this.tech_.dispose(),this.tech_=!1,this.isPosterFromTech_&&(this.poster_="",this.trigger("posterchange")),this.isPosterFromTech_=!1},o.tech=function(e){return e===void 0&&$.warn(`Using the tech directly can be dangerous. I hope you know what you're doing.
See https://github.com/videojs/video.js/issues/2617 for more info.
`),this.tech_},o.addTechControlsListeners_=function(){this.removeTechControlsListeners_(),this.on(this.tech_,"click",this.boundHandleTechClick_),this.on(this.tech_,"dblclick",this.boundHandleTechDoubleClick_),this.on(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.on(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.on(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.on(this.tech_,"tap",this.boundHandleTechTap_)},o.removeTechControlsListeners_=function(){this.off(this.tech_,"tap",this.boundHandleTechTap_),this.off(this.tech_,"touchstart",this.boundHandleTechTouchStart_),this.off(this.tech_,"touchmove",this.boundHandleTechTouchMove_),this.off(this.tech_,"touchend",this.boundHandleTechTouchEnd_),this.off(this.tech_,"click",this.boundHandleTechClick_),this.off(this.tech_,"dblclick",this.boundHandleTechDoubleClick_)},o.handleTechReady_=function(){this.triggerReady(),this.cache_.volume&&this.techCall_("setVolume",this.cache_.volume),this.handleTechPosterChange_(),this.handleTechDurationChange_()},o.handleTechLoadStart_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-seeking"),this.error(null),this.handleTechDurationChange_(),this.paused()?(this.hasStarted(!1),this.trigger("loadstart")):(this.trigger("loadstart"),this.trigger("firstplay")),this.manualAutoplay_(this.autoplay()===!0&&this.options_.normalizeAutoplay?"play":this.autoplay())},o.manualAutoplay_=function(e){var t=this;if(!(!this.tech_||typeof e!="string")){var b=function(){var Y=t.muted();t.muted(!0);var J=function(){t.muted(Y)};t.playTerminatedQueue_.push(J);var te=t.play();if(!!Gt(te))return te.catch(function(Q){throw J(),new Error("Rejection at manualAutoplay. Restoring muted value. "+(Q||""))})},U;if(e==="any"&&!this.muted()?(U=this.play(),Gt(U)&&(U=U.catch(b))):e==="muted"&&!this.muted()?U=b():U=this.play(),!!Gt(U))return U.then(function(){t.trigger({type:"autoplay-success",autoplay:e})}).catch(function(){t.trigger({type:"autoplay-failure",autoplay:e})})}},o.updateSourceCaches_=function(e){e===void 0&&(e="");var t=e,b="";typeof t!="string"&&(t=e.src,b=e.type),this.cache_.source=this.cache_.source||{},this.cache_.sources=this.cache_.sources||[],t&&!b&&(b=Ta(this,t)),this.cache_.source=xe({},e,{src:t,type:b});for(var U=this.cache_.sources.filter(function(ne){return ne.src&&ne.src===t}),z=[],Y=this.$$("source"),J=[],te=0;te<Y.length;te++){var Q=Ze(Y[te]);z.push(Q),Q.src&&Q.src===t&&J.push(Q.src)}J.length&&!U.length?this.cache_.sources=z:U.length||(this.cache_.sources=[this.cache_.source]),this.cache_.src=t},o.handleTechSourceset_=function(e){var t=this;if(!this.changingSrc_){var b=function(J){return t.updateSourceCaches_(J)},U=this.currentSource().src,z=e.src;U&&!/^blob:/.test(U)&&/^blob:/.test(z)&&(!this.lastSource_||this.lastSource_.tech!==z&&this.lastSource_.player!==U)&&(b=function(){}),b(z),e.src||this.tech_.any(["sourceset","loadstart"],function(Y){if(Y.type!=="sourceset"){var J=t.techGet("currentSrc");t.lastSource_.tech=J,t.updateSourceCaches_(J)}})}this.lastSource_={player:this.currentSource().src,tech:e.src},this.trigger({src:e.src,type:"sourceset"})},o.hasStarted=function(e){if(e===void 0)return this.hasStarted_;e!==this.hasStarted_&&(this.hasStarted_=e,this.hasStarted_?(this.addClass("vjs-has-started"),this.trigger("firstplay")):this.removeClass("vjs-has-started"))},o.handleTechPlay_=function(){this.removeClass("vjs-ended"),this.removeClass("vjs-paused"),this.addClass("vjs-playing"),this.hasStarted(!0),this.trigger("play")},o.handleTechRateChange_=function(){this.tech_.playbackRate()>0&&this.cache_.lastPlaybackRate===0&&(this.queuedCallbacks_.forEach(function(e){return e.callback(e.event)}),this.queuedCallbacks_=[]),this.cache_.lastPlaybackRate=this.tech_.playbackRate(),this.trigger("ratechange")},o.handleTechWaiting_=function(){var e=this;this.addClass("vjs-waiting"),this.trigger("waiting");var t=this.currentTime(),b=function U(){t!==e.currentTime()&&(e.removeClass("vjs-waiting"),e.off("timeupdate",U))};this.on("timeupdate",b)},o.handleTechCanPlay_=function(){this.removeClass("vjs-waiting"),this.trigger("canplay")},o.handleTechCanPlayThrough_=function(){this.removeClass("vjs-waiting"),this.trigger("canplaythrough")},o.handleTechPlaying_=function(){this.removeClass("vjs-waiting"),this.trigger("playing")},o.handleTechSeeking_=function(){this.addClass("vjs-seeking"),this.trigger("seeking")},o.handleTechSeeked_=function(){this.removeClass("vjs-seeking"),this.removeClass("vjs-ended"),this.trigger("seeked")},o.handleTechFirstPlay_=function(){this.options_.starttime&&($.warn("Passing the `starttime` option to the player will be deprecated in 6.0"),this.currentTime(this.options_.starttime)),this.addClass("vjs-has-started"),this.trigger("firstplay")},o.handleTechPause_=function(){this.removeClass("vjs-playing"),this.addClass("vjs-paused"),this.trigger("pause")},o.handleTechEnded_=function(){this.addClass("vjs-ended"),this.removeClass("vjs-waiting"),this.options_.loop?(this.currentTime(0),this.play()):this.paused()||this.pause(),this.trigger("ended")},o.handleTechDurationChange_=function(){this.duration(this.techGet_("duration"))},o.handleTechClick_=function(e){!this.controls_||(this.options_===void 0||this.options_.userActions===void 0||this.options_.userActions.click===void 0||this.options_.userActions.click!==!1)&&(this.options_!==void 0&&this.options_.userActions!==void 0&&typeof this.options_.userActions.click=="function"?this.options_.userActions.click.call(this,e):this.paused()?ot(this.play()):this.pause())},o.handleTechDoubleClick_=function(e){if(!!this.controls_){var t=Array.prototype.some.call(this.$$(".vjs-control-bar, .vjs-modal-dialog"),function(b){return b.contains(e.target)});t||(this.options_===void 0||this.options_.userActions===void 0||this.options_.userActions.doubleClick===void 0||this.options_.userActions.doubleClick!==!1)&&(this.options_!==void 0&&this.options_.userActions!==void 0&&typeof this.options_.userActions.doubleClick=="function"?this.options_.userActions.doubleClick.call(this,e):this.isFullscreen()?this.exitFullscreen():this.requestFullscreen())}},o.handleTechTap_=function(){this.userActive(!this.userActive())},o.handleTechTouchStart_=function(){this.userWasActive=this.userActive()},o.handleTechTouchMove_=function(){this.userWasActive&&this.reportUserActivity()},o.handleTechTouchEnd_=function(e){e.cancelable&&e.preventDefault()},o.handleStageClick_=function(){this.reportUserActivity()},o.toggleFullscreenClass_=function(){this.isFullscreen()?this.addClass("vjs-fullscreen"):this.removeClass("vjs-fullscreen")},o.documentFullscreenChange_=function(e){var t=e.target.player;if(!(t&&t!==this)){var b=this.el(),U=E.default[this.fsApi_.fullscreenElement]===b;!U&&b.matches?U=b.matches(":"+this.fsApi_.fullscreen):!U&&b.msMatchesSelector&&(U=b.msMatchesSelector(":"+this.fsApi_.fullscreen)),this.isFullscreen(U)}},o.handleTechFullscreenChange_=function(e,t){t&&(t.nativeIOSFullscreen&&this.toggleClass("vjs-ios-native-fs"),this.isFullscreen(t.isFullscreen))},o.handleTechFullscreenError_=function(e,t){this.trigger("fullscreenerror",t)},o.togglePictureInPictureClass_=function(){this.isInPictureInPicture()?this.addClass("vjs-picture-in-picture"):this.removeClass("vjs-picture-in-picture")},o.handleTechEnterPictureInPicture_=function(e){this.isInPictureInPicture(!0)},o.handleTechLeavePictureInPicture_=function(e){this.isInPictureInPicture(!1)},o.handleTechError_=function(){var e=this.tech_.error();this.error(e)},o.handleTechTextData_=function(){var e=null;arguments.length>1&&(e=arguments[1]),this.trigger("textdata",e)},o.getCache=function(){return this.cache_},o.resetCache_=function(){this.cache_={currentTime:0,initTime:0,inactivityTimeout:this.options_.inactivityTimeout,duration:NaN,lastVolume:1,lastPlaybackRate:this.defaultPlaybackRate(),media:null,src:"",source:{},sources:[],playbackRates:[],volume:1}},o.techCall_=function(e,t){this.ready(function(){if(e in pa)return ha(this.middleware_,this.tech_,e,t);if(e in zi)return Vi(this.middleware_,this.tech_,e,t);try{this.tech_&&this.tech_[e](t)}catch(b){throw $(b),b}},!0)},o.techGet_=function(e){if(!(!this.tech_||!this.tech_.isReady_)){if(e in va)return fa(this.middleware_,this.tech_,e);if(e in zi)return Vi(this.middleware_,this.tech_,e);try{return this.tech_[e]()}catch(t){throw this.tech_[e]===void 0?($("Video.js: "+e+" method not defined for "+this.techName_+" playback technology.",t),t):t.name==="TypeError"?($("Video.js: "+e+" unavailable on "+this.techName_+" playback technology element.",t),this.tech_.isReady_=!1,t):($(t),t)}}},o.play=function(){var e=this,t=this.options_.Promise||d.default.Promise;return t?new t(function(b){e.play_(b)}):this.play_()},o.play_=function(e){var t=this;e===void 0&&(e=ot),this.playCallbacks_.push(e);var b=Boolean(!this.changingSrc_&&(this.src()||this.currentSrc()));if(this.waitToPlay_&&(this.off(["ready","loadstart"],this.waitToPlay_),this.waitToPlay_=null),!this.isReady_||!b){this.waitToPlay_=function(z){t.play_()},this.one(["ready","loadstart"],this.waitToPlay_),!b&&(Ce||be)&&this.load();return}var U=this.techGet_("play");U===null?this.runPlayTerminatedQueue_():this.runPlayCallbacks_(U)},o.runPlayTerminatedQueue_=function(){var e=this.playTerminatedQueue_.slice(0);this.playTerminatedQueue_=[],e.forEach(function(t){t()})},o.runPlayCallbacks_=function(e){var t=this.playCallbacks_.slice(0);this.playCallbacks_=[],this.playTerminatedQueue_=[],t.forEach(function(b){b(e)})},o.pause=function(){this.techCall_("pause")},o.paused=function(){return this.techGet_("paused")!==!1},o.played=function(){return this.techGet_("played")||bt(0,0)},o.scrubbing=function(e){if(typeof e=="undefined")return this.scrubbing_;this.scrubbing_=!!e,this.techCall_("setScrubbing",this.scrubbing_),e?this.addClass("vjs-scrubbing"):this.removeClass("vjs-scrubbing")},o.currentTime=function(e){if(typeof e!="undefined"){if(e<0&&(e=0),!this.isReady_||this.changingSrc_||!this.tech_||!this.tech_.isReady_){this.cache_.initTime=e,this.off("canplay",this.boundApplyInitTime_),this.one("canplay",this.boundApplyInitTime_);return}this.techCall_("setCurrentTime",e),this.cache_.initTime=0;return}return this.cache_.currentTime=this.techGet_("currentTime")||0,this.cache_.currentTime},o.applyInitTime_=function(){this.currentTime(this.cache_.initTime)},o.duration=function(e){if(e===void 0)return this.cache_.duration!==void 0?this.cache_.duration:NaN;e=parseFloat(e),e<0&&(e=Infinity),e!==this.cache_.duration&&(this.cache_.duration=e,e===Infinity?this.addClass("vjs-live"):this.removeClass("vjs-live"),isNaN(e)||this.trigger("durationchange"))},o.remainingTime=function(){return this.duration()-this.currentTime()},o.remainingTimeDisplay=function(){return Math.floor(this.duration())-Math.floor(this.currentTime())},o.buffered=function(){var e=this.techGet_("buffered");return(!e||!e.length)&&(e=bt(0,0)),e},o.bufferedPercent=function(){return xi(this.buffered(),this.duration())},o.bufferedEnd=function(){var e=this.buffered(),t=this.duration(),b=e.end(e.length-1);return b>t&&(b=t),b},o.volume=function(e){var t;if(e!==void 0){t=Math.max(0,Math.min(1,parseFloat(e))),this.cache_.volume=t,this.techCall_("setVolume",t),t>0&&this.lastVolume_(t);return}return t=parseFloat(this.techGet_("volume")),isNaN(t)?1:t},o.muted=function(e){if(e!==void 0){this.techCall_("setMuted",e);return}return this.techGet_("muted")||!1},o.defaultMuted=function(e){return e!==void 0?this.techCall_("setDefaultMuted",e):this.techGet_("defaultMuted")||!1},o.lastVolume_=function(e){if(e!==void 0&&e!==0){this.cache_.lastVolume=e;return}return this.cache_.lastVolume},o.supportsFullScreen=function(){return this.techGet_("supportsFullScreen")||!1},o.isFullscreen=function(e){if(e!==void 0){var t=this.isFullscreen_;this.isFullscreen_=Boolean(e),this.isFullscreen_!==t&&this.fsApi_.prefixed&&this.trigger("fullscreenchange"),this.toggleFullscreenClass_();return}return this.isFullscreen_},o.requestFullscreen=function(e){var t=this.options_.Promise||d.default.Promise;if(t){var b=this;return new t(function(U,z){function Y(){b.off("fullscreenerror",te),b.off("fullscreenchange",J)}function J(){Y(),U()}function te(ne,fe){Y(),z(fe)}b.one("fullscreenchange",J),b.one("fullscreenerror",te);var Q=b.requestFullscreenHelper_(e);Q&&(Q.then(Y,Y),Q.then(U,z))})}return this.requestFullscreenHelper_()},o.requestFullscreenHelper_=function(e){var t=this,b;if(this.fsApi_.prefixed||(b=this.options_.fullscreen&&this.options_.fullscreen.options||{},e!==void 0&&(b=e)),this.fsApi_.requestFullscreen){var U=this.el_[this.fsApi_.requestFullscreen](b);return U&&U.then(function(){return t.isFullscreen(!0)},function(){return t.isFullscreen(!1)}),U}else this.tech_.supportsFullScreen()&&!this.options_.preferFullWindow?this.techCall_("enterFullScreen"):this.enterFullWindow()},o.exitFullscreen=function(){var e=this.options_.Promise||d.default.Promise;if(e){var t=this;return new e(function(b,U){function z(){t.off("fullscreenerror",J),t.off("fullscreenchange",Y)}function Y(){z(),b()}function J(Q,ne){z(),U(ne)}t.one("fullscreenchange",Y),t.one("fullscreenerror",J);var te=t.exitFullscreenHelper_();te&&(te.then(z,z),te.then(b,U))})}return this.exitFullscreenHelper_()},o.exitFullscreenHelper_=function(){var e=this;if(this.fsApi_.requestFullscreen){var t=E.default[this.fsApi_.exitFullscreen]();return t&&ot(t.then(function(){return e.isFullscreen(!1)})),t}else this.tech_.supportsFullScreen()&&!this.options_.preferFullWindow?this.techCall_("exitFullScreen"):this.exitFullWindow()},o.enterFullWindow=function(){this.isFullscreen(!0),this.isFullWindow=!0,this.docOrigOverflow=E.default.documentElement.style.overflow,qe(E.default,"keydown",this.boundFullWindowOnEscKey_),E.default.documentElement.style.overflow="hidden",et(E.default.body,"vjs-full-window"),this.trigger("enterFullWindow")},o.fullWindowOnEscKey=function(e){p.default.isEventKey(e,"Esc")&&this.isFullscreen()===!0&&(this.isFullWindow?this.exitFullWindow():this.exitFullscreen())},o.exitFullWindow=function(){this.isFullscreen(!1),this.isFullWindow=!1,Ve(E.default,"keydown",this.boundFullWindowOnEscKey_),E.default.documentElement.style.overflow=this.docOrigOverflow,_t(E.default.body,"vjs-full-window"),this.trigger("exitFullWindow")},o.disablePictureInPicture=function(e){if(e===void 0)return this.techGet_("disablePictureInPicture");this.techCall_("setDisablePictureInPicture",e),this.options_.disablePictureInPicture=e,this.trigger("disablepictureinpicturechanged")},o.isInPictureInPicture=function(e){if(e!==void 0){this.isInPictureInPicture_=!!e,this.togglePictureInPictureClass_();return}return!!this.isInPictureInPicture_},o.requestPictureInPicture=function(){if("pictureInPictureEnabled"in E.default&&this.disablePictureInPicture()===!1)return this.techGet_("requestPictureInPicture")},o.exitPictureInPicture=function(){if("pictureInPictureEnabled"in E.default)return E.default.exitPictureInPicture()},o.handleKeyDown=function(e){var t=this.options_.userActions;if(!(!t||!t.hotkeys)){var b=function(z){var Y=z.tagName.toLowerCase();if(z.isContentEditable)return!0;var J=["button","checkbox","hidden","radio","reset","submit"];if(Y==="input")return J.indexOf(z.type)===-1;var te=["textarea"];return te.indexOf(Y)!==-1};b(this.el_.ownerDocument.activeElement)||(typeof t.hotkeys=="function"?t.hotkeys.call(this,e):this.handleHotkeys(e))}},o.handleHotkeys=function(e){var t=this.options_.userActions?this.options_.userActions.hotkeys:{},b=t.fullscreenKey,U=b===void 0?function(Se){return p.default.isEventKey(Se,"f")}:b,z=t.muteKey,Y=z===void 0?function(Se){return p.default.isEventKey(Se,"m")}:z,J=t.playPauseKey,te=J===void 0?function(Se){return p.default.isEventKey(Se,"k")||p.default.isEventKey(Se,"Space")}:J;if(U.call(this,e)){e.preventDefault(),e.stopPropagation();var Q=ae.getComponent("FullscreenToggle");E.default[this.fsApi_.fullscreenEnabled]!==!1&&Q.prototype.handleClick.call(this,e)}else if(Y.call(this,e)){e.preventDefault(),e.stopPropagation();var ne=ae.getComponent("MuteToggle");ne.prototype.handleClick.call(this,e)}else if(te.call(this,e)){e.preventDefault(),e.stopPropagation();var fe=ae.getComponent("PlayToggle");fe.prototype.handleClick.call(this,e)}},o.canPlayType=function(e){for(var t,b=0,U=this.options_.techOrder;b<U.length;b++){var z=U[b],Y=Re.getTech(z);if(Y||(Y=ae.getComponent(z)),!Y){$.error('The "'+z+'" tech is undefined. Skipped browser support check for that tech.');continue}if(Y.isSupported()&&(t=Y.canPlayType(e),t))return t}return""},o.selectSource=function(e){var t=this,b=this.options_.techOrder.map(function(te){return[te,Re.getTech(te)]}).filter(function(te){var Q=te[0],ne=te[1];return ne?ne.isSupported():($.error('The "'+Q+'" tech is undefined. Skipped browser support check for that tech.'),!1)}),U=function(Q,ne,fe){var Se;return Q.some(function(ht){return ne.some(function(hi){if(Se=fe(ht,hi),Se)return!0})}),Se},z,Y=function(Q){return function(ne,fe){return Q(fe,ne)}},J=function(Q,ne){var fe=Q[0],Se=Q[1];if(Se.canPlaySource(ne,t.options_[fe.toLowerCase()]))return{source:ne,tech:fe}};return this.options_.sourceOrder?z=U(e,b,Y(J)):z=U(b,e,J),z||!1},o.handleSrc_=function(e,t){var b=this;if(typeof e=="undefined")return this.cache_.src||"";this.resetRetryOnError_&&this.resetRetryOnError_();var U=_a(e);if(!U.length){this.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0);return}if(this.changingSrc_=!0,t||(this.cache_.sources=U),this.updateSourceCaches_(U[0]),ca(this,U[0],function(J,te){b.middleware_=te,t||(b.cache_.sources=U),b.updateSourceCaches_(J);var Q=b.src_(J);if(Q){if(U.length>1)return b.handleSrc_(U.slice(1));b.changingSrc_=!1,b.setTimeout(function(){this.error({code:4,message:this.localize(this.options_.notSupportedMessage)})},0),b.triggerReady();return}da(te,b.tech_)}),this.options_.retryOnError&&U.length>1){var z=function(){b.error(null),b.handleSrc_(U.slice(1),!0)},Y=function(){b.off("error",z)};this.one("error",z),this.one("playing",Y),this.resetRetryOnError_=function(){b.off("error",z),b.off("playing",Y)}}},o.src=function(e){return this.handleSrc_(e,!1)},o.src_=function(e){var t=this,b=this.selectSource([e]);return b?Vn(b.tech,this.techName_)?(this.ready(function(){this.tech_.constructor.prototype.hasOwnProperty("setSource")?this.techCall_("setSource",e):this.techCall_("src",e.src),this.changingSrc_=!1},!0),!1):(this.changingSrc_=!0,this.loadTech_(b.tech,b.source),this.tech_.ready(function(){t.changingSrc_=!1}),!1):!0},o.load=function(){this.techCall_("load")},o.reset=function(){var e=this,t=this.options_.Promise||d.default.Promise;if(this.paused()||!t)this.doReset_();else{var b=this.play();ot(b.then(function(){return e.doReset_()}))}},o.doReset_=function(){this.tech_&&this.tech_.clearTracks("text"),this.resetCache_(),this.poster(""),this.loadTech_(this.options_.techOrder[0],null),this.techCall_("reset"),this.resetControlBarUI_(),ft(this)&&this.trigger("playerreset")},o.resetControlBarUI_=function(){this.resetProgressBar_(),this.resetPlaybackRate_(),this.resetVolumeBar_()},o.resetProgressBar_=function(){this.currentTime(0);var e=this.controlBar,t=e.durationDisplay,b=e.remainingTimeDisplay;t&&t.updateContent(),b&&b.updateContent()},o.resetPlaybackRate_=function(){this.playbackRate(this.defaultPlaybackRate()),this.handleTechRateChange_()},o.resetVolumeBar_=function(){this.volume(1),this.trigger("volumechange")},o.currentSources=function(){var e=this.currentSource(),t=[];return Object.keys(e).length!==0&&t.push(e),this.cache_.sources||t},o.currentSource=function(){return this.cache_.source||{}},o.currentSrc=function(){return this.currentSource()&&this.currentSource().src||""},o.currentType=function(){return this.currentSource()&&this.currentSource().type||""},o.preload=function(e){if(e!==void 0){this.techCall_("setPreload",e),this.options_.preload=e;return}return this.techGet_("preload")},o.autoplay=function(e){if(e===void 0)return this.options_.autoplay||!1;var t;typeof e=="string"&&/(any|play|muted)/.test(e)||e===!0&&this.options_.normalizeAutoplay?(this.options_.autoplay=e,this.manualAutoplay_(typeof e=="string"?e:"play"),t=!1):e?this.options_.autoplay=!0:this.options_.autoplay=!1,t=typeof t=="undefined"?this.options_.autoplay:t,this.tech_&&this.techCall_("setAutoplay",t)},o.playsinline=function(e){return e!==void 0?(this.techCall_("setPlaysinline",e),this.options_.playsinline=e,this):this.techGet_("playsinline")},o.loop=function(e){if(e!==void 0){this.techCall_("setLoop",e),this.options_.loop=e;return}return this.techGet_("loop")},o.poster=function(e){if(e===void 0)return this.poster_;e||(e=""),e!==this.poster_&&(this.poster_=e,this.techCall_("setPoster",e),this.isPosterFromTech_=!1,this.trigger("posterchange"))},o.handleTechPosterChange_=function(){if((!this.poster_||this.options_.techCanOverridePoster)&&this.tech_&&this.tech_.poster){var e=this.tech_.poster()||"";e!==this.poster_&&(this.poster_=e,this.isPosterFromTech_=!0,this.trigger("posterchange"))}},o.controls=function(e){if(e===void 0)return!!this.controls_;e=!!e,this.controls_!==e&&(this.controls_=e,this.usingNativeControls()&&this.techCall_("setControls",e),this.controls_?(this.removeClass("vjs-controls-disabled"),this.addClass("vjs-controls-enabled"),this.trigger("controlsenabled"),this.usingNativeControls()||this.addTechControlsListeners_()):(this.removeClass("vjs-controls-enabled"),this.addClass("vjs-controls-disabled"),this.trigger("controlsdisabled"),this.usingNativeControls()||this.removeTechControlsListeners_()))},o.usingNativeControls=function(e){if(e===void 0)return!!this.usingNativeControls_;e=!!e,this.usingNativeControls_!==e&&(this.usingNativeControls_=e,this.usingNativeControls_?(this.addClass("vjs-using-native-controls"),this.trigger("usingnativecontrols")):(this.removeClass("vjs-using-native-controls"),this.trigger("usingcustomcontrols")))},o.error=function(e){var t=this;if(e===void 0)return this.error_||null;if(n("beforeerror").forEach(function(U){var z=U(t,e);if(!(le(z)&&!Array.isArray(z)||typeof z=="string"||typeof z=="number"||z===null)){t.log.error("please return a value that MediaError expects in beforeerror hooks");return}e=z}),this.options_.suppressNotSupportedError&&e&&e.code===4){var b=function(){this.error(e)};this.options_.suppressNotSupportedError=!1,this.any(["click","touchstart"],b),this.one("loadstart",function(){this.off(["click","touchstart"],b)});return}if(e===null){this.error_=e,this.removeClass("vjs-error"),this.errorDisplay&&this.errorDisplay.close();return}this.error_=new Xe(e),this.addClass("vjs-error"),$.error("(CODE:"+this.error_.code+" "+Xe.errorTypes[this.error_.code]+")",this.error_.message,this.error_),this.trigger("error"),n("error").forEach(function(U){return U(t,t.error_)})},o.reportUserActivity=function(e){this.userActivity_=!0},o.userActive=function(e){if(e===void 0)return this.userActive_;if(e=!!e,e!==this.userActive_){if(this.userActive_=e,this.userActive_){this.userActivity_=!0,this.removeClass("vjs-user-inactive"),this.addClass("vjs-user-active"),this.trigger("useractive");return}this.tech_&&this.tech_.one("mousemove",function(t){t.stopPropagation(),t.preventDefault()}),this.userActivity_=!1,this.removeClass("vjs-user-active"),this.addClass("vjs-user-inactive"),this.trigger("userinactive")}},o.listenForUserActivity_=function(){var e,t,b,U=Oe(this,this.reportUserActivity),z=function(fe){(fe.screenX!==t||fe.screenY!==b)&&(t=fe.screenX,b=fe.screenY,U())},Y=function(){U(),this.clearInterval(e),e=this.setInterval(U,250)},J=function(fe){U(),this.clearInterval(e)};this.on("mousedown",Y),this.on("mousemove",z),this.on("mouseup",J),this.on("mouseleave",J);var te=this.getChild("controlBar");te&&!be&&!Le&&(te.on("mouseenter",function(ne){this.player().options_.inactivityTimeout!==0&&(this.player().cache_.inactivityTimeout=this.player().options_.inactivityTimeout),this.player().options_.inactivityTimeout=0}),te.on("mouseleave",function(ne){this.player().options_.inactivityTimeout=this.player().cache_.inactivityTimeout})),this.on("keydown",U),this.on("keyup",U);var Q;this.setInterval(function(){if(!!this.userActivity_){this.userActivity_=!1,this.userActive(!0),this.clearTimeout(Q);var ne=this.options_.inactivityTimeout;ne<=0||(Q=this.setTimeout(function(){this.userActivity_||this.userActive(!1)},ne))}},250)},o.playbackRate=function(e){if(e!==void 0){this.techCall_("setPlaybackRate",e);return}return this.tech_&&this.tech_.featuresPlaybackRate?this.cache_.lastPlaybackRate||this.techGet_("playbackRate"):1},o.defaultPlaybackRate=function(e){return e!==void 0?this.techCall_("setDefaultPlaybackRate",e):this.tech_&&this.tech_.featuresPlaybackRate?this.techGet_("defaultPlaybackRate"):1},o.isAudio=function(e){if(e!==void 0){this.isAudio_=!!e;return}return!!this.isAudio_},o.addTextTrack=function(e,t,b){if(this.tech_)return this.tech_.addTextTrack(e,t,b)},o.addRemoteTextTrack=function(e,t){if(this.tech_)return this.tech_.addRemoteTextTrack(e,t)},o.removeRemoteTextTrack=function(e){e===void 0&&(e={});var t=e,b=t.track;if(b||(b=e),this.tech_)return this.tech_.removeRemoteTextTrack(b)},o.getVideoPlaybackQuality=function(){return this.techGet_("getVideoPlaybackQuality")},o.videoWidth=function(){return this.tech_&&this.tech_.videoWidth&&this.tech_.videoWidth()||0},o.videoHeight=function(){return this.tech_&&this.tech_.videoHeight&&this.tech_.videoHeight()||0},o.language=function(e){if(e===void 0)return this.language_;this.language_!==String(e).toLowerCase()&&(this.language_=String(e).toLowerCase(),ft(this)&&this.trigger("languagechange"))},o.languages=function(){return xe(T.prototype.options_.languages,this.languages_)},o.toJSON=function(){var e=xe(this.options_),t=e.tracks;e.tracks=[];for(var b=0;b<t.length;b++){var U=t[b];U=xe(U),U.player=void 0,e.tracks[b]=U}return e},o.createModal=function(e,t){var b=this;t=t||{},t.content=e||"";var U=new It(this,t);return this.addChild(U),U.on("dispose",function(){b.removeChild(U)}),U.open(),U},o.updateCurrentBreakpoint_=function(){if(!!this.responsive())for(var e=this.currentBreakpoint(),t=this.currentWidth(),b=0;b<di.length;b++){var U=di[b],z=this.breakpoints_[U];if(t<=z){if(e===U)return;e&&this.removeClass(vr[e]),this.addClass(vr[U]),this.breakpoint_=U;break}}},o.removeCurrentBreakpoint_=function(){var e=this.currentBreakpointClass();this.breakpoint_="",e&&this.removeClass(e)},o.breakpoints=function(e){return e===void 0?se(this.breakpoints_):(this.breakpoint_="",this.breakpoints_=se({},Ja,e),this.updateCurrentBreakpoint_(),se(this.breakpoints_))},o.responsive=function(e){if(e===void 0)return this.responsive_;e=Boolean(e);var t=this.responsive_;if(e!==t)return this.responsive_=e,e?(this.on("playerresize",this.boundUpdateCurrentBreakpoint_),this.updateCurrentBreakpoint_()):(this.off("playerresize",this.boundUpdateCurrentBreakpoint_),this.removeCurrentBreakpoint_()),e},o.currentBreakpoint=function(){return this.breakpoint_},o.currentBreakpointClass=function(){return vr[this.breakpoint_]||""},o.loadMedia=function(e,t){var b=this;if(!(!e||typeof e!="object")){this.reset(),this.cache_.media=xe(e);var U=this.cache_.media,z=U.artwork,Y=U.poster,J=U.src,te=U.textTracks;!z&&Y&&(this.cache_.media.artwork=[{src:Y,type:or(Y)}]),J&&this.src(J),Y&&this.poster(Y),Array.isArray(te)&&te.forEach(function(Q){return b.addRemoteTextTrack(Q,!1)}),this.ready(t)}},o.getMedia=function(){if(!this.cache_.media){var e=this.poster(),t=this.currentSources(),b=Array.prototype.map.call(this.remoteTextTracks(),function(z){return{kind:z.kind,label:z.label,language:z.language,src:z.src}}),U={src:t,textTracks:b};return e&&(U.poster=e,U.artwork=[{src:U.poster,type:or(U.poster)}]),U}return xe(this.cache_.media)},T.getTagSettings=function(e){var t={sources:[],tracks:[]},b=Ze(e),U=b["data-setup"];if(ct(e,"vjs-fill")&&(b.fill=!0),ct(e,"vjs-fluid")&&(b.fluid=!0),U!==null){var z=l.default(U||"{}"),Y=z[0],J=z[1];Y&&$.error(Y),se(b,J)}if(se(t,b),e.hasChildNodes())for(var te=e.childNodes,Q=0,ne=te.length;Q<ne;Q++){var fe=te[Q],Se=fe.nodeName.toLowerCase();Se==="source"?t.sources.push(Ze(fe)):Se==="track"&&t.tracks.push(Ze(fe))}return t},o.flexNotSupported_=function(){var e=E.default.createElement("i");return!("flexBasis"in e.style||"webkitFlexBasis"in e.style||"mozFlexBasis"in e.style||"msFlexBasis"in e.style||"msFlexOrder"in e.style)},o.debug=function(e){if(e===void 0)return this.debugEnabled_;e?(this.trigger("debugon"),this.previousLogLevel_=this.log.level,this.log.level("debug"),this.debugEnabled_=!0):(this.trigger("debugoff"),this.log.level(this.previousLogLevel_),this.previousLogLevel_=void 0,this.debugEnabled_=!1)},o.playbackRates=function(e){if(e===void 0)return this.cache_.playbackRates;!Array.isArray(e)||!e.every(function(t){return typeof t=="number"})||(this.cache_.playbackRates=e,this.trigger("playbackrateschange"))},T}(ae);$e.names.forEach(function(g){var T=$e[g];je.prototype[T.getterName]=function(){return this.tech_?this.tech_[T.getterName]():(this[T.privateName]=this[T.privateName]||new T.ListClass,this[T.privateName])}}),je.prototype.crossorigin=je.prototype.crossOrigin,je.players={};var Xt=d.default.navigator;je.prototype.options_={techOrder:Re.defaultTechOrder_,html5:{},inactivityTimeout:2e3,playbackRates:[],liveui:!1,children:["mediaLoader","posterImage","textTrackDisplay","loadingSpinner","bigPlayButton","liveTracker","controlBar","errorDisplay","textTrackSettings","resizeManager"],language:Xt&&(Xt.languages&&Xt.languages[0]||Xt.userLanguage||Xt.language)||"en",languages:{},notSupportedMessage:"No compatible source was found for this media.",normalizeAutoplay:!1,fullscreen:{options:{navigationUI:"hide"}},breakpoints:{},responsive:!1},["ended","seeking","seekable","networkState","readyState"].forEach(function(g){je.prototype[g]=function(){return this.techGet_(g)}}),Rn.forEach(function(g){je.prototype["handleTech"+Ue(g)+"_"]=function(){return this.trigger(g)}}),ae.registerComponent("Player",je);var pr="plugin",Nt="activePlugins_",Ut={},gr=function(T){return Ut.hasOwnProperty(T)},mr=function(T){return gr(T)?Ut[T]:void 0},In=function(T,o){T[Nt]=T[Nt]||{},T[Nt][o]=!0},yr=function(T,o,r){var e=(r?"before":"")+"pluginsetup";T.trigger(e,o),T.trigger(e+":"+o.name,o)},Za=function(T,o){var r=function(){yr(this,{name:T,plugin:o,instance:null},!0);var t=o.apply(this,arguments);return In(this,T),yr(this,{name:T,plugin:o,instance:t}),t};return Object.keys(o).forEach(function(e){r[e]=o[e]}),r},Mn=function(T,o){return o.prototype.name=T,function(){yr(this,{name:T,plugin:o,instance:null},!0);for(var r=arguments.length,e=new Array(r),t=0;t<r;t++)e[t]=arguments[t];var b=m.default(o,[this].concat(e));return this[T]=function(){return b},yr(this,b.getEventHash()),b}},lt=function(){function g(o){if(this.constructor===g)throw new Error("Plugin must be sub-classed; not directly instantiated.");this.player=o,this.log||(this.log=this.player.log.createLogger(this.name)),Pr(this),delete this.trigger,Ii(this,this.constructor.defaultState),In(o,this.name),this.dispose=this.dispose.bind(this),o.on("dispose",this.dispose)}var T=g.prototype;return T.version=function(){return this.constructor.VERSION},T.getEventHash=function(r){return r===void 0&&(r={}),r.name=this.name,r.plugin=this.constructor,r.instance=this,r},T.trigger=function(r,e){return e===void 0&&(e={}),Ot(this.eventBusEl_,r,this.getEventHash(e))},T.handleStateChanged=function(r){},T.dispose=function(){var r=this.name,e=this.player;this.trigger("dispose"),this.off(),e.off("dispose",this.dispose),e[Nt][r]=!1,this.player=this.state=null,e[r]=Mn(r,Ut[r])},g.isBasic=function(r){var e=typeof r=="string"?mr(r):r;return typeof e=="function"&&!g.prototype.isPrototypeOf(e.prototype)},g.registerPlugin=function(r,e){if(typeof r!="string")throw new Error('Illegal plugin name, "'+r+'", must be a string, was '+typeof r+".");if(gr(r))$.warn('A plugin named "'+r+'" already exists. You may want to avoid re-registering plugins!');else if(je.prototype.hasOwnProperty(r))throw new Error('Illegal plugin name, "'+r+'", cannot share a name with an existing player method!');if(typeof e!="function")throw new Error('Illegal plugin for "'+r+'", must be a function, was '+typeof e+".");return Ut[r]=e,r!==pr&&(g.isBasic(e)?je.prototype[r]=Za(r,e):je.prototype[r]=Mn(r,e)),e},g.deregisterPlugin=function(r){if(r===pr)throw new Error("Cannot de-register base plugin.");gr(r)&&(delete Ut[r],delete je.prototype[r])},g.getPlugins=function(r){r===void 0&&(r=Object.keys(Ut));var e;return r.forEach(function(t){var b=mr(t);b&&(e=e||{},e[t]=b)}),e},g.getPluginVersion=function(r){var e=mr(r);return e&&e.VERSION||""},g}();lt.getPlugin=mr,lt.BASE_PLUGIN_NAME=pr,lt.registerPlugin(pr,lt),je.prototype.usingPlugin=function(g){return!!this[Nt]&&this[Nt][g]===!0},je.prototype.hasPlugin=function(g){return!!gr(g)};var qa=function(T,o){o===void 0&&(o={});var r=function(){T.apply(this,arguments)},e={};typeof o=="object"?(o.constructor!==Object.prototype.constructor&&(r=o.constructor),e=o):typeof o=="function"&&(r=o),L.default(r,T),T&&(r.super_=T);for(var t in e)e.hasOwnProperty(t)&&(r.prototype[t]=e[t]);return r},xn=function(T){return T.indexOf("#")===0?T.slice(1):T};function pe(g,T,o){var r=pe.getPlayer(g);if(r)return T&&$.warn('Player "'+g+'" is already initialised. Options will not be applied.'),o&&r.ready(o),r;var e=typeof g=="string"?gt("#"+xn(g)):g;if(!He(e))throw new TypeError("The element or ID supplied is not valid. (videojs)");(!e.ownerDocument.defaultView||!e.ownerDocument.body.contains(e))&&$.warn("The element supplied is not included in the DOM"),T=T||{},n("beforesetup").forEach(function(b){var U=b(e,xe(T));if(!le(U)||Array.isArray(U)){$.error("please return an object in beforesetup hooks");return}T=xe(T,U)});var t=ae.getComponent("Player");return r=new t(e,T,o),n("setup").forEach(function(b){return b(r)}),r}if(pe.hooks_=v,pe.hooks=n,pe.hook=s,pe.hookOnce=_,pe.removeHook=A,d.default.VIDEOJS_NO_DYNAMIC_STYLE!==!0&&ze()){var Er=gt(".vjs-styles-defaults");if(!Er){Er=Ci("vjs-styles-defaults");var fi=gt("head");fi&&fi.insertBefore(Er,fi.firstChild),Ai(Er,`
      .video-js {
        width: 300px;
        height: 150px;
      }

      .vjs-fluid {
        padding-top: 56.25%
      }
    `)}}br(1,pe),pe.VERSION=S,pe.options=je.prototype.options_,pe.getPlayers=function(){return je.players},pe.getPlayer=function(g){var T=je.players,o;if(typeof g=="string"){var r=xn(g),e=T[r];if(e)return e;o=gt("#"+r)}else o=g;if(He(o)){var t=o,b=t.player,U=t.playerId;if(b||T[U])return b||T[U]}},pe.getAllPlayers=function(){return Object.keys(je.players).map(function(g){return je.players[g]}).filter(Boolean)},pe.players=je.players,pe.getComponent=ae.getComponent,pe.registerComponent=function(g,T){Re.isTech(T)&&$.warn("The "+g+" tech was registered as a component. It should instead be registered using videojs.registerTech(name, tech)"),ae.registerComponent.call(ae,g,T)},pe.getTech=Re.getTech,pe.registerTech=Re.registerTech,pe.use=ua,Object.defineProperty(pe,"middleware",{value:{},writeable:!1,enumerable:!0}),Object.defineProperty(pe.middleware,"TERMINATOR",{value:sr,writeable:!1,enumerable:!0}),pe.browser=Me,pe.TOUCH_ENABLED=Pe,pe.extend=qa,pe.mergeOptions=xe,pe.bind=Oe,pe.registerPlugin=lt.registerPlugin,pe.deregisterPlugin=lt.deregisterPlugin,pe.plugin=function(g,T){return $.warn("videojs.plugin() is deprecated; use videojs.registerPlugin() instead"),lt.registerPlugin(g,T)},pe.getPlugins=lt.getPlugins,pe.getPlugin=lt.getPlugin,pe.getPluginVersion=lt.getPluginVersion,pe.addLanguage=function(g,T){var o;return g=(""+g).toLowerCase(),pe.options.languages=xe(pe.options.languages,(o={},o[g]=T,o)),pe.options.languages[g]},pe.log=$,pe.createLogger=q,pe.createTimeRange=pe.createTimeRanges=bt,pe.formatTime=wt,pe.setFormatTime=Pa,pe.resetFormatTime=Oa,pe.parseUrl=Fr,pe.isCrossOrigin=ar,pe.EventTarget=We,pe.on=qe,pe.one=tr,pe.off=Ve,pe.trigger=Ot,pe.xhr=f.default,pe.TextTrack=Vt,pe.AudioTrack=Ki,pe.VideoTrack=Hi,["isEl","isTextNode","createEl","hasClass","addClass","removeClass","toggleClass","setAttributes","getAttributes","emptyEl","appendContent","insertContent"].forEach(function(g){pe[g]=function(){return $.warn("videojs."+g+"() is deprecated; use videojs.dom."+g+"() instead"),Si[g].apply(null,arguments)}}),pe.computedStyle=me,pe.dom=Si,pe.url=aa,pe.defineLazyProperty=ui,pe.addLanguage("en",{"Non-Fullscreen":"Exit Fullscreen"}),oe.exports=pe},288:(oe,re,K)=>{/**
 * videojs-mux
 * @version 4.0.0
 * @copyright 2021 Mux, Inc.
 * @license
 */(function(){var M=!1;(function(H,k){if(!0)oe.exports=k(K(207));else var x,j})(typeof self!="undefined"?self:this,function(H){return function(k){function x(F){if(j[F])return j[F].exports;var R=j[F]={i:F,l:!1,exports:{}};return k[F].call(R.exports,R,R.exports,x),R.l=!0,R.exports}var j={};return x.m=k,x.c=j,x.d=function(F,R,O){x.o(F,R)||Object.defineProperty(F,R,{configurable:!1,enumerable:!0,get:O})},x.n=function(F){var R=F&&F.__esModule?function(){return F.default}:function(){return F};return x.d(R,"a",R),R},x.o=function(F,R){return Object.prototype.hasOwnProperty.call(F,R)},x.p="",x(x.s=2)}([function(k,x,j){(function(){(function(F,R){k.exports=R()})(0,function(){return function(F){function R(y){if(O[y])return O[y].exports;var C=O[y]={i:y,l:!1,exports:{}};return F[y].call(C.exports,C,C.exports,R),C.l=!0,C.exports}var O={};return R.m=F,R.c=O,R.d=function(y,C,P){R.o(y,C)||Object.defineProperty(y,C,{configurable:!1,enumerable:!0,get:P})},R.n=function(y){var C=y&&y.__esModule?function(){return y.default}:function(){return y};return R.d(C,"a",C),C},R.o=function(y,C){return Object.prototype.hasOwnProperty.call(y,C)},R.p="",R(R.s=16)}([function(F,R,O){(function(y){var C;C=typeof window!="undefined"?window:y!==void 0?y:typeof self!="undefined"?self:{},F.exports=C}).call(R,O(6))},function(F,R){function O(Z,ee,ie){switch(ie.length){case 0:return Z.call(ee);case 1:return Z.call(ee,ie[0]);case 2:return Z.call(ee,ie[0],ie[1]);case 3:return Z.call(ee,ie[0],ie[1],ie[2])}return Z.apply(ee,ie)}function y(Z,ee){for(var ie=-1,ue=Array(Z);++ie<Z;)ue[ie]=ee(ie);return ue}function C(Z,ee){var ie=$(Z)||p(Z)?y(Z.length,String):[],ue=ie.length,se=!!ue;for(var le in Z)!ee&&!B.call(Z,le)||se&&(le=="length"||c(le,ue))||ie.push(le);return ie}function P(Z,ee,ie){var ue=Z[ee];B.call(Z,ee)&&l(ue,ie)&&(ie!==void 0||ee in Z)||(Z[ee]=ie)}function u(Z){if(!i(Z))return G(Z);var ee=[];for(var ie in Object(Z))B.call(Z,ie)&&ie!="constructor"&&ee.push(ie);return ee}function d(Z,ee){return ee=V(ee===void 0?Z.length-1:ee,0),function(){for(var ie=arguments,ue=-1,se=V(ie.length-ee,0),le=Array(se);++ue<se;)le[ue]=ie[ee+ue];ue=-1;for(var ce=Array(ee+1);++ue<ee;)ce[ue]=ie[ue];return ce[ee]=le,O(Z,this,ce)}}function E(Z,ee,ie,ue){ie||(ie={});for(var se=-1,le=ee.length;++se<le;){var ce=ee[se],me=ue?ue(ie[ce],Z[ce],ce,ie,Z):void 0;P(ie,ce,me===void 0?Z[ce]:me)}return ie}function c(Z,ee){return!!(ee=ee==null?s:ee)&&(typeof Z=="number"||I.test(Z))&&Z>-1&&Z%1==0&&Z<ee}function a(Z,ee,ie){if(!S(ie))return!1;var ue=typeof ee;return!!(ue=="number"?f(ie)&&c(ee,ie.length):ue=="string"&&ee in ie)&&l(ie[ee],Z)}function i(Z){var ee=Z&&Z.constructor;return Z===(typeof ee=="function"&&ee.prototype||w)}function l(Z,ee){return Z===ee||Z!==Z&&ee!==ee}function p(Z){return h(Z)&&B.call(Z,"callee")&&(!W.call(Z,"callee")||N.call(Z)==A)}function f(Z){return Z!=null&&L(Z.length)&&!m(Z)}function h(Z){return v(Z)&&f(Z)}function m(Z){var ee=S(Z)?N.call(Z):"";return ee==_||ee==D}function L(Z){return typeof Z=="number"&&Z>-1&&Z%1==0&&Z<=s}function S(Z){var ee=typeof Z;return!!Z&&(ee=="object"||ee=="function")}function v(Z){return!!Z&&typeof Z=="object"}function n(Z){return f(Z)?C(Z):u(Z)}var s=9007199254740991,A="[object Arguments]",_="[object Function]",D="[object GeneratorFunction]",I=/^(?:0|[1-9]\d*)$/,w=Object.prototype,B=w.hasOwnProperty,N=w.toString,W=w.propertyIsEnumerable,G=function(Z,ee){return function(ie){return Z(ee(ie))}}(Object.keys,Object),V=Math.max,X=!W.call({valueOf:1},"valueOf"),$=Array.isArray,q=function(Z){return d(function(ee,ie){var ue=-1,se=ie.length,le=se>1?ie[se-1]:void 0,ce=se>2?ie[2]:void 0;for(le=Z.length>3&&typeof le=="function"?(se--,le):void 0,ce&&a(ie[0],ie[1],ce)&&(le=se<3?void 0:le,se=1),ee=Object(ee);++ue<se;){var me=ie[ue];me&&Z(ee,me)}return ee})}(function(Z,ee){if(X||i(ee)||f(ee))return void E(ee,n(ee),Z);for(var ie in ee)B.call(ee,ie)&&P(Z,ie,ee[ie])});F.exports=q},function(F,R,O){"use strict";function y(C,P,u){u=u===void 0?1:u,C[P]=C[P]||0,C[P]+=u}Object.defineProperty(R,"__esModule",{value:!0}),R.default=y},function(F,R,O){"use strict";Object.defineProperty(R,"__esModule",{value:!0});var y=O(0),C=function(u){return u&&u.__esModule?u:{default:u}}(y),P={};P.now=function(){var u=C.default.performance,d=u&&u.timing;return d&&typeof d.navigationStart=="number"&&typeof u.now=="function"?d.navigationStart+u.now():Date.now()},R.default=P},function(F,R,O){"use strict";Object.defineProperty(R,"__esModule",{value:!0});var y=O(18),C=function(u){return u&&u.__esModule?u:{default:u}}(y),P=C.default.methodFactory;C.default.methodFactory=function(u,d,E){var c=P(u,d,E);return function(){for(var a=["[mux]"],i=0;i<arguments.length;i++)a.push(arguments[i]);c.apply(void 0,a)}},C.default.setLevel(C.default.getLevel()),R.default=C.default},function(F,R,O){"use strict";Object.defineProperty(R,"__esModule",{value:!0});var y=function(u){return P(u)[0]},C=function(u){return P(u)[1]},P=function(u){if(typeof u!="string"||u==="")return["localhost"];var d=/^(([^:\/?#]+):)?(\/\/([^\/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/,E=u.match(d)||[],c=E[4],a=void 0;return c&&(a=(c.match(/[^\.]+\.[^\.]+$/)||[])[0]),[c,a]};R.extractHostnameAndDomain=P,R.extractHostname=y,R.extractDomain=C},function(F,R){var O;O=function(){return this}();try{O=O||Function("return this")()||(0,eval)("this")}catch(y){typeof window=="object"&&(O=window)}F.exports=O},function(F,R,O){"use strict";Object.defineProperty(R,"__esModule",{value:!0});var y=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(P){var u=16*Math.random()|0;return(P==="x"?u:3&u|8).toString(16)})},C=function(){return("000000"+(Math.random()*Math.pow(36,6)<<0).toString(36)).slice(-6)};R.generateUUID=y,R.generateShortID=C},function(F,R,O){"use strict";function y(P){P=P||"";var u={};return P.trim().split(/[\r\n]+/).forEach(function(d){if(d){var E=d.split(": "),c=E.shift();c&&C.indexOf(c.toLowerCase())>=0&&(u[c]=E.join(": "))}}),u}Object.defineProperty(R,"__esModule",{value:!0}),R.default=y;var C=["x-cdn","content-type"]},function(F,R,O){"use strict";Object.defineProperty(R,"__esModule",{value:!0}),R.findMediaElement=R.getMuxPlayerId=void 0;var y=O(7),C=function(u){return u&&u.nodeName!==void 0?(u.muxId||(u.muxId=u.id||(0,y.generateShortID)()),u.muxId):u},P=function(u){var d=void 0;return u&&u.nodeName!==void 0?(d=u,u=C(d)):d=document.querySelector(u),[d,u,d&&d.nodeName?d.nodeName.toLowerCase():""]};R.getMuxPlayerId=C,R.findMediaElement=P},function(F,R,O){"use strict";function y(){return(P.default.doNotTrack||P.default.navigator&&(P.default.navigator.doNotTrack||P.default.navigator.msDoNotTrack))==="1"}Object.defineProperty(R,"__esModule",{value:!0}),R.default=y;var C=O(0),P=function(u){return u&&u.__esModule?u:{default:u}}(C)},function(F,R,O){"use strict";Object.defineProperty(R,"__esModule",{value:!0});var y=O(0),C=function(u){return u&&u.__esModule?u:{default:u}}(y),P={};P.exists=function(){var u=C.default.performance;return(u&&u.timing)!==void 0},P.domContentLoadedEventEnd=function(){var u=C.default.performance,d=u&&u.timing;return d&&d.domContentLoadedEventEnd},P.navigationStart=function(){var u=C.default.performance,d=u&&u.timing;return d&&d.navigationStart},R.default=P},function(F,R,O){"use strict";var y=O(42),C=O(43),P=O(14);F.exports={formats:P,parse:C,stringify:y}},function(F,R,O){"use strict";var y=Object.prototype.hasOwnProperty,C=function(){for(var u=[],d=0;d<256;++d)u.push("%"+((d<16?"0":"")+d.toString(16)).toUpperCase());return u}(),P=function(u){for(var d;u.length;){var E=u.pop();if(d=E.obj[E.prop],Array.isArray(d)){for(var c=[],a=0;a<d.length;++a)d[a]!==void 0&&c.push(d[a]);E.obj[E.prop]=c}}return d};R.arrayToObject=function(u,d){for(var E=d&&d.plainObjects?Object.create(null):{},c=0;c<u.length;++c)u[c]!==void 0&&(E[c]=u[c]);return E},R.merge=function(u,d,E){if(!d)return u;if(typeof d!="object"){if(Array.isArray(u))u.push(d);else{if(typeof u!="object")return[u,d];(E.plainObjects||E.allowPrototypes||!y.call(Object.prototype,d))&&(u[d]=!0)}return u}if(typeof u!="object")return[u].concat(d);var c=u;return Array.isArray(u)&&!Array.isArray(d)&&(c=R.arrayToObject(u,E)),Array.isArray(u)&&Array.isArray(d)?(d.forEach(function(a,i){y.call(u,i)?u[i]&&typeof u[i]=="object"?u[i]=R.merge(u[i],a,E):u.push(a):u[i]=a}),u):Object.keys(d).reduce(function(a,i){var l=d[i];return y.call(a,i)?a[i]=R.merge(a[i],l,E):a[i]=l,a},c)},R.assign=function(u,d){return Object.keys(d).reduce(function(E,c){return E[c]=d[c],E},u)},R.decode=function(u){try{return decodeURIComponent(u.replace(/\+/g," "))}catch(d){return u}},R.encode=function(u){if(u.length===0)return u;for(var d=typeof u=="string"?u:String(u),E="",c=0;c<d.length;++c){var a=d.charCodeAt(c);a===45||a===46||a===95||a===126||a>=48&&a<=57||a>=65&&a<=90||a>=97&&a<=122?E+=d.charAt(c):a<128?E+=C[a]:a<2048?E+=C[192|a>>6]+C[128|63&a]:a<55296||a>=57344?E+=C[224|a>>12]+C[128|a>>6&63]+C[128|63&a]:(c+=1,a=65536+((1023&a)<<10|1023&d.charCodeAt(c)),E+=C[240|a>>18]+C[128|a>>12&63]+C[128|a>>6&63]+C[128|63&a])}return E},R.compact=function(u){for(var d=[{obj:{o:u},prop:"o"}],E=[],c=0;c<d.length;++c)for(var a=d[c],i=a.obj[a.prop],l=Object.keys(i),p=0;p<l.length;++p){var f=l[p],h=i[f];typeof h=="object"&&h!==null&&E.indexOf(h)===-1&&(d.push({obj:i,prop:f}),E.push(h))}return P(d)},R.isRegExp=function(u){return Object.prototype.toString.call(u)==="[object RegExp]"},R.isBuffer=function(u){return u!=null&&!!(u.constructor&&u.constructor.isBuffer&&u.constructor.isBuffer(u))}},function(F,R,O){"use strict";var y=String.prototype.replace,C=/%20/g;F.exports={default:"RFC3986",formatters:{RFC1738:function(P){return y.call(P,C,"+")},RFC3986:function(P){return P}},RFC1738:"RFC1738",RFC3986:"RFC3986"}},function(F,R,O){"use strict";function y(f){return f&&f.__esModule?f:{default:f}}function C(f){var h={};for(var m in f)f.hasOwnProperty(m)&&(h[f[m]]=m);return h}function P(f){var h={},m={};return Object.keys(f).forEach(function(L){var S=!1;if(f.hasOwnProperty(L)&&f[L]!==void 0){var v=L.split("_"),n=v[0],s=i[n];s||(d.default.info("Data key word `"+v[0]+"` not expected in "+L),s=n+"_"),v.splice(1).forEach(function(A){A==="url"&&(S=!0),p[A]?s+=p[A]:(d.default.info("Data key word `"+A+"` not expected in "+L),s+="_"+A+"_")}),S?m[s]=f[L]:h[s]=f[L]}}),(0,c.default)(h,m)}Object.defineProperty(R,"__esModule",{value:!0}),R.default=P;var u=O(4),d=y(u),E=O(1),c=y(E),a={a:"env",b:"beacon",d:"ad",e:"event",f:"experiment",m:"mux",n:"response",p:"player",q:"request",r:"retry",s:"session",t:"timestamp",u:"viewer",v:"video",w:"page",x:"view",y:"sub"},i=C(a),l={ad:"ad",ag:"aggregate",ap:"api",al:"application",ar:"architecture",as:"asset",au:"autoplay",av:"average",bi:"bitrate",br:"break",bw:"browser",by:"bytes",ca:"cached",cb:"cancel",cd:"code",cg:"category",ch:"changed",cn:"config",co:"count",ce:"counter",cp:"complete",cr:"creative",ct:"content",cu:"current",cx:"connection",dg:"downscaling",dm:"domain",dn:"cdn",do:"downscale",du:"duration",dv:"device",ec:"encoding",en:"end",eg:"engine",em:"embed",er:"error",es:"errorcode",et:"errortext",ee:"event",ev:"events",ex:"expires",fi:"first",fm:"family",ft:"format",fq:"frequency",fr:"frame",fs:"fullscreen",he:"headers",ho:"host",hn:"hostname",ht:"height",id:"id",ii:"init",in:"instance",ip:"ip",is:"is",ke:"key",la:"language",lb:"labeled",le:"level",li:"live",ld:"loaded",lo:"load",ls:"lists",lt:"latency",ma:"max",md:"media",me:"message",mi:"mime",ml:"midroll",mm:"min",mn:"manufacturer",mo:"model",mx:"mux",nm:"name",no:"number",on:"on",os:"os",pa:"paused",pb:"playback",pd:"producer",pe:"percentage",pf:"played",pg:"program",ph:"playhead",pi:"plugin",pl:"preroll",pn:"playing",po:"poster",pr:"preload",ps:"position",py:"property",ra:"rate",rd:"requested",re:"rebuffer",rf:"rendition",ro:"ratio",rp:"response",rq:"request",rs:"requests",sa:"sample",se:"session",sk:"seek",sm:"stream",so:"source",sq:"sequence",sr:"series",st:"start",su:"startup",sv:"server",sw:"software",ta:"tag",tc:"tech",te:"text",th:"throughput",ti:"time",tl:"total",to:"to",tt:"title",ty:"type",ug:"upscaling",up:"upscale",ur:"url",us:"user",va:"variant",vd:"viewed",vi:"video",ve:"version",vw:"view",vr:"viewer",wd:"width",wa:"watch",wt:"waiting"},p=C(l)},function(F,R,O){"use strict";F.exports=O(17).default},function(F,R,O){"use strict";function y(A){return A&&A.__esModule?A:{default:A}}Object.defineProperty(R,"__esModule",{value:!0});var C=function(){function A(_,D){var I=[],w=!0,B=!1,N=void 0;try{for(var W,G=_[Symbol.iterator]();!(w=(W=G.next()).done)&&(I.push(W.value),!D||I.length!==D);w=!0);}catch(V){B=!0,N=V}finally{try{!w&&G.return&&G.return()}finally{if(B)throw N}}return I}return function(_,D){if(Array.isArray(_))return _;if(Symbol.iterator in Object(_))return A(_,D);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),P=O(0),u=y(P),d=O(9),E=O(4),c=y(E),a=O(10),i=y(a),l=O(3),p=y(l),f=O(19),h=y(f),m=O(50),L=y(m),S=O(51),v=y(S),n={},s=function A(_){var D=arguments;typeof _=="string"?A.hasOwnProperty(_)?u.default.setTimeout(function(){D=Array.prototype.splice.call(D,1),A[_].apply(null,D)},0):c.default.warn("`"+_+"` is an unknown task"):typeof _=="function"?u.default.setTimeout(function(){_(A)},0):c.default.warn("`"+_+"` is invalid.")};s.loaded=p.default.now(),s.NAME="mux-embed",s.VERSION="4.0.0",s.API_VERSION="2.1",s.PLAYER_TRACKED=!1,s.monitor=function(A,_){return(0,L.default)(s,A,_)},s.destroyMonitor=function(A){var _=(0,d.findMediaElement)(A),D=C(_,1),I=D[0];I&&I.mux&&typeof I.mux.destroy=="function"?I.mux.destroy():c.default.error("A video element monitor for `"+A+"` has not been initialized via `mux.monitor`.")},s.addHLSJS=function(A,_){var D=(0,d.getMuxPlayerId)(A);n[D]?n[D].addHLSJS(_):c.default.error("A monitor for `"+D+"` has not been initialized.")},s.addDashJS=function(A,_){var D=(0,d.getMuxPlayerId)(A);n[D]?n[D].addDashJS(_):c.default.error("A monitor for `"+D+"` has not been initialized.")},s.removeHLSJS=function(A){var _=(0,d.getMuxPlayerId)(A);n[_]?n[_].removeHLSJS():c.default.error("A monitor for `"+_+"` has not been initialized.")},s.removeDashJS=function(A){var _=(0,d.getMuxPlayerId)(A);n[_]?n[_].removeDashJS():c.default.error("A monitor for `"+_+"` has not been initialized.")},s.init=function(A,_){(0,i.default)()&&_&&_.respectDoNotTrack&&c.default.info("The browser's Do Not Track flag is enabled - Mux beaconing is disabled.");var D=(0,d.getMuxPlayerId)(A);n[D]=new h.default(s,D,_)},s.emit=function(A,_,D){var I=(0,d.getMuxPlayerId)(A);n[I]?(n[I].emit(_,D),_==="destroy"&&delete n[I]):c.default.error("A monitor for `"+I+"` has not been initialized.")},u.default!==void 0&&typeof u.default.addEventListener=="function"&&u.default.addEventListener("unload",function(){s.WINDOW_UNLOADING=!0},!1),s.checkDoNotTrack=i.default,s.log=c.default,s.utils=v.default,R.default=s},function(F,R,O){var y,C;(function(P,u){"use strict";y=u,(C=typeof y=="function"?y.call(R,O,R,F):y)!==void 0&&(F.exports=C)})(0,function(){"use strict";function P(v,n){var s=v[n];if(typeof s.bind=="function")return s.bind(v);try{return Function.prototype.bind.call(s,v)}catch(A){return function(){return Function.prototype.apply.apply(s,[v,arguments])}}}function u(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function d(v){return v==="debug"&&(v="log"),typeof console!==p&&(v==="trace"&&f?u:console[v]!==void 0?P(console,v):console.log!==void 0?P(console,"log"):l)}function E(v,n){for(var s=0;s<h.length;s++){var A=h[s];this[A]=s<v?l:this.methodFactory(A,v,n)}this.log=this.debug}function c(v,n,s){return function(){typeof console!==p&&(E.call(this,n,s),this[v].apply(this,arguments))}}function a(v,n,s){return d(v)||c.apply(this,arguments)}function i(v,n,s){function A(N){var W=(h[N]||"silent").toUpperCase();if(typeof window!==p&&w){try{return void(window.localStorage[w]=W)}catch(G){}try{window.document.cookie=encodeURIComponent(w)+"="+W+";"}catch(G){}}}function _(){var N;if(typeof window!==p&&w){try{N=window.localStorage[w]}catch(V){}if(typeof N===p)try{var W=window.document.cookie,G=W.indexOf(encodeURIComponent(w)+"=");G!==-1&&(N=/^([^;]+)/.exec(W.slice(G))[1])}catch(V){}return I.levels[N]===void 0&&(N=void 0),N}}var D,I=this,w="loglevel";typeof v=="string"?w+=":"+v:typeof v=="symbol"&&(w=void 0),I.name=v,I.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},I.methodFactory=s||a,I.getLevel=function(){return D},I.setLevel=function(N,W){if(typeof N=="string"&&I.levels[N.toUpperCase()]!==void 0&&(N=I.levels[N.toUpperCase()]),!(typeof N=="number"&&N>=0&&N<=I.levels.SILENT))throw"log.setLevel() called with invalid level: "+N;if(D=N,W!==!1&&A(N),E.call(I,N,v),typeof console===p&&N<I.levels.SILENT)return"No console available for logging"},I.setDefaultLevel=function(N){_()||I.setLevel(N,!1)},I.enableAll=function(N){I.setLevel(I.levels.TRACE,N)},I.disableAll=function(N){I.setLevel(I.levels.SILENT,N)};var B=_();B==null&&(B=n==null?"WARN":n),I.setLevel(B,!1)}var l=function(){},p="undefined",f=typeof window!==p&&typeof window.navigator!==p&&/Trident\/|MSIE /.test(window.navigator.userAgent),h=["trace","debug","info","warn","error"],m=new i,L={};m.getLogger=function(v){if(typeof v!="symbol"&&typeof v!="string"||v==="")throw new TypeError("You must supply a name when creating a logger.");var n=L[v];return n||(n=L[v]=new i(v,m.getLevel(),m.methodFactory)),n};var S=typeof window!==p?window.log:void 0;return m.noConflict=function(){return typeof window!==p&&window.log===m&&(window.log=S),m},m.getLoggers=function(){return L},m.default=m,m})},function(F,R,O){"use strict";function y(de){return de&&de.__esModule?de:{default:de}}Object.defineProperty(R,"__esModule",{value:!0});var C=function(){function de(ge,ve){var De=[],Fe=!0,Pe=!1,we=void 0;try{for(var Ge,be=ge[Symbol.iterator]();!(Fe=(Ge=be.next()).done)&&(De.push(Ge.value),!ve||De.length!==ve);Fe=!0);}catch(Ce){Pe=!0,we=Ce}finally{try{!Fe&&be.return&&be.return()}finally{if(Pe)throw we}}return De}return function(ge,ve){if(Array.isArray(ge))return ge;if(Symbol.iterator in Object(ge))return de(ge,ve);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),P=O(4),u=y(P),d=O(1),E=y(d),c=O(7),a=O(5),i=O(0),l=y(i),p=O(11),f=y(p),h=O(2),m=y(h),L=O(20),S=y(L),v=O(25),n=O(26),s=O(27),A=y(s),_=O(28),D=y(_),I=O(29),w=y(I),B=O(30),N=y(B),W=O(31),G=y(W),V=O(32),X=y(V),$=O(33),q=y($),Z=O(34),ee=y(Z),ie=O(35),ue=y(ie),se=O(36),le=y(se),ce=O(37),me=y(ce),ye=O(38),Ee=y(ye),ke=O(39),Ae=y(ke),Ie=O(40),Le=y(Ie),Be=O(49),Ne=y(Be),Ke=["viewstart","ended","loadstart","pause","play","playing","ratechange","waiting","adplay","adpause","adended","aderror","adplaying","adrequest","adresponse","adbreakstart","adbreakend","adfirstquartile","admidpoint","adthirdquartile","rebufferstart","rebufferend","seeked","error","hb","requestcompleted","requestfailed","requestcanceled","renditionchange"],Te=function(de,ge,ve){var De=this;this.DOM_CONTENT_LOADED_EVENT_END=f.default.domContentLoadedEventEnd(),this.NAVIGATION_START=f.default.navigationStart();var Fe={debug:!1,minimumRebufferDuration:250,sustainedRebufferThreshold:1e3,playbackHeartbeatTime:25,beaconDomain:"litix.io",sampleRate:1,disableCookies:!1,respectDoNotTrack:!1,disableRebufferTracking:!1,errorTranslator:function(Ce){return Ce}};this.mux=de,this.id=ge,ve=(0,E.default)(Fe,ve),ve.data=ve.data||{},ve.data.property_key&&(ve.data.env_key=ve.data.property_key,delete ve.data.property_key),u.default.setLevel(ve.debug?"debug":"warn"),this.getPlayheadTime=ve.getPlayheadTime,this.getStateData=ve.getStateData||function(){},this.getAdData=ve.getAdData||function(){},this.minimumRebufferDuration=ve.minimumRebufferDuration,this.sustainedRebufferThreshold=ve.sustainedRebufferThreshold,this.playbackHeartbeatTime=ve.playbackHeartbeatTime,this.disableRebufferTracking=ve.disableRebufferTracking,this.disableRebufferTracking&&this.mux.log.warn("Disabling rebuffer tracking. This should only be used in specific circumstances as a last resort when your player is known to unreliably track rebuffering."),this.errorTranslator=ve.errorTranslator,this.playbackEventDispatcher=new Le.default(de,ve.data.env_key,ve),this.data={player_instance_id:(0,c.generateUUID)(),mux_sample_rate:ve.sampleRate,beacon_domain:ve.beaconDomain},this.data.view_sequence_number=1,this.data.player_sequence_number=1,this.oldEmit=this.emit,this.emit=function(Ce,Me){Me=(0,E.default)({viewer_time:this.mux.utils.now()},Me),this.oldEmit(Ce,Me)};var Pe=function(){this.data.view_start===void 0&&(this.data.view_start=this.mux.utils.now(),this.emit("viewstart"))}.bind(this);this.on("viewinit",function(Ce,Me){this._resetVideoData(),this._resetViewData(),this._resetErrorData(),this._updateStateData(),(0,E.default)(this.data,Me),this._initializeViewData(),this.one("play",Pe),this.one("adbreakstart",Pe)});var we=function(Ce){this.emit("viewend"),this.send("viewend"),this.emit("viewinit",Ce)}.bind(this);this.on("videochange",function(Ce,Me){we(Me)}),this.on("programchange",function(Ce,Me){this.data.player_is_paused&&this.mux.log.warn("The `programchange` event is intended to be used when the content changes mid playback without the video source changing, however the video is not currently playing. If the video source is changing please use the videochange event otherwise you will lose startup time information."),we((0,E.default)(Me,{view_program_changed:!0})),Pe()}),this.on("destroy",this.destroy);var Ge=this.destroy.bind(this);l.default!==void 0&&typeof l.default.addEventListener=="function"&&l.default.addEventListener("unload",Ge,!1),this.on("destroy",function(){l.default!==void 0&&typeof l.default.removeEventListener=="function"&&l.default.removeEventListener("unload",Ge)}),this.on("playerready",function(Ce,Me){(0,E.default)(this.data,Me)}),Ke.forEach(function(Ce){De.on(Ce,function(Me,Je){Ce.indexOf("ad")!==0&&this._updateStateData(),(0,E.default)(this.data,Je),this._sanitizeData()}),De.on("after"+Ce,function(){(Ce!=="error"||this.viewErrored)&&this.send(Ce)})}),this.on("viewend",function(Ce,Me){(0,E.default)(De.data,Me)});var be=function(Ce){var Me=this.mux.utils.now();this.data.player_init_time&&(this.data.player_startup_time=Me-this.data.player_init_time),!this.mux.PLAYER_TRACKED&&this.NAVIGATION_START&&(this.mux.PLAYER_TRACKED=!0,(this.data.player_init_time||this.DOM_CONTENT_LOADED_EVENT_END)&&(this.data.page_load_time=Math.min(this.data.player_init_time||1/0,this.DOM_CONTENT_LOADED_EVENT_END||1/0)-this.NAVIGATION_START)),this.send("playerready"),delete this.data.player_startup_time,delete this.data.page_load_time};this.one("playerready",be),w.default.apply(this),Ae.default.apply(this),le.default.apply(this),X.default.apply(this),D.default.apply(this),ue.default.apply(this),N.default.apply(this),G.default.apply(this),me.default.apply(this),q.default.apply(this),ee.default.apply(this),Ee.default.apply(this),Ne.default.apply(this),ve.hlsjs&&this.addHLSJS(ve),ve.dashjs&&this.addDashJS(ve),this.emit("viewinit",ve.data)};(0,E.default)(Te.prototype,A.default.prototype),(0,E.default)(Te.prototype,X.default.prototype),(0,E.default)(Te.prototype,le.default.prototype),(0,E.default)(Te.prototype,D.default.prototype),(0,E.default)(Te.prototype,N.default.prototype),(0,E.default)(Te.prototype,G.default.prototype),(0,E.default)(Te.prototype,me.default.prototype),(0,E.default)(Te.prototype,q.default.prototype),(0,E.default)(Te.prototype,ee.default.prototype),Te.prototype.destroy=function(){this._destroyed||(this._destroyed=!0,this.data.view_start!==void 0&&(this.emit("viewend"),this.send("viewend")),this.playbackEventDispatcher.destroy(),this.removeHLSJS(),this.removeDashJS(),l.default.clearTimeout(this._heartBeatTimeout))},Te.prototype.send=function(de){var ge=(0,E.default)({},this.data);if(ge.player_error_code===1&&(delete ge.player_error_code,delete ge.player_error_message),ge.player_source_duration===1/0||ge.video_source_duration===1/0?ge.video_source_is_live=!0:(ge.player_source_duration>0||ge.video_source_duration>0)&&(ge.video_source_is_live=!1),ge.video_source_url=ge.video_source_url||ge.player_source_url,ge.video_source_url){var ve=(0,a.extractHostnameAndDomain)(ge.video_source_url),De=C(ve,2),Fe=De[0],Pe=De[1];ge.video_source_domain=Pe,ge.video_source_hostname=Fe}delete ge.ad_request_id,this.playbackEventDispatcher.send(de,ge),this.data.view_sequence_number++,this.data.player_sequence_number++,this._restartHeartBeat()},Te.prototype._updateStateData=function(){(0,E.default)(this.data,this.getStateData()),this.getPlayheadTime&&(this.data.player_playhead_time=this.getPlayheadTime()),this._sanitizeData()},Te.prototype._sanitizeData=function(){var de=this;["player_width","player_height","video_source_width","video_source_height","player_playhead_time","video_source_bitrate"].forEach(function(ge){var ve=parseInt(de.data[ge],10);de.data[ge]=isNaN(ve)?void 0:ve}),["player_source_url","video_source_url"].forEach(function(ge){if(de.data[ge]){var ve=de.data[ge].toLowerCase();ve.indexOf("data:")!==0&&ve.indexOf("blob:")!==0||(de.data[ge]="MSE style URL")}})},Te.prototype._resetVideoData=function(de,ge){var ve=this;Object.keys(this.data).forEach(function(De){De.indexOf("video_")===0&&delete ve.data[De]})},Te.prototype._resetViewData=function(){var de=this;Object.keys(this.data).forEach(function(ge){ge.indexOf("view_")===0&&delete de.data[ge]}),this.data.view_sequence_number=1},Te.prototype._resetErrorData=function(de,ge){delete this.data.player_error_code,delete this.data.player_error_message},Te.prototype._initializeViewData=function(){var de=this,ge=this.data.view_id=(0,c.generateUUID)();this.data.video_id||(this.data.video_id=(0,S.default)(this.data.player_source_url));var ve=function(){ge===de.data.view_id&&(0,m.default)(de.data,"player_view_count",1)};this.data.player_is_paused?this.one("play",ve):ve()},Te.prototype._restartHeartBeat=function(){var de=this;l.default.clearTimeout(this._heartBeatTimeout),this.viewErrored||(this._heartBeatTimeout=l.default.setTimeout(function(){de.data.player_is_paused||de.emit("hb")},1e4))},Te.prototype.addHLSJS=function(de){return de.hlsjs?this.hlsjs?void this.mux.log.warn("An instance of HLS.js is already being monitored for this player."):(this.hlsjs=de.hlsjs,void(0,v.monitorHlsJs)(this.mux,this.id,de.hlsjs,{},de.Hls||l.default.Hls)):void this.mux.log.warn("You must pass a valid hlsjs instance in order to track it.")},Te.prototype.removeHLSJS=function(){this.hlsjs&&((0,v.stopMonitoringHlsJs)(this.hlsjs),this.hlsjs=void 0)},Te.prototype.addDashJS=function(de){return de.dashjs?this.dashjs?void this.mux.log.warn("An instance of Dash.js is already being monitored for this player."):(this.dashjs=de.dashjs,void(0,n.monitorDashJS)(this.mux,this.id,de.dashjs)):void this.mux.log.warn("You must pass a valid dashjs instance in order to track it.")},Te.prototype.removeDashJS=function(){this.dashjs&&((0,n.stopMonitoringDashJS)(this.dashjs),this.dashjs=void 0)},R.default=Te},function(F,R,O){"use strict";function y(c){return c&&c.__esModule?c:{default:c}}function C(c){var a=u.default.createElement("a");a.href=c;var i=a.pathname.replace(/\.[^\/.]+$/,"");return E.default.encode(a.host+i).split("=")[0]}Object.defineProperty(R,"__esModule",{value:!0}),R.default=C;var P=O(21),u=y(P),d=O(23),E=y(d)},function(F,R,O){(function(y){var C,P=y!==void 0?y:typeof window!="undefined"?window:{},u=O(22);typeof document!="undefined"?C=document:(C=P["__GLOBAL_DOCUMENT_CACHE@4"])||(C=P["__GLOBAL_DOCUMENT_CACHE@4"]=u),F.exports=C}).call(R,O(6))},function(F,R){},function(F,R,O){(function(y,C){var P;(function(u){var d=(typeof y=="object"&&y&&y.exports,function(f){this.message=f});d.prototype=new Error,d.prototype.name="InvalidCharacterError";var E=function(f){throw new d(f)},c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",a=/[\t\n\f\r ]/g,i=function(f){f=String(f).replace(a,"");var h=f.length;h%4==0&&(f=f.replace(/==?$/,""),h=f.length),(h%4==1||/[^+a-zA-Z0-9\/]/.test(f))&&E("Invalid character: the string to be decoded is not correctly encoded.");for(var m,L,S=0,v="",n=-1;++n<h;)L=c.indexOf(f.charAt(n)),m=S%4?64*m+L:L,S++%4&&(v+=String.fromCharCode(255&m>>(-2*S&6)));return v},l=function(f){f=String(f),/[^\0-\xFF]/.test(f)&&E("The string to be encoded contains characters outside of the Latin1 range.");for(var h,m,L,S,v=f.length%3,n="",s=-1,A=f.length-v;++s<A;)h=f.charCodeAt(s)<<16,m=f.charCodeAt(++s)<<8,L=f.charCodeAt(++s),S=h+m+L,n+=c.charAt(S>>18&63)+c.charAt(S>>12&63)+c.charAt(S>>6&63)+c.charAt(63&S);return v==2?(h=f.charCodeAt(s)<<8,m=f.charCodeAt(++s),S=h+m,n+=c.charAt(S>>10)+c.charAt(S>>4&63)+c.charAt(S<<2&63)+"="):v==1&&(S=f.charCodeAt(s),n+=c.charAt(S>>2)+c.charAt(S<<4&63)+"=="),n},p={encode:l,decode:i,version:"0.1.0"};(P=function(){return p}.call(R,O,R,y))!==void 0&&(y.exports=P)})()}).call(R,O(24)(F),O(6))},function(F,R){F.exports=function(O){return O.webpackPolyfill||(O.deprecate=function(){},O.paths=[],O.children||(O.children=[]),Object.defineProperty(O,"loaded",{enumerable:!0,get:function(){return O.l}}),Object.defineProperty(O,"id",{enumerable:!0,get:function(){return O.i}}),O.webpackPolyfill=1),O}},function(F,R,O){"use strict";function y(p){return p&&p.__esModule?p:{default:p}}Object.defineProperty(R,"__esModule",{value:!0}),R.stopMonitoringHlsJs=R.monitorHlsJs=void 0;var C=O(8),P=y(C),u=O(11),d=y(u),E=O(5),c=function(p){if(!p)return{};var f=d.default.navigationStart();return{bytesLoaded:p.total,requestStart:Math.round(f+p.trequest),responseStart:Math.round(f+p.tfirst),responseEnd:Math.round(f+p.tload)}},a=function(p){if(p&&typeof p.getAllResponseHeaders=="function")return(0,P.default)(p.getAllResponseHeaders())},i=function(p,f,h){var m=(arguments.length>3&&arguments[3]!==void 0&&arguments[3],arguments[4]),L=p.log;if(!d.default.exists())return void L.warn("performance timing not supported. Not tracking HLS.js.");var S=function(w,B){return p.emit(f,w,B)},v=function(w,B){var N=B.levels,W=B.audioTracks,G=B.url,V=B.stats,X=B.networkDetails,$={},q={};N.forEach(function(le,ce){$[ce]={width:le.width,height:le.height,bitrate:le.bitrate,attrs:le.attrs}}),W.forEach(function(le,ce){q[ce]={name:le.name,language:le.lang,bitrate:le.bitrate}});var Z=c(V),ee=Z.bytesLoaded,ie=Z.requestStart,ue=Z.responseStart,se=Z.responseEnd;S("requestcompleted",{request_event_type:w,request_bytes_loaded:ee,request_start:ie,request_response_start:ue,request_response_end:se,request_type:"manifest",request_hostname:(0,E.extractHostname)(G),request_response_headers:a(X),request_rendition_lists:{media:$,audio:q,video:{}}})};h.on(m.Events.MANIFEST_LOADED,v);var n=function(w,B){var N=B.details,W=B.level,G=B.networkDetails,V=B.stats,X=c(V),$=X.bytesLoaded,q=X.requestStart,Z=X.responseStart,ee=X.responseEnd;S("requestcompleted",{request_event_type:w,request_bytes_loaded:$,request_start:q,request_response_start:Z,request_response_end:ee,request_current_level:W,request_type:"manifest",request_hostname:(0,E.extractHostname)(N.url),request_response_headers:a(G)})};h.on(m.Events.LEVEL_LOADED,n);var s=function(w,B){var N=B.details,W=B.networkDetails,G=B.stats,V=c(G),X=V.bytesLoaded,$=V.requestStart,q=V.responseStart,Z=V.responseEnd;S("requestcompleted",{request_event_type:w,request_bytes_loaded:X,request_start:$,request_response_start:q,request_response_end:Z,request_type:"manifest",request_hostname:(0,E.extractHostname)(N.url),request_response_headers:a(W)})};h.on(m.Events.AUDIO_TRACK_LOADED,s);var A=function(w,B){var N=B.stats,W=B.networkDetails,G=B.frag,V=c(N),X=V.bytesLoaded,$=V.requestStart,q=V.responseStart,Z=V.responseEnd,ee={request_event_type:w,request_bytes_loaded:X,request_start:$,request_response_start:q,request_response_end:Z,request_hostname:W?(0,E.extractHostname)(W.responseURL):void 0,request_response_headers:a(W),request_media_duration:G.duration};G.type==="main"?(ee.request_type="media",ee.request_current_level=G.level,ee.request_video_width=(h.levels[G.level]||{}).width,ee.request_video_height=(h.levels[G.level]||{}).height):ee.request_type=G.type,S("requestcompleted",ee)};h.on(m.Events.FRAG_LOADED,A);var _=function(w,B){var N=B.details,W=B.response,G=B.context,V=B.frag;if(N===m.ErrorDetails.MANIFEST_LOAD_ERROR||N===m.ErrorDetails.MANIFEST_LOAD_TIMEOUT||N===m.ErrorDetails.FRAG_LOAD_ERROR||N===m.ErrorDetails.FRAG_LOAD_TIMEOUT||N===m.ErrorDetails.LEVEL_LOAD_ERROR||N===m.ErrorDetails.LEVEL_LOAD_TIMEOUT){var X=V&&V.url||G&&G.url||"";S("requestfailed",{request_error:N,request_url:X,request_hostname:(0,E.extractHostname)(X),request_type:N===m.ErrorDetails.FRAG_LOAD_ERROR||N===m.ErrorDetails.FRAG_LOAD_TIMEOUT?"media":"manifest",request_error_code:W&&W.code,request_error_text:W&&W.text})}};h.on(m.Events.ERROR,_);var D=function(w,B){var N=B.frag,W=N&&N._url||"";S("requestcanceled",{request_cancel:w,request_url:W,request_type:"media",request_hostname:(0,E.extractHostname)(W)})};h.on(m.Events.FRAG_LOAD_EMERGENCY_ABORTED,D);var I=function(w,B){var N=B.level,W=h.levels.find(function(V){return V.level===N});if(W&&W.attrs&&W.attrs.BANDWIDTH){var G=W.attrs.BANDWIDTH;G?S("renditionchange",{video_source_bitrate:G,video_source_width:W.width,video_source_height:W.height}):L.warn("missing BANDWIDTH from HLS manifest parsed by HLS.js")}};h.on(m.Events.LEVEL_SWITCHED,I),h._stopMuxMonitor=function(){h.off(m.Events.MANIFEST_LOADED,v),h.off(m.Events.LEVEL_LOADED,n),h.off(m.Events.AUDIO_TRACK_LOADED,s),h.off(m.Events.FRAG_LOADED,A),h.off(m.Events.ERROR,_),h.off(m.Events.FRAG_LOAD_EMERGENCY_ABORTED,D),h.off(m.Events.LEVEL_SWITCHED,I),h.off(m.Events.DESTROYING,h._stopMuxMonitor),delete h._stopMuxMonitor},h.on(m.Events.DESTROYING,h._stopMuxMonitor)},l=function(p){p&&typeof p._stopMuxMonitor=="function"&&p._stopMuxMonitor()};R.monitorHlsJs=i,R.stopMonitoringHlsJs=l},function(F,R,O){"use strict";function y(p){return p&&p.__esModule?p:{default:p}}Object.defineProperty(R,"__esModule",{value:!0}),R.stopMonitoringDashJS=R.monitorDashJS=void 0;var C=O(0),P=y(C),u=O(8),d=y(u),E=O(5),c=function(p,f){if(!p||typeof p.getRequests!="function")return{};var h=p.getRequests({state:"executed"});if(h.length===0)return{};var m=h[h.length-1],L=(0,E.extractHostname)(m.url),S=m.bytesLoaded,v=new Date(m.requestStartDate).getTime(),n=new Date(m.firstByteDate).getTime(),s=new Date(m.requestEndDate).getTime(),A=isNaN(m.duration)?0:m.duration,_=typeof f.getMetricsFor=="function"?f.getMetricsFor(m.mediaType).HttpList:f.getDashMetrics().getHttpRequests(m.mediaType),D=void 0;return _.length>0&&(D=(0,d.default)(_[_.length-1]._responseHeaders||"")),{requestStart:v,requestResponseStart:n,requestResponseEnd:s,requestBytesLoaded:S,requestResponseHeaders:D,requestMediaDuration:A,requestHostname:L}},a=function(p,f){var h=f.getQualityFor(p),m=f.getCurrentTrackFor(p),L=m.bitrateList;return L?{currentLevel:h,renditionWidth:L[h].width||null,renditionHeight:L[h].height||null,renditionBitrate:L[h].bandwidth}:{}},i=function(p,f,h){var m=(arguments.length>3&&arguments[3]!==void 0&&arguments[3],p.log);if(!h||!h.on)return void m.warn("Invalid dash.js player reference. Monitoring blocked.");var L=function(w,B){return p.emit(f,w,B)},S=function(w){var B=w.type,N=w.data,W=N||{},G=W.url;L("requestcompleted",{request_event_type:B,request_start:0,request_response_start:0,request_response_end:0,request_bytes_loaded:-1,request_type:"manifest",request_hostname:(0,E.extractHostname)(G)})};h.on("manifestLoaded",S);var v={},n=function(w){var B=w.type,N=w.fragmentModel,W=w.chunk,G=W||{},V=G.mediaInfo,X=V||{},$=X.type,q=X.bitrateList;q=q||[];var Z={};q.forEach(function(ye,Ee){Z[Ee]={},Z[Ee].width=ye.width,Z[Ee].height=ye.height,Z[Ee].bitrate=ye.bandwidth,Z[Ee].attrs={}}),$==="video"?v.video=Z:$==="audio"?v.audio=Z:v.media=Z;var ee=c(N,h),ie=ee.requestStart,ue=ee.requestResponseStart,se=ee.requestResponseEnd,le=ee.requestResponseHeaders,ce=ee.requestMediaDuration,me=ee.requestHostname;L("requestcompleted",{request_event_type:B,request_start:ie,request_response_start:ue,request_response_end:se,request_bytes_loaded:-1,request_type:$+"_init",request_response_headers:le,request_hostname:me,request_media_duration:ce,request_rendition_lists:v})};h.on("initFragmentLoaded",n);var s=function(w){var B=w.type,N=w.fragmentModel,W=w.chunk,G=W||{},V=G.mediaInfo,X=G.start,$=V||{},q=$.type,Z=c(N,h),ee=Z.requestStart,ie=Z.requestResponseStart,ue=Z.requestResponseEnd,se=Z.requestBytesLoaded,le=Z.requestResponseHeaders,ce=Z.requestMediaDuration,me=Z.requestHostname,ye=a(q,h),Ee=ye.currentLevel,ke=ye.renditionWidth,Ae=ye.renditionHeight,Ie=ye.renditionBitrate;L("requestcompleted",{request_event_type:B,request_start:ee,request_response_start:ie,request_response_end:ue,request_bytes_loaded:se,request_type:q,request_response_headers:le,request_hostname:me,request_media_start_time:X,request_media_duration:ce,request_current_level:Ee,request_labeled_bitrate:Ie,request_video_width:ke,request_video_height:Ae})};h.on("mediaFragmentLoaded",s);var A={video:void 0,audio:void 0,totalBitrate:void 0},_=function(){if(A.video&&typeof A.video.bitrate=="number"){if(!A.video.width||!A.video.height)return void m.warn("have bitrate info for video but missing width/height");var w=A.video.bitrate;return A.audio&&typeof A.audio.bitrate=="number"&&(w+=A.audio.bitrate),w!==A.totalBitrate?(A.totalBitrate=w,{video_source_bitrate:w,video_source_height:A.video.height,video_source_width:A.video.width}):void 0}},D=function(w,B,N){if(typeof w.newQuality!="number")return void m.warn("missing evt.newQuality in qualityChangeRendered event",w);var W=w.mediaType;if(W==="audio"||W==="video"){var G=h.getBitrateInfoListFor(W).find(function(X){return X.qualityIndex===w.newQuality});if(!G||typeof G.bitrate!="number")return void m.warn("missing bitrate info for "+W);A[W]=G;var V=_();V&&L("renditionchange",V)}};h.on("qualityChangeRendered",D);var I=function(w){var B=w.error,N=w.event;N=N||{};var W=N.request||{},G=P.default.event&&P.default.event.currentTarget||{};L("requestfailed",{request_error:B+"_"+N.id+"_"+W.type,request_url:N.url,request_hostname:(0,E.extractHostname)(N.url),request_type:W.mediaType,request_error_code:G.status,request_error_type:G.statusText})};h.on("error",I),h._stopMuxMonitor=function(){h.off("manifestLoaded",S),h.off("initFragmentLoaded",n),h.off("mediaFragmentLoaded",s),h.off("qualityChangeRendered",D),h.off("error",I),delete h._stopMuxMonitor}},l=function(p){p&&typeof p._stopMuxMonitor=="function"&&p._stopMuxMonitor()};R.monitorDashJS=i,R.stopMonitoringDashJS=l},function(F,R,O){"use strict";Object.defineProperty(R,"__esModule",{value:!0});var y=function(){},C=0;y.prototype.on=function(P,u,d){return u._eventEmitterGuid=u._eventEmitterGuid||++C,this._listeners=this._listeners||{},this._listeners[P]=this._listeners[P]||[],d&&(u=u.bind(d)),this._listeners[P].push(u),u},y.prototype.off=function(P,u){var d=this._listeners&&this._listeners[P];d&&d.forEach(function(E,c){E._eventEmitterGuid===u._eventEmitterGuid&&d.splice(c,1)})},y.prototype.one=function(P,u,d){var E=this;u._eventEmitterGuid=u._eventEmitterGuid||++C;var c=function a(){E.off(P,a),u.apply(d||this,arguments)};c._eventEmitterGuid=u._eventEmitterGuid,this.on(P,c)},y.prototype.emit=function(P,u){var d=this;if(this._listeners){u=u||{};var E=this._listeners["before*"]||[],c=this._listeners[P]||[],a=this._listeners["after"+P]||[],i=function(l,p){l=l.slice(),l.forEach(function(f){f.call(d,{type:P},p)})};i(E,u),i(c,u),i(a,u)}},R.default=y},function(F,R,O){"use strict";Object.defineProperty(R,"__esModule",{value:!0});var y=O(0),C=function(u){return u&&u.__esModule?u:{default:u}}(y),P=function(){this._playbackHeartbeatInterval=null,this._playheadShouldBeProgressing=!1,this.on("playing",function(){this._playheadShouldBeProgressing=!0}),this.on("play",this._startPlaybackHeartbeatInterval),this.on("playing",this._startPlaybackHeartbeatInterval),this.on("adbreakstart",this._startPlaybackHeartbeatInterval),this.on("adplay",this._startPlaybackHeartbeatInterval),this.on("adplaying",this._startPlaybackHeartbeatInterval),this.on("seeking",this._startPlaybackHeartbeatInterval),this.on("devicewake",this._startPlaybackHeartbeatInterval),this.on("viewstart",this._startPlaybackHeartbeatInterval),this.on("pause",this._stopPlaybackHeartbeatInterval),this.on("ended",this._stopPlaybackHeartbeatInterval),this.on("viewend",this._stopPlaybackHeartbeatInterval),this.on("error",this._stopPlaybackHeartbeatInterval),this.on("aderror",this._stopPlaybackHeartbeatInterval),this.on("adpause",this._stopPlaybackHeartbeatInterval),this.on("adended",this._stopPlaybackHeartbeatInterval),this.on("adbreakend",this._stopPlaybackHeartbeatInterval),this.on("seeked",function(){this.data.player_is_paused?this._stopPlaybackHeartbeatInterval():this._startPlaybackHeartbeatInterval()}),this.on("timeupdate",function(){this._playbackHeartbeatInterval!==null&&this.emit("playbackheartbeat")}),this.on("devicesleep",function(u,d){this._playbackHeartbeatInterval!==null&&(C.default.clearInterval(this._playbackHeartbeatInterval),this.emit("playbackheartbeatend",{viewer_time:d.viewer_time}),this._playbackHeartbeatInterval=null)})};P.prototype._startPlaybackHeartbeatInterval=function(){var u=this;this._playbackHeartbeatInterval===null&&(this.emit("playbackheartbeat"),this._playbackHeartbeatInterval=C.default.setInterval(function(){u.emit("playbackheartbeat")},this.playbackHeartbeatTime))},P.prototype._stopPlaybackHeartbeatInterval=function(){this._playheadShouldBeProgressing=!1,this._playbackHeartbeatInterval!==null&&(C.default.clearInterval(this._playbackHeartbeatInterval),this.emit("playbackheartbeatend"),this._playbackHeartbeatInterval=null)},R.default=P},function(F,R,O){"use strict";function y(){var C=this;this.on("viewinit",function(){C.viewErrored=!1}),this.on("error",function(){try{var P=C.errorTranslator({player_error_code:C.data.player_error_code,player_error_message:C.data.player_error_message});P?(C.data.player_error_code=P.player_error_code,C.data.player_error_message=P.player_error_message,C.viewErrored=!0):(delete C.data.player_error_code,delete C.data.player_error_message)}catch(u){C.mux.log.warn("Exception in error translator callback.",u),C.viewErrored=!0}})}Object.defineProperty(R,"__esModule",{value:!0}),R.default=y},function(F,R,O){"use strict";Object.defineProperty(R,"__esModule",{value:!0});var y=O(2),C=function(u){return u&&u.__esModule?u:{default:u}}(y),P=function(){this._watchTimeTrackerLastCheckedTime=null,this.on("playbackheartbeat",this._updateWatchTime),this.on("playbackheartbeatend",this._clearWatchTimeState)};P.prototype._updateWatchTime=function(u,d){var E=d.viewer_time;this._watchTimeTrackerLastCheckedTime===null&&(this._watchTimeTrackerLastCheckedTime=E),(0,C.default)(this.data,"view_watch_time",E-this._watchTimeTrackerLastCheckedTime),this._watchTimeTrackerLastCheckedTime=E},P.prototype._clearWatchTimeState=function(u,d){this._updateWatchTime(u,d),this._watchTimeTrackerLastCheckedTime=null},R.default=P},function(F,R,O){"use strict";Object.defineProperty(R,"__esModule",{value:!0});var y=O(2),C=function(u){return u&&u.__esModule?u:{default:u}}(y),P=function(){this._playbackTimeTrackerLastPlayheadPosition=-1,this.on("playbackheartbeat",this._updatePlaybackTime),this.on("playbackheartbeatend",this._clearPlaybackTimeState),this.on("seeking",this._clearPlaybackTimeState)};P.prototype._updatePlaybackTime=function(){var u=this.data.player_playhead_time;if(this._playbackTimeTrackerLastPlayheadPosition>=0&&u>this._playbackTimeTrackerLastPlayheadPosition){var d=u-this._playbackTimeTrackerLastPlayheadPosition;d<=1e3&&(0,C.default)(this.data,"view_content_playback_time",d)}this._playbackTimeTrackerLastPlayheadPosition=u},P.prototype._clearPlaybackTimeState=function(){this._updatePlaybackTime(),this._playbackTimeTrackerLastPlayheadPosition=-1},R.default=P},function(F,R,O){"use strict";Object.defineProperty(R,"__esModule",{value:!0});var y=function(){this.on("playbackheartbeat",this._updatePlayheadTime),this.on("playbackheartbeatend",this._updatePlayheadTime),this.on("timeupdate",this._updatePlayheadTime),this.on("destroy",function(){this.off("timeupdate",this._updatePlayheadTime)})};y.prototype._updateMaxPlayheadPosition=function(){this.data.view_max_playhead_position=this.data.view_max_playhead_position===void 0?this.data.player_playhead_time:Math.max(this.data.view_max_playhead_position,this.data.player_playhead_time)},y.prototype._updatePlayheadTime=function(C,P){if(P.player_playhead_time)this.data.player_playhead_time=P.player_playhead_time,this._updateMaxPlayheadPosition();else if(this.getPlayheadTime){var u=this.getPlayheadTime();u!==void 0&&(this.data.player_playhead_time=u,this._updateMaxPlayheadPosition())}},R.default=y},function(F,R,O){"use strict";function y(c){return c&&c.__esModule?c:{default:c}}Object.defineProperty(R,"__esModule",{value:!0});var C=O(3),P=y(C),u=O(2),d=y(u),E=function(){this._lastCheckedTime=null,this._lastPlayheadTime=null,this._lastPlayheadTimeUpdatedTime=null,this.on("playbackheartbeat",this._checkIfRebuffering),this.on("playbackheartbeatend",this._cleanupRebufferTracker),this.on("seeking",function(){this._cleanupRebufferTracker(null,{viewer_time:P.default.now()})})};E.prototype._checkIfRebuffering=function(c,a){if(!this.disableRebufferTracking){if(this.isSeeking||this.isAdBreak||!this._playheadShouldBeProgressing)return void this._cleanupRebufferTracker(c,a);if(this._lastCheckedTime===null)return this._prepareRebufferTrackerState(a.viewer_time),void this._updateRebufferMetrics();if(this._lastPlayheadTime!==this.data.player_playhead_time)return void this._cleanupRebufferTracker(c,a,!0);var i=a.viewer_time-this._lastPlayheadTimeUpdatedTime;i>=this.sustainedRebufferThreshold&&(this._rebuffering?this._updateRebufferMetrics(a.viewer_time-this._lastCheckedTime):(this._rebuffering=!0,(0,d.default)(this.data,"view_rebuffer_count",1),this._updateRebufferMetrics(i),this.emit("rebufferstart"))),this._lastCheckedTime=a.viewer_time}},E.prototype._clearRebufferTrackerState=function(){this._lastCheckedTime=null,this._lastPlayheadTime=null,this._lastPlayheadTimeUpdatedTime=null},E.prototype._prepareRebufferTrackerState=function(c){this._lastCheckedTime=c,this._lastPlayheadTime=this.data.player_playhead_time,this._lastPlayheadTimeUpdatedTime=c},E.prototype._cleanupRebufferTracker=function(c,a){var i=arguments.length>2&&arguments[2]!==void 0&&arguments[2];if(!this.disableRebufferTracking){if(this._rebuffering)this._rebuffering=!1,this._updateRebufferMetrics(a.viewer_time-this._lastCheckedTime),this.emit("rebufferend",{viewer_time:a.viewer_time});else{if(this._lastCheckedTime===null)return void this._updateRebufferMetrics();var l=this.data.player_playhead_time-this._lastPlayheadTime,p=a.viewer_time-this._lastPlayheadTimeUpdatedTime;l>0&&p-l>this.minimumRebufferDuration?((0,d.default)(this.data,"view_rebuffer_count",1),this._updateRebufferMetrics(p-l),this.emit("rebufferstart",{viewer_time:this._lastPlayheadTimeUpdatedTime}),this.emit("rebufferend",{viewer_time:this._lastPlayheadTimeUpdatedTime+p-l})):this._updateRebufferMetrics()}i?this._prepareRebufferTrackerState(a.viewer_time):this._clearRebufferTrackerState()}},E.prototype._updateRebufferMetrics=function(c){c>0&&(0,d.default)(this.data,"view_rebuffer_duration",c),this.data.view_watch_time>=0&&this.data.view_rebuffer_count>0&&(this.data.view_rebuffer_frequency=this.data.view_rebuffer_count/this.data.view_watch_time,this.data.view_rebuffer_percentage=this.data.view_rebuffer_duration/this.data.view_watch_time)},R.default=E},function(F,R,O){"use strict";Object.defineProperty(R,"__esModule",{value:!0});var y=O(3),C=function(u){return u&&u.__esModule?u:{default:u}}(y),P=function(){this.on("viewinit",function(){var u=this.data,d=u.view_id;if(!u.view_program_changed){var E=function(c,a){var i=a.viewer_time;c.type==="playing"&&this.data.view_time_to_first_frame===void 0?this.calculateTimeToFirstFrame(i||C.default.now(),d):c.type!=="adplaying"||this.data.view_time_to_first_frame!==void 0&&!this.inPrerollPosition()||this.calculateTimeToFirstFrame(i||C.default.now(),d)};this.one("playing",E),this.one("adplaying",E),this.one("viewend",function(){this.off("playing",E),this.off("adplaying",E)})}})};P.prototype.calculateTimeToFirstFrame=function(u,d){d===this.data.view_id&&(this._updateWatchTime(null,{viewer_time:u}),this.data.view_time_to_first_frame=this.data.view_watch_time,(this.data.player_autoplay_on||this.data.video_is_autoplay)&&this.NAVIGATION_START&&(this.data.view_aggregate_startup_time=this.data.view_start+this.data.view_watch_time-this.NAVIGATION_START))},R.default=P},function(F,R,O){"use strict";function y(){var u=this;this.on("viewinit",function(){this._lastPlayheadPosition=-1});var d=["pause","rebufferstart","seeking","error","adbreakstart","hb"],E=["playing","hb"];d.forEach(function(c){u.on(c,function(){if(this._lastPlayheadPosition>=0&&this.data.player_playhead_time>=0&&this._lastPlayerWidth>=0&&this._lastSourceWidth>0&&this._lastPlayerHeight>=0&&this._lastSourceHeight>0){var a=this.data.player_playhead_time-this._lastPlayheadPosition;if(a<0)return void(this._lastPlayheadPosition=-1);var i=Math.min(this._lastPlayerWidth/this._lastSourceWidth,this._lastPlayerHeight/this._lastSourceHeight),l=Math.max(0,i-1),p=Math.max(0,1-i);this.data.view_max_upscale_percentage=Math.max(this.data.view_max_upscale_percentage||0,l),this.data.view_max_downscale_percentage=Math.max(this.data.view_max_downscale_percentage||0,p),(0,P.default)(this.data,"view_total_content_playback_time",a),(0,P.default)(this.data,"view_total_upscaling",l*a),(0,P.default)(this.data,"view_total_downscaling",p*a)}this._lastPlayheadPosition=-1})}),E.forEach(function(c){u.on(c,function(){this._lastPlayheadPosition=this.data.player_playhead_time,this._lastPlayerWidth=this.data.player_width,this._lastPlayerHeight=this.data.player_height,this._lastSourceWidth=this.data.video_source_width,this._lastSourceHeight=this.data.video_source_height})})}Object.defineProperty(R,"__esModule",{value:!0}),R.default=y;var C=O(2),P=function(u){return u&&u.__esModule?u:{default:u}}(C)},function(F,R,O){"use strict";function y(i){return i&&i.__esModule?i:{default:i}}function C(){this.isSeeking=!1,this.on("seeking",function(i,l){(0,a.default)(this.data,l),this._lastSeekingTime=u.default.now(),this.isSeeking===!1&&(this.isSeeking=!0,this.send("seeking"))}),this.on("seeked",function(){this.isSeeking=!1;var i=this._lastSeekingTime||u.default.now(),l=u.default.now()-i;(0,E.default)(this.data,"view_seek_count",1),(0,E.default)(this.data,"view_seek_duration",l);var p=this.data.view_max_seek_time||0;this.data.view_max_seek_time=Math.max(p,l)}),this.on("viewend",function(){this.isSeeking=!1})}Object.defineProperty(R,"__esModule",{value:!0}),R.default=C;var P=O(3),u=y(P),d=O(2),E=y(d),c=O(1),a=y(c)},function(F,R,O){"use strict";function y(p){return p&&p.__esModule?p:{default:p}}Object.defineProperty(R,"__esModule",{value:!0});var C=function(){function p(f,h){var m=[],L=!0,S=!1,v=void 0;try{for(var n,s=f[Symbol.iterator]();!(L=(n=s.next()).done)&&(m.push(n.value),!h||m.length!==h);L=!0);}catch(A){S=!0,v=A}finally{try{!L&&s.return&&s.return()}finally{if(S)throw v}}return m}return function(f,h){if(Array.isArray(f))return f;if(Symbol.iterator in Object(f))return p(f,h);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),P=O(2),u=y(P),d=O(5),E=O(1),c=y(E),a=function(p,f){p.push(f),p.sort(function(h,m){return h.viewer_time-m.viewer_time})},i=["adbreakstart","adrequest","adresponse","adplay","adplaying","adpause","adended","adbreakend","aderror"],l=function(){var p=this;this.on("viewinit",function(){this.isAdBreak=!1,this._currentAdRequestNumber=0,this._currentAdResponseNumber=0,this._adRequests=[],this._adResponses=[],this._adHasPlayed=!1,this._wouldBeNewAdPlay=!0,this._prerollPlayTime=void 0}),i.forEach(function(h){return p.on(h,p._updateAdData)});var f=function(){p.isAdBreak=!1};this.on("adbreakstart",function(){this.isAdBreak=!0}),this.on("play",f),this.on("playing",f),this.on("viewend",f),this.on("adrequest",function(h,m){m=(0,c.default)({ad_request_id:"generatedAdRequestId"+this._currentAdRequestNumber++},m),a(this._adRequests,m),(0,u.default)(this.data,"view_ad_request_count"),this.inPrerollPosition()&&(this.data.view_preroll_requested=!0,this._adHasPlayed||(0,u.default)(this.data,"view_preroll_request_count"))}),this.on("adresponse",function(h,m){m=(0,c.default)({ad_request_id:"generatedAdRequestId"+this._currentAdResponseNumber++},m),a(this._adResponses,m);var L=this.findAdRequest(m.ad_request_id);L&&(0,u.default)(this.data,"view_ad_request_time",Math.max(0,m.viewer_time-L.viewer_time))}),this.on("adplay",function(h,m){this._adHasPlayed=!0,this._wouldBeNewAdPlay&&(this._wouldBeNewAdPlay=!1,(0,u.default)(this.data,"view_ad_played_count")),this.inPrerollPosition()&&!this.data.view_preroll_played&&(this.data.view_preroll_played=!0,this._adRequests.length>0&&(this.data.view_preroll_request_time=Math.max(0,m.viewer_time-this._adRequests[0].viewer_time)),this.data.view_start&&(this.data.view_startup_preroll_request_time=Math.max(0,m.viewer_time-this.data.view_start)),this._prerollPlayTime=m.viewer_time)}),this.on("adplaying",function(h,m){this.inPrerollPosition()&&this.data.view_preroll_load_time===void 0&&this._prerollPlayTime!==void 0&&(this.data.view_preroll_load_time=m.viewer_time-this._prerollPlayTime,this.data.view_startup_preroll_load_time=m.viewer_time-this._prerollPlayTime)}),this.on("adended",function(){this._wouldBeNewAdPlay=!0}),this.on("aderror",function(){this._wouldBeNewAdPlay=!0})};l.prototype.inPrerollPosition=function(){return this.data.view_content_playback_time===void 0||this.data.view_content_playback_time<=1e3},l.prototype.findAdRequest=function(p){for(var f=0;f<this._adRequests.length;f++)if(this._adRequests[f].ad_request_id===p)return this._adRequests[f]},l.prototype._updateAdData=function(p,f){if(this.inPrerollPosition()){if(!this.data.view_preroll_ad_tag_hostname&&f.ad_tag_url){var h=(0,d.extractHostnameAndDomain)(f.ad_tag_url),m=C(h,2),L=m[0],S=m[1];this.data.view_preroll_ad_tag_domain=S,this.data.view_preroll_ad_tag_hostname=L}if(!this.data.view_preroll_ad_asset_hostname&&f.ad_asset_url){var v=(0,d.extractHostnameAndDomain)(f.ad_asset_url),n=C(v,2),s=n[0],A=n[1];this.data.view_preroll_ad_asset_domain=A,this.data.view_preroll_ad_asset_hostname=s}}},R.default=l},function(F,R,O){"use strict";function y(c){return c&&c.__esModule?c:{default:c}}function C(){var c=this,a=void 0,i=void 0,l=function(){c.disableRebufferTracking||((0,E.default)(c.data,"view_waiting_rebuffer_count",1),a=u.default.now(),i=window.setInterval(function(){if(a){var L=u.default.now();(0,E.default)(c.data,"view_waiting_rebuffer_duration",L-a),a=L}},250))},p=function(){c.disableRebufferTracking||a&&((0,E.default)(c.data,"view_waiting_rebuffer_duration",u.default.now()-a),a=!1,window.clearInterval(i))},f=!1,h=function(){f=!0},m=function(){f=!1,p()};this.on("waiting",function(){f&&l()}),this.on("playing",function(){p(),h()}),this.on("pause",m),this.on("seeking",m)}Object.defineProperty(R,"__esModule",{value:!0}),R.default=C;var P=O(3),u=y(P),d=O(2),E=y(d)},function(F,R,O){"use strict";function y(i){return i&&i.__esModule?i:{default:i}}function C(){var i=this;this.one("playbackheartbeat",c),this.on("playbackheartbeatend",function(){i.off("before*",a),i.one("playbackheartbeat",c)})}Object.defineProperty(R,"__esModule",{value:!0}),R.default=C;var P=O(1),u=y(P),d=O(3),E=y(d),c=function(){this.lastWallClockTime=E.default.now(),this.on("before*",a)},a=function(i){var l=E.default.now(),p=this.lastWallClockTime;this.lastWallClockTime=l,l-p>3e4&&(this.emit("devicesleep",{viewer_time:p}),(0,u.default)(this.data,{viewer_time:p}),this.send("devicesleep"),this.emit("devicewake",{viewer_time:l}),(0,u.default)(this.data,{viewer_time:l}),this.send("devicewake"))}},function(F,R,O){"use strict";function y(B){return B&&B.__esModule?B:{default:B}}Object.defineProperty(R,"__esModule",{value:!0});var C=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(B){return typeof B}:function(B){return B&&typeof Symbol=="function"&&B.constructor===Symbol&&B!==Symbol.prototype?"symbol":typeof B},P=O(0),u=y(P),d=O(41),E=O(4),c=y(E),a=O(45),i=y(a),l=O(10),p=y(l),f=O(46),h=y(f),m=O(15),L=y(m),S=O(47),v=y(S),n=O(1),s=y(n),A=["env_key","view_id","view_sequence_number","player_sequence_number","beacon_domain","player_playhead_time","viewer_time","mux_api_version","event","video_id","player_instance_id"],_=["viewstart","error","ended","viewend"],D=function(B,N){var W=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.mux=B,this.envKey=N,this.eventQueue=new v.default((0,i.default)(N,W.beaconDomain)),this.previousBeaconData=null,this.lastEventTime=null,this.sampleRate=W.sampleRate,this.disableCookies=W.disableCookies,this.respectDoNotTrack=W.respectDoNotTrack;var G=W.platform||{};this.pageLevelData={mux_api_version:this.mux.API_VERSION,mux_embed:this.mux.NAME,mux_embed_version:this.mux.VERSION,viewer_application_name:G.name,viewer_application_version:G.version,viewer_application_engine:G.layout,viewer_device_name:G.product,viewer_device_category:"",viewer_device_manufacturer:G.manufacturer,viewer_os_family:G.os&&G.os.family,viewer_os_architecture:G.os&&G.os.architecture,viewer_os_version:G.os&&G.os.version};var V=(0,h.default)();V&&(this.pageLevelData=(0,s.default)(this.pageLevelData,{viewer_connection_type:V})),u.default!==void 0&&u.default.location&&u.default.location.href&&(this.pageLevelData.page_url=u.default.location.href),this.viewerData=this.disableCookies?{}:(0,d.getAndUpdateViewerData)()};D.prototype.send=function(B,N){if(B){if(this.respectDoNotTrack&&(0,p.default)())return c.default.info("Not sending `"+B+"` because Do Not Track is enabled");if(!N||(N===void 0?"undefined":C(N))!=="object")return c.default.error("A data object was expected in send() but was not provided");var W=this.disableCookies?{}:(0,d.getAndUpdateSessionData)(),G={};(0,s.default)(G,this.pageLevelData),(0,s.default)(G,N),(0,s.default)(G,W),(0,s.default)(G,this.viewerData),G.event=B,G.env_key=this.envKey,G.user_id&&(G.viewer_user_id=G.user_id,delete G.user_id);var V=G.mux_sample_number>=this.sampleRate,X=this._deduplicateBeaconData(B,G),$=(0,L.default)(X);if(this.lastEventTime=this.mux.utils.now(),V)return c.default.info("Not sending event due to sample rate restriction",B,G,$);if(!this.envKey)return c.default.info("Not sending event due to missing environment key",B,G,$);if(!this.rateLimited){if(c.default.info("Sending event",B,G,$),this.rateLimited=!this.eventQueue.queueEvent(B,$),this.mux.WINDOW_UNLOADING&&B==="viewend")this.eventQueue.destroy(!0);else if(_.indexOf(B)>=0&&this.eventQueue.flushEvents(),this.rateLimited)return G.event="eventrateexceeded",$=(0,L.default)(G),this.eventQueue.queueEvent(G.event,$),c.default.error("Beaconing disabled due to rate limit.")}}},D.prototype.destroy=function(){this.eventQueue.destroy(!1)};var I=function(B,N,W,G){return!(!B||N.indexOf("request_")!==0||N!=="request_response_headers"&&(W===void 0?"undefined":C(W))==="object"&&(G===void 0?"undefined":C(G))==="object"&&Object.keys(W||{}).length===Object.keys(G||{}).length)},w=function(B,N){return B==="renditionchange"&&N.indexOf("video_source_")===0};D.prototype._deduplicateBeaconData=function(B,N){var W=this,G={},V=N.view_id;if(!V||B==="viewstart"||B==="viewend"||!this.previousBeaconData||this.mux.utils.now()-this.lastEventTime>=6e5)G=(0,s.default)({},N),V&&(this.previousBeaconData=G),V&&B==="viewend"&&(this.previousBeaconData=null);else{var X=B.indexOf("request")===0;Object.keys(N).forEach(function($){var q=N[$];(q!==W.previousBeaconData[$]||A.indexOf($)>-1||I(X,$,q,W.previousBeaconData[$])||w(B,$))&&(G[$]=q,W.previousBeaconData[$]=q)})}return G},R.default=D},function(F,R,O){"use strict";function y(h){return h&&h.__esModule?h:{default:h}}Object.defineProperty(R,"__esModule",{value:!0}),R.getAndUpdateSessionData=R.getAndUpdateViewerData=void 0;var C=O(12),P=y(C),u=O(44),d=y(u),E=O(7),c=O(3),a=y(c),i=function(){var h=void 0;try{h=P.default.parse(d.default.get("muxData")||"")}catch(m){h={}}return h},l=function(h){try{d.default.set("muxData",P.default.stringify(h),{expires:7300})}catch(m){}},p=function(){var h=i();return h.mux_viewer_id=h.mux_viewer_id||(0,E.generateUUID)(),h.msn=h.msn||Math.random(),l(h),{mux_viewer_id:h.mux_viewer_id,mux_sample_number:h.msn}},f=function(){var h=i(),m=a.default.now();return h.session_start&&(h.sst=h.session_start,delete h.session_start),h.session_id&&(h.sid=h.session_id,delete h.session_id),h.session_expires&&(h.sex=h.session_expires,delete h.session_expires),(!h.sex||h.sex<m)&&(h.sid=(0,E.generateUUID)(),h.sst=m),h.sex=m+15e5,l(h),{session_id:h.sid,session_start:h.sst,session_expires:h.sex}};R.getAndUpdateViewerData=p,R.getAndUpdateSessionData=f},function(F,R,O){"use strict";var y=O(13),C=O(14),P={brackets:function(c){return c+"[]"},indices:function(c,a){return c+"["+a+"]"},repeat:function(c){return c}},u=Date.prototype.toISOString,d={delimiter:"&",encode:!0,encoder:y.encode,encodeValuesOnly:!1,serializeDate:function(c){return u.call(c)},skipNulls:!1,strictNullHandling:!1},E=function c(a,i,l,p,f,h,m,L,S,v,n,s){var A=a;if(typeof m=="function")A=m(i,A);else if(A instanceof Date)A=v(A);else if(A===null){if(p)return h&&!s?h(i,d.encoder):i;A=""}if(typeof A=="string"||typeof A=="number"||typeof A=="boolean"||y.isBuffer(A))return h?[n(s?i:h(i,d.encoder))+"="+n(h(A,d.encoder))]:[n(i)+"="+n(String(A))];var _=[];if(A===void 0)return _;var D;if(Array.isArray(m))D=m;else{var I=Object.keys(A);D=L?I.sort(L):I}for(var w=0;w<D.length;++w){var B=D[w];f&&A[B]===null||(_=Array.isArray(A)?_.concat(c(A[B],l(i,B),l,p,f,h,m,L,S,v,n,s)):_.concat(c(A[B],i+(S?"."+B:"["+B+"]"),l,p,f,h,m,L,S,v,n,s)))}return _};F.exports=function(c,a){var i=c,l=a?y.assign({},a):{};if(l.encoder!==null&&l.encoder!==void 0&&typeof l.encoder!="function")throw new TypeError("Encoder has to be a function.");var p=l.delimiter===void 0?d.delimiter:l.delimiter,f=typeof l.strictNullHandling=="boolean"?l.strictNullHandling:d.strictNullHandling,h=typeof l.skipNulls=="boolean"?l.skipNulls:d.skipNulls,m=typeof l.encode=="boolean"?l.encode:d.encode,L=typeof l.encoder=="function"?l.encoder:d.encoder,S=typeof l.sort=="function"?l.sort:null,v=l.allowDots!==void 0&&l.allowDots,n=typeof l.serializeDate=="function"?l.serializeDate:d.serializeDate,s=typeof l.encodeValuesOnly=="boolean"?l.encodeValuesOnly:d.encodeValuesOnly;if(l.format===void 0)l.format=C.default;else if(!Object.prototype.hasOwnProperty.call(C.formatters,l.format))throw new TypeError("Unknown format option provided.");var A,_,D=C.formatters[l.format];typeof l.filter=="function"?(_=l.filter,i=_("",i)):Array.isArray(l.filter)&&(_=l.filter,A=_);var I=[];if(typeof i!="object"||i===null)return"";var w;w=l.arrayFormat in P?l.arrayFormat:"indices"in l?l.indices?"indices":"repeat":"indices";var B=P[w];A||(A=Object.keys(i)),S&&A.sort(S);for(var N=0;N<A.length;++N){var W=A[N];h&&i[W]===null||(I=I.concat(E(i[W],W,B,f,h,m?L:null,_,S,v,n,D,s)))}var G=I.join(p),V=l.addQueryPrefix===!0?"?":"";return G.length>0?V+G:""}},function(F,R,O){"use strict";var y=O(13),C=Object.prototype.hasOwnProperty,P={allowDots:!1,allowPrototypes:!1,arrayLimit:20,decoder:y.decode,delimiter:"&",depth:5,parameterLimit:1e3,plainObjects:!1,strictNullHandling:!1},u=function(c,a){for(var i={},l=a.ignoreQueryPrefix?c.replace(/^\?/,""):c,p=a.parameterLimit===1/0?void 0:a.parameterLimit,f=l.split(a.delimiter,p),h=0;h<f.length;++h){var m,L,S=f[h],v=S.indexOf("]="),n=v===-1?S.indexOf("="):v+1;n===-1?(m=a.decoder(S,P.decoder),L=a.strictNullHandling?null:""):(m=a.decoder(S.slice(0,n),P.decoder),L=a.decoder(S.slice(n+1),P.decoder)),C.call(i,m)?i[m]=[].concat(i[m]).concat(L):i[m]=L}return i},d=function(c,a,i){for(var l=a,p=c.length-1;p>=0;--p){var f,h=c[p];if(h==="[]")f=[],f=f.concat(l);else{f=i.plainObjects?Object.create(null):{};var m=h.charAt(0)==="["&&h.charAt(h.length-1)==="]"?h.slice(1,-1):h,L=parseInt(m,10);!isNaN(L)&&h!==m&&String(L)===m&&L>=0&&i.parseArrays&&L<=i.arrayLimit?(f=[],f[L]=l):f[m]=l}l=f}return l},E=function(c,a,i){if(c){var l=i.allowDots?c.replace(/\.([^.[]+)/g,"[$1]"):c,p=/(\[[^[\]]*])/,f=/(\[[^[\]]*])/g,h=p.exec(l),m=h?l.slice(0,h.index):l,L=[];if(m){if(!i.plainObjects&&C.call(Object.prototype,m)&&!i.allowPrototypes)return;L.push(m)}for(var S=0;(h=f.exec(l))!==null&&S<i.depth;){if(S+=1,!i.plainObjects&&C.call(Object.prototype,h[1].slice(1,-1))&&!i.allowPrototypes)return;L.push(h[1])}return h&&L.push("["+l.slice(h.index)+"]"),d(L,a,i)}};F.exports=function(c,a){var i=a?y.assign({},a):{};if(i.decoder!==null&&i.decoder!==void 0&&typeof i.decoder!="function")throw new TypeError("Decoder has to be a function.");if(i.ignoreQueryPrefix=i.ignoreQueryPrefix===!0,i.delimiter=typeof i.delimiter=="string"||y.isRegExp(i.delimiter)?i.delimiter:P.delimiter,i.depth=typeof i.depth=="number"?i.depth:P.depth,i.arrayLimit=typeof i.arrayLimit=="number"?i.arrayLimit:P.arrayLimit,i.parseArrays=i.parseArrays!==!1,i.decoder=typeof i.decoder=="function"?i.decoder:P.decoder,i.allowDots=typeof i.allowDots=="boolean"?i.allowDots:P.allowDots,i.plainObjects=typeof i.plainObjects=="boolean"?i.plainObjects:P.plainObjects,i.allowPrototypes=typeof i.allowPrototypes=="boolean"?i.allowPrototypes:P.allowPrototypes,i.parameterLimit=typeof i.parameterLimit=="number"?i.parameterLimit:P.parameterLimit,i.strictNullHandling=typeof i.strictNullHandling=="boolean"?i.strictNullHandling:P.strictNullHandling,c===""||c===null||c===void 0)return i.plainObjects?Object.create(null):{};for(var l=typeof c=="string"?u(c,i):c,p=i.plainObjects?Object.create(null):{},f=Object.keys(l),h=0;h<f.length;++h){var m=f[h],L=E(m,l[m],i);p=y.merge(p,L,i)}return y.compact(p)}},function(F,R,O){"use strict";var y,C,P=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(u){return typeof u}:function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u};(function(u){var d=!1;if(y=u,(C=typeof y=="function"?y.call(R,O,R,F):y)!==void 0&&(F.exports=C),d=!0,P(R)==="object"&&(F.exports=u(),d=!0),!d){var E=window.Cookies,c=window.Cookies=u();c.noConflict=function(){return window.Cookies=E,c}}})(function(){function u(E){function c(a,i,l){var p;if(typeof document!="undefined"){if(arguments.length>1){if(l=d({path:"/"},c.defaults,l),typeof l.expires=="number"){var f=new Date;f.setMilliseconds(f.getMilliseconds()+864e5*l.expires),l.expires=f}try{p=JSON.stringify(i),/^[\{\[]/.test(p)&&(i=p)}catch(s){}return i=E.write?E.write(i,a):encodeURIComponent(String(i)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),a=encodeURIComponent(String(a)),a=a.replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent),a=a.replace(/[\(\)]/g,escape),document.cookie=[a,"=",i,l.expires?"; expires="+l.expires.toUTCString():"",l.path?"; path="+l.path:"",l.domain?"; domain="+l.domain:"",l.secure?"; secure":""].join("")}a||(p={});for(var h=document.cookie?document.cookie.split("; "):[],m=/(%[0-9A-Z]{2})+/g,L=0;L<h.length;L++){var S=h[L].split("="),v=S.slice(1).join("=");v.charAt(0)==='"'&&(v=v.slice(1,-1));try{var n=S[0].replace(m,decodeURIComponent);if(v=E.read?E.read(v,n):E(v,n)||v.replace(m,decodeURIComponent),this.json)try{v=JSON.parse(v)}catch(s){}if(a===n){p=v;break}a||(p[n]=v)}catch(s){}}return p}}return c.set=c,c.get=function(a){return c.call(c,a)},c.getJSON=function(){return c.apply({json:!0},[].slice.call(arguments))},c.defaults={},c.remove=function(a,i){c(a,"",d(i,{expires:-1}))},c.withConverter=u,c}var d=function(){for(var E=0,c={};E<arguments.length;E++){var a=arguments[E];for(var i in a)c[i]=a[i]}return c};return u(function(){})})},function(F,R,O){"use strict";function y(C,P){return C=C||"",P=P||"litix.io",C.match(/^[a-z0-9]+$/)?"https://"+C+"."+P:"https://img.litix.io/a.gif"}Object.defineProperty(R,"__esModule",{value:!0}),R.default=y},function(F,R,O){"use strict";Object.defineProperty(R,"__esModule",{value:!0});var y=O(0),C=function(d){return d&&d.__esModule?d:{default:d}}(y),P=function(){var d=void 0;switch(u()){case"cellular":d="cellular";break;case"ethernet":d="wired";break;case"wifi":d="wifi";break;case void 0:break;default:d="other"}return d},u=function(){var d=C.default.navigator,E=d&&(d.connection||d.mozConnection||d.webkitConnection);return E&&E.type};R.default=P},function(F,R,O){"use strict";function y(L){return L&&L.__esModule?L:{default:L}}Object.defineProperty(R,"__esModule",{value:!0});var C=O(0),P=y(C),u=O(4),d=y(u),E=O(48),c=y(E),a=O(1),i=y(a),l=O(15),p=y(l),f=!!P.default.XMLHttpRequest&&"withCredentials"in new P.default.XMLHttpRequest,h={maxBeaconSize:300,maxQueueLength:3600,baseTimeBetweenBeacons:5e3},m=function(L,S){this._beaconUrl=L||"https://img.litix.io",this._eventQueue=[],this._postInFlight=!1,this._failureCount=0,this._sendTimeout=!1,this._options=(0,i.default)({},h,S)};m.prototype.queueEvent=function(L,S){var v=(0,i.default)({},S);return f?(this._eventQueue.length<=this._options.maxQueueLength||L==="eventrateexceeded")&&(this._eventQueue.push(v),this._sendTimeout||this._startBeaconSending(),this._eventQueue.length<=this._options.maxQueueLength):(c.default.send(this._beaconUrl,v),!0)},m.prototype.flushEvents=function(){f&&(this._eventQueue.length&&this._sendBeaconQueue(),this._startBeaconSending())},m.prototype.destroy=function(){var L=arguments.length>0&&arguments[0]!==void 0&&arguments[0];this.destroyed=!0,L?this._clearBeaconQueue():this.flushEvents(),P.default.clearTimeout(this._sendTimeout)},m.prototype._clearBeaconQueue=function(){var L=P.default.navigator,S=this._eventQueue.length>this._options.maxBeaconSize?this._eventQueue.length-this._options.maxBeaconSize:0,v=this._eventQueue.slice(S);if(S>0&&(0,i.default)(v[v.length-1],(0,p.default)({mux_view_message:"event queue truncated"})),L.sendBeacon)L.sendBeacon(this._beaconUrl,JSON.stringify({events:v}));else if(P.default.XMLHttpRequest){var n=new P.default.XMLHttpRequest;n.open("POST",this._beaconUrl),n.setRequestHeader("Content-Type","application/json"),n.send(JSON.stringify({events:v}))}else c.default.send(this._beaconUrl,v[v.length-1])},m.prototype._sendBeaconQueue=function(){var L=this;if(P.default.XMLHttpRequest&&!this._postInFlight){var S=new P.default.XMLHttpRequest,v=this._eventQueue.slice(0,this._options.maxBeaconSize);this._eventQueue=this._eventQueue.slice(this._options.maxBeaconSize),this._postInFlight=!0,S.onreadystatechange=function(){S.readyState===4&&(S.status!==200?(L._eventQueue=v.concat(L._eventQueue),L._failureCount+=1,d.default.info("Error sending beacon: "+S.status),d.default.info(S.responseText)):L._failureCount=0,L._postInFlight=!1)},S.open("POST",this._beaconUrl),S.setRequestHeader("Content-Type","application/json"),S.send(JSON.stringify({events:v}))}},m.prototype._getNextBeaconTime=function(){if(!this._failureCount)return this._options.baseTimeBetweenBeacons;var L=Math.pow(2,this._failureCount-1);return(1+(L*=Math.random()))*this._options.baseTimeBetweenBeacons},m.prototype._startBeaconSending=function(){var L=this;P.default.clearTimeout(this._sendTimeout),this.destroyed||(this._sendTimeout=P.default.setTimeout(function(){L._eventQueue.length&&L._sendBeaconQueue(),L._startBeaconSending()},this._getNextBeaconTime()))},R.default=m},function(F,R,O){"use strict";function y(c){return c&&c.__esModule?c:{default:c}}Object.defineProperty(R,"__esModule",{value:!0});var C=O(12),P=y(C),u=O(0),d=y(u),E={};E.send=function(c,a){function i(){l.src=f+(p?"&rc="+p:"")}var l=new Image,p=0,f=c+"?"+P.default.stringify(a);return l.addEventListener("error",function(){p>3||d.default.setTimeout(function(){p++,i()},5e3*p)}),i(),l},R.default=E},function(F,R,O){"use strict";function y(){function C(f,h){var m=h.request_start,L=h.request_response_start,S=h.request_response_end,v=h.request_bytes_loaded;a++;var n=void 0,s=void 0;if(L?(n=L-m,s=S-L):s=S-m,s>0&&v>0){var A=v/s*8e3;i++,E+=v,c+=s,this.data.view_min_request_throughput=Math.min(this.data.view_min_request_throughput||1/0,A),this.data.view_average_request_throughput=E/c*8e3,this.data.view_request_count=a,n>0&&(d+=n,this.data.view_max_request_latency=Math.max(this.data.view_max_request_latency||0,n),this.data.view_average_request_latency=d/i)}}function P(f,h){a++,l++,this.data.view_request_count=a,this.data.view_request_failed_count=l}function u(f,h){a++,p++,this.data.view_request_count=a,this.data.view_request_canceled_count=p}var d=0,E=0,c=0,a=0,i=0,l=0,p=0;this.on("requestcompleted",C),this.on("requestfailed",P),this.on("requestcanceled",u)}Object.defineProperty(R,"__esModule",{value:!0}),R.default=y},function(F,R,O){"use strict";function y(i,l,p){var f=(0,E.findMediaElement)(l),h=P(f,3),m=h[0],L=h[1],S=h[2],v=i.log,n=i.utils.getComputedStyle,s=i.utils.secondsToMs,A={automaticErrorTracking:!0};return m?S!=="video"&&S!=="audio"?v.error("The element of `"+L+"` was not a media element."):(p=(0,d.default)(A,p),p.data=(0,d.default)({player_software:"HTML5 Video Element",player_software_version:"No Versions",player_mux_plugin_name:"VideoElementMonitor",player_mux_plugin_version:"4.0.0"},p.data),p.getPlayheadTime=function(){return s(m.currentTime)},p.getStateData=function(){var _=this.hlsjs&&this.hlsjs.url,D=this.dashjs&&C(this.dashjs.getSource==="function")&&this.dashjs.getSource();return{player_is_paused:m.paused,player_playhead_time:s(m.currentTime),player_width:parseInt(n(m,"width")),player_height:parseInt(n(m,"height")),player_autoplay_on:m.autoplay,player_preload_on:m.preload,video_poster_url:m.poster,video_source_url:_||D||m.currentSrc,video_source_duration:s(m.duration),video_source_height:m.videoHeight,video_source_width:m.videoWidth}},m.mux=m.mux||{},m.mux.emit=function(_,D){i.emit(L,_,D)},m.mux.destroy=function(){Object.keys(m.mux.listeners).forEach(function(_){m.removeEventListener(_,m.mux.listeners[_],!1)}),delete m.mux.listeners,i.emit(L,"destroy")},m.mux.swapElement=function(_){var D=(0,E.findMediaElement)(_),I=P(D,3),w=I[0],B=I[1],N=I[2];return w?N!=="video"&&N!=="audio"?i.log.error("The element of `"+B+"` was not a media element."):(w.muxId=m.muxId,delete m.muxId,w.mux=w.mux||{},w.mux.listeners=(0,d.default)({},m.mux.listeners),delete m.mux.listeners,Object.keys(w.mux.listeners).forEach(function(W){m.removeEventListener(W,w.mux.listeners[W],!1),w.addEventListener(W,w.mux.listeners[W],!1)}),w.mux.swapElement=m.mux.swapElement,w.mux.destroy=m.mux.destroy,delete m.mux,void(m=w)):i.log.error("No element was found with the `"+B+"` query selector.")},m.mux.addHLSJS=function(_){i.addHLSJS(L,_)},m.mux.addDashJS=function(_){i.addDashJS(L,_)},m.mux.removeHLSJS=function(){i.removeHLSJS(L)},m.mux.removeDashJS=function(){i.removeDashJS(L)},i.init(L,p),i.emit(L,"playerready"),m.paused||(i.emit(L,"play"),m.readyState>2&&i.emit(L,"playing")),m.mux.listeners={},void c.forEach(function(_){(_!=="error"||p.automaticErrorTracking)&&(m.mux.listeners[_]=function(){var D={};_==="error"&&(D.player_error_code=m.error&&m.error.code,D.player_error_message=m.error&&a[m.error.code]),i.emit(L,_,D)},m.addEventListener(_,m.mux.listeners[_],!1))})):v.error("No element was found with the `"+L+"` query selector.")}Object.defineProperty(R,"__esModule",{value:!0});var C=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},P=function(){function i(l,p){var f=[],h=!0,m=!1,L=void 0;try{for(var S,v=l[Symbol.iterator]();!(h=(S=v.next()).done)&&(f.push(S.value),!p||f.length!==p);h=!0);}catch(n){m=!0,L=n}finally{try{!h&&v.return&&v.return()}finally{if(m)throw L}}return f}return function(l,p){if(Array.isArray(l))return l;if(Symbol.iterator in Object(l))return i(l,p);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();R.default=y;var u=O(1),d=function(i){return i&&i.__esModule?i:{default:i}}(u),E=O(9),c=["loadstart","pause","play","playing","seeking","seeked","timeupdate","ratechange","stalled","waiting","error","ended"],a={1:"MEDIA_ERR_ABORTED",2:"MEDIA_ERR_NETWORK",3:"MEDIA_ERR_DECODE",4:"MEDIA_ERR_SRC_NOT_SUPPORTED"}},function(F,R,O){"use strict";function y(n){return n&&n.__esModule?n:{default:n}}Object.defineProperty(R,"__esModule",{value:!0});var C=O(52),P=y(C),u=O(2),d=y(u),E=O(53),c=y(E),a=O(54),i=y(a),l=O(1),p=y(l),f=O(8),h=y(f),m=O(5),L=O(3),S=y(L),v={};v.safeCall=P.default,v.safeIncrement=d.default,v.getComputedStyle=c.default,v.secondsToMs=i.default,v.assign=p.default,v.headersStringToObject=h.default,v.extractHostnameAndDomain=m.extractHostnameAndDomain,v.extractHostname=m.extractHostname,v.now=S.default.now,R.default=v},function(F,R,O){"use strict";function y(u,d,E,c){var a=c;if(u&&typeof u[d]=="function")try{a=u[d].apply(u,E)}catch(i){P.default.info("safeCall error",i)}return a}Object.defineProperty(R,"__esModule",{value:!0}),R.default=y;var C=O(4),P=function(u){return u&&u.__esModule?u:{default:u}}(C)},function(F,R,O){"use strict";function y(d,E){if(d&&E&&P.default&&typeof P.default.getComputedStyle=="function"){var c=void 0;return u&&u.has(d)&&(c=u.get(d)),c||(c=P.default.getComputedStyle(d,null),u&&u.set(d,c)),c.getPropertyValue(E)}}Object.defineProperty(R,"__esModule",{value:!0}),R.default=y;var C=O(0),P=function(d){return d&&d.__esModule?d:{default:d}}(C),u=void 0;P.default&&P.default.WeakMap&&(u=new WeakMap)},function(F,R,O){"use strict";function y(C){return Math.floor(1e3*C)}Object.defineProperty(R,"__esModule",{value:!0}),R.default=y}])})})()},function(k,x,j){"use strict";function F(C,P){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],d=arguments.length>3&&arguments[3]!==void 0?arguments[3]:[],E=arguments.length>4&&arguments[4]!==void 0?arguments[4]:function(){return{}},c=!1;C.on("adstart",function(){c=!0}),C.on("adend",function(){c=!1}),C.on("adserror",function(){c=!1});var a=function(){var i=y(P.currentTime()),l=function f(){var h=O.default.utils.now(),m=y(P.currentTime());if(c){if(m>i){var L=E();L.viewer_time=h-Math.max(0,m-i),P.off("timeupdate",f),C.mux.emit("adplaying",L)}}else P.off("timeupdate",f)};P.on("timeupdate",l);var p=function f(){P.off("timeupdate",l),u.forEach(function(h){P.off(h,f)})};u.forEach(function(f){P.on(f,p)})};d.forEach(function(i){P.on(i,a)})}Object.defineProperty(x,"__esModule",{value:!0}),x.default=F;var R=j(0),O=function(C){return C&&C.__esModule?C:{default:C}}(R),y=O.default.utils.secondsToMs},function(k,x,j){"use strict";function F(D){return D&&D.__esModule?D:{default:D}}function R(D){if(y.default.IS_IE8)return!1;var I=this,w=I.id();D=v({automaticErrorTracking:!0},D),D.data=v({player_software_name:"Video.js",player_software_version:y.default.VERSION||"< 4.11",player_mux_plugin_name:"videojs-mux",player_mux_plugin_version:"4.0.0"},D.data),D.getPlayheadTime=function(){return A(I.currentTime())},D.getStateData=function(){var V=n(I,"videoHeight"),X=n(I,"videoWidth");if(X===void 0||V===void 0){var $=I.el().firstChild;$&&$.nodeName.toUpperCase()==="VIDEO"&&(V=$.videoHeight,X=$.videoWidth)}return{player_is_paused:n(I,"paused"),player_is_fullscreen:n(I,"isFullscreen"),player_autoplay_on:!!n(I,"autoplay"),player_preload_on:n(I,"preload"),player_width:s(I.el(),"width"),player_height:s(I.el(),"height"),player_language_code:n(I,"language"),video_poster_url:n(I,"poster"),video_source_url:n(I,"currentSrc"),video_source_mime_type:n(I,"currentType")&&n(I,"currentType").toLowerCase(),video_source_duration:A(n(I,"duration")||0),video_source_height:V,video_source_width:X}},I.mux=function(){S.error("[videojs-mux] The plugin was initialized more than once.")},I.mux.emit=function(V,X){P.default.emit(w,V,X)},I.mux.addHLSJS=function(V){P.default.addHLSJS(w,V)},I.mux.log=S,I.mux.utils=P.default.utils,P.default.init(w,D);var B=!1,N=function(){B||I.mux.emit("playerready"),B=!0};I.ready(function(){I.addClass("vjs-mux"),d.default.setTimeout(N,0)});var W=!1;I.one("play",N),_.forEach(function(V){(V!=="error"||D.automaticErrorTracking)&&I.on(V,function(){if(!W){var X={};if(V==="error"){var $=n(I,"error");X.player_error_code=$&&$.code,X.player_error_message=$&&$.message}I.mux.emit(V,X)}})});var G=!1;I.on("play",function(){G=!0}),I.on("pause",function(){G=!1}),I.on("adstart",function(){W=!0,G&&I.mux.emit("pause"),I.mux.emit("adbreakstart")}),I.on("adend",function(){I.mux.emit("adbreakend"),W=!1,n(I,"paused")||(I.mux.emit("play"),G=!0,I.onceux&&I.mux.emit("playing"))}),I.ima&&(0,c.default)(I),I.onceux&&(0,h.default)(I),I.ima3&&typeof I.ima3.ready=="function"&&(0,i.default)(I),I.FreeWheelPlugin&&I.FreeWheelPlugin.VERSION&&(0,p.default)(I),I.on("dispose",function(){I.mux.emit("destroy")})}var O=j(3),y=F(O),C=j(0),P=F(C),u=j(4),d=F(u),E=j(6),c=F(E),a=j(7),i=F(a),l=j(8),p=F(l),f=j(9),h=F(f),m=j(10),L=F(m),S=P.default.log,v=P.default.utils.assign,n=P.default.utils.safeCall,s=P.default.utils.getComputedStyle,A=P.default.utils.secondsToMs,_=["loadstart","pause","play","playing","seeking","seeked","timeupdate","ratechange","stalled","waiting","error","ended"];(y.default.registerPlugin||y.default.plugin||function(){P.default.log.error("No valid method to register videojs plugin available.")})("mux",R),(0,L.default)(y.default)},function(k,x){k.exports=H},function(k,x,j){(function(F){var R;R=typeof window!="undefined"?window:F!==void 0?F:typeof self!="undefined"?self:{},k.exports=R}).call(x,j(5))},function(k,x){var j;j=function(){return this}();try{j=j||Function("return this")()||(0,eval)("this")}catch(F){typeof window=="object"&&(j=window)}k.exports=j},function(k,x,j){"use strict";function F(R){var O=function(i){i=i||{};var l=typeof i.getAdData=="function"?i.getAdData():{},p=typeof i.getAd=="function"?i.getAd():{},f=typeof p.getMediaUrl=="function"?p.getMediaUrl():l.mediaUrl,h=R.ima.settings||{},m={};return f&&(m.ad_asset_url=f),h.adTagUrl&&(m.ad_tag_url=h.adTagUrl),m},y=void 0,C=void 0,P=void 0,u=void 0,d=void 0,E=void 0;try{var c=window.google.ima.AdEvent.Type;y=c.LOADED,C=c.STARTED,P=c.COMPLETE,u=c.PAUSED,d=c.RESUMED,E=c.SKIPPED}catch(i){y="loaded",C="start",P="complete",u="pause",d="resume",E="skip"}var a=0;R.mux.triggerAdRequest=function(){a++,R.mux.emit("adrequest",O())},R.on("adsready",function(){var i=R.ima.addEventListener||function(){};i(y,function(l){var p=O(l);a>0&&(a--,R.mux.emit("adresponse",p)),R.mux.emit("adplay",p)}),i(C,function(l){var p=O(l);R.mux.emit("adplaying",p)}),i(d,function(l){var p=O(l);R.mux.emit("adplay",p),R.mux.emit("adplaying",p)}),i(u,function(l){var p=O(l);R.mux.emit("adpause",p)}),i(P,function(l){var p=O(l);R.mux.emit("adended",p)}),i(E,function(l){var p=O(l);R.mux.emit("adended",p)}),R.on("adserror",function(){a>0&&(a--,R.mux.emit("adresponse")),R.mux.emit("aderror")})})}Object.defineProperty(x,"__esModule",{value:!0}),x.default=F},function(k,x,j){"use strict";function F(C){if(typeof C!="string")return!1;var P=C.split(".").map(function(E){return parseInt(E)}),u=P[0],d=P[1];return u>2||u===2&&d>=3}function R(C){var P=function(){var E=C.ima3.currentAd,c=C.ima3.settings,a={};return E&&(a.ad_asset_url=E.mediaUrl),c&&(a.ad_tag_url=c.serverUrl),a};if(F(C.ima3.version)){var u=0,d=function(){u>0&&(u--,C.mux.emit("adresponse",P()))};C.on("ads-request",function(){u++,C.mux.emit("adrequest",P())}),C.on("ads-load",function(){d(),C.mux.emit("adplay",P())}),C.on("adserror",function(){d(),C.mux.emit("aderror")}),C.on("ads-play",function(){C.mux.emit("adplay",P())}),C.on("ads-pause",function(){C.mux.emit("adpause",P())}),C.on("ads-ad-ended",function(){C.mux.emit("adended",P())})}C.ima3.ready(function(){if(C.ima3.adPlayer){F(C.ima3.version)||(C.ima3.adPlayer.on("play",function(){C.mux.emit("adplay")}),C.ima3.adPlayer.on("pause",function(){C.mux.emit("adpause")}),C.ima3.adPlayer.on("ended",function(){C.mux.emit("adended")}));var E=["pause","ended","adserror"],c=["play"];(0,y.default)(C,C.ima3.adPlayer,E,c,P)}else C.mux.log("Legacy IMA3 plugin found, ad events may not track correctly."),C.on("ads-ad-started",function(){C.mux.emit("adplaying",P())}),C.on("ads-play",function(){C.mux.emit("adplaying",P())})})}Object.defineProperty(x,"__esModule",{value:!0}),x.brightcoveImaAdsEventsSupported=F,x.default=R;var O=j(1),y=function(C){return C&&C.__esModule?C:{default:C}}(O)},function(k,x,j){"use strict";function F(R){var O=function(y){var C=R.FreeWheelPlugin,P={};switch(y){case"adplay":case"adplaying":case"adpause":P.ad_asset_url=R.currentSrc()}return C&&(P.ad_tag_url=C.tech.toLowerCase()==="html5"?C.settings.Html5.serverUrl:C.settings.Flash.serverUrl),P};R.on("ads-request",function(){R.mux.emit("adrequest",O("adrequest"))}),R.on("ads-load",function(){R.mux.emit("adresponse",O("adresponse"))}),R.on("adserror",function(){R.mux.emit("aderror")}),R.on("ads-ad-started",function(){R.mux.emit("adplay",O("adplay")),R.mux.emit("adplaying",O("adplaying"))}),R.on("ads-play",function(){R.mux.emit("adplay",O("adplay")),R.mux.emit("adplaying",O("adplaying"))}),R.on("ads-pause",function(){R.mux.emit("adpause",O("adpause"))}),R.on("ads-ad-ended",function(){R.mux.emit("adended",O("adended"))}),R.on("adend",function(){R.mux.emit("play")})}Object.defineProperty(x,"__esModule",{value:!0}),x.default=F},function(k,x,j){"use strict";function F(y){var C=["onceux-linearad-pause","onceux-linearad-skipped","onceux-linearad-complete","adserror"],P=["adstart","onceux-linearad-resume"];(0,O.default)(y,y,C,P),y.on("adstart",function(){y.mux.emit("adplay")}),y.on("onceux-linearad-start",function(u){u.linearAd&&u.linearAd.index>0&&(y.mux.emit("adplay"),y.mux.emit("adplaying"))}),y.on("onceux-linearad-resume",function(){y.mux.emit("adplay")}),y.on("onceux-linearad-pause",function(){y.mux.emit("adpause")}),y.on("onceux-linearad-complete",function(){y.mux.emit("adended")}),y.on("onceux-linearad-skipped",function(){y.mux.emit("adended")})}Object.defineProperty(x,"__esModule",{value:!0}),x.default=F;var R=j(1),O=function(y){return y&&y.__esModule?y:{default:y}}(R)},function(k,x,j){"use strict";function F(u){if(!P&&typeof u.getTech=="function"){for(var d=u.getTech("Html5")||{},E=d.sourceHandlers,c=0;c<E.length;c++)(function(a){var i=E[a],l=i.handleSource;i.handleSource=function(p,f){var h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},m=l(p,f,h);if(m&&typeof m.xhr=="function")try{var L=u.VERSION.split("."),S=R(L,2),v=S[0],n=S[1];v=parseInt(v),n=parseInt(n);var s=v>=7&&n>=4?m.player().id():m.player_.el_.parentNode.id;(0,y.default)(u(s),m.xhr),(0,C.trackRenditionChanges)(u(s))}catch(A){}return m}})(c);P=!0}}Object.defineProperty(x,"__esModule",{value:!0});var R=function(){function u(d,E){var c=[],a=!0,i=!1,l=void 0;try{for(var p,f=d[Symbol.iterator]();!(a=(p=f.next()).done)&&(c.push(p.value),!E||c.length!==E);a=!0);}catch(h){i=!0,l=h}finally{try{!a&&f.return&&f.return()}finally{if(i)throw l}}return c}return function(d,E){if(Array.isArray(d))return d;if(Symbol.iterator in Object(d))return u(d,E);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();x.default=F;var O=j(11),y=function(u){return u&&u.__esModule?u:{default:u}}(O),C=j(13),P=!1},function(k,x,j){"use strict";function F(u){return u&&u.__esModule?u:{default:u}}function R(u,d){var E=function(a,i,l){var p=(0,y.default)(u,a,i);return function(){try{p()}catch(f){}try{l()}catch(f){}}},c=function(a){return function(i){var l=P.default.utils.now();try{a(i)}catch(p){}try{i.onreadystatechange=E(i,l,i.onreadystatechange||function(){})}catch(p){}}};d.beforeRequest=function(a){return function(i){var l=a(i);return l.beforeSend=c(l.beforeSend||function(){}),l}}(d.beforeRequest||function(a){return a})}Object.defineProperty(x,"__esModule",{value:!0}),x.default=R;var O=j(12),y=F(O),C=j(0),P=F(C)},function(k,x,j){"use strict";function F(C,P,u){var d=C.mux.utils.extractHostnameAndDomain,E=C.mux.utils.headersStringToObject,c=function(i){var l=i["content-type"];return l?l.match(/^audio\/mpegurl/i)?"manifest":l.match(/^audio.*/i)?"audio":l.match(/^video.*/)?"video":l.match(/^application\/x-mpegurl/i)||l.match(/^application\/vnd.apple.mpegurl/i)||l.match(/^application\/dash+xml/i)?"manifest":"unknown":"unknown"},a=0;return function(){var i=P.readyState;if(i>=2){if(a=a||y.default.utils.now(),i!==4)return;if(P.status>=200&&P.status<300){var l=y.default.utils.now(),p=P.responseType==="arraybuffer"?P.response.byteLength:P.responseText.length,f=d(P.responseURL),h=R(f,1),m=h[0],L=E(P.getAllResponseHeaders?P.getAllResponseHeaders():""),S=c(L),v={request_start:u,request_response_start:a,request_response_end:l,request_bytes_loaded:p,request_hostname:m,request_response_headers:L,request_type:S};C.mux.emit("requestcompleted",v)}else C.mux.emit("requestfailed")}}}Object.defineProperty(x,"__esModule",{value:!0});var R=function(){function C(P,u){var d=[],E=!0,c=!1,a=void 0;try{for(var i,l=P[Symbol.iterator]();!(E=(i=l.next()).done)&&(d.push(i.value),!u||d.length!==u);E=!0);}catch(p){c=!0,a=p}finally{try{!E&&l.return&&l.return()}finally{if(c)throw a}}return d}return function(P,u){if(Array.isArray(P))return P;if(Symbol.iterator in Object(P))return C(P,u);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();x.default=F;var O=j(0),y=function(C){return C&&C.__esModule?C:{default:C}}(O)},function(k,x,j){"use strict";Object.defineProperty(x,"__esModule",{value:!0});var F=function(O){for(var y=O.textTracks(),C=void 0,P=0;P<y.length;P++)y[P].label==="segment-metadata"&&(C=y[P]);return C},R=function(O){var y=F(O),C=void 0;y&&y.on&&y.on("cuechange",function(){try{var P=O.tech({IWillNotUseThisInPlugins:!0}),u=P.vhs||P.hls,d=u.playlists.media().attributes.BANDWIDTH;C!==d&&O.mux.emit("renditionchange",{video_source_bitrate:d}),C=d}catch(E){O.mux&&O.mux.log&&O.mux.log.warn&&O.mux.log.warn("Cannot retrieve BANDWIDTH information from player: "+E)}})};x.getSegmentMetadataTrack=F,x.trackRenditionChanges=R}])})})()},497:(oe,re,K)=>{var M=K(697),H=oe.exports={WebVTT:K(13),VTTCue:K(190),VTTRegion:K(146)};M.vttjs=H,M.WebVTT=H.WebVTT;var k=H.VTTCue,x=H.VTTRegion,j=M.VTTCue,F=M.VTTRegion;H.shim=function(){M.VTTCue=k,M.VTTRegion=x},H.restore=function(){M.VTTCue=j,M.VTTRegion=F},M.VTTCue||H.shim()},13:(oe,re,K)=>{var M=K(675),H=Object.create||function(){function n(){}return function(s){if(arguments.length!==1)throw new Error("Object.create shim only accepts one parameter.");return n.prototype=s,new n}}();function k(n,s){this.name="ParsingError",this.code=n.code,this.message=s||n.message}k.prototype=H(Error.prototype),k.prototype.constructor=k,k.Errors={BadSignature:{code:0,message:"Malformed WebVTT signature."},BadTimeStamp:{code:1,message:"Malformed time stamp."}};function x(n){function s(_,D,I,w){return(_|0)*3600+(D|0)*60+(I|0)+(w|0)/1e3}var A=n.match(/^(\d+):(\d{1,2})(:\d{1,2})?\.(\d{3})/);return A?A[3]?s(A[1],A[2],A[3].replace(":",""),A[4]):A[1]>59?s(A[1],A[2],0,A[4]):s(0,A[1],A[2],A[4]):null}function j(){this.values=H(null)}j.prototype={set:function(n,s){!this.get(n)&&s!==""&&(this.values[n]=s)},get:function(n,s,A){return A?this.has(n)?this.values[n]:s[A]:this.has(n)?this.values[n]:s},has:function(n){return n in this.values},alt:function(n,s,A){for(var _=0;_<A.length;++_)if(s===A[_]){this.set(n,s);break}},integer:function(n,s){/^-?\d+$/.test(s)&&this.set(n,parseInt(s,10))},percent:function(n,s){var A;return(A=s.match(/^([\d]{1,3})(\.[\d]*)?%$/))&&(s=parseFloat(s),s>=0&&s<=100)?(this.set(n,s),!0):!1}};function F(n,s,A,_){var D=_?n.split(_):[n];for(var I in D)if(typeof D[I]=="string"){var w=D[I].split(A);if(w.length===2){var B=w[0],N=w[1];s(B,N)}}}function R(n,s,A){var _=n;function D(){var B=x(n);if(B===null)throw new k(k.Errors.BadTimeStamp,"Malformed timestamp: "+_);return n=n.replace(/^[^\sa-zA-Z-]+/,""),B}function I(B,N){var W=new j;F(B,function(G,V){switch(G){case"region":for(var X=A.length-1;X>=0;X--)if(A[X].id===V){W.set(G,A[X].region);break}break;case"vertical":W.alt(G,V,["rl","lr"]);break;case"line":var $=V.split(","),q=$[0];W.integer(G,q),W.percent(G,q)&&W.set("snapToLines",!1),W.alt(G,q,["auto"]),$.length===2&&W.alt("lineAlign",$[1],["start","center","end"]);break;case"position":$=V.split(","),W.percent(G,$[0]),$.length===2&&W.alt("positionAlign",$[1],["start","center","end"]);break;case"size":W.percent(G,V);break;case"align":W.alt(G,V,["start","center","end","left","right"]);break}},/:/,/\s/),N.region=W.get("region",null),N.vertical=W.get("vertical","");try{N.line=W.get("line","auto")}catch(G){}N.lineAlign=W.get("lineAlign","start"),N.snapToLines=W.get("snapToLines",!0),N.size=W.get("size",100);try{N.align=W.get("align","center")}catch(G){N.align=W.get("align","middle")}try{N.position=W.get("position","auto")}catch(G){N.position=W.get("position",{start:0,left:0,center:50,middle:50,end:100,right:100},N.align)}N.positionAlign=W.get("positionAlign",{start:"start",left:"start",center:"center",middle:"center",end:"end",right:"end"},N.align)}function w(){n=n.replace(/^\s+/,"")}if(w(),s.startTime=D(),w(),n.substr(0,3)!=="-->")throw new k(k.Errors.BadTimeStamp,"Malformed time stamp (time stamps must be separated by '-->'): "+_);n=n.substr(3),w(),s.endTime=D(),w(),I(n,s)}var O=M.createElement&&M.createElement("textarea"),y={c:"span",i:"i",b:"b",u:"u",ruby:"ruby",rt:"rt",v:"span",lang:"span"},C={white:"rgba(255,255,255,1)",lime:"rgba(0,255,0,1)",cyan:"rgba(0,255,255,1)",red:"rgba(255,0,0,1)",yellow:"rgba(255,255,0,1)",magenta:"rgba(255,0,255,1)",blue:"rgba(0,0,255,1)",black:"rgba(0,0,0,1)"},P={v:"title",lang:"lang"},u={rt:"ruby"};function d(n,s){function A(){if(!s)return null;function q(ee){return s=s.substr(ee.length),ee}var Z=s.match(/^([^<]*)(<[^>]*>?)?/);return q(Z[1]?Z[1]:Z[2])}function _(q){return O.innerHTML=q,q=O.textContent,O.textContent="",q}function D(q,Z){return!u[Z.localName]||u[Z.localName]===q.localName}function I(q,Z){var ee=y[q];if(!ee)return null;var ie=n.document.createElement(ee),ue=P[q];return ue&&Z&&(ie[ue]=Z.trim()),ie}for(var w=n.document.createElement("div"),B=w,N,W=[];(N=A())!==null;){if(N[0]==="<"){if(N[1]==="/"){W.length&&W[W.length-1]===N.substr(2).replace(">","")&&(W.pop(),B=B.parentNode);continue}var G=x(N.substr(1,N.length-2)),V;if(G){V=n.document.createProcessingInstruction("timestamp",G),B.appendChild(V);continue}var X=N.match(/^<([^.\s/0-9>]+)(\.[^\s\\>]+)?([^>\\]+)?(\\?)>?$/);if(!X||(V=I(X[1],X[3]),!V)||!D(B,V))continue;if(X[2]){var $=X[2].split(".");$.forEach(function(q){var Z=/^bg_/.test(q),ee=Z?q.slice(3):q;if(C.hasOwnProperty(ee)){var ie=Z?"background-color":"color",ue=C[ee];V.style[ie]=ue}}),V.className=$.join(" ")}W.push(X[1]),B.appendChild(V),B=V;continue}B.appendChild(n.document.createTextNode(_(N)))}return w}var E=[[1470,1470],[1472,1472],[1475,1475],[1478,1478],[1488,1514],[1520,1524],[1544,1544],[1547,1547],[1549,1549],[1563,1563],[1566,1610],[1645,1647],[1649,1749],[1765,1766],[1774,1775],[1786,1805],[1807,1808],[1810,1839],[1869,1957],[1969,1969],[1984,2026],[2036,2037],[2042,2042],[2048,2069],[2074,2074],[2084,2084],[2088,2088],[2096,2110],[2112,2136],[2142,2142],[2208,2208],[2210,2220],[8207,8207],[64285,64285],[64287,64296],[64298,64310],[64312,64316],[64318,64318],[64320,64321],[64323,64324],[64326,64449],[64467,64829],[64848,64911],[64914,64967],[65008,65020],[65136,65140],[65142,65276],[67584,67589],[67592,67592],[67594,67637],[67639,67640],[67644,67644],[67647,67669],[67671,67679],[67840,67867],[67872,67897],[67903,67903],[67968,68023],[68030,68031],[68096,68096],[68112,68115],[68117,68119],[68121,68147],[68160,68167],[68176,68184],[68192,68223],[68352,68405],[68416,68437],[68440,68466],[68472,68479],[68608,68680],[126464,126467],[126469,126495],[126497,126498],[126500,126500],[126503,126503],[126505,126514],[126516,126519],[126521,126521],[126523,126523],[126530,126530],[126535,126535],[126537,126537],[126539,126539],[126541,126543],[126545,126546],[126548,126548],[126551,126551],[126553,126553],[126555,126555],[126557,126557],[126559,126559],[126561,126562],[126564,126564],[126567,126570],[126572,126578],[126580,126583],[126585,126588],[126590,126590],[126592,126601],[126603,126619],[126625,126627],[126629,126633],[126635,126651],[1114109,1114109]];function c(n){for(var s=0;s<E.length;s++){var A=E[s];if(n>=A[0]&&n<=A[1])return!0}return!1}function a(n){var s=[],A="",_;if(!n||!n.childNodes)return"ltr";function D(B,N){for(var W=N.childNodes.length-1;W>=0;W--)B.push(N.childNodes[W])}function I(B){if(!B||!B.length)return null;var N=B.pop(),W=N.textContent||N.innerText;if(W){var G=W.match(/^.*(\n|\r)/);return G?(B.length=0,G[0]):W}if(N.tagName==="ruby")return I(B);if(N.childNodes)return D(B,N),I(B)}for(D(s,n);A=I(s);)for(var w=0;w<A.length;w++)if(_=A.charCodeAt(w),c(_))return"rtl";return"ltr"}function i(n){if(typeof n.line=="number"&&(n.snapToLines||n.line>=0&&n.line<=100))return n.line;if(!n.track||!n.track.textTrackList||!n.track.textTrackList.mediaElement)return-1;for(var s=n.track,A=s.textTrackList,_=0,D=0;D<A.length&&A[D]!==s;D++)A[D].mode==="showing"&&_++;return++_*-1}function l(){}l.prototype.applyStyles=function(n,s){s=s||this.div;for(var A in n)n.hasOwnProperty(A)&&(s.style[A]=n[A])},l.prototype.formatStyle=function(n,s){return n===0?0:n+s};function p(n,s,A){l.call(this),this.cue=s,this.cueDiv=d(n,s.text);var _={color:"rgba(255, 255, 255, 1)",backgroundColor:"rgba(0, 0, 0, 0.8)",position:"relative",left:0,right:0,top:0,bottom:0,display:"inline",writingMode:s.vertical===""?"horizontal-tb":s.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext"};this.applyStyles(_,this.cueDiv),this.div=n.document.createElement("div"),_={direction:a(this.cueDiv),writingMode:s.vertical===""?"horizontal-tb":s.vertical==="lr"?"vertical-lr":"vertical-rl",unicodeBidi:"plaintext",textAlign:s.align==="middle"?"center":s.align,font:A.font,whiteSpace:"pre-line",position:"absolute"},this.applyStyles(_),this.div.appendChild(this.cueDiv);var D=0;switch(s.positionAlign){case"start":D=s.position;break;case"center":D=s.position-s.size/2;break;case"end":D=s.position-s.size;break}s.vertical===""?this.applyStyles({left:this.formatStyle(D,"%"),width:this.formatStyle(s.size,"%")}):this.applyStyles({top:this.formatStyle(D,"%"),height:this.formatStyle(s.size,"%")}),this.move=function(I){this.applyStyles({top:this.formatStyle(I.top,"px"),bottom:this.formatStyle(I.bottom,"px"),left:this.formatStyle(I.left,"px"),right:this.formatStyle(I.right,"px"),height:this.formatStyle(I.height,"px"),width:this.formatStyle(I.width,"px")})}}p.prototype=H(l.prototype),p.prototype.constructor=p;function f(n){var s,A,_,D;if(n.div){A=n.div.offsetHeight,_=n.div.offsetWidth,D=n.div.offsetTop;var I=(I=n.div.childNodes)&&(I=I[0])&&I.getClientRects&&I.getClientRects();n=n.div.getBoundingClientRect(),s=I?Math.max(I[0]&&I[0].height||0,n.height/I.length):0}this.left=n.left,this.right=n.right,this.top=n.top||D,this.height=n.height||A,this.bottom=n.bottom||D+(n.height||A),this.width=n.width||_,this.lineHeight=s!==void 0?s:n.lineHeight}f.prototype.move=function(n,s){switch(s=s!==void 0?s:this.lineHeight,n){case"+x":this.left+=s,this.right+=s;break;case"-x":this.left-=s,this.right-=s;break;case"+y":this.top+=s,this.bottom+=s;break;case"-y":this.top-=s,this.bottom-=s;break}},f.prototype.overlaps=function(n){return this.left<n.right&&this.right>n.left&&this.top<n.bottom&&this.bottom>n.top},f.prototype.overlapsAny=function(n){for(var s=0;s<n.length;s++)if(this.overlaps(n[s]))return!0;return!1},f.prototype.within=function(n){return this.top>=n.top&&this.bottom<=n.bottom&&this.left>=n.left&&this.right<=n.right},f.prototype.overlapsOppositeAxis=function(n,s){switch(s){case"+x":return this.left<n.left;case"-x":return this.right>n.right;case"+y":return this.top<n.top;case"-y":return this.bottom>n.bottom}},f.prototype.intersectPercentage=function(n){var s=Math.max(0,Math.min(this.right,n.right)-Math.max(this.left,n.left)),A=Math.max(0,Math.min(this.bottom,n.bottom)-Math.max(this.top,n.top)),_=s*A;return _/(this.height*this.width)},f.prototype.toCSSCompatValues=function(n){return{top:this.top-n.top,bottom:n.bottom-this.bottom,left:this.left-n.left,right:n.right-this.right,height:this.height,width:this.width}},f.getSimpleBoxPosition=function(n){var s=n.div?n.div.offsetHeight:n.tagName?n.offsetHeight:0,A=n.div?n.div.offsetWidth:n.tagName?n.offsetWidth:0,_=n.div?n.div.offsetTop:n.tagName?n.offsetTop:0;n=n.div?n.div.getBoundingClientRect():n.tagName?n.getBoundingClientRect():n;var D={left:n.left,right:n.right,top:n.top||_,height:n.height||s,bottom:n.bottom||_+(n.height||s),width:n.width||A};return D};function h(n,s,A,_){function D(ee,ie){for(var ue,se=new f(ee),le=1,ce=0;ce<ie.length;ce++){for(;ee.overlapsOppositeAxis(A,ie[ce])||ee.within(A)&&ee.overlapsAny(_);)ee.move(ie[ce]);if(ee.within(A))return ee;var me=ee.intersectPercentage(A);le>me&&(ue=new f(ee),le=me),ee=new f(se)}return ue||se}var I=new f(s),w=s.cue,B=i(w),N=[];if(w.snapToLines){var W;switch(w.vertical){case"":N=["+y","-y"],W="height";break;case"rl":N=["+x","-x"],W="width";break;case"lr":N=["-x","+x"],W="width";break}var G=I.lineHeight,V=G*Math.round(B),X=A[W]+G,$=N[0];Math.abs(V)>X&&(V=V<0?-1:1,V*=Math.ceil(X/G)*G),B<0&&(V+=w.vertical===""?A.height:A.width,N=N.reverse()),I.move($,V)}else{var q=I.lineHeight/A.height*100;switch(w.lineAlign){case"center":B-=q/2;break;case"end":B-=q;break}switch(w.vertical){case"":s.applyStyles({top:s.formatStyle(B,"%")});break;case"rl":s.applyStyles({left:s.formatStyle(B,"%")});break;case"lr":s.applyStyles({right:s.formatStyle(B,"%")});break}N=["+y","-x","+x","-y"],I=new f(s)}var Z=D(I,N);s.move(Z.toCSSCompatValues(A))}function m(){}m.StringDecoder=function(){return{decode:function(n){if(!n)return"";if(typeof n!="string")throw new Error("Error - expected string data.");return decodeURIComponent(encodeURIComponent(n))}}},m.convertCueToDOMTree=function(n,s){return!n||!s?null:d(n,s)};var L=.05,S="sans-serif",v="1.5%";m.processCues=function(n,s,A){if(!n||!s||!A)return null;for(;A.firstChild;)A.removeChild(A.firstChild);var _=n.document.createElement("div");_.style.position="absolute",_.style.left="0",_.style.right="0",_.style.top="0",_.style.bottom="0",_.style.margin=v,A.appendChild(_);function D(G){for(var V=0;V<G.length;V++)if(G[V].hasBeenReset||!G[V].displayState)return!0;return!1}if(!D(s)){for(var I=0;I<s.length;I++)_.appendChild(s[I].displayState);return}var w=[],B=f.getSimpleBoxPosition(_),N=Math.round(B.height*L*100)/100,W={font:N+"px "+S};(function(){for(var G,V,X=0;X<s.length;X++)V=s[X],G=new p(n,V,W),_.appendChild(G.div),h(n,G,B,w),V.displayState=G.div,w.push(f.getSimpleBoxPosition(G))})()},m.Parser=function(n,s,A){A||(A=s,s={}),s||(s={}),this.window=n,this.vttjs=s,this.state="INITIAL",this.buffer="",this.decoder=A||new TextDecoder("utf8"),this.regionList=[]},m.Parser.prototype={reportOrThrowError:function(n){if(n instanceof k)this.onparsingerror&&this.onparsingerror(n);else throw n},parse:function(n){var s=this;n&&(s.buffer+=s.decoder.decode(n,{stream:!0}));function A(){for(var G=s.buffer,V=0;V<G.length&&G[V]!=="\r"&&G[V]!==`
`;)++V;var X=G.substr(0,V);return G[V]==="\r"&&++V,G[V]===`
`&&++V,s.buffer=G.substr(V),X}function _(G){var V=new j;if(F(G,function($,q){switch($){case"id":V.set($,q);break;case"width":V.percent($,q);break;case"lines":V.integer($,q);break;case"regionanchor":case"viewportanchor":var Z=q.split(",");if(Z.length!==2)break;var ee=new j;if(ee.percent("x",Z[0]),ee.percent("y",Z[1]),!ee.has("x")||!ee.has("y"))break;V.set($+"X",ee.get("x")),V.set($+"Y",ee.get("y"));break;case"scroll":V.alt($,q,["up"]);break}},/=/,/\s/),V.has("id")){var X=new(s.vttjs.VTTRegion||s.window.VTTRegion);X.width=V.get("width",100),X.lines=V.get("lines",3),X.regionAnchorX=V.get("regionanchorX",0),X.regionAnchorY=V.get("regionanchorY",100),X.viewportAnchorX=V.get("viewportanchorX",0),X.viewportAnchorY=V.get("viewportanchorY",100),X.scroll=V.get("scroll",""),s.onregion&&s.onregion(X),s.regionList.push({id:V.get("id"),region:X})}}function D(G){var V=new j;F(G,function(X,$){switch(X){case"MPEGT":V.integer(X+"S",$);break;case"LOCA":V.set(X+"L",x($));break}},/[^\d]:/,/,/),s.ontimestampmap&&s.ontimestampmap({MPEGTS:V.get("MPEGTS"),LOCAL:V.get("LOCAL")})}function I(G){G.match(/X-TIMESTAMP-MAP/)?F(G,function(V,X){switch(V){case"X-TIMESTAMP-MAP":D(X);break}},/=/):F(G,function(V,X){switch(V){case"Region":_(X);break}},/:/)}try{var w;if(s.state==="INITIAL"){if(!/\r\n|\n/.test(s.buffer))return this;w=A();var B=w.match(/^WEBVTT([ \t].*)?$/);if(!B||!B[0])throw new k(k.Errors.BadSignature);s.state="HEADER"}for(var N=!1;s.buffer;){if(!/\r\n|\n/.test(s.buffer))return this;switch(N?N=!1:w=A(),s.state){case"HEADER":/:/.test(w)?I(w):w||(s.state="ID");continue;case"NOTE":w||(s.state="ID");continue;case"ID":if(/^NOTE($|[ \t])/.test(w)){s.state="NOTE";break}if(!w)continue;s.cue=new(s.vttjs.VTTCue||s.window.VTTCue)(0,0,"");try{s.cue.align="center"}catch(G){s.cue.align="middle"}if(s.state="CUE",w.indexOf("-->")===-1){s.cue.id=w;continue}case"CUE":try{R(w,s.cue,s.regionList)}catch(G){s.reportOrThrowError(G),s.cue=null,s.state="BADCUE";continue}s.state="CUETEXT";continue;case"CUETEXT":var W=w.indexOf("-->")!==-1;if(!w||W&&(N=!0)){s.oncue&&s.oncue(s.cue),s.cue=null,s.state="ID";continue}s.cue.text&&(s.cue.text+=`
`),s.cue.text+=w.replace(/\u2028/g,`
`).replace(/u2029/g,`
`);continue;case"BADCUE":w||(s.state="ID");continue}}}catch(G){s.reportOrThrowError(G),s.state==="CUETEXT"&&s.cue&&s.oncue&&s.oncue(s.cue),s.cue=null,s.state=s.state==="INITIAL"?"BADWEBVTT":"BADCUE"}return this},flush:function(){var n=this;try{if(n.buffer+=n.decoder.decode(),(n.cue||n.state==="HEADER")&&(n.buffer+=`

`,n.parse()),n.state==="INITIAL")throw new k(k.Errors.BadSignature)}catch(s){n.reportOrThrowError(s)}return n.onflush&&n.onflush(),this}},oe.exports=m},190:oe=>{var re="auto",K={"":1,lr:1,rl:1},M={start:1,center:1,end:1,left:1,right:1,auto:1,"line-left":1,"line-right":1};function H(j){if(typeof j!="string")return!1;var F=K[j.toLowerCase()];return F?j.toLowerCase():!1}function k(j){if(typeof j!="string")return!1;var F=M[j.toLowerCase()];return F?j.toLowerCase():!1}function x(j,F,R){this.hasBeenReset=!1;var O="",y=!1,C=j,P=F,u=R,d=null,E="",c=!0,a="auto",i="start",l="auto",p="auto",f=100,h="center";Object.defineProperties(this,{id:{enumerable:!0,get:function(){return O},set:function(m){O=""+m}},pauseOnExit:{enumerable:!0,get:function(){return y},set:function(m){y=!!m}},startTime:{enumerable:!0,get:function(){return C},set:function(m){if(typeof m!="number")throw new TypeError("Start time must be set to a number.");C=m,this.hasBeenReset=!0}},endTime:{enumerable:!0,get:function(){return P},set:function(m){if(typeof m!="number")throw new TypeError("End time must be set to a number.");P=m,this.hasBeenReset=!0}},text:{enumerable:!0,get:function(){return u},set:function(m){u=""+m,this.hasBeenReset=!0}},region:{enumerable:!0,get:function(){return d},set:function(m){d=m,this.hasBeenReset=!0}},vertical:{enumerable:!0,get:function(){return E},set:function(m){var L=H(m);if(L===!1)throw new SyntaxError("Vertical: an invalid or illegal direction string was specified.");E=L,this.hasBeenReset=!0}},snapToLines:{enumerable:!0,get:function(){return c},set:function(m){c=!!m,this.hasBeenReset=!0}},line:{enumerable:!0,get:function(){return a},set:function(m){if(typeof m!="number"&&m!==re)throw new SyntaxError("Line: an invalid number or illegal string was specified.");a=m,this.hasBeenReset=!0}},lineAlign:{enumerable:!0,get:function(){return i},set:function(m){var L=k(m);L?(i=L,this.hasBeenReset=!0):console.warn("lineAlign: an invalid or illegal string was specified.")}},position:{enumerable:!0,get:function(){return l},set:function(m){if(m<0||m>100)throw new Error("Position must be between 0 and 100.");l=m,this.hasBeenReset=!0}},positionAlign:{enumerable:!0,get:function(){return p},set:function(m){var L=k(m);L?(p=L,this.hasBeenReset=!0):console.warn("positionAlign: an invalid or illegal string was specified.")}},size:{enumerable:!0,get:function(){return f},set:function(m){if(m<0||m>100)throw new Error("Size must be between 0 and 100.");f=m,this.hasBeenReset=!0}},align:{enumerable:!0,get:function(){return h},set:function(m){var L=k(m);if(!L)throw new SyntaxError("align: an invalid or illegal alignment string was specified.");h=L,this.hasBeenReset=!0}}}),this.displayState=void 0}x.prototype.getCueAsHTML=function(){return WebVTT.convertCueToDOMTree(window,this.text)},oe.exports=x},146:oe=>{var re={"":!0,up:!0};function K(k){if(typeof k!="string")return!1;var x=re[k.toLowerCase()];return x?k.toLowerCase():!1}function M(k){return typeof k=="number"&&k>=0&&k<=100}function H(){var k=100,x=3,j=0,F=100,R=0,O=100,y="";Object.defineProperties(this,{width:{enumerable:!0,get:function(){return k},set:function(C){if(!M(C))throw new Error("Width must be between 0 and 100.");k=C}},lines:{enumerable:!0,get:function(){return x},set:function(C){if(typeof C!="number")throw new TypeError("Lines must be set to a number.");x=C}},regionAnchorY:{enumerable:!0,get:function(){return F},set:function(C){if(!M(C))throw new Error("RegionAnchorX must be between 0 and 100.");F=C}},regionAnchorX:{enumerable:!0,get:function(){return j},set:function(C){if(!M(C))throw new Error("RegionAnchorY must be between 0 and 100.");j=C}},viewportAnchorY:{enumerable:!0,get:function(){return O},set:function(C){if(!M(C))throw new Error("ViewportAnchorY must be between 0 and 100.");O=C}},viewportAnchorX:{enumerable:!0,get:function(){return R},set:function(C){if(!M(C))throw new Error("ViewportAnchorX must be between 0 and 100.");R=C}},scroll:{enumerable:!0,get:function(){return y},set:function(C){var P=K(C);P===!1?console.warn("Scroll: an invalid or illegal string was specified."):y=P}}})}oe.exports=H},18:(oe,re,K)=>{oe.exports=K(159).default},159:(oe,re,K)=>{"use strict";K.d(re,{default:()=>A});var M=K(207),H=K.n(M),k=K(199),x=K.n(k),j=Object.defineProperty,F=Object.assign,R=(_,D,I)=>(typeof D!="symbol"&&(D+=""),D in _?j(_,D,{enumerable:!0,configurable:!0,writable:!0,value:I}):_[D]=I);const O={MEDIA_ERR_CUSTOM:0,MEDIA_ERR_ABORTED:1,MEDIA_ERR_NETWORK:2,MEDIA_ERR_DECODE:3,MEDIA_ERR_SRC_NOT_SUPPORTED:4,MEDIA_ERR_ENCRYPTED:5},y={[x().ErrorTypes.NETWORK_ERROR]:O.MEDIA_ERR_NETWORK,[x().ErrorTypes.MEDIA_ERROR]:O.MEDIA_ERR_DECODE,[x().ErrorTypes.MUX_ERROR]:O.MEDIA_ERR_DECODE,[x().ErrorTypes.KEY_SYSTEM_ERROR]:O.MEDIA_ERR_ENCRYPTED,DEFAULT:O.MEDIA_ERR_CUSTOM},C=H().getTech("Tech").prototype.error;class P{constructor(D,I,w={}){this.source=D,this.tech=I,this._html5TechError=this.tech.error,this.tech.error=C,this.el=I.el(),this.hls=new(x())(F(F({},w.hls),{liveDurationInfinity:!0})),this.setupEventHandlers(),this.setupHls(),this.mediaElErrorHandler_=()=>this.tech.error(this.el.error)}dispose(){this.el.removeEventListener("error",this.mediaElErrorHandler_),this.tech.error=this._html5TechError,this.hls.destroy()}setupEventHandlers(){Object.values(x().Events).forEach(D=>{if(D===x().Events.ERROR){this.hls.on(D,(I,w)=>{var B;const{type:N}=w,W=(B=y[N])!=null?B:y.DEFAULT;this.tech.error({code:W,hlsError:w})});return}this.hls.on(D,(I,w)=>{this.tech.trigger(D,w)})}),this.el.addEventListener("error",this.mediaElErrorHandler_)}setupHls(){x().isSupported()?(this.hls.attachMedia(this.el),this.hls.loadSource(this.source.src)):this.el.canPlayType("application/vnd.apple.mpegurl")?this.el.src=this.source.src:console.log("[videojs-mux-kit] Error: browser does not support MSE nor Hls natively")}}R(P,"hlsTypeRE",/^application\/(x-mpegURL|vnd\.apple\.mpegURL)$/i),R(P,"hlsExtRE",/\.m3u8/i);const u={canHandleSource(_){return _.skipHlsJs?"":P.hlsTypeRE.test(_.type)?"probably":P.hlsExtRE.test(_.src)?"maybe":""},handleSource(_,D){return new P(_,D)},canPlayType(_){return P.hlsTypeRE.test(_)?"probably":""}};H().getTech("Html5").registerSourceHandler(u,0);const d=null,E={i8:"0.6.1"};var c=K(288);function a(_){var D,I;if((I=(D=_.tech_)==null?void 0:D.sourceHandler_)==null?void 0:I.hls){const w=_.tech_.sourceHandler_.hls;_.mux.addHLSJS({hlsjs:w,Hls:x()})}}function i(_,D){var I,w,B,N,W;if((I=_==null?void 0:_.dataset)==null?void 0:I.setup){let G=_.dataset.setup;G=JSON.parse(G),G&&((B=(w=G==null?void 0:G.plugins)==null?void 0:w.mux)==null?void 0:B.data)&&(G=l(G),G=JSON.stringify(G),_.dataset.setup=G)}return((W=(N=D==null?void 0:D.plugins)==null?void 0:N.mux)==null?void 0:W.data)&&(D=l(D)),D}function l(_){var D;return _.plugins.mux.data.player_software_name="vjs-mux-kit-"+((D=H())==null?void 0:D.VERSION.split(".")[0]),_.plugins.mux.data.player_software_version=E.i8,_}function p(_){var D,I;(I=(D=_.tech_)==null?void 0:D.sourceHandler_)==null||I.hls.on(x().Events.MANIFEST_LOADED,function(w,B){if(B.subtitles){let N;for(N=0;N<B.subtitles.length;N++)_.addRemoteTextTrack({kind:B.subtitles[N].type,label:B.subtitles[N].name,srclang:B.subtitles[N].lang,default:B.subtitles[N].default},!1)}}),_.remoteTextTracks().addEventListener("change",w=>{let B=_.remoteTextTracks(),N,W=!1;for(N=0;N<B.length;N++)B[N].mode==="showing"&&(_.tech_.sourceHandler_.hls.subtitleTrack=N,W=!0);W!==!0&&(_.tech_.sourceHandler_.hls.subtitleTrack=-1)})}const f={},h={},m=H().registerPlugin||H().plugin,L=(_,D)=>{_.addClass("vjs-vtt-thumbnails"),_.vttThumbnails=new v(_,D)},S=function(_){this.ready(()=>{L(this,H().mergeOptions(f,_))})};class v{constructor(D,I){return this.player=D,this.options=I,this.listenForDurationChange(),this.initializeThumbnails(),this.registeredEvents={},this}src(D){this.resetPlugin(),this.options.src=D,this.initializeThumbnails()}detach(){this.resetPlugin()}resetPlugin(){this.thumbnailHolder&&this.thumbnailHolder.parentNode.removeChild(this.thumbnailHolder),this.progressBar&&(this.progressBar.removeEventListener("mouseenter",this.registeredEvents.progressBarMouseEnter),this.progressBar.removeEventListener("mouseleave",this.registeredEvents.progressBarMouseLeave),this.progressBar.removeEventListener("mousemove",this.registeredEvents.progressBarMouseMove)),delete this.registeredEvents.progressBarMouseEnter,delete this.registeredEvents.progressBarMouseLeave,delete this.registeredEvents.progressBarMouseMove,delete this.progressBar,delete this.vttData,delete this.thumbnailHolder,delete this.lastStyle}listenForDurationChange(){this.player.on("durationchange",()=>{})}initializeThumbnails(){if(!this.options.src)return;const D=this.getBaseUrl(),I=this.getFullyQualifiedUrl(this.options.src,D);this.getVttFile(I).then(w=>{this.vttData=this.processVtt(w),this.setupThumbnailElement()})}getBaseUrl(){return[window.location.protocol,"//",window.location.hostname,window.location.port?":"+window.location.port:"",window.location.pathname].join("").split(/([^\/]*)$/gi).shift()}getVttFile(D){return new Promise((I,w)=>{const B=new XMLHttpRequest;B.data={resolve:I},B.addEventListener("load",this.vttFileLoaded),B.open("GET",D),B.overrideMimeType("text/plain; charset=utf-8"),B.send()})}vttFileLoaded(){this.data.resolve(this.responseText)}setupThumbnailElement(D){let I=null;this.options.showTimestamp||(I=this.player.$(".vjs-mouse-display"));const w=document.createElement("div");w.setAttribute("class","vjs-vtt-thumbnail-display"),this.progressBar=this.player.$(".vjs-progress-control"),this.progressBar.appendChild(w),this.thumbnailHolder=w,I&&!this.options.showTimestamp&&I.classList.add("vjs-hidden"),this.registeredEvents.progressBarMouseEnter=()=>this.onBarMouseenter(),this.registeredEvents.progressBarMouseLeave=()=>this.onBarMouseleave(),this.progressBar.addEventListener("mouseenter",this.registeredEvents.progressBarMouseEnter),this.progressBar.addEventListener("mouseleave",this.registeredEvents.progressBarMouseLeave)}onBarMouseenter(){this.mouseMoveCallback=D=>{this.onBarMousemove(D)},this.registeredEvents.progressBarMouseMove=this.mouseMoveCallback,this.progressBar.addEventListener("mousemove",this.registeredEvents.progressBarMouseMove),this.showThumbnailHolder()}onBarMouseleave(){this.registeredEvents.progressBarMouseMove&&this.progressBar.removeEventListener("mousemove",this.registeredEvents.progressBarMouseMove),this.hideThumbnailHolder()}getXCoord(D,I){const w=D.getBoundingClientRect(),B=document.documentElement;return I-(w.left+(window.pageXOffset||B.scrollLeft||0))}onBarMousemove(D){this.updateThumbnailStyle(H().dom.getPointerPosition(this.progressBar,D).x,this.progressBar.offsetWidth)}getStyleForTime(D){for(let I=0;I<this.vttData.length;++I){const w=this.vttData[I];if(D>=w.start&&D<w.end){if(w.css.url&&!h[w.css.url]){const B=new Image;B.src=w.css.url,h[w.css.url]=B}return w.css}}}showThumbnailHolder(){this.thumbnailHolder.style.opacity="1"}hideThumbnailHolder(){this.thumbnailHolder.style.opacity="0"}updateThumbnailStyle(D,I){const w=this.player.duration(),B=D*w,N=this.getStyleForTime(B);if(!N)return this.hideThumbnailHolder();const W=D*I,G=parseInt(N.width,10),V=G>>1,X=I-(W+V),$=W-V;if($>0&&X>0?this.thumbnailHolder.style.transform="translateX("+(W-V)+"px)":$<=0?this.thumbnailHolder.style.transform="translateX("+0+"px)":X<=0&&(this.thumbnailHolder.style.transform="translateX("+(I-G)+"px)"),!(this.lastStyle&&this.lastStyle===N)){this.lastStyle=N;for(const q in N)N.hasOwnProperty(q)&&(this.thumbnailHolder.style[q]=N[q])}}processVtt(D){const I=[];return D.split(/[\r\n][\r\n]/i).forEach(B=>{if(B.match(/([0-9]{2}:)?([0-9]{2}:)?[0-9]{2}(.[0-9]{3})?( ?--> ?)([0-9]{2}:)?([0-9]{2}:)?[0-9]{2}(.[0-9]{3})?[\r\n]{1}.*/gi)){const N=B.split(/[\r\n]/i),G=N[0].split(/ ?--> ?/i),V=G[0],X=G[1],$=N[1],q=this.getVttCss($);I.push({start:this.getSecondsFromTimestamp(V),end:this.getSecondsFromTimestamp(X),css:q})}}),I}getFullyQualifiedUrl(D,I){return D.indexOf("//")>=0?D:I.indexOf("//")===0?[I.replace(/\/$/gi,""),this.trim(D,"/")].join("/"):I.indexOf("//")>0?[this.trim(I,"/"),this.trim(D,"/")].join("/"):D}getPropsFromDef(D){const I=D.split(/#xywh=/i),w=I[0],N=I[1].match(/[0-9]+/gi);return{x:N[0],y:N[1],w:N[2],h:N[3],image:w}}getVttCss(D){const I={};let w;if(this.options.src.indexOf("//")>=0?w=this.options.src.split(/([^\/]*)$/gi).shift():w=this.getBaseUrl()+this.options.src.split(/([^\/]*)$/gi).shift(),D=this.getFullyQualifiedUrl(D,w),!D.match(/#xywh=/i))return I.background='url("'+D+'")',I;const B=this.getPropsFromDef(D);return I.background='url("'+B.image+'") no-repeat -'+B.x+"px -"+B.y+"px",I.width=B.w+"px",I.height=B.h+"px",I.url=B.image,I}deconstructTimestamp(D){const I=D.split("."),B=I[0].split(":");return{milliseconds:parseInt(I[1],10)||0,seconds:parseInt(B.pop(),10)||0,minutes:parseInt(B.pop(),10)||0,hours:parseInt(B.pop(),10)||0}}getSecondsFromTimestamp(D){const I=this.deconstructTimestamp(D);return parseInt(I.hours*(60*60)+I.minutes*60+I.seconds+I.milliseconds/1e3,10)}trim(D,I){let w=[" ",`
`,"\r","	","\f","\v","\xA0","\u2000","\u2001","\u2002","\u2003","\u2004","\u2005","\u2006","\u2007","\u2008","\u2009","\u200A","\u200B","\u2028","\u2029","\u3000"].join(""),B=0,N=0;for(D+="",I&&(w=(I+"").replace(/([[\]().?/*{}+$^:])/g,"$1")),B=D.length,N=0;N<B;N++)if(w.indexOf(D.charAt(N))===-1){D=D.substring(N);break}for(B=D.length,N=B-1;N>=0;N--)if(w.indexOf(D.charAt(N))===-1){D=D.substring(0,N+1);break}return w.indexOf(D.charAt(0))===-1?D:""}}m("vttThumbnails",S);const n=null;function s(_){_.timelineHoverPreviews=function(D){let I=(D==null?void 0:D.enabled)||!1,w=(D==null?void 0:D.src)||null;if(!I&&typeof _.vttThumbnails.detach=="function"){_.vttThumbnails.detach(),_.options().timelineHoverPreviewsUrl=null;return}else if(typeof _.vttThumbnails=="function"&&w!==null){_.vttThumbnails({src:w}),_.options().timelineHoverPreviewsUrl=w;return}else if(typeof _.vttThumbnails.src=="function"&&w!==null){_.vttThumbnails.src(w),_.options().timelineHoverPreviewsUrl=w;return}}}H().hook("beforesetup",function(_,D){return D=i(_,D),D}),H().hook("setup",function(_){s(_),_.options().timelineHoverPreviewsUrl&&_.timelineHoverPreviews({enabled:!0,src:_.options().timelineHoverPreviewsUrl})}),H().use("video/mux",_=>({setSource({src:D},I){if(_.options().timelineHoverPreviews){let B=`https://image.mux.com/${D.split("?",1)[0]}/storyboard.vtt`;_.timelineHoverPreviews({enabled:!0,src:B})}I(null,{src:`https://stream.mux.com/${D}`,type:"application/x-mpegurl"}),_.mux&&_.mux.addHLSJS&&a(_),p(_)}}));const A=H()},893:()=>{}},$t={};function Qe(oe){var re=$t[oe];if(re!==void 0)return re.exports;var K=$t[oe]={exports:{}};return pi[oe].call(K.exports,K,K.exports,Qe),K.exports}(()=>{Qe.n=oe=>{var re=oe&&oe.__esModule?()=>oe.default:()=>oe;return Qe.d(re,{a:re}),re}})(),(()=>{Qe.d=(oe,re)=>{for(var K in re)Qe.o(re,K)&&!Qe.o(oe,K)&&Object.defineProperty(oe,K,{enumerable:!0,get:re[K]})}})(),(()=>{Qe.g=function(){if(typeof globalThis=="object")return globalThis;try{return this||new Function("return this")()}catch(oe){if(typeof window=="object")return window}}()})(),(()=>{Qe.o=(oe,re)=>Object.prototype.hasOwnProperty.call(oe,re)})();var kn=Qe(18);return kn})()});
